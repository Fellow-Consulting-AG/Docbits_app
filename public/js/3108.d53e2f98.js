"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[3108],{43108:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Le});var i=s(61758),a=s(58790);const o={class:"row highlighted-back q-pl-md field_validation"},r={class:"row full-width"},l={class:"primary-dashboard"},n={key:1,class:"row q-pl-md"},d={key:2,class:"row bg-grey-2 q-pl-md q-pr-md q-pb-md"},u={class:"col-3 footer-status-message"};function c(e,t,s,c,p,h){const g=(0,i.g2)("MessageBanner"),_=(0,i.g2)("SubHeader"),m=(0,i.g2)("q-icon"),k=(0,i.g2)("f-btn"),b=(0,i.g2)("Task"),f=(0,i.g2)("ImageComponent"),v=(0,i.g2)("q-splitter"),y=(0,i.g2)("ErrorDocumentView"),w=(0,i.g2)("Loader"),L=(0,i.g2)("q-separator"),F=(0,i.g2)("q-toolbar"),D=(0,i.g2)("q-footer");return(0,i.uX)(),(0,i.CE)(i.FK,null,[e.isReadOnly||e.error?((0,i.uX)(),(0,i.Wv)(g,{key:0,message:e.error_message,messageCategoryClass:"error-banner"},null,8,["message"])):(0,i.Q3)("",!0),(0,i.bF)(_,{name:"tasks",label:e.$t("tasks"),show_expiry_alert:!0,onSearch:!1},null,8,["label"]),(0,i.Lk)("div",o,[(0,i.Lk)("div",r,[(0,i.Lk)("div",{class:"secondary-c-text text-h6",style:(0,a.Tr)("width:"+e.imageFieldSplitter+"%")},[(0,i.bF)(k,{appearance:"tertiary",onClick:e.goToList},{default:(0,i.k6)((()=>[(0,i.bF)(m,{name:"fa-solid fa-circle-arrow-left",size:"sm"}),(0,i.Lk)("label",l,(0,a.v_)(e.$t("tasks")),1)])),_:1},8,["onClick"])],4),(0,i.Lk)("div",{class:"q-pt-sm q-pl-md filename-container",style:(0,a.Tr)("width:"+(100-e.imageFieldSplitter)+"%")},null,4)])]),e.doc_fetch_error?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.bF)(y)])):((0,i.uX)(),(0,i.CE)("div",n,[(0,i.Lk)("div",{class:(0,a.C4)(["scroll-area-height-medi",e.expert_mode?"right_section":"full-width"]),id:"right_section"},[(0,i.bF)(v,{modelValue:e.splitterModel,"onUpdate:modelValue":t[0]||(t[0]=t=>e.splitterModel=t),class:"aa-splitter full-width right-content-height"},{before:(0,i.k6)((()=>[e.task?((0,i.uX)(),(0,i.Wv)(b,{key:0})):(0,i.Q3)("",!0)])),separator:(0,i.k6)((()=>[])),after:(0,i.k6)((()=>[(0,i.bF)(f,{renderOpenWindoIcon:!0,docName:e.record.filename,docImages:e.record.images},null,8,["docName","docImages"])])),_:1},8,["modelValue"])],2)])),(0,i.bF)(w),(0,i.bF)(D,{class:"validation-status-bar back-white"},{default:(0,i.k6)((()=>[(0,i.bF)(F,{class:"row justify-start"},{default:(0,i.k6)((()=>[(0,i.Lk)("span",{class:"footer-filename text-primary cursor-pointer",onClick:t[1]||(t[1]=t=>e.openDocument())},(0,a.v_)(e.record.filename),1),(0,i.bF)(L,{vertical:"",class:"q-mx-md"}),(0,i.Lk)("span",u,(0,a.v_)(e.currentDisplayedMessage),1)])),_:1})])),_:1})],64)}var p=s(1659),h=s(24622),g=s(38734),_=s(96056),m=s(8420),k=s(64233),b=s(18505),f=s(28684),v=s(25891),y=s(95488),w=s(12566),L=s(68450),F=s(94822),D=s(64775),V=s(29104);const q={class:"row full-width q-mb-sm"},A={class:"col-9 secondary-c-text text-h6 text-weight-bold"},T={key:0,class:"col-3 secondary-c-text text-h6 text-weight-bold q-ml-auto"},C={class:"row full-width q-mb-sm"},Q={class:"row full-width q-mb-sm"},O={class:"col-6"},$={class:"col-6 q-pl-sm"},U={class:"row full-width q-mb-sm"},x={class:"col-6"},I={class:"row items-center"},P={class:"row items-center justify-end q-gutter-sm"},E={class:"col-5 q-pl-sm"},M={class:"ellipsis"},S={class:"col-1"},K={class:"row full-width q-mb-sm"};function R(e,t,s,o,r,l){const n=(0,i.g2)("f-btn"),d=(0,i.g2)("q-tooltip"),u=(0,i.g2)("q-icon"),c=(0,i.g2)("q-input"),p=(0,i.g2)("q-select"),h=(0,i.g2)("q-date"),g=(0,i.g2)("q-popup-proxy"),_=(0,i.g2)("q-item-section"),m=(0,i.g2)("q-item"),k=(0,i.g2)("q-toggle"),b=(0,i.g2)("q-card-section"),f=(0,i.g2)("q-card-actions"),v=(0,i.g2)("q-card"),y=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.Wv)(v,{flat:"",class:"popup-background"},{default:(0,i.k6)((()=>[(0,i.bF)(b,{class:"q-pa-md"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",q,[(0,i.Lk)("div",A,(0,a.v_)(e.$t("task_details")),1),e.assign_to_me?((0,i.uX)(),(0,i.CE)("div",T,[(0,i.bF)(n,{label:e.$t("assign_to_me"),appearance:"primary",onClick:e.AssignToMe,class:"float-right"},null,8,["label","onClick"])])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",C,[(0,i.bF)(c,{dense:"",outlined:"",modelValue:e.task.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.task.title=t),class:"back-white full-width",label:e.$t("name")},{append:(0,i.k6)((()=>[e.errors.hasOwnProperty("title")&&""!=e.errors["title"]?((0,i.uX)(),(0,i.Wv)(u,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{class:"bg-red line-error-tooltip"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.errors["title"]),1)])),_:1})])),_:1})):(0,i.Q3)("",!0)])),_:1},8,["modelValue","label"])]),(0,i.Lk)("div",Q,[(0,i.Lk)("div",O,[(0,i.bF)(p,{dense:"",outlined:"",options:e.priorityOptions,class:"back-white",modelValue:e.task.priority,"onUpdate:modelValue":t[1]||(t[1]=t=>e.task.priority=t),"emit-value":"","map-options":"",label:e.$t("priority")},null,8,["options","modelValue","label"])]),(0,i.Lk)("div",$,[(0,i.bF)(p,{dense:"",outlined:"",options:e.statusOptions,class:"back-white",modelValue:e.task.status,"onUpdate:modelValue":t[2]||(t[2]=t=>e.task.status=t),label:e.$t("status"),"emit-value":"","map-options":""},null,8,["options","modelValue","label"])])]),(0,i.Lk)("div",U,[(0,i.Lk)("div",x,[(0,i.bF)(c,{dense:"",outlined:"",readonly:"",class:"back-white",modelValue:e.task.deadline,"onUpdate:modelValue":t[9]||(t[9]=t=>e.task.deadline=t),label:e.$t("deadline")},{append:(0,i.k6)((()=>[(0,i.bF)(u,{name:"event",class:"cursor-pointer",onClick:t[8]||(t[8]=(0,V.D$)((()=>{}),["stop"]))},{default:(0,i.k6)((()=>[(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.eW)("Select Date-Time")])),_:1}),(0,i.bF)(g,{cover:"",modelValue:e.show_calender,"onUpdate:modelValue":t[7]||(t[7]=t=>e.show_calender=t),"transition-show":"scale","transition-hide":"scale",ref:"qDateProxy"},{default:(0,i.k6)((()=>[(0,i.bF)(h,{modelValue:e.task.date,"onUpdate:modelValue":[t[5]||(t[5]=t=>e.task.date=t),t[6]||(t[6]=t=>{e.OnDateChange(t)})],minimal:""},{default:(0,i.k6)((()=>[(0,i.Lk)("div",I,[(0,i.bF)(u,{name:"schedule ",class:"icon-grey q-mr-sm",size:"20px"}),(0,i.bF)(p,{dense:"",outlined:"",options:e.timeOptions,class:"back-white",modelValue:e.task.time,"onUpdate:modelValue":[t[3]||(t[3]=t=>e.task.time=t),t[4]||(t[4]=t=>{e.OnTimeChange(t)})],label:e.$t("set_time"),"emit-value":"","map-options":""},null,8,["options","modelValue","label"])]),(0,i.Lk)("div",P,[(0,i.bo)((0,i.bF)(n,{label:e.$t("pages.select_app.close"),appearance:"negative-tertiary"},null,8,["label"]),[[y]]),(0,i.bo)((0,i.bF)(n,{label:"Ok",appearance:"tertiary"},null,512),[[y]])])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue","label"])]),(0,i.Lk)("div",E,[e.task["assigned_to_group"]?((0,i.uX)(),(0,i.Wv)(p,{key:0,clearable:"","use-input":"",dense:"",outlined:"",onFilter:e.filterGroupsEvent,options:e.filteredGroupList,loading:e.groups_loading,"hide-dropdown-icon":"","emit-value":"","map-options":"",class:"back-white",modelValue:e.task.assigned_to_group_id,"onUpdate:modelValue":t[10]||(t[10]=t=>e.task.assigned_to_group_id=t),label:e.$t("assigned_to_group")},{"selected-item":(0,i.k6)((e=>[(0,i.Lk)("div",M,(0,a.v_)(e.opt.label),1)])),"no-option":(0,i.k6)((()=>[(0,i.bF)(m,null,{default:(0,i.k6)((()=>[(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.eW)(" No results ")])),_:1})])),_:1})])),append:(0,i.k6)((()=>[e.errors.hasOwnProperty("assigned_to_group_id")&&""!=e.errors["assigned_to_group_id"]?((0,i.uX)(),(0,i.Wv)(u,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{class:"bg-red line-error-tooltip"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.errors["assigned_to_group_id"]),1)])),_:1})])),_:1})):(0,i.Q3)("",!0)])),_:1},8,["onFilter","options","loading","modelValue","label"])):(0,i.Q3)("",!0),e.task["assigned_to_group"]?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(p,{key:1,clearable:"","use-input":"",dense:"",outlined:"","hide-dropdown-icon":"",onFilter:e.filterUsersEvent,options:e.filteredUserList,loading:e.user_list_loading,"emit-value":"","map-options":"",class:"back-white",modelValue:e.task.assigned_to_user_id,"onUpdate:modelValue":t[11]||(t[11]=t=>e.task.assigned_to_user_id=t),label:e.$t("assigned_to")},{append:(0,i.k6)((()=>[e.errors.hasOwnProperty("assigned_to_user_id")&&""!=e.errors["assigned_to_user_id"]?((0,i.uX)(),(0,i.Wv)(u,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{class:"bg-red line-error-tooltip"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.errors["assigned_to_user_id"]),1)])),_:1})])),_:1})):(0,i.Q3)("",!0)])),"no-option":(0,i.k6)((()=>[(0,i.bF)(m,null,{default:(0,i.k6)((()=>[(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.eW)(" No results ")])),_:1})])),_:1})])),_:1},8,["onFilter","options","loading","modelValue","label"]))]),(0,i.Lk)("div",S,[(0,i.bF)(k,{size:"lg",modelValue:e.task["assigned_to_group"],"onUpdate:modelValue":[t[12]||(t[12]=t=>e.task["assigned_to_group"]=t),e.resetAssigned],icon:e.task["assigned_to_group"]?"group":"person"},null,8,["modelValue","onUpdate:modelValue","icon"])])]),(0,i.Lk)("div",K,[(0,i.bF)(c,{dense:"",outlined:"",modelValue:e.task.description,"onUpdate:modelValue":t[13]||(t[13]=t=>e.task.description=t),class:"back-white full-width",label:e.$t("description"),type:"textarea",rows:"10"},null,8,["modelValue","label"])])])),_:1}),(0,i.bF)(f,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{label:e.$t("save"),appearance:"tertiary",onClick:e.save,class:"cursor-pointer"},null,8,["label","onClick"]),(0,i.bF)(n,{label:e.$t("save_and_exit"),appearance:"primary",onClick:e.done,class:"cursor-pointer"},null,8,["label","onClick"]),(0,i.bF)(n,{label:e.$t("done"),appearance:"positive",onClick:e.finish_task,class:"q-mr-sm cursor-pointer"},null,8,["label","onClick"])])),_:1})])),_:1})}var W=s(94124),B=s(91486),G=s(11470),z=function(e,t,s,i){function a(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,o){function r(e){try{n(i.next(e))}catch(t){o(t)}}function l(e){try{n(i["throw"](e))}catch(t){o(t)}}function n(e){e.done?s(e.value):a(e.value).then(r,l)}n((i=i.apply(e,t||[])).next())}))};const X=(0,i.pM)({props:{},mixins:[h.A],emits:["btnClicked"],components:{},data(){return{}},watch:{groups_loading:function(e){e&&this.loadGroupsList()},user_list_loading:function(e){e&&this.loadUserList()},data_fetched:function(e){e&&(this.isButtonVisible(),this.convertDeadline())}},mounted:function(){this.initView()},methods:{initView(){try{this.priorityOptions=B.G.map((e=>({label:this.$t(e),value:e}))),this.statusOptions=B.E.map((e=>({label:this.$t(e),value:e}))),this.makeTimeOptions(),this.convertDeadline(),this.loadUserList(),this.loadGroupsList(),this.isButtonVisible()}catch(e){}},isButtonVisible(){if(this.assign_to_me=!1,!this.data_fetched||!this.task.assigned_to_group_id)return;if(!this.task.hasOwnProperty("group_users")||0===this.task.group_users.length)return;const e=this.getUserDetailByKey("id");for(const[t,s]of Object.entries(this.task.group_users))s===e&&(this.assign_to_me=!0)},convertDeadline(){try{if(!this.data_fetched||(0,L.z)(this.task.deadline))return;const{formated_date:e,formatted_time:t,formatted_deadline:s}=this.getDisplayDeadline(this.task.deadline);this.task.date=e,this.task.time=t,this.task.deadline=s}catch(e){}},OnTimeChange(e){const t=this.makeDeadline(e,this.task.date);this.task.deadline=t},OnDateChange(e){const t=this.makeDeadline(this.task.time,e);this.task.deadline=t},resetAssigned(){this.errors["assigned_to_group_id"]="",this.errors["assigned_to_user_id"]="",this.task.assigned_to_group_id=null,this.task.assigned_to_user_id=null},loadUserList(){this.filteredUserList=this.usersList},loadGroupsList(){this.filteredGroupList=this.group_list},filterGroupsEvent(e,t,s){e.length<1?s():t((()=>{const t=e.toLowerCase();this.filteredGroupList=this.group_list.filter((e=>e.label.toLowerCase().startsWith(t)))}))},filterUsersEvent(e,t,s){e.length<1?s():t((()=>{const t=e.toLowerCase();this.filteredUserList=this.usersList.filter((e=>e.label.toLowerCase().startsWith(t)))}))},finish_task(){return z(this,void 0,void 0,(function*(){this.task.status="done",yield this.done()}))},done(){return z(this,void 0,void 0,(function*(){yield this.save(),this.$router.go(-1)}))},save(){return z(this,void 0,void 0,(function*(){try{if(!this.validateForm())return;this.processing=!0;const e=Object.assign({},this.task);e.deadline=this.getIsoFormatDate(e.deadline),(0,L.z)(e.assigned_to_group_id)&&(e.assigned_to_group_id="",e.assigned_to_group="");const t=yield G.Hg.editTask(this.task.id,e);if(!1===t.success)throw t;this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),t.data.hasOwnProperty("group_users")&&(this.task.group_users=t.data.group_users)}catch(e){const t=D.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.processing=!1}}))},validateForm(){this.errors={};let e=!0;return this.task.title||(this.errors["title"]=this.$t("field_required"),e=!1),this.task.assigned_to_group?this.task.assigned_to_group_id||(this.errors["assigned_to_group_id"]=this.$t("field_required"),e=!1):this.task.assigned_to_user_id||(this.errors["assigned_to_user_id"]=this.$t("field_required"),e=!1),e},AssignToMe(){this.task.assigned_to_user_id=this.getUserDetailByKey("id"),this.task.assigned_to_group_id=null,this.task.assigned_to_group=!1,this.save()}},setup(){const e=(0,W.OP)(),{task:t,processing:s,data_fetched:i,timeOptions:a,task_date_format:o}=(0,p.bP)(e),{getTasks:r,makeTimeOptions:l,getDeadlineTime:n,getIsoFormatDate:d,makeDeadline:u,getDisplayDeadline:c}=e,h=(0,W.cY)(),_=(0,g.KR)(h.usersList),{user_list_loading:m,usersList:k}=(0,p.bP)(h),b=(0,W.$i)(),f=(0,g.KR)(b.group_list),{group_list:v,groups_loading:y}=(0,p.bP)(b),w=(0,W.kH)(),{getUserDetailByKey:L}=w;return{getDisplayDeadline:c,makeDeadline:u,getIsoFormatDate:d,task_date_format:o,getDeadlineTime:n,getUserDetailByKey:L,timeOptions:a,makeTimeOptions:l,data_fetched:i,group_list:v,groups_loading:y,filteredGroupList:f,user_list_loading:m,usersList:k,filteredUserList:_,task:t,processing:s,getTasks:r,priorityOptions:(0,g.KR)([]),statusOptions:(0,g.KR)([]),show_calender:(0,g.KR)(!1),errors:(0,g.KR)({}),assign_to_me:(0,g.KR)(!1)}}});var N=s(12807),j=s(23316),H=s(44189),Y=s(67837),J=s(50492),Z=s(97410),ee=s(94940),te=s(48975),se=s(93692),ie=s(90124),ae=s(25173),oe=s(66908),re=s(62669),le=s(88672),ne=s(98582),de=s.n(ne);const ue=(0,N.A)(X,[["render",R]]),ce=ue;de()(X,"components",{QCard:j.A,QCardSection:H.A,QInput:Y.A,QIcon:J.A,QTooltip:Z.A,QSelect:ee.A,QPopupProxy:te.A,QDate:se.A,QItem:ie.A,QItemSection:ae.A,QToggle:oe.A,QCardActions:re.A}),de()(X,"directives",{ClosePopup:le.A});var pe=s(84857),he=function(e,t,s,i){function a(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,o){function r(e){try{n(i.next(e))}catch(t){o(t)}}function l(e){try{n(i["throw"](e))}catch(t){o(t)}}function n(e){e.done?s(e.value):a(e.value).then(r,l)}n((i=i.apply(e,t||[])).next())}))};const ge=(0,i.pM)({el:"#app",mixins:[h.A,_.A,b.A,k.A,v.A,f.A],components:{Loader:m.A,ErrorDocumentView:w.A,ImageComponent:F["default"],Task:ce,MessageBanner:pe.A,SubHeader:y.A},watch:{processing:function(e){e?this.showLoading():this.hideLoading()}},data(){return{docId:"",currentDisplayedMessage:(0,g.KR)("")}},beforeRouteLeave(e,t,s){this.record={},this.page=1,s()},mounted:function(){this.init(),window.addEventListener("resize",this.windowResize),document.body.addEventListener("click",this.mouseClicked,!0),document.addEventListener("dispatch_status_bar_message",this.dispatchTaskbarMessage)},unmounted:function(){window.removeEventListener("resize",this.windowResize),document.removeEventListener("dispatch_status_bar_message",this.dispatchTaskbarMessage)},methods:{dispatchTaskbarMessage(e){e.detail.message&&(this.currentDisplayedMessage=e.detail.message)},init(){return he(this,void 0,void 0,(function*(){try{this.data_fetched=!1,this.showLoading(),this.resetTaskStore(),yield this.prepareUsersDropdown(),yield this.getGroups();const e=this.$route.params.id;if(yield this.getTask(e),this.docId=this.task.document_id,yield this.getInvoiceDataByDocId(this.docId),this.data_fetched=!0,!this.record||0===Object.keys(this.record).length||!1===this.record.success||this.doc_fetch_error)return void this.hideLoading()}catch(e){const t=D.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.hideLoading()}}))},getInvoiceDataByDocId(e){return he(this,void 0,void 0,(function*(){try{this.record=[];const t=yield this.getDocumentById(e);null!=t&&!1===t.success&&(this.error_message=t.message,this.error=!0,this.currentDisplayedMessage=t.message)}catch(t){throw t}}))},hasApiData(){return 0!==(0,L.Ns)(this.record)&&!this.doc_fetch_error},goToList(){this.$router.push("/tasks")},openDocument(){this.record.hasOwnProperty("has_layout")&&"true"===String(this.record.has_layout)&&this.$router.push("/field_validation_v1/"+this.record.doc_id)}},setup(){const e=(0,W.q3)();e.$reset();const{record:t,doc_loaded:s,error:i,has_ai_table:a,page:o,error_message:r}=(0,p.bP)(e),{getDocumentById:l}=e,n=(0,W._6)(),{tokenQueryParam:d}=(0,p.bP)(n);n.getTokenQueryParam();const u=(0,W.OP)(),{task:c,data_fetched:h}=(0,p.bP)(u),{getTask:_,resetTaskStore:m}=u,k=(0,W.cY)(),{prepareUsersDropdown:b}=k,f=(0,W.$i)(),{getGroups:v}=f;return{error_message:r,data_fetched:h,prepareUsersDropdown:b,getGroups:v,resetTaskStore:m,task:c,getTask:_,has_ai_table:a,doc_loaded:s,getDocumentById:l,record:t,error:i,doc_fetch_error:(0,g.KR)(""),page:o,isReadOnly:(0,g.KR)(!1),imageFieldSplitter:(0,g.KR)(36),is_admin:(0,g.KR)(!1),tokenQueryParam:d,splitterModel:(0,g.KR)(50)}}});var _e=s(98072),me=s(57092),ke=s(36914),be=s(10386),fe=s(67156),ve=s(42315),ye=s(56384);const we=(0,N.A)(ge,[["render",c],["__scopeId","data-v-804fb6bc"]]),Le=we;de()(ge,"components",{QIcon:J.A,QSplitter:_e.A,QFooter:me.A,QToolbar:ke.A,QSeparator:be.A,QField:fe.A,QTable:ve.A,QBtn:ye.A,QItem:ie.A})}}]);