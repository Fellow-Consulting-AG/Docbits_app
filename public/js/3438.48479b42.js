"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[3438],{43438:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ke});var r=a(61758),l=a(58790),i=a(29104);const s=e=>((0,r.Qi)("data-v-968ae0ae"),e=e(),(0,r.jt)(),e),o={class:"q-ml-auto col-6 mobile-hide"},d={class:"row __bg_wrapper q-px-lg q-pb-lg"},n={class:"col-12 border-bottom-bdbdbd q-pb-sm"},u={class:"row"},c={class:"col-6 items-center"},_={class:"text-h6 text-bold text-primary flex items-center"},p=s((()=>(0,r.Lk)("img",{src:"images/purchase-order-icon-20240409-130351.svg",style:{width:"70px"}},null,-1))),h={key:0,class:"col-12 mt-4 q-pa-lg text-blue-grey-5"},g={class:"row mb-4"},m={class:"col-3 text-bold"},v={class:"col-3 text-uppercase"},b={class:"col-3 text-bold"},k={class:"col-3"},f={class:"row mb-4"},y={class:"col-3 text-bold"},L={class:"col-3"},w={class:"col-3 text-bold"},x={class:"col-3"},q={class:"row mb-4"},A={class:"col-3 text-bold"},P={class:"col-3"},C={class:"col-3 text-bold"},F={class:"col-3"},$={class:"row mb-4"},Q={class:"col-3 text-bold"},D={class:"col-3"},T={class:"col-3 text-bold"},S={class:"col-3"},E={class:"q-pa-md col-12"},I={id:"customers",class:"shadow-1"},K={align:"right"},X={align:"right"},O={align:"right"},B={align:"right"},M={align:"right"},R={class:"sub-table-row"},V={colspan:"100%",class:"sub-table-main-td"},W={class:"text-uppercase sticky-header transparent-header table_height table-striped resizable shadow-1 sub-table"},z={align:"right"},j={align:"right"},N={key:1},U={colspan:"9",class:"text-center"},H={class:"col-12 iframe-padding"},Z={class:"mx-12 q-card mt-10"},G=["src"],Y={class:"text-weight-bold"},J=s((()=>(0,r.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1)));function ee(e,t,a,s,ee,te){const ae=(0,r.g2)("TaskCounters"),re=(0,r.g2)("SubHeader"),le=(0,r.g2)("BackToSettings"),ie=(0,r.g2)("q-badge"),se=(0,r.g2)("q-img"),oe=(0,r.g2)("q-icon"),de=(0,r.g2)("q-skeleton"),ne=(0,r.g2)("q-card-actions"),ue=(0,r.g2)("q-card"),ce=(0,r.g2)("q-toolbar-title"),_e=(0,r.g2)("q-btn"),pe=(0,r.g2)("q-toolbar"),he=(0,r.g2)("SupplierItemNumberMap"),ge=(0,r.g2)("q-card-section"),me=(0,r.g2)("q-dialog"),ve=(0,r.g2)("q-inner-loading"),be=(0,r.gN)("close-popup");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(re,{name:"purchase order",label:e.$t("purchase_order"),show_expiry_alert:!0,display_back_button:!1,back_to_link:"/purchase-order"},{default:(0,r.k6)((()=>[(0,r.Lk)("span",o,[(0,r.bF)(ae)])])),_:1},8,["label"]),(0,r.bF)(le,{back_to_rotue:"/purchase-order",label:e.$t("po_dashboard.back")},null,8,["label"]),(0,r.Lk)("div",d,[(0,r.bF)(ue,{class:"col-12 q-mt-sm q-pa-md"},{default:(0,r.k6)((()=>[(0,r.bF)(ne,{class:"row"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",n,[(0,r.Lk)("div",u,[(0,r.Lk)("div",c,[(0,r.Lk)("div",_,[p,(0,r.Lk)("span",null,(0,l.v_)(e.$t("Purchase_Order"))+" #"+(0,l.v_)(e.po_detail.purchase_order.purchase_order_number),1)])])])]),e.po_detail.purchase_order?((0,r.uX)(),(0,r.CE)("div",h,[(0,r.Lk)("div",g,[(0,r.Lk)("div",m,(0,l.v_)(e.$t("order_status"))+" :",1),(0,r.Lk)("div",v,[e.po_detail.purchase_order.status?((0,r.uX)(),(0,r.Wv)(ie,{key:0,transparent:"",align:"middle",color:e.statusColor(e.po_detail.purchase_order.status)},{default:(0,r.k6)((()=>[(0,r.eW)((0,l.v_)(e.po_detail.purchase_order.status),1)])),_:1},8,["color"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",b,(0,l.v_)(e.$t("purchase_order_number"))+" :",1),(0,r.Lk)("div",k,(0,l.v_)(e.po_detail.purchase_order.purchase_order_number),1)]),(0,r.Lk)("div",f,[(0,r.Lk)("div",y,(0,l.v_)(e.$t("order_date"))+" :",1),(0,r.Lk)("div",L,(0,l.v_)(e.formatDateTimeZone(e.po_detail.purchase_order.order_date,!0)),1),(0,r.Lk)("div",w,(0,l.v_)(e.$t("po_dashboard.requested_delivery_date"))+":",1),(0,r.Lk)("div",x,(0,l.v_)(e.formatDateTimeZone(e.po_detail.purchase_order.requested_shipment_date,!0)),1)]),(0,r.Lk)("div",q,[(0,r.Lk)("div",A,(0,l.v_)(e.$t("total_amount"))+" :",1),(0,r.Lk)("div",P,(0,l.v_)(e.po_detail.purchase_order.total_amount),1),(0,r.Lk)("div",C,(0,l.v_)(e.$t("ship_to_party_name"))+" :",1),(0,r.Lk)("div",F,(0,l.v_)(e.po_detail.purchase_order.ship_to_party_name),1)]),(0,r.Lk)("div",$,[(0,r.Lk)("div",Q,(0,l.v_)(e.$t("warehouse"))+" :",1),(0,r.Lk)("div",D,(0,l.v_)(e.po_detail.purchase_order.location_id),1),(0,r.Lk)("div",T,(0,l.v_)(e.$t("geo_code"))+" :",1),(0,r.Lk)("div",S,(0,l.v_)(e.po_detail.purchase_order.geo_code),1)])])):(0,r.Q3)("",!0),(0,r.Lk)("div",E,[(0,r.Lk)("table",I,[(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.columns,(t=>((0,r.uX)(),(0,r.CE)("th",{key:t.field,class:(0,l.C4)(e.getTextRightAligement(t.field))},(0,l.v_)(t.label),3)))),128))])]),(0,r.Lk)("tbody",null,[e.po_detail.purchase_order_line&&e.po_detail.purchase_order_line.length?((0,r.uX)(!0),(0,r.CE)(r.FK,{key:0},(0,r.pI)(e.po_detail.purchase_order_line,((t,a)=>{var s;return(0,r.uX)(),(0,r.CE)(r.FK,{key:a},[(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(null===(s=t.charges)||void 0===s?void 0:s.length)>0?((0,r.uX)(),(0,r.Wv)(se,{key:0,src:"images/charges/charges.svg",height:"21px",width:"19px",class:"charge-icon icon-grey-svg",onClick:e=>t.show_charges=!t.show_charges},null,8,["onClick"])):(0,r.Q3)("",!0)]),(0,r.Lk)("td",null,[(0,r.bF)(ie,{transparent:"",align:"middle",color:e.statusColor(t.status)},{default:(0,r.k6)((()=>[(0,r.eW)((0,l.v_)(t.status),1)])),_:2},1032,["color"])]),(0,r.Lk)("td",K,(0,l.v_)(t.line_number),1),(0,r.Lk)("td",null,(0,l.v_)(t.item_id),1),(0,r.Lk)("td",null,(0,l.v_)(t.supplier_item_id),1),(0,r.Lk)("td",null,(0,l.v_)(t.description),1),(0,r.Lk)("td",X,(0,l.v_)(t.quantity),1),(0,r.Lk)("td",O,[(0,r.eW)((0,l.v_)(t.received_quantity)+" ",1),t.quantity==t.received_quantity?((0,r.uX)(),(0,r.Wv)(oe,{key:0,name:"check",color:"green",size:"xs"})):(0,r.Q3)("",!0)]),(0,r.Lk)("td",B,(0,l.v_)(t.unit_price),1),(0,r.Lk)("td",M,(0,l.v_)(t.total_amount),1)]),(0,r.bo)((0,r.Lk)("tr",R,[(0,r.Lk)("td",V,[(0,r.Lk)("table",W,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,(0,l.v_)(e.$t("charge_id")),1),(0,r.Lk)("th",null,(0,l.v_)(e.$t("amount")),1),(0,r.Lk)("th",null,(0,l.v_)(e.$t("charge_type")),1),(0,r.Lk)("th",null,(0,l.v_)(e.$t("purchase_order_number")),1)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.charges,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:t},[(0,r.Lk)("td",null,(0,l.v_)(e.charge_id),1),(0,r.Lk)("td",z,(0,l.v_)(e.formattedAmount),1),(0,r.Lk)("td",null,(0,l.v_)(e.charge_type),1),(0,r.Lk)("td",j,(0,l.v_)(e.purchase_order_number),1)])))),128))])])],512),[[i.aG,t.show_charges]])],64)})),128)):(0,r.Q3)("",!0),0==e.po_detail.purchase_order_line.length?((0,r.uX)(),(0,r.CE)("tr",N,[(0,r.Lk)("td",U,(0,l.v_)(e.$t("no_data_found")),1)])):(0,r.Q3)("",!0)])])]),(0,r.Lk)("div",H,[(0,r.Lk)("div",Z,[e.skeletonLoad?((0,r.uX)(),(0,r.Wv)(de,{key:1,style:{width:"100%"},animated:!1,width:"100%",height:"900px",class:"custom-skeleton"})):((0,r.uX)(),(0,r.CE)("iframe",{key:0,id:"preview_frame",src:e.iframe_path,title:"file preview",width:"100%",height:"900px"},null,8,G))])])])),_:1})])),_:1})]),(0,r.bF)(me,{modelValue:e.showSupplierMapDlg,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showSupplierMapDlg=t),persistent:""},{default:(0,r.k6)((()=>[(0,r.bF)(ue,{style:{width:"700px"}},{default:(0,r.k6)((()=>[(0,r.bF)(pe,{class:"text-white secondary-toolbar"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,null,{default:(0,r.k6)((()=>[(0,r.Lk)("span",Y,(0,l.v_)(e.$t("supplier_item_number_map")),1)])),_:1}),(0,r.bo)((0,r.bF)(_e,{flat:"",round:"",dense:"",icon:"close"},null,512),[[be]])])),_:1}),(0,r.bF)(ge,null,{default:(0,r.k6)((()=>[(0,r.bF)(he,{width:100,supplierId:e.po_detail.purchase_order.supplier_id},null,8,["supplierId"])])),_:1}),(0,r.bF)(ne,{align:"right",class:"bg-white text-teal"},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.bF)(_e,{flat:"",label:e.$t("close"),color:"primary"},null,8,["label"]),[[be]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,r.bF)(ve,{showing:e.loading,style:{"z-index":"1000000000"}},{default:(0,r.k6)((()=>[J])),_:1},8,["showing"])],64)}var te=a(23537),ae=a(1659),re=a(60455),le=a(38734),ie=a(76651),se=a(94124),oe=a(30955),de=a(95488),ne=a(62488),ue=a(39012),ce=a(60894),_e=a(11470),pe=a(82303),he=a(68450),ge=a(64775),me=a(46162),ve=a(46736),be=function(e,t,a,r){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,i){function s(e){try{d(r.next(e))}catch(t){i(t)}}function o(e){try{d(r["throw"](e))}catch(t){i(t)}}function d(e){e.done?a(e.value):l(e.value).then(s,o)}d((r=r.apply(e,t||[])).next())}))};const ke=(0,r.pM)({mixins:[ve.A],props:{},data(){return{showSupplierMapDlg:(0,le.KR)(!1),formattedAmount:(0,le.KR)(""),skeletonLoad:(0,le.KR)(!1),iframe_path:(0,le.KR)("")}},components:{SubHeader:de.A,TaskCounters:oe.A,BackToSettings:ce.A,SupplierItemNumberMap:ue.A},mounted(){this.init()},methods:{init(){this.getDataServer()},getDataServer(){return be(this,void 0,void 0,(function*(){try{this.preview_path="",this.loading=!0,this.skeletonLoad=!0;const e=[];yield this.getPurchaseOrderDetail(this.id);const t=yield _e.nb.getPoCharges({purchase_order_numbers:this.po_detail.purchase_order.purchase_order_number});if(t.success){const a=t.data;this.po_detail.purchase_order_line.map((t=>{t.charges=a.filter((e=>e.line_number===t.line_number));for(const a of t.charges)e.push(a.amount);return t.show_charges=!1,t})),this.columns.unshift()}const a=yield this.formatAmount(e),r=t.data;this.po_detail.purchase_order_line.map((e=>{e.charges=r.filter((t=>t.line_number===e.line_number));for(const t of e.charges)t.formattedAmount=this.searchValueByKey(t.amount,a);return e.show_charges=!1,e})),yield this.getPreviewPathDetails()}catch(e){}finally{this.loading=!1,this.skeletonLoad=!1}}))},getPreviewPathDetails(){return be(this,void 0,void 0,(function*(){try{if(!(0,he.z)(this.preview_path)&&!(0,he.jw)(this.preview_path))return void this.getPdfFileDetails();try{this.skeletonLoad=!0,yield this.getPreviewPath(this.id),yield this.getPdfFileDetails()}catch(e){}finally{this.skeletonLoad=!1}}catch(e){const t=ge.t.getErrorMessage(e),a=document.getElementById("preview_frame"),r=a.contentDocument;r&&(r.write("<h1>Error</h1><p>Oops!  "+t+".</p>"),r.close())}}))},getPdfFileDetails(){return be(this,void 0,void 0,(function*(){try{if((0,he.z)(this.preview_path)||(0,he.jw)(this.preview_path))return;const t=(0,se._6)();yield t.getTokenQueryParam();const{tokenQueryParam:a}=t;try{this.skeletonLoad=!0;const e=yield pe.A.get(`${me.VA}/resource/get_file/${this.po_number_path}?path=${this.preview_path}&download=false&${a}`,{responseType:"blob"});if("application/json"==e.headers["content-type"])return setTimeout((()=>{this.getPdfFileDetails()}),5e3);const t=e.config.url;this.iframe_path=t}catch(e){}finally{this.skeletonLoad=!1}}catch(t){}}))},statusColor(e){return(0,ne.qY)(e.toLowerCase())||"primary"},getTextRightAligement(e){return"total_amount"===e||"unit_price"===e||"quantity"===e||"line_number"===e||"received_quantity"===e||"geo_code"===e?"text-right":"text-left"},searchValueByKey(e,t){return(0,se.gP)().searchValueByKey(e,t)},formatAmount(e){return be(this,void 0,void 0,(function*(){let t=[];Array.isArray(e)?t=e.map((e=>({key:e,value:e}))):e?t.push({key:e,value:e}):t.push({key:0,value:0});const{user_settings:a}=(0,se.Bu)(),r=yield(0,se.gP)().formatMultiValues(t,"en_US",a.AMOUNTS_LOCALE);return r}))}},setup(){const{t:e}=(0,te.s9)(),t=(0,ie.av)(),a=(0,re.lq)(),r=(0,le.KR)(a.params.purchase_number),l=(0,le.KR)([{field:"",label:""},{field:"status",label:e("status")},{field:"line_number",label:e("line_number")},{field:"item_id",label:e("item_id")},{field:"supplier_item_id",label:e("supplier_item_id")},{field:"description",label:e("description")},{field:"quantity",label:e("quantity")},{field:"received_quantity",label:e("received_quantity")},{field:"unit_price",label:e("po_unit_price")},{field:"total_amount",label:e("total_amount")}]),{datePattern:i,statusInterface:s,dateFormatOnly:o}=(0,se.Bu)(),{display_data:d,loading:n,table_columns:u,po_detail:c,preview_path:_,po_number_path:p}=(0,ae.bP)(t),{getPurchaseOrderData:h,getPurchaseOrderDetail:g,getPreviewPath:m}=t;return{getPurchaseOrderData:h,getPurchaseOrderDetail:g,dashboard_purchase_order_store:t,id:r,loading:n,display_data:d,po_detail:c,table_columns:u,columns:l,datePattern:i,statusInterface:s,dateFormatOnly:o,purchaseOrderService:_e.nb,preview_path:_,getPreviewPath:m,po_number_path:p}}});var fe=a(12807),ye=a(23316),Le=a(62669),we=a(56384),xe=a(23954),qe=a(15046),Ae=a(50492),Pe=a(43820),Ce=a(82156),Fe=a(36914),$e=a(39150),Qe=a(44189),De=a(39035),Te=a(88672),Se=a(98582),Ee=a.n(Se);const Ie=(0,fe.A)(ke,[["render",ee],["__scopeId","data-v-968ae0ae"]]),Ke=Ie;Ee()(ke,"components",{QCard:ye.A,QCardActions:Le.A,QBtn:we.A,QBadge:xe.A,QImg:qe.A,QIcon:Ae.A,QSkeleton:Pe.Ay,QDialog:Ce.A,QToolbar:Fe.A,QToolbarTitle:$e.A,QCardSection:Qe.A,QInnerLoading:De.A}),Ee()(ke,"directives",{ClosePopup:Te.A})}}]);