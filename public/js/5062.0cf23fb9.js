"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[5062],{5062:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Et});var s=a(61758),i=a(58790);const o=t=>((0,s.Qi)("data-v-3dc080d1"),t=t(),(0,s.jt)(),t),l={class:"row bg-grey-2 q-pb-md"},r={class:"col-12 q-pl-sm q-mt-sm"},n={class:"row"},c={class:"po-container-parrent po-page-height scrolle-y",id:"po-container-parrent"},d={class:"row"},h={class:"col-sm-12 col-md-12 col-lg-12 q-pr-md row"},p={class:"q-mr-auto"},u=o((()=>(0,s.Lk)("img",{width:"30",src:"images/back-primary.svg"},null,-1))),m={class:"q-ml-auto"},_={class:"row ml-10"},g={class:"col-sm-12 col-md-12 col-lg-12"},b={class:"row ml-10"},f={class:"col-sm-4 col-md-4 col-lg-3"},v={class:"col-sm-4 col-md-4 col-lg-4",id:"search-po"},w=o((()=>(0,s.Lk)("div",{class:"col-sm-4 col-md-4 col-lg-5"},null,-1))),y={class:"col-sm-12 col-md-12 col-lg-12"},D=o((()=>(0,s.Lk)("div",{class:"q-mt-sm q-ma-sm"},null,-1))),k={class:"row"},L={class:"col-sm-12 col-md-12 col-lg-12"},x={class:"full-width scrolle-y po-container bg-grey-2"},O={key:1,class:"row q-pa-sm"},P={class:"bg-grey-3"},F=o((()=>(0,s.Lk)("div",{class:"q-mt-sm q-ma-sm"},null,-1))),A={class:"full-width scrolle-y"},E={class:"row bg-white q-pa-sm"},I={class:"col-sm-12 col-md-12 col-lg-12 pr-6 row"},S={class:"q-mr-auto"},T={class:"q-ml-auto"},C={class:"full-width bg-white"},q=["src"],$={class:"po-image-container po-page-height q-pr-md",id:"po-image-container"},R={class:"text-weight-medium text-h6"},V={class:"bg-grey-3"},K={class:"text-left",style:{"font-weight":"bold"}},U={class:"text-left",style:{"font-weight":"900"}},Q=o((()=>(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"bold"}},"Move between items"),(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"900"}},[(0,s.Lk)("span",{class:"shortcut-Key-box"}," TAB ")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"bold"}},"To Select or click a item"),(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"900"}},[(0,s.Lk)("span",{class:"shortcut-Key-box"}," ENTER ")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"bold"}},"Search PO"),(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"900"}},[(0,s.Lk)("span",{class:"shortcut-Key-box"}," f ")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"bold"}},"Selecting first row of PO items "),(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"900"}},[(0,s.Lk)("span",{class:"shortcut-Key-box q-mr-sm"}," CTRL "),(0,s.eW)(" + "),(0,s.Lk)("span",{class:"shortcut-Key-box q-ml-sm"}," SHIFT ")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"bold"}},"To connect a PO line with the line item."),(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"900"}},[(0,s.Lk)("span",{class:"shortcut-Key-box q-mr-sm"}," CTRL "),(0,s.eW)(" + "),(0,s.Lk)("span",{class:"shortcut-Key-box q-ml-sm"}," C ")])]),(0,s.Lk)("tr",null,[(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"bold"}},"To Connect PO Line with line item"),(0,s.Lk)("td",{class:"text-left",style:{"font-weight":"900"}},[(0,s.Lk)("span",{class:"shortcut-Key-box q-mr-sm"}," CTRL "),(0,s.eW)(" + "),(0,s.Lk)("span",{class:"shortcut-Key-box q-ml-sm"}," V ")])])],-1))),N=o((()=>(0,s.Lk)("span",{class:"q-ml-sm"},"PO and AB are not same Please choose action.",-1)));function M(t,e,a,o,M,W){const j=(0,s.g2)("q-icon"),B=(0,s.g2)("q-tooltip"),X=(0,s.g2)("q-btn"),H=(0,s.g2)("q-input"),z=(0,s.g2)("PurchaseOrderPreview"),G=(0,s.g2)("q-dialog"),J=(0,s.g2)("q-tab"),Y=(0,s.g2)("q-tabs"),Z=(0,s.g2)("q-separator"),tt=(0,s.g2)("PurchaseOrder"),et=(0,s.g2)("q-tab-panel"),at=(0,s.g2)("q-tab-panels"),st=(0,s.g2)("q-markup-table"),it=(0,s.g2)("LineItems"),ot=(0,s.g2)("ImageComponent"),lt=(0,s.g2)("Loader"),rt=(0,s.g2)("q-card-section"),nt=(0,s.g2)("q-card"),ct=(0,s.g2)("q-avatar"),dt=(0,s.g2)("q-card-actions"),ht=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",l,[(0,s.Lk)("div",r,[(0,s.Lk)("div",n,[(0,s.Lk)("div",c,[(0,s.Lk)("div",d,[(0,s.Lk)("div",h,[(0,s.Lk)("div",p,[(0,s.bF)(X,{flat:"",rounded:"",color:"primary",to:"/dashboard"},{default:(0,s.k6)((()=>[(0,s.bF)(j,{class:"text-red-13",size:"sm"},{default:(0,s.k6)((()=>[u])),_:1}),(0,s.bF)(B,{anchor:"center left",self:"center right",offset:[10,10]},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(t.$t("dashboard")),1)])),_:1})])),_:1})]),(0,s.Lk)("div",m,[(0,s.bF)(X,{round:"",color:"info",padding:"xs",onClick:t.goToHelp,icon:"info",class:"q-ma-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(B,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(t.$t("help")),1)])),_:1})])),_:1},8,["onClick"]),(0,s.bF)(X,{round:"",color:"positive",padding:"xs",onClick:e[0]||(e[0]=e=>t.showKeyboardShortcuts=!0),icon:"keyboard",class:"q-ma-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(B,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(t.$t("keyboard_shortcut")),1)])),_:1})])),_:1}),(0,s.bF)(X,{round:"",color:"secondary",padding:"xs",onClick:e[1]||(e[1]=e=>t.saveData()),icon:"save",class:"q-ma-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(B,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(t.$t("pages.screen2a.save")),1)])),_:1})])),_:1}),(0,s.bF)(X,{round:"",color:"primary",padding:"xs",onClick:e[2]||(e[2]=e=>t.validationsForExportData()),disable:t.isExportDisabled,icon:"import_export",class:"q-ma-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(B,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(t.$t("pages.settings.export")),1)])),_:1})])),_:1},8,["disable"])])])]),(0,s.Lk)("div",_,[(0,s.Lk)("div",g,(0,i.v_)(t.$t("invoice_id"))+": "+(0,i.v_)(t.get_fields["invoice_id"]),1)]),(0,s.Lk)("div",b,[(0,s.Lk)("div",f,(0,i.v_)(t.$t("purchase_order_number")),1),(0,s.Lk)("div",v,[(0,s.bF)(H,{class:"bg-white po-search",outlined:"",modelValue:t.po_search,"onUpdate:modelValue":e[3]||(e[3]=e=>t.po_search=e),"data-id":"po_search"},{append:(0,s.k6)((()=>[t.po_search&&""!=t.po_search?((0,s.uX)(),(0,s.Wv)(j,{key:0,name:"close",class:"cursor-pointer",onClick:t.clearSearch,tabindex:"0"},null,8,["onClick"])):(0,s.Q3)("",!0),(0,s.bF)(j,{name:"search",onClick:t.searchPurchaseOrder,tabindex:"0"},null,8,["onClick"])])),_:1},8,["modelValue"])]),w,(0,s.Lk)("div",y,[(0,s.bF)(G,{modelValue:t.po_preview,"onUpdate:modelValue":e[4]||(e[4]=e=>t.po_preview=e),persistent:"","full-width":""},{default:(0,s.k6)((()=>[(0,s.bF)(z,{po_preview_columns:t.po_preview_columns,po_lines:t.po_preview_items,po_number:t.po_search,onClearSearch:t.clearSearch,onAddToPoItemsList:t.addToPoItemsList},null,8,["po_preview_columns","po_lines","po_number","onClearSearch","onAddToPoItemsList"])])),_:1},8,["modelValue"])])]),D,(0,s.Lk)("div",k,[(0,s.Lk)("div",L,[(0,s.Lk)("div",x,[!1===t.hasPurchaseOrderItems()?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(Y,{modelValue:t.tab,"onUpdate:modelValue":e[5]||(e[5]=e=>t.tab=e),class:"text-black text-weight-bold align-tabs-left"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.po_items,((t,e)=>((0,s.uX)(),(0,s.Wv)(J,{draggable:"false",key:e,name:e,label:e,tabindex:"0"},null,8,["name","label"])))),128))])),_:1},8,["modelValue"]),(0,s.bF)(Z),(0,s.bF)(at,{modelValue:t.tab,"onUpdate:modelValue":e[6]||(e[6]=e=>t.tab=e)},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.po_items,((e,a)=>((0,s.uX)(),(0,s.Wv)(et,{key:a,name:a},{default:(0,s.k6)((()=>[(0,s.bF)(tt,{apiData:t.apiData,po_lines:e,po_number:a},null,8,["apiData","po_lines","po_number"])])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])],64)):((0,s.uX)(),(0,s.CE)("div",O,[(0,s.bF)(st,{class:"full-width"},{default:(0,s.k6)((()=>[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",P,[(0,s.Lk)("th",null,(0,i.v_)(t.$t("no_po_line_items_found")),1)])])])),_:1})]))]),F,(0,s.Lk)("div",A,[(0,s.Lk)("div",E,[(0,s.Lk)("div",I,[(0,s.Lk)("div",S,(0,i.v_)(t.$t("pages.settings."+t.apiData.doc_type)),1),(0,s.Lk)("div",T,[(0,s.bF)(j,{name:"drag_indicator",class:"float-right secondary-c-text-grey text-h6"})])])]),(0,s.Lk)("div",C,[(0,s.bF)(it,{ref:"lineItemsRef",apiData:t.apiData,onUpdateExtractionDataForSave:t.updateExtractionDataForSave,onUpdateTableDataForSave:t.updateTableDataForSave,onUpdateReadOnlyFlag:t.updateReadOnlyFlag,onUpdateTableForSave:t.updateTableForSave},null,8,["apiData","onUpdateExtractionDataForSave","onUpdateTableDataForSave","onUpdateReadOnlyFlag","onUpdateTableForSave"])])])])])]),(0,s.Lk)("div",{class:"po-image-toggler cursor-pointer",onClick:e[7]||(e[7]=e=>t.togglePoImage())},[(0,s.Lk)("img",{class:"icon-hover po-image-toggler-icon",src:t.togglerIcon},null,8,q)]),(0,s.Lk)("div",$,[(0,s.bF)(ot,{renderOpenWindoIcon:!0,imageData:t.imageObjStr,docName:t.apiData.filename},null,8,["imageData","docName"])])])])]),(0,s.bF)(lt),(0,s.bF)(G,{modelValue:t.showKeyboardShortcuts,"onUpdate:modelValue":e[9]||(e[9]=e=>t.showKeyboardShortcuts=e)},{default:(0,s.k6)((()=>[(0,s.bF)(nt,null,{default:(0,s.k6)((()=>[(0,s.bF)(rt,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",R,(0,i.v_)(t.$t("keyboard_shortcuts")),1)])),_:1}),(0,s.bF)(rt,null,{default:(0,s.k6)((()=>[(0,s.bF)(st,{class:"full-width"},{default:(0,s.k6)((()=>[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",V,[(0,s.Lk)("th",K,(0,i.v_)(t.$t("action")),1),(0,s.Lk)("th",U,(0,i.v_)(t.$t("keyboard_shortcut")),1)])]),Q])),_:1}),(0,s.bF)(X,{flat:"",color:"primary",label:t.$t("conclude"),class:"float-right v-m-10",style:{"font-weight":"900"},onClick:e[8]||(e[8]=e=>t.showKeyboardShortcuts=!1)},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,s.bF)(G,{modelValue:t.confirmDecision,"onUpdate:modelValue":e[12]||(e[12]=e=>t.confirmDecision=e),persistent:""},{default:(0,s.k6)((()=>[(0,s.bF)(nt,null,{default:(0,s.k6)((()=>[(0,s.bF)(rt,{class:"row items-center"},{default:(0,s.k6)((()=>[(0,s.bF)(ct,{icon:"info",color:"primary","text-color":"white"}),N])),_:1}),(0,s.bF)(dt,{align:"right"},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.bF)(X,{flat:"",label:"Cancel",color:"primary"},null,512),[[ht]]),(0,s.bo)((0,s.bF)(X,{flat:"",label:"Close PO",color:"primary",onClick:e[10]||(e[10]=e=>t.setPOStatus("close"))},null,512),[[ht]]),(0,s.bo)((0,s.bF)(X,{flat:"",label:"Accept",color:"primary",onClick:e[11]||(e[11]=e=>t.setPOStatus("accept"))},null,512),[[ht]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var W=a(82303),j=a(24622),B=a(92162),X=a(38734),H=a(46162),z=a(8420),G=a(14907),J=a(76956),Y=a(18505),Z=a(25901),tt=a(37384),et=a(57016),at=a(68450),st=a(94822),it=a(41498),ot=a(11470),lt=a(85487),rt=function(t,e,a,s){function i(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,o){function l(t){try{n(s.next(t))}catch(e){o(e)}}function r(t){try{n(s["throw"](t))}catch(e){o(e)}}function n(t){t.done?a(t.value):i(t.value).then(l,r)}n((s=s.apply(t,e||[])).next())}))};const nt=(0,s.pM)({el:"#app",mixins:[Y.A,j.A],components:{Loader:z.A,LineItems:Z.A,PurchaseOrder:tt.A,ImageComponent:st["default"],PurchaseOrderPreview:et.A},data(){return{docId:"",imageObjStr:"",isReadOnly:!0,allowedDoctypes:J.Gk,po_search:"",warning_alert:{}}},mounted(){this.docId=this.$route.params.id,this.init(),document.addEventListener("po_connection_success",this.lineItemConnected),document.addEventListener("po_connection_remove",this.lineItemPOConnectionRemoved),document.addEventListener("keydown",this.keyDownEvent)},unmounted:function(){document.removeEventListener("po_connection_success",this.lineItemConnected),document.removeEventListener("po_connection_remove",this.lineItemPOConnectionRemoved),document.removeEventListener("keydown",this.keyDownEvent)},methods:{init(){return rt(this,void 0,void 0,(function*(){try{yield this.getInvoiceDataByDocId(this.docId),this.handleReadOnlyAlert(),this.imageObjStr=JSON.stringify(this.apiData.images),this.initPage(),this.apiData.hasOwnProperty("po_matched")&&this.apiData.po_matched.length?this.isExportDisabled=!1:this.isExportDisabled=!0}catch(t){return this.showErrorToast("Error while displaying Page"),void this.hideLoading()}}))},handleReadOnlyAlert(){if(0==this.apiData.editable){let t="po_readonly_doc_warning";J.B2.includes(this.apiData.status)&&(t="po_finished_doc_warning"),"error"===this.apiData.status&&(t="po_error_doc_warning"),this.warning_alert=this.showWarningAlert(this.$t(t))}},getInvoiceDataByDocId(t){return rt(this,void 0,void 0,(function*(){try{this.showLoading();const e={doc_id:t},a=yield ot.M8.getById(e);if(!a.doc_id)return this.showErrorToast(this.$t("pages.messages.INVALID_DOCUMENT")),void this.hideLoading();this.apiData=a,this.setViewEditable(),this.apiData.tables&&Array.isArray(this.apiData.tables)&&this.apiData.tables.length>0&&!this.apiData.tables[0].hasOwnProperty("original_extraction_info")&&this.apiData.tables[0].extraction_info&&(this.apiData.tables[0]["original_extraction_info"]=this.apiData.tables[0].extraction_info),this.apiData.hasOwnProperty("table_data_copy")||(this.apiData["table_data_copy"]=this.apiData.tables)}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},initPage(){this.apiData&&this.apiData.fields&&(this.ShowStaticPO(),this.getFieldValues(),this.renderMultiplePOItems(),this.$forceUpdate())},setViewEditable(){this.apiData.editable=!0,(J.B2.includes(this.apiData.status)||"error"==this.apiData.status)&&(this.apiData.editable=!1)},cleanupDataforApi(t){t&&t.hasOwnProperty("doc_type")&&-1===this.allowedDoctypes.indexOf(t.doc_type)&&t.hasOwnProperty("tables")},saveData(){return rt(this,void 0,void 0,(function*(){let t=this.apiData;this.showLoading(),this.cleanupDataforApi(t),t.hasOwnProperty("table_data_copy")&&delete t["table_data_copy"];let e,a=new FormData;a.append("data",JSON.stringify(t));try{let t=yield(0,H.L3)();e=yield W.A.post(H.FH.save_document+this.docId,a,{headers:{Authorization:t}})}catch(s){return this.hideLoading(),void this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}this.hideLoading(),!1===e.data.success?(this.showErrorToast(this.$t("pages.messages.error_internal_occur")),this.showErrorToast(e.data.message)):(this.apiData=e.data.data,this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")))}))},validationsForExportData(){"ORDER_CONFIRMATION"==this.apiData.doc_type?this.apiData.po_matched.forEach((t=>{"mismatch"===t.connection_status&&(this.confirmDecision=!0)})):this.exportData()},setPOStatus(t){this.apiData["po_status"]=t,this.exportData()},exportData(){return rt(this,void 0,void 0,(function*(){let t=this.apiData;this.showLoading(),this.cleanupDataforApi(t),t.hasOwnProperty("table_data_copy")&&delete t["table_data_copy"];let e,a=new FormData;a.append("data",JSON.stringify(t));try{let t=yield(0,H.L3)();e=yield W.A.post(H.FH.save_document+this.docId,a,{headers:{Authorization:t}})}catch(s){return this.hideLoading(),void this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}this.hideLoading(),!1===e.data.success?(this.showErrorToast(this.$t("pages.messages.error_internal_occur")),this.showErrorToast(e.data.message)):(this.apiData=e.data.data,this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")))}))},updateExtractionDataForSave(t,e){if(this.apiData&&this.apiData.tables&&this.apiData.tables[0]&&this.apiData.tables[0].hasOwnProperty("extraction_info"))for(let[a,s]of Object.entries(this.apiData.tables[0].extraction_info))this.apiData.tables[0].extraction_info[a][t]=e},updateTableDataForSave(t){this.apiData&&this.apiData.tables&&this.apiData.tables[0]&&t&&(this.apiData.tables[0].data=t)},updateReadOnlyFlag(t){this.isReadOnly=t},updateTableForSave(t){this.apiData&&t&&(this.apiData.tables=t,this.$refs["lineItemsRef"].resetlintItems())},goToExtractionTableView(){this.$router.push("/tbl_ext_v3/"+this.$route.params.id)},ShowStaticPO(){this.$route.fullPath.match(/PO/g)&&(this.apiData.showStaticPo="4002513646")},lineItemConnected(t){this.apiData&&(this.apiData.hasOwnProperty("po_matched")||(this.apiData.po_matched=[]),this.apiData.po_matched.push(t.detail.data),this.isExportDisabled=!1)},lineItemPOConnectionRemoved(t){if(!this.apiData||!this.apiData.hasOwnProperty("po_matched"))return;let e=t.detail.data,a=null;for(let[s,i]of this.apiData.po_matched.entries())e.invoice_table_line_id==i.invoice_table_line_id&&(a=s);null!=a&&(this.apiData.po_matched.splice(a,1),this.apiData.po_matched.lenght>0?this.isExportDisabled=!1:this.isExportDisabled=!0)},getFieldValues(){for(let t of this.apiData.fields)this.get_fields.hasOwnProperty(t.name)&&(this.get_fields[t.name]=t.formatted_value);this.apiData.showStaticPo&&(this.get_fields["purchase_order"]=this.apiData.showStaticPo)},showConnectedLines(){const t=new CustomEvent("show_connected_lines",{detail:{}});document.dispatchEvent(t)},renderMultiplePOItems(){return rt(this,void 0,void 0,(function*(){yield this.getPOColumns();let t={};t=this.getPurchaseOrderData();for(let[e,a]of Object.entries(t))this.addToPoItems(e,a);if((!t||0===Object.keys(t).length)&&this.get_fields["purchase_order"]){let t=yield this.getPOitems(this.get_fields["purchase_order"]);this.addToPoItems(this.get_fields["purchase_order"],t,!0)}}))},addToPoItems(t,e,a=!1){(0,at.z)(this.po_items)&&(this.po_items={}),0!=(0,at.Ns)(e)&&(this.po_items[t]=e,1==(0,at.Ns)(this.po_items)&&(this.tab=Object.keys(this.po_items)[0]),a&&this.setPoItemsforSave())},setPoItemsforSave(){if(this.apiData&&this.apiData.tables&&this.apiData.tables[0]&&this.apiData.tables[0].hasOwnProperty("extraction_info"))for(let[t,e]of Object.entries(this.apiData.tables[0].extraction_info))this.apiData.tables[0].extraction_info[t].hasOwnProperty("po_items")||(this.apiData.tables[0].extraction_info[t].po_items={}),this.apiData.tables[0].extraction_info[t].po_items=this.po_items},getPurchaseOrderData(){let t={};if(!this.apiData||!this.apiData.tables||!this.apiData.tables[0]||!this.apiData.tables[0].hasOwnProperty("extraction_info"))return t;for(let[e,a]of Object.entries(this.apiData.tables[0].extraction_info))this.apiData.tables[0].extraction_info[e].hasOwnProperty("po_items")&&(t=this.apiData.tables[0].extraction_info[e].po_items);return t},getPOitems(t){return rt(this,void 0,void 0,(function*(){let e,a=[];try{let s="?purchase_order_number="+t+"&doc_locale="+this.apiData.doc_locale,i=yield(0,H.L3)();e=yield W.A.get((0,lt.MV)(H.FH.get_purchase_order_data+s),{headers:{Authorization:i}}),!1!==e.data.success&&(a=e.data)}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}return a}))},searchPurchaseOrder(){return rt(this,void 0,void 0,(function*(){if((0,J.UN)(this.apiData.doc_type)&&this.apiData.editable&&!(0,at.jw)(this.po_search)){this.showLoading();try{this.po_preview_items=[],this.po_preview=!1;let t=yield this.getPOitems(this.po_search);this.po_preview_items=t,this.po_preview=!0}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}this.hideLoading()}}))},clearSearch(){this.po_search="",this.po_preview_items=[],this.po_preview=!1},addToPoItemsList(){this.po_preview_items&&this.apiData.editable&&(this.addToPoItems(this.po_search,this.po_preview_items,!0),this.clearSearch())},togglePoImage(){"images/left-arrow-white.svg"===this.togglerIcon?this.togglerIcon="images/right-arrow-white.svg":this.togglerIcon="images/left-arrow-white.svg",(0,B.$)("#po-image-container").classList.toggle("hidden"),(0,B.$)("#po-container-parrent").classList.toggle("po-container-parrent"),(0,B.$)("#po-container-parrent").classList.toggle("po-container-parrent-full-width")},hasPurchaseOrderItems(){return(0,at.dd)(this.po_items)},getPOColumns(){return rt(this,void 0,void 0,(function*(){let t;try{this.apiData.po_columns=[];let e=this.apiData&&this.apiData.doc_type?this.apiData.doc_type:"PO_TABLE",a="?doc_type="+e,s=yield(0,H.L3)();if(t=yield W.A.get((0,lt.MV)(H.FH.get_purchase_order_display_cols+a),{headers:{Authorization:s}}),!1===t.data.success)throw"Api response error";this.apiData.po_columns=t.data.data,this.po_preview_columns=[],this.apiData.po_columns.forEach(((t,e)=>{!0===t.preview&&this.po_preview_columns.push(t)}))}catch(e){throw this.showErrorToast(this.$t("pages.messages.PO_COLUMNS_API_ERROR")),"stop execuation, no columns for purchase order lines"}}))},keyDownEvent(t){const e=t.target;"Enter"===t.key&&null!==e?e.hasAttribute("data-id")&&"po_search"===e.getAttribute("data-id")&&this.searchPurchaseOrder():"f"===t.key&&setTimeout((()=>{(0,B.$)("#search-po").querySelector("label").click()}),10)},goToHelp(){window.open(it.v6)}},beforeRouteLeave:function(t,e,a){"function"===typeof this.warning_alert&&this.warning_alert(),a()},setup(){(0,G.A)();let t=[];return{tab:(0,X.KR)(""),apiData:t,showKeyboardShortcuts:(0,X.KR)(!1),po_preview:(0,X.KR)(!1),confirmDecision:(0,X.KR)(!1),isExportDisabled:(0,X.KR)(!0),po_preview_items:(0,X.KR)(t),togglerIcon:(0,X.KR)("images/right-arrow-white.svg"),po_items:(0,X.KR)({}),baseUrl:H.VA,get_fields:{purchase_order:"",invoice_id:""},po_preview_columns:(0,X.KR)(t)}}});var ct=a(12807),dt=a(56384),ht=a(50492),pt=a(97410),ut=a(67837),mt=a(82156),_t=a(42980),gt=a(10327),bt=a(10386),ft=a(39041),vt=a(71746),wt=a(857),yt=a(23316),Dt=a(44189),kt=a(3952),Lt=a(62669),xt=a(67156),Ot=a(88672),Pt=a(98582),Ft=a.n(Pt);const At=(0,ct.A)(nt,[["render",M],["__scopeId","data-v-3dc080d1"]]),Et=At;Ft()(nt,"components",{QBtn:dt.A,QIcon:ht.A,QTooltip:pt.A,QInput:ut.A,QDialog:mt.A,QTabs:_t.A,QTab:gt.A,QSeparator:bt.A,QTabPanels:ft.A,QTabPanel:vt.A,QMarkupTable:wt.A,QCard:yt.A,QCardSection:Dt.A,QAvatar:kt.A,QCardActions:Lt.A,QField:xt.A}),Ft()(nt,"directives",{ClosePopup:Ot.A})}}]);