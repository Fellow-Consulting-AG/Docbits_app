"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[2207],{52207:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ja});var n=i(61758),s=i(58790);const o={class:"row q-pl-md q-pr-md"},a={class:"col-12 q-pl-sm q-pr-sm q-mt-sm"},l={key:0,class:"row"},r={key:1,class:"row accounting-area"},d={class:"col-12 highlighted-back"},c={class:"col-sm-4 col-md-4 col-lg-4"},u={class:"secondary-c-text text-h6"},m={class:"primary-dashboard"},h={class:"q-mt-sm q-mb-sm q-mr-sm"},_={class:"header row"},p={class:"col-auto"},g={class:"col-auto"},v={class:"q-ml-auto"},y={key:0},f={key:1},b={key:0,class:"back-white border-left-bdbdbd vw-30",id:"left_section"},w={class:"left-area-height q-ma-sm scrolle-y"},x={class:"text-weight-bold primary-bg-text"},k={class:"q-ml-sm"},I={class:"row items-center full-width q-mt-md q-mb-lg"},L={class:"text-weight-bold primary-bg-text"},A={class:"text-item"};function F(e,t,i,F,C,S){const q=(0,n.g2)("MessageBanner"),E=(0,n.g2)("SubHeader"),P=(0,n.g2)("ErrorDocumentView"),M=(0,n.g2)("q-icon"),D=(0,n.g2)("q-btn"),O=(0,n.g2)("q-btn-toggle"),Q=(0,n.g2)("PredictionBtn"),T=(0,n.g2)("DocumentAutoSaveNotify"),V=(0,n.g2)("ProceedBtn"),$=(0,n.g2)("SaveBtn"),K=(0,n.g2)("q-badge"),X=(0,n.g2)("q-tooltip"),R=(0,n.g2)("f-btn"),B=(0,n.g2)("ImageComponent"),N=(0,n.g2)("q-splitter"),W=(0,n.g2)("ExpertMode"),U=(0,n.g2)("q-toolbar-title"),j=(0,n.g2)("q-toolbar"),z=(0,n.g2)("q-input"),H=(0,n.g2)("q-card-section"),G=(0,n.g2)("q-card"),J=(0,n.g2)("q-dialog"),Y=(0,n.g2)("SetupValidation"),Z=(0,n.g2)("router-link"),ee=(0,n.g2)("Loader"),te=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.CE)(n.FK,null,[e.error_message?((0,n.uX)(),(0,n.Wv)(q,{key:0,message:e.error_message,messageCategoryClass:e.messageCategoryClass?e.messageCategoryClass:"error-banner"},null,8,["message","messageCategoryClass"])):(0,n.Q3)("",!0),(0,n.bF)(E,{name:"accounting",label:e.$t("accounting"),show_expiry_alert:!0,onSearch:!1},null,8,["label"]),(0,n.Lk)("div",o,[(0,n.Lk)("div",a,[e.has_fetch_error?((0,n.uX)(),(0,n.CE)("div",l,[(0,n.bF)(P)])):((0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("div",d,[(0,n.Lk)("div",c,[(0,n.Lk)("div",u,[(0,n.bF)(D,{flat:"",rounded:"","data-cy":"dashboard",color:"primary",onClick:t[0]||(t[0]=t=>e.routeToBack())},{default:(0,n.k6)((()=>[(0,n.bF)(M,{name:"fa-solid fa-circle-arrow-left",size:"sm"}),(0,n.Lk)("label",m,(0,s.v_)(e.$t("back")),1)])),_:1})])])]),(0,n.Lk)("div",{class:(0,s.C4)(["scroll-area-height-accounting",e.expert_mode?"right_section":"full-width"]),id:"right_section"},[(0,n.bF)(N,{modelValue:e.splitterModel,"onUpdate:modelValue":t[3]||(t[3]=t=>e.splitterModel=t),class:"accounting aa-splitter full-width right-content-height"},{before:(0,n.k6)((()=>[(0,n.Lk)("div",h,[(0,n.Lk)("div",_,[(0,n.Lk)("div",p,[(0,n.bF)(O,{tabindex:"1",modelValue:e.accounting_mode,"onUpdate:modelValue":[t[1]||(t[1]=t=>e.accounting_mode=t),e.handleMode],spread:"",unelevated:"","no-caps":"","toggle-color":"primary",color:"white","text-color":"black",class:"accounting_model_toggle",options:e.accounting_mode_options,disable:e.is_view_readonly||!e.data_loaded||e.disable_mode},null,8,["modelValue","options","onUpdate:modelValue","disable"])]),(0,n.Lk)("div",g,[(0,n.bF)(Q)]),(0,n.Lk)("div",v,[(0,n.bF)(T),(0,n.bF)(V),(0,n.bF)($),(0,n.bF)(R,{class:"q-ml-sm",icon:"settings",onClick:t[2]||(t[2]=t=>e.show_setup_validation=!e.show_setup_validation)},{default:(0,n.k6)((()=>[e.setup_error?((0,n.uX)(),(0,n.Wv)(K,{key:0,color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(M,{name:"warning",color:"white"})])),_:1})):(0,n.Q3)("",!0),(0,n.bF)(X,null,{default:(0,n.k6)((()=>[e.setup_error?((0,n.uX)(),(0,n.CE)("span",y,(0,s.v_)(e.$t("validate_setup_has_error")),1)):((0,n.uX)(),(0,n.CE)("span",f,(0,s.v_)(e.$t("validate_setup")),1))])),_:1})])),_:1})])])]),""!==e.view_template?((0,n.uX)(),(0,n.Wv)((0,n.$y)(e.view_template),{key:0,currentView:e.view_template,onAddLineItem:e.addLineItem},null,40,["currentView","onAddLineItem"])):(0,n.Q3)("",!0)])),separator:(0,n.k6)((()=>[])),after:(0,n.k6)((()=>[(0,n.bF)(B,{renderOpenWindoIcon:!0,docName:e.record.filename,docImages:e.record.images},{default:(0,n.k6)((()=>[(0,n.bF)(D,{class:"float-right",icon:"tune",disabled:e.is_view_readonly,flat:"",dense:"",onClick:e.toggleMenu},null,8,["disabled","onClick"])])),_:1},8,["docName","docImages"])])),_:1},8,["modelValue"])],2),e.expert_mode&&!e.is_view_readonly?((0,n.uX)(),(0,n.CE)("div",b,[(0,n.Lk)("div",w,[(0,n.bF)(W)])])):(0,n.Q3)("",!0)]))])]),(0,n.bF)(J,{modelValue:e.empty_line_item,"onUpdate:modelValue":t[6]||(t[6]=t=>e.empty_line_item=t),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(G,null,{default:(0,n.k6)((()=>[(0,n.bF)(j,{class:"secondary-toolbar"},{default:(0,n.k6)((()=>[(0,n.bF)(U,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",x,(0,s.v_)(e.$t("error")),1)])),_:1}),(0,n.bo)((0,n.bF)(D,{flat:"",round:"",dense:"",class:"primary-bg-text",icon:"close",onClick:t[4]||(t[4]=t=>e.empty_line_item=!1)},null,512),[[te]])])),_:1}),(0,n.bF)(H,{class:"row items-center"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",k,(0,s.v_)(e.$t("please_share_document_with_admin")),1),(0,n.Lk)("div",I,[(0,n.bF)(z,{class:"accouting-input col-11",outlined:"",modelValue:e.doc_url,"onUpdate:modelValue":t[5]||(t[5]=t=>e.doc_url=t)},{append:(0,n.k6)((()=>[(0,n.bF)(M,{flat:"",dense:"",name:"fas fa-copy",size:"24px",color:"primary",onClick:e.copyURL},{default:(0,n.k6)((()=>[(0,n.bF)(X,{anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("copy")),1)])),_:1})])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.bF)(J,{modelValue:e.show_setup_validation,"onUpdate:modelValue":t[8]||(t[8]=t=>e.show_setup_validation=t)},{default:(0,n.k6)((()=>[(0,n.bF)(G,{style:{"min-width":"600px","min-height":"500px"}},{default:(0,n.k6)((()=>[(0,n.bF)(j,{class:"secondary-toolbar"},{default:(0,n.k6)((()=>[(0,n.bF)(U,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",L,(0,s.v_)(e.$t("validate_setup")),1)])),_:1}),(0,n.bo)((0,n.bF)(D,{flat:"",round:"",dense:"",class:"primary-bg-text",icon:"close",onClick:t[7]||(t[7]=t=>e.show_setup_validation=!1)},null,512),[[te]])])),_:1}),(0,n.bF)(H,null,{default:(0,n.k6)((()=>[(0,n.bF)(Y)])),_:1}),(0,n.bF)(H,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",A,[(0,n.eW)((0,s.v_)(e.$t("visit_module_link"))+" ",1),(0,n.bF)(Z,{style:{"text-decoration":"none",color:"#2388ae","padding-left":"5px"},to:{path:"/settings/modules",hash:"#account_id_scroll"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("click_here"))+" ",1),(0,n.bF)(M,{name:e.mdiShare},null,8,["name"])])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.bF)(ee)],64)}var C=i(85192),S=i(1659),q=i(24622),E=i(60521),P=i(38734),M=i(84857),D=i(94822),O=i(12566),Q=i(64775),T=i(76956),V=i(94124),$=i(78652),K=i(8420),X=i(18505);const R={class:"row full-width"},B={class:"col-12"},N={class:"validation-list"},W={class:"alert alert-success",role:"alert"},U=["innerHTML"],j={class:"alert alert-danger",role:"alert"},z=["innerHTML"];function H(e,t,i,o,a,l){const r=(0,n.g2)("q-icon");return""!==e.view_template?((0,n.uX)(),(0,n.Wv)((0,n.$y)(e.view_template),{key:0,currentView:e.view_template},null,8,["currentView"])):((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(e.validation,((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:t},[(0,n.Lk)("div",R,[(0,n.Lk)("div",B,(0,s.v_)(t),1)]),(0,n.Lk)("ul",N,[e.success_steps.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(e.success_steps,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},[(0,n.Lk)("div",W,[(0,n.bF)(r,{name:"done",color:"green",size:"sm"}),(0,n.Lk)("span",{innerHTML:e},null,8,U)])])))),128)):(0,n.Q3)("",!0),e.errors.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(e.errors,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},[(0,n.Lk)("div",j,[(0,n.bF)(r,{name:"close",color:"red",size:"sm"}),(0,n.Lk)("span",{innerHTML:e},null,8,z)])])))),128)):(0,n.Q3)("",!0)])],64)))),128))}const G={class:"row full-width"},J={class:"col-12"},Y={class:"validation-list"},Z={class:"alert alert-success",role:"alert"},ee=["innerHTML"],te={class:"alert alert-danger",role:"alert"},ie=["innerHTML"],ne={key:1,class:"container-svg"};function se(e,t,i,o,a,l){const r=(0,n.g2)("q-icon"),d=(0,n.g2)("q-spinner-gears");return(0,n.uX)(),(0,n.CE)(n.FK,null,[e.validating?(0,n.Q3)("",!0):((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(e.validation,((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:t},[(0,n.Lk)("div",G,[(0,n.Lk)("div",J,(0,s.v_)(t),1)]),(0,n.Lk)("ul",Y,[e.success_steps.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(e.success_steps,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},[(0,n.Lk)("div",Z,[(0,n.bF)(r,{name:"done",color:"green",size:"sm"}),(0,n.Lk)("span",{innerHTML:e},null,8,ee)])])))),128)):(0,n.Q3)("",!0),e.errors.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(e.errors,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},[(0,n.Lk)("div",te,[(0,n.bF)(r,{name:"close",color:"red",size:"sm"}),(0,n.Lk)("span",{innerHTML:e},null,8,ie)])])))),128)):(0,n.Q3)("",!0)])],64)))),128)),e.validating?((0,n.uX)(),(0,n.CE)("div",ne,[(0,n.bF)(d,{color:"primary",size:"10em"})])):(0,n.Q3)("",!0)],64)}var oe=i(68450),ae=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const le=(0,n.pM)({mixins:[],props:{},components:{},data(){return{auto_accounting_setting:T.P1,auto_accounting_types_setting:T.hv,auto_accounting_acc_list_name_setting:T.ez,auto_accounting_dimensions_list_setting:T.qW,auto_accounting_dimensions_options_setting:T.Ej}},mounted:function(){this.validate()},methods:{validate(){return ae(this,void 0,void 0,(function*(){try{if(this.validating=!0,this.invalidMainSettings())return;yield this.validateAccounts(),yield this.validateDimensions(),yield this.validateDimensionOptions()}catch(e){const t="Error";this.validation[t]={},this.validation[t].errors=[],this.validation[t].errors.push(e.message)}finally{this.validating=!1}}))},invalidMainSettings(){const e=this.verifyModuleSettings();if(e.length>0){const t=this.$t("missing_auto_accounting_settings");return this.validation[t]={},this.validation[t].errors=[],this.validation[t].success_steps=[],e.forEach((e=>{this.validation[t].errors.push(e)})),!0}return!1},validateDimensionOptions(){return ae(this,void 0,void 0,(function*(){const e="Dimensions Options";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],this.vertifySettings(e,this.auto_accounting_dimensions_options_setting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.auto_accounting_dimensions_options_setting];try{t=yield this.getDimensionDropdownsFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(o){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n=Object.keys(t[0]),s=["id","name","dimensionid"];this.generateColumnsValidityMessage(n,s,e)}))},validateDimensions(){return ae(this,void 0,void 0,(function*(){const e="Dimensions";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],this.vertifySettings(e,this.auto_accounting_dimensions_list_setting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.auto_accounting_dimensions_list_setting];try{t=yield this.getDimensionsFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(o){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n=Object.keys(t[0]),s=["id","name"];this.generateColumnsValidityMessage(n,s,e)}))},vertifySettings(e,t){if(!(0,oe.a4)(this.user_settings[t])){let i="";return i+=this.$t("please_set_following_setting"),i+="<ul>",i+="<li>"+t+"</li>",i+="</ul>",void this.validation[e].errors.push(i)}},validateAccounts(){return ae(this,void 0,void 0,(function*(){const e="Accounts";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],this.vertifySettings(e,this.auto_accounting_acc_list_name_setting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.auto_accounting_acc_list_name_setting];try{t=yield this.getAccountsFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(o){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n=Object.keys(t[0]),s=["flexdimensions","nominalaccount","description"];this.generateColumnsValidityMessage(n,s,e)}))},generateColumnsValidityMessage(e,t,i){const n=t.filter((t=>!e.includes(t)));if(0===n.length){let e=this.$t("list_has_all_columns");return e+="<ul>",Array.from(t).forEach((t=>{e+="<li>"+t.replace(/_/g," ")+"</li>"})),e+="</ul>",void this.validation[i].success_steps.push(e)}if(n.length>0){let e=this.$t("list_has_missing_columns");e+="<ul>",Array.from(n).forEach((t=>{e+="<li>"+t.replace(/_/g," ")+"</li>"})),e+="</ul>",this.validation[i].errors.push(e)}const s=t.filter((t=>e.includes(t)));if(s.length!==t.length){let e=this.$t("list_has_columns");e+="<ul>",Array.from(s).forEach((t=>{e+="<li>"+t.replace(/_/g," ")+"</li>"})),e+="</ul>",this.validation[i].success_steps.push(e)}}},setup(){const e=(0,V.NF)(),{getAccountsFromServer:t,getDimensionsFromServer:i,getDimensionDropdownsFromServer:n}=e,s=(0,V.WN)(),{verifyModuleSettings:o}=s,a=(0,V.Bu)(),{user_settings:l}=(0,S.bP)(a);return{verifyModuleSettings:o,user_settings:l,getDimensionDropdownsFromServer:n,getAccountsFromServer:t,getDimensionsFromServer:i,validation:(0,P.KR)({}),validating:(0,P.KR)(!1)}}});var re=i(12807),de=i(50492),ce=i(85792),ue=i(98582),me=i.n(ue);const he=(0,re.A)(le,[["render",se],["__scopeId","data-v-380d11b5"]]),_e=he;me()(le,"components",{QIcon:de.A,QSpinnerGears:ce.A});const pe={class:"row full-width"},ge={class:"col-12"},ve={class:"validation-list"},ye={class:"alert alert-success",role:"alert"},fe=["innerHTML"],be={class:"alert alert-danger",role:"alert"},we=["innerHTML"],xe={key:1,class:"container-svg"};function ke(e,t,i,o,a,l){const r=(0,n.g2)("q-icon"),d=(0,n.g2)("q-spinner-gears");return(0,n.uX)(),(0,n.CE)(n.FK,null,[e.validating?(0,n.Q3)("",!0):((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(e.validation,((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:t},[(0,n.Lk)("div",pe,[(0,n.Lk)("div",ge,(0,s.v_)(t),1)]),(0,n.Lk)("ul",ve,[e.success_steps.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(e.success_steps,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},[(0,n.Lk)("div",ye,[(0,n.bF)(r,{name:"done",color:"green",size:"sm"}),(0,n.Lk)("span",{innerHTML:e},null,8,fe)])])))),128)):(0,n.Q3)("",!0),e.errors.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(e.errors,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},[(0,n.Lk)("div",be,[(0,n.bF)(r,{name:"close",color:"red",size:"sm"}),(0,n.Lk)("span",{innerHTML:e},null,8,we)])])))),128)):(0,n.Q3)("",!0)])],64)))),128)),e.validating?((0,n.uX)(),(0,n.CE)("div",xe,[(0,n.bF)(d,{color:"primary",size:"10em"})])):(0,n.Q3)("",!0)],64)}var Ie=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const Le=(0,n.pM)({mixins:[],props:{},components:{},data(){return{auto_accounting_setting:T.P1,auto_accounting_types_setting:T.hv,auto_accounting_acc_list_name_setting:T.ez,auto_accounting_po_acc_list_name_setting:T.Eq,auto_accounting_dimensions_options_setting:T.Ej,dimension_general_dropdown_accounting:T.Mp}},mounted:function(){this.validate()},methods:{validate(){return Ie(this,void 0,void 0,(function*(){try{if(this.validating=!0,this.invalidMainSettings())return;if(this.hasPoMatchData())return void(yield this.validatePoAccounts());yield this.validateAccounts(),yield this.validateDimensionsDropdown(),yield this.validateGeneralDimensionDropdown()}catch(e){const t="Error";this.validation[t]={},this.validation[t].errors=[],this.validation[t].errors.push(e.message)}finally{this.validating=!1}}))},invalidMainSettings(){const e=this.verifyModuleSettings();if(e.length>0){const t=this.$t("missing_auto_accounting_settings");return this.validation[t]={},this.validation[t].errors=[],this.validation[t].success_steps=[],e.forEach((e=>{this.validation[t].errors.push(e)})),!0}return!1},validateDimensionsDropdown(){return Ie(this,void 0,void 0,(function*(){const e="Dimensions Range Options";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],this.vertifySettings(e,this.auto_accounting_dimensions_options_setting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.auto_accounting_dimensions_options_setting];try{t=yield this.getM3DimensionRulesFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(a){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n={};Object.keys(t[0]).forEach((e=>{let i=e.trim().toLowerCase().replace(/\s+/g,"_");n[i]=t[0][e]}));const s=Object.keys(n),o=["accounting_identity","accounting_dimension","to_accounting_identity","from_accounting_identity","accounting_dimension"];this.generateColumnsValidityMessage(s,o,e)}))},validateGeneralDimensionDropdown(){return Ie(this,void 0,void 0,(function*(){const e="Dimensions General Options";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],this.vertifySettings(e,this.dimension_general_dropdown_accounting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.dimension_general_dropdown_accounting];try{t=yield this.getM3DimensionsFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(o){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n=Object.keys(t[0]),s=["id","description","dimension","listid","codevalue"];this.generateColumnsValidityMessage(n,s,e)}))},generateColumnsValidityMessage(e,t,i){const n=t.filter((t=>!e.includes(t)));if(0===n.length){let e=this.$t("list_has_all_columns");return e+="<br /><ul>",Array.from(t).forEach((t=>{e+="<li>"+t.replace(/_/g," ")+"</li>"})),e+="</ul>",void this.validation[i].success_steps.push(e)}if(n.length>0){let e=this.$t("list_has_missing_columns");e+="<br /><ul>",Array.from(n).forEach((t=>{e+="<li>"+t.replace(/_/g," ")+"</li>"})),e+="</ul>",this.validation[i].errors.push(e)}const s=t.filter((t=>e.includes(t)));if(s.length!==t.length){let e=this.$t("list_has_columns");e+="<br /><ul>",Array.from(s).forEach((t=>{e+="<li>"+t.replace(/_/g," ")+"</li>"})),e+="</ul>",this.validation[i].success_steps.push(e)}},validatePoAccounts(){return Ie(this,void 0,void 0,(function*(){const e="Accounts";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],!(0,oe.a4)(this.user_settings[this.auto_accounting_po_acc_list_name_setting]))return void this.validation[e].errors.push(this.$t("master_data_list_not_found"));if(this.vertifySettings(e,this.auto_accounting_po_acc_list_name_setting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.auto_accounting_po_acc_list_name_setting];try{t=yield this.getM3POAccountsFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(o){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n=Object.keys(t[0]),s=["id","description"];this.generateColumnsValidityMessage(n,s,e)}))},vertifySettings(e,t){if(!(0,oe.a4)(this.user_settings[t])){let i="";return i+=this.$t("please_set_following_setting"),i+="<ul>",i+="<li>"+t+"</li>",i+="</ul>",void this.validation[e].errors.push(i)}},validateAccounts(){return Ie(this,void 0,void 0,(function*(){const e="Accounts";let t=[];if(this.validation[e]={},this.validation[e].errors=[],this.validation[e].success_steps=[],this.vertifySettings(e,this.auto_accounting_acc_list_name_setting),this.validation[e].errors.length>0)return;const i=this.user_settings[this.auto_accounting_acc_list_name_setting];try{t=yield this.getM3AccountsFromServer();const n=this.$t("list_exists").replace("%s",i);this.validation[e].success_steps.push(n)}catch(o){const t=this.$t("master_data_list_not_found").replace("%s",i);return void this.validation[e].errors.push(t)}if(0===t.length){const t=this.$t("please_check_if_master_data_list_has_data").replace("%s",i);return void this.validation[e].errors.push(t)}this.validation[e].success_steps.push(this.$t("list_has_data"));const n=Object.keys(t[0]),s=["id","dimensionprofile","nominalaccount","description"];this.generateColumnsValidityMessage(n,s,e)}))}},setup(){const e=(0,V.WN)(),{getM3AccountsFromServer:t,getM3DimensionsFromServer:i,getM3POAccountsFromServer:n,getM3DimensionRulesFromServer:s,verifyModuleSettings:o}=e,a=(0,V.R9)(),{hasPoMatchData:l}=a,r=(0,V.Bu)(),{user_settings:d}=(0,S.bP)(r);return{verifyModuleSettings:o,getM3DimensionRulesFromServer:s,user_settings:d,hasPoMatchData:l,getM3AccountsFromServer:t,getM3DimensionsFromServer:i,getM3POAccountsFromServer:n,validation:(0,P.KR)({}),validating:(0,P.KR)(!1)}}}),Ae=(0,re.A)(Le,[["render",ke],["__scopeId","data-v-c7263cfe"]]),Fe=Ae;me()(Le,"components",{QIcon:de.A,QSpinnerGears:ce.A});const Ce=(0,n.pM)({mixins:[],props:{},components:{LN_VIEW:_e,M3_VIEW:Fe},watch:{view_template:{handler:function(e,t){this.verifyBasicValidation()}}},mounted(){this.verifyBasicValidation()},methods:{verifyBasicValidation(){""===this.view_template&&this.invalidMainSettings()},invalidMainSettings(){const e=this.verifyModuleSettings();if(e.length>0){const t=this.$t("missing_auto_accounting_settings");return this.validation[t]={},this.validation[t].errors=[],this.validation[t].success_steps=[],e.forEach((e=>{this.validation[t].errors.push(e)})),!0}return!1}},setup(){const e=(0,V.WN)(),{verifyModuleSettings:t}=e,{view_template:i}=(0,S.bP)(e);return{verifyModuleSettings:t,view_template:i,validation:(0,P.KR)({})}}}),Se=(0,re.A)(Ce,[["render",H]]),qe=Se;function Ee(e,t,i,s,o,a){const l=(0,n.g2)("q-btn"),r=(0,n.g2)("export-dialog"),d=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(l,{unelevated:"",class:"bg-primary text-white",tabindex:"1",onClick:e.onProceed,label:e.$t("proceed"),disabled:e.is_view_readonly},null,8,["onClick","label","disabled"]),(0,n.bF)(d,{modelValue:e.display_config_dialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.display_config_dialog=t),position:"top",class:"export-dialog",persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(r)])),_:1},8,["modelValue"])],64)}me()(Ce,"components",{QIcon:de.A});var Pe=i(30739),Me=i(62107),De=i(46162),Oe=i(82303),Qe=i(85487);const Te={validate:function(e,t){let i=!1;e=e.trim();for(const n of t)e>=n.start&&e<=n.end&&(i=!0);return i}};var Ve=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const $e=(0,n.pM)({mixins:[q.A,X.A],props:{},components:{ExportDialog:Me.A},watch:{config_saved:{handler:function(e,t){!0===t&&!1===e||(this.display_config_dialog=!1)}}},computed:{},methods:{onProceed(){return Ve(this,void 0,void 0,(function*(){try{if(this.is_view_readonly||!(yield this.validateForm()))return;this.processing=!0;const e=yield this.confirmExportConfiguration();if(!e)return void(this.display_config_dialog=!0);this.callExportApi()}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},prepareJsonForSave(){this.record.accounting={mode:this.accounting_mode,line_items:this.lineItems}},validateForm(){return Ve(this,void 0,void 0,(function*(){let e=!0;try{this.clearErrors(this.lineItems);const t=this.validateLineItemDimensions(this.lineItems),i=yield this.validateLineItemAmount(),n=this.validateAccounts();t&&i&&n||(e=!1,this.showErrorToast(this.$t("please_check_some_values_are_missing")))}catch(t){}return e}))},clearErrors(e){for(const[t,i]of e.entries())if(this.clearLineItemErrors(i),i.hasOwnProperty("split_items")&&i.split_items.length>0)for(const[e,n]of i.split_items.entries())this.clearErrors(i.split_items)},clearLineItemErrors(e){e.hasOwnProperty("account_error")&&(e.account_error=""),e.hasOwnProperty("amount_error")&&(e.amount_error=""),e.hasOwnProperty("error")&&(e.error="")},validateLineItemDimensions(e){let t=!0;for(const[i,n]of e.entries()){if(n.account||(n.dimensions=[]),n.dimensions&&n.dimensions.length>0){const e=this.validateDimensionForEach(n.dimensions,n.account);e||(t=!1)}if(n.hasOwnProperty("split_items")&&n.split_items.length>0){const e=this.validateLineItemDimensions(n.split_items);e||(t=!1)}}return t},validateDimensionForEach(e,t){let i=!0;return Array.from(e).forEach(((e,n)=>{e.error="";const s=this.getDimensionRules(t.id,e.id);"m"==e.rule.toLowerCase()&&0===e.value.trim().length?(e.error=this.buildRangeErrorMessage(s,!0),i=!1):s.length>0&&0!==e.value.trim().length&&!1===Te.validate(e.value,s)&&(e.error=this.buildRangeErrorMessage(s),i=!1)})),i},getDimensionRules(e,t){return this.dimension_rules.hasOwnProperty(e)&&this.dimension_rules[e].hasOwnProperty(t)?this.dimension_rules[e][t]:[]},buildRangeErrorMessage(e,t=!1){let i="";if(t&&(i=this.$t("required")),0===e.length)return i;i=(0,oe.jw)(i)?"":" - "+i+"<br />",i+="Please add a value within one of the following ranges:<br />";for(const[n,s]of e.entries()){let e=s.start.toString(),t=s.end.toString();i+=e===t?` - ${e}<br />`:` - From "${e}" to "${t}"<br />`}return i},validateAccounts(){const e=this.getSelectedModeLineItems();return this.validateLineItemsAccounts(e)},getSelectedModeLineItems(){if("total_line"===this.accounting_mode){const e=this.lineItems.filter((e=>"total_line_item"===e.type.toLowerCase()));return e}const e=this.lineItems.filter((e=>"line_item"===e.type.toLowerCase()));return e},validateLineItemsAccounts(e){let t=!0;return Array.from(e).forEach(((e,i)=>{if(e.hasOwnProperty("split_items")&&e.split_items.length>0){const i=this.validateLineItemsAccounts(e.split_items);i||(t=!1)}else e.account||(e.account_error=this.$t("required"),t=!1)})),t},validateLineItemAmount(){return Ve(this,void 0,void 0,(function*(){let e=!0;yield this.calculateTotalByMode();const t=this.getTotalLineIndex();if(-1===t)return!1;const i=this.lineItems[t];if(parseFloat((0,Pe.H2)(i.pending_amount))>0&&(e=!1,i.error=this.$t("total_amount_not_equal_to_line_items")),"total_line"===this.accounting_mode)return e;for(const[n,s]of this.lineItems.entries()){if("total_line_item"===s.type)continue;const t=yield this.checkTotalForEachLineItem(s);t||(e=!1,s.error=this.$t("line_item_total_not_equal_to_line_item_split_total"))}return e}))},confirmExportConfiguration(){return Ve(this,void 0,void 0,(function*(){let e,t=new FormData;t.append("doc_type",this.record.doc_type),t.append("org_id",(0,Qe.I)());let i=yield(0,De.L3)();const n=yield Oe.A.post(De.FH.export_configuration_existence,t,{headers:{Authorization:i}});return e=n.data.valid,e}))},callExportApi(){return Ve(this,void 0,void 0,(function*(){try{this.prepareJsonForSave(),this.processing=!0;const e=yield this.exportDocument(this.record.doc_id);if(!1===e.success)throw{message:e.message};if(this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),this.is_view_readonly=!0,!0===e.success)return void this.$router.push("/dashboard");this.showErrorToast(e.data.message),this.record=e.data}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.processing=!1}}))}},setup(){const e=(0,V.q3)(),{record:t,processing:i}=(0,S.bP)(e),{saveDocument:n,exportDocument:s}=e,o=(0,V.NF)(),{lineItems:a,is_view_readonly:l,accounting_mode:r,dimension_rules:d}=(0,S.bP)(o),{calculateTotalByMode:c,getTotalLineIndex:u,checkTotalForEachLineItem:m}=o,h=(0,V.t8)(),{clearStateForExportDialog:_,config_saved:p}=h,{display_config_dialog:g}=(0,S.bP)(h);return{config_saved:p,exportDocument:s,display_config_dialog:g,getTotalLineIndex:u,calculateTotalByMode:c,saveDocument:n,checkTotalForEachLineItem:m,record:t,processing:i,lineItems:a,is_view_readonly:l,accounting_mode:r,dimension_rules:d}}});var Ke=i(56384),Xe=i(82156);const Re=(0,re.A)($e,[["render",Ee]]),Be=Re;me()($e,"components",{QBtn:Ke.A,QDialog:Xe.A});var Ne=i(95488);function We(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("f-btn");return(0,n.uX)(),(0,n.Wv)(d,{class:"q-ml-sm",icon:"save",onClick:e.onSave,disabled:e.is_view_readonly},{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("save")),1)])),_:1})])),_:1},8,["onClick","disabled"])}var Ue=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const je=(0,n.pM)({mixins:[q.A,X.A],props:{},components:{},watch:{},computed:{},methods:{onSave(){return Ue(this,void 0,void 0,(function*(){try{if(this.is_view_readonly)return;this.processing=!0,this.prepareJsonForSave();const e=yield this.saveDocument(this.record.doc_id);if(!1===e.success)throw{message:e.message};this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.processing=!1}}))},prepareJsonForSave(){this.record.accounting={mode:this.accounting_mode,line_items:this.lineItems}}},setup(){const e=(0,V.q3)(),{record:t,processing:i}=(0,S.bP)(e),{saveDocument:n}=e,s=(0,V.NF)(),{lineItems:o,is_view_readonly:a,accounting_mode:l}=(0,S.bP)(s);return{saveDocument:n,record:t,processing:i,lineItems:o,is_view_readonly:a,accounting_mode:l}}});var ze=i(97410);const He=(0,re.A)(je,[["render",We]]),Ge=He;me()(je,"components",{QTooltip:ze.A});var Je=i(29104);function Ye(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("f-btn"),c=(0,n.g2)("PredictionPopup"),u=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(d,{class:(0,s.C4)(["q-ml-sm",e.is_view_readonly?" disabled ":""]),icon:"img:images/magic_wand.svg",onClick:e.showPredictions},{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("show_predictions")),1)])),_:1})])),_:1},8,["class","onClick"]),(0,n.bF)(u,{modelValue:e.show_popup,"onUpdate:modelValue":t[0]||(t[0]=t=>e.show_popup=t),onKeydown:(0,Je.jR)(e.cleanupOnhide,["esc"]),onHide:e.cleanupOnhide},{default:(0,n.k6)((()=>[(0,n.bF)(c,{show_popup:e.show_popup,onCleanupOnhide:e.cleanupOnhide},null,8,["show_popup","onCleanupOnhide"])])),_:1},8,["modelValue","onKeydown","onHide"])],64)}const Ze={class:"text-weight-bold primary-bg-text"},et={class:"row items-center q-mb-sm"},tt={class:"q-ml-auto q-mr-auto"},it=(0,n.Lk)("img",{src:"images/Magier-active.svg"},null,-1),nt={class:"row q-pl-sm q-pt-sm q-pb-sm table-header"},st={class:"col-2 flex items-center justify-left"},ot={class:"col-9 flex items-center justify-left"},at=(0,n.Lk)("div",{class:"col-1"},null,-1),lt={key:0,class:"row q-pl-sm q-pt-sm total-line-item-area"},rt={class:"col-12 flex flex-center"},dt={class:"row q-pl-sm q-pt-sm"},ct={class:"col-12 flex items-center justify-left"},ut={class:"row pl-20"},mt={class:"row"},ht={class:"col-10 flex items-center justify-left"},_t={class:"col-1"};function pt(e,t,i,o,a,l){const r=(0,n.g2)("q-toolbar-title"),d=(0,n.g2)("q-btn"),c=(0,n.g2)("q-toolbar"),u=(0,n.g2)("q-avatar"),m=(0,n.g2)("q-checkbox"),h=(0,n.g2)("q-circular-progress"),_=(0,n.g2)("q-separator"),p=(0,n.g2)("q-card-section"),g=(0,n.g2)("f-btn"),v=(0,n.g2)("q-card-actions"),y=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.Wv)(y,{style:{width:"800px","max-width":"1060px"}},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"secondary-toolbar"},{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",Ze,(0,s.v_)(e.$t("accounts")),1)])),_:1}),(0,n.bF)(d,{flat:"",round:"",dense:"",class:"primary-bg-text",icon:"close",onClick:e.closeDialog},null,8,["onClick"])])),_:1}),(0,n.bF)(p,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",et,[(0,n.Lk)("div",tt,[(0,n.bF)(u,{square:"",size:"80px"},{default:(0,n.k6)((()=>[it])),_:1})])]),(0,n.Lk)("div",nt,[(0,n.Lk)("div",st,(0,s.v_)(e.$t("pages.line_items_columns.POSITION")),1),(0,n.Lk)("div",ot,(0,s.v_)(e.$t("accounts")),1),at]),0===e.predictions_by_mode.length?((0,n.uX)(),(0,n.CE)("div",lt,[(0,n.Lk)("div",rt,(0,s.v_)(e.$t("no_predictions_found")),1)])):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(e.predictions_by_mode,((t,i)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:i},[(0,n.Lk)("div",dt,[(0,n.Lk)("div",ct,[(0,n.Lk)("span",null,(0,s.v_)(i),1)])]),(0,n.Lk)("div",ut,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t,(t=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"col-6 q-mb-sm"},[(0,n.Lk)("div",mt,[(0,n.Lk)("div",ht,[((0,n.uX)(),(0,n.Wv)(m,{modelValue:t.checked,"onUpdate:modelValue":e=>t.checked=e,label:t.account_obj.label,key:e.index+"_"+t.account_obj.value},null,8,["modelValue","onUpdate:modelValue","label"]))]),(0,n.Lk)("div",_t,[(0,n.bF)(h,{"show-value":"","font-size":"12px",value:t.percentage,size:"40px",thickness:.22,color:t.percentage>55?"primary":"red"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(t.percentage)+"% ",1)])),_:2},1032,["value","color"])])])])))),128))]),(0,n.bF)(_,{class:"q-mt-sm"})],64)))),128))])),_:1}),(0,n.bF)(v,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(g,{appearance:"cancel",label:e.$t("cancel"),onClick:e.closeDialog},null,8,["label","onClick"]),e.is_view_readonly?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(g,{key:0,class:"float-right btns",label:e.$t("proceed"),onClick:t[0]||(t[0]=t=>e.proceed())},null,8,["label"]))])),_:1})])),_:1})}const gt=(0,n.pM)({mixins:[q.A],props:{},components:{},watch:{},emits:["itemSelected","cleanupOnhide"],computed:{},mounted(){},methods:{proceed(){this.saveSelections(),this.closeDialog()},saveSelections(){for(let[e,t]of Object.entries(this.predictions_by_mode)){const t=this.predictions_by_mode[e];let i=[];for(const[e,s]of t.entries())s.checked&&(s.checked=!1,i.push(s));if(0===i.length)continue;const n=t[0].line_index;this.updateAccountInStore(n,null,{}),this.lineItems[n].split_items=[],1===i.length&&this.updateAccountInStore(n,null,i[0].account_obj),i.length>1&&this.makeSplittedLineItems(i,n)}},makeSplittedLineItems(e,t){for(const[i,n]of e.entries()){const e=this.baseSplitLineItem();e.percentage="0%",this.lineItems[t].split_items.push(e),this.updateAccountInStore(t,i,n.account_obj)}this.autFillEmptyLineItems(t)},closeDialog(){this.$emit("cleanupOnhide")}},setup(){const e=(0,V.NF)(),{is_view_readonly:t,total_line_predictions:i,line_items_line_predictions:n,accounting_mode:s,lineItems:o,predictions_by_mode:a,prediction_selections:l}=(0,S.bP)(e),{updateAccount:r,hasTotalPredictions:d,hasLineItemsPredictions:c,getTotalLineIndex:u,baseSplitLineItem:m,autFillEmptyLineItems:h}=e;return{is_view_readonly:t,predictions_by_mode:a,updateAccountInStore:r,autFillEmptyLineItems:h,baseSplitLineItem:m,lineItems:o,getTotalLineIndex:u,hasTotalPredictions:d,hasLineItemsPredictions:c,accounting_mode:s,total_line_predictions:i,line_items_line_predictions:n,prediction_selections:l}}});var vt=i(23316),yt=i(36914),ft=i(39150),bt=i(44189),wt=i(3952),xt=i(80460),kt=i(34222),It=i(10386),Lt=i(62669);const At=(0,re.A)(gt,[["render",pt]]),Ft=At;me()(gt,"components",{QCard:vt.A,QToolbar:yt.A,QToolbarTitle:ft.A,QBtn:Ke.A,QCardSection:bt.A,QAvatar:wt.A,QCheckbox:xt.A,QCircularProgress:kt.A,QSeparator:It.A,QCardActions:Lt.A});const Ct=(0,n.pM)({mixins:[q.A],props:{},components:{PredictionPopup:Ft},watch:{},computed:{},methods:{showPredictions(){this.show_popup=!0},cleanupOnhide(){this.show_popup=!1}},setup(){const e=(0,V.NF)(),{is_view_readonly:t}=(0,S.bP)(e);return{is_view_readonly:t,show_popup:(0,P.KR)(!1)}}}),St=(0,re.A)(Ct,[["render",Ye]]),qt=St;me()(Ct,"components",{QTooltip:ze.A,QDialog:Xe.A});const Et={key:0,class:"row full-width q-mb-sm"},Pt={class:"col-4"},Mt={class:"col-8"},Dt={class:"fixed-height-div scrolle-y"},Ot={class:"q-ml-sm"},Qt={class:"q-ml-sm"};function Tt(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-btn"),c=(0,n.g2)("TrainingModel"),u=(0,n.g2)("TestModel"),m=(0,n.g2)("q-avatar"),h=(0,n.g2)("q-card-section"),_=(0,n.g2)("f-btn"),p=(0,n.g2)("q-card-actions"),g=(0,n.g2)("q-card"),v=(0,n.g2)("q-dialog"),y=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.CE)(n.FK,null,[e.is_view_readonly?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",Et,[(0,n.Lk)("div",Pt,[(0,n.bF)(d,{class:"bg-primary text-white",unelevated:"",tabindex:"1",onClick:t[0]||(t[0]=t=>e.confirm_all_training_delete=!0),label:e.$t("Delete All"),disabled:e.is_view_readonly},{default:(0,n.k6)((()=>[(0,n.bF)(r,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("delete_all_training_for_this_org")),1)])),_:1})])),_:1},8,["label","disabled"])]),(0,n.Lk)("div",Mt,[(0,n.bF)(d,{class:"bg-primary text-white q-mr-sm",unelevated:"",tabindex:"1",onClick:t[1]||(t[1]=t=>e.confirm_supplier_training_delete=!0),label:e.$t("Delete Supplier Training"),disabled:e.is_view_readonly},{default:(0,n.k6)((()=>[(0,n.bF)(r,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("delete_current_supplier_training")),1)])),_:1})])),_:1},8,["label","disabled"])])])),(0,n.Lk)("div",Dt,[(0,n.bF)(c),(0,n.bF)(u)]),(0,n.bF)(v,{modelValue:e.confirm_all_training_delete,"onUpdate:modelValue":t[4]||(t[4]=t=>e.confirm_all_training_delete=t),onKeydown:t[5]||(t[5]=(0,Je.jR)((t=>e.confirm_all_training_delete=!1),["esc"])),onHide:t[6]||(t[6]=t=>e.confirm_all_training_delete=!1)},{default:(0,n.k6)((()=>[(0,n.bF)(g,null,{default:(0,n.k6)((()=>[(0,n.bF)(h,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,n.k6)((()=>[(0,n.bF)(m,{icon:"warning",color:"primary","text-color":"white"})])),_:1}),(0,n.bF)(h,{class:"row items-center"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",Ot,(0,s.v_)(e.$t("confirm_all_training_delete")),1)])),_:1}),(0,n.bF)(p,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.bF)(_,{appearance:"cancel",label:e.$t("cancel"),onClick:t[2]||(t[2]=t=>e.confirm_all_training_delete=!1)},null,8,["label"]),[[y]]),(0,n.bF)(_,{label:e.$t("proceed"),class:"q-mr-sm",onClick:t[3]||(t[3]=t=>e.deleteAllTrainings())},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.bF)(v,{modelValue:e.confirm_supplier_training_delete,"onUpdate:modelValue":t[9]||(t[9]=t=>e.confirm_supplier_training_delete=t),onKeydown:t[10]||(t[10]=(0,Je.jR)((t=>e.confirm_supplier_training_delete=!1),["esc"])),onHide:t[11]||(t[11]=t=>e.confirm_supplier_training_delete=!1)},{default:(0,n.k6)((()=>[(0,n.bF)(g,null,{default:(0,n.k6)((()=>[(0,n.bF)(h,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,n.k6)((()=>[(0,n.bF)(m,{icon:"warning",color:"primary","text-color":"white"})])),_:1}),(0,n.bF)(h,{class:"row items-center"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",Qt,(0,s.v_)(e.$t("confirm_supplier_training_delete")),1)])),_:1}),(0,n.bF)(p,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(_,{appearance:"cancel",label:e.$t("cancel"),onClick:t[7]||(t[7]=t=>e.confirm_supplier_training_delete=!1)},null,8,["label"]),(0,n.bF)(_,{label:e.$t("proceed"),class:"q-mr-sm",onClick:t[8]||(t[8]=t=>e.deleteCurrentSupplierTraining())},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var Vt=i(11470);const $t={class:"border-left-bdbdbd border-bottom-bdbdbd border-right-bdbdbd border-top-bdbdbd"},Kt={class:"row mb-10 mt-8 q-ml-sm full-width table-header"},Xt={key:0,class:"col-4"},Rt={class:"q-ml-sm"},Bt={class:"q-ml-sm"},Nt=(0,n.Lk)("div",{class:"col-2"},null,-1),Wt={key:0,class:"col-4"},Ut={class:"ellipsis"},jt=["innerHTML"],zt={class:"col-2 flex-center"};function Ht(e,t,i,o,a,l){const r=(0,n.g2)("q-space"),d=(0,n.g2)("q-separator"),c=(0,n.g2)("q-tooltip"),u=(0,n.g2)("q-icon"),m=(0,n.g2)("q-input"),h=(0,n.g2)("q-item-label"),_=(0,n.g2)("q-item-section"),p=(0,n.g2)("q-item"),g=(0,n.g2)("q-select"),v=(0,n.g2)("q-btn"),y=(0,n.g2)("q-card-actions"),f=(0,n.g2)("q-expansion-item");return(0,n.uX)(),(0,n.CE)("div",$t,[(0,n.bF)(f,{"expand-separator":"","header-class":"highlighted-back"},{header:(0,n.k6)((()=>[(0,n.Lk)("span",null,(0,s.v_)(e.$t("train_data")),1),(0,n.bF)(r)])),default:(0,n.k6)((()=>[(0,n.bF)(d),(0,n.Lk)("div",Kt,["total_line"!==e.accounting_mode?((0,n.uX)(),(0,n.CE)("div",Xt,[(0,n.Lk)("span",Rt,(0,s.v_)(e.$t("description")),1)])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,s.C4)("total_line"!==e.accounting_mode?"col-6":"col-10")},[(0,n.Lk)("span",Bt,(0,s.v_)(e.$t("account")),1)],2),Nt]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.training_data,((t,i)=>((0,n.uX)(),(0,n.CE)("div",{key:i,class:"row mb-10 mt-8 q-ml-sm full-width"},["total_line"!==e.accounting_mode?((0,n.uX)(),(0,n.CE)("div",Wt,[(0,n.bF)(m,{readonly:!0,dense:"",outlined:"",modelValue:t["description"],"onUpdate:modelValue":e=>t["description"]=e,class:(0,s.C4)("q-pl-sm accouting-input ")},{append:(0,n.k6)((()=>[""!==e.errors[i]["description"]?((0,n.uX)(),(0,n.Wv)(u,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:2},1032,["modelValue","onUpdate:modelValue"])])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,s.C4)(["account-container","total_line"!==e.accounting_mode?"col-6":"col-10"])},[(0,n.bF)(g,{dense:"",tabindex:"1",class:"q-mr-sm q-pl-sm accounting-select account-select",clearable:"","use-input":"",outlined:"",modelValue:t["ledger_account"],"onUpdate:modelValue":e=>t["ledger_account"]=e,loading:!e.accounts_loaded,options:e.filterAccounts,onFilter:e.filterAccountsEvent,onInputValue:e.selectInputValue,disable:e.is_view_readonly,"emit-value":"","map-options":""},{"selected-item":(0,n.k6)((e=>[(0,n.Lk)("div",Ut,(0,s.v_)(e.opt.label),1)])),option:(0,n.k6)((t=>[(0,n.bF)(p,(0,n.v6)({ref_for:!0},t.itemProps),{default:(0,n.k6)((()=>[(0,n.bF)(_,null,{default:(0,n.k6)((()=>[(0,n.bF)(h,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",{innerHTML:e.highlightOption(t.opt.label,e.input_value)},null,8,jt)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),append:(0,n.k6)((()=>[""!==e.errors[i]["ledger_account"]?((0,n.uX)(),(0,n.Wv)(u,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:2},1032,["modelValue","onUpdate:modelValue","loading","options","onFilter","onInputValue","disable"])],2),(0,n.Lk)("div",zt,[(0,n.bF)(u,{tabindex:"1",name:"img:images/trash-bin-default.svg",size:"22px",onClick:t=>e.deleteRow(i),onKeydown:(0,Je.jR)((t=>e.deleteRow(i)),["enter"]),class:(0,s.C4)(["cursor-pointer q-ml-sm mt-4",e.is_view_readonly?"disabled":""])},null,8,["onClick","onKeydown","class"])])])))),128)),(0,n.bF)(y,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(v,{unelevated:"",color:"grey",class:"q-mr-sm",label:e.$t("refresh"),onClick:t[0]||(t[0]=t=>e.refresh())},null,8,["label"]),(0,n.bF)(v,{unelevated:"",color:"primary",class:"q-mr-sm",label:e.$t("train"),onClick:e.trainModelProceed},null,8,["label","onClick"])])),_:1})])),_:1})])}var Gt=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const Jt=(0,n.pM)({mixins:[q.A,X.A],props:{},components:{},watch:{accounting_mode:{handler:function(e,t){e!==t&&this.init()}}},computed:{},mounted:function(){this.init()},methods:{init(){try{if(this.training_data=[],this.input_value="",!this.supplier_name)return;for(const e of this.lineItems)"line_items"===this.accounting_mode&&"total_line_item"===e.type||"total_line"===this.accounting_mode&&"line_item"===e.type||this.addEmptyTrainingLine({description:e.description})}catch(e){}},refresh(){this.is_view_readonly||(this.supplier_name?this.init():this.showErrorToast(this.$t("missing_supplier_warning")))},addEmptyTrainingLine(e={}){const t={supplier_name:this.supplier_name,ledger_account:""},i=Object.assign(e,t);this.training_data.push(i);const n=Object.assign({},{ledger_account:"",description:""});this.errors.push(n)},renderTrainingData(){},deleteRow(e){this.training_data.splice(e,1),this.errors.splice(e,1)},filterAccountsEvent(e,t,i){t(e?()=>{this.filterAccounts=this.accountFilterByAnyValue(e)}:()=>{this.filterAccounts=this.accounts})},trainModelProceed(){return Gt(this,void 0,void 0,(function*(){try{if(this.is_view_readonly)return;if(!this.supplier_name)return void this.showErrorToast(this.$t("missing_supplier_warning"));if(this.validateTrainingData())return;this.showLoading();const e={line_items:JSON.stringify(this.training_data)},t=yield Vt.WM.trainModel(e);if(!1===t.success)throw{message:t.data};this.training_data.map((e=>(delete e["ledger_account"],e)));const i=this.getLineItemsForPredictionAccount(),n={line_items:JSON.stringify(i)};this.getPredictions(n),this.showSuccessToast(this.$t("train_model_success_test"))}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.hideLoading()}}))},validateTrainingData(){let e=!1;for(const[t,i]of this.training_data.entries())this.errors[t]["supplier_name"]="",""===i["supplier_name"]&&(this.errors[t]["supplier_name"]="error",e=!0),this.errors[t]["ledger_account"]="",""===i["ledger_account"]&&(e=!0,this.errors[t]["ledger_account"]="error"),this.errors[t]["description"]="","line_items"===this.accounting_mode&&""===i["description"]&&(e=!0,this.errors[t]["description"]="error");return e},selectInputValue(e){this.input_value=e}},setup(){const e=(0,V.NF)(),{accountFilterByAnyValue:t,is_view_readonly:i,supplier_name:n,accounts:s,accounts_loaded:o,accounting_mode:a,lineItems:l}=(0,S.bP)(e),{highlightOption:r}=e,{getPredictions:d,getLineItemsForPredictionAccount:c}=e,u=(0,P.KR)(e.accounts);return{highlightOption:r,getLineItemsForPredictionAccount:c,lineItems:l,getPredictions:d,accounts_loaded:o,accounts:s,accountFilterByAnyValue:t,filterAccounts:u,accounting_mode:a,is_view_readonly:i,supplier_name:n,training_data:(0,P.KR)([]),errors:(0,P.KR)([]),input_value:(0,P.KR)("")}}});var Yt=i(88841),Zt=i(93676),ei=i(67837),ti=i(94940),ii=i(90124),ni=i(25173),si=i(13796);const oi=(0,re.A)(Jt,[["render",Ht]]),ai=oi;me()(Jt,"components",{QExpansionItem:Yt.A,QSpace:Zt.A,QSeparator:It.A,QInput:ei.A,QIcon:de.A,QTooltip:ze.A,QSelect:ti.A,QItem:ii.A,QItemSection:ni.A,QItemLabel:si.A,QCardActions:Lt.A,QBtn:Ke.A});const li={class:"border-left-bdbdbd border-bottom-bdbdbd border-right-bdbdbd border-top-bdbdbd q-mt-sm"},ri={key:0,class:"row q-pl-sm q-pt-sm total-line-item-area"},di={class:"col-12 flex flex-center"},ci={class:"col-12 q-pl-sm text-weight-bold"},ui={class:"col-11 q-mt-sm q-pl-md"},mi={class:"col-1"},hi={class:"col-12 q-mb-sm q-mt-sm"},_i={class:"q-ml-sm"};function pi(e,t,i,o,a,l){const r=(0,n.g2)("q-space"),d=(0,n.g2)("q-separator"),c=(0,n.g2)("q-circular-progress"),u=(0,n.g2)("q-tooltip"),m=(0,n.g2)("q-icon"),h=(0,n.g2)("q-btn"),_=(0,n.g2)("q-card-actions"),p=(0,n.g2)("q-expansion-item"),g=(0,n.g2)("q-avatar"),v=(0,n.g2)("q-card-section"),y=(0,n.g2)("f-btn"),f=(0,n.g2)("q-card"),b=(0,n.g2)("q-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",li,[(0,n.bF)(p,{"expand-separator":"","header-class":"highlighted-back"},{header:(0,n.k6)((()=>[(0,n.Lk)("span",null,(0,s.v_)(e.$t("test_data")),1),(0,n.bF)(r)])),default:(0,n.k6)((()=>[(0,n.bF)(d),e.test_clicked?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[0===e.has_predictions?((0,n.uX)(),(0,n.CE)("div",ri,[(0,n.Lk)("div",di,(0,s.v_)(e.$t("no_predictions_found")),1)])):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.predictions_by_mode,((t,i)=>((0,n.uX)(),(0,n.CE)("div",{key:i,class:"row q-mt-sm"},[(0,n.Lk)("div",ci,(0,s.v_)(i),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t,((t,i)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:i},[(0,n.Lk)("div",ui,[(0,n.bF)(c,{"show-value":"","font-size":"12px",value:t.percentage,size:"40px",thickness:.22,color:t.percentage>55?"primary":"red"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(t.percentage)+"% ",1)])),_:2},1032,["value","color"]),(0,n.eW)(" "+(0,s.v_)(t.account_obj.label),1)]),(0,n.Lk)("div",mi,[(0,n.bF)(m,{tabindex:"1",name:"img:images/trash-bin-default.svg",size:"22px",onClick:i=>e.deletePredictionData(t),onKeydown:(0,Je.jR)((i=>e.deletePredictionData(t)),["enter"]),class:(0,s.C4)(["cursor-pointer q-ml-sm mt-4",e.is_view_readonly?"disabled":""])},{default:(0,n.k6)((()=>[(0,n.bF)(u,{anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("delete_prediction_data_for_this_account")),1)])),_:1})])),_:2},1032,["onClick","onKeydown","class"])])],64)))),128)),(0,n.Lk)("div",hi,[(0,n.bF)(d)])])))),128))],64)):(0,n.Q3)("",!0),(0,n.bF)(_,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(h,{unelevated:"",color:"primary",class:"q-mr-sm",label:e.$t("test"),onClick:e.Proceed},null,8,["label","onClick"])])),_:1})])),_:1})]),(0,n.bF)(b,{modelValue:e.confirm_ledger_account_delete,"onUpdate:modelValue":t[2]||(t[2]=t=>e.confirm_ledger_account_delete=t),onKeydown:t[3]||(t[3]=(0,Je.jR)((t=>e.confirm_ledger_account_delete=!1),["esc"])),onHide:t[4]||(t[4]=t=>e.confirm_ledger_account_delete=!1)},{default:(0,n.k6)((()=>[(0,n.bF)(f,null,{default:(0,n.k6)((()=>[(0,n.bF)(v,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,n.k6)((()=>[(0,n.bF)(g,{icon:"warning",color:"primary","text-color":"white"})])),_:1}),(0,n.bF)(v,{class:"row items-center"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",_i,(0,s.v_)(e.$t("confirm_ledger_account_delete")),1)])),_:1}),(0,n.bF)(_,{align:"right"},{default:(0,n.k6)((()=>[(0,n.bF)(y,{appearance:"cancel",label:e.$t("cancel"),onClick:t[0]||(t[0]=t=>e.confirm_ledger_account_delete=!1)},null,8,["label"]),(0,n.bF)(y,{label:e.$t("proceed"),class:"q-mr-sm",onClick:t[1]||(t[1]=t=>e.deleteSupplierLedgerAccount())},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var gi=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const vi=(0,n.pM)({mixins:[q.A,X.A],props:{},components:{},watch:{accounting_mode:{handler:function(e,t){e!==t&&this.init()}}},computed:{has_predictions(){return"total_line"===this.accounting_mode?this.total_line_predictions.length>0:this.line_items_line_predictions.length>0}},mounted:function(){this.init()},methods:{init(){try{if(this.is_view_readonly)return;this.testing_data=[],this.addEmptyLine()}catch(e){}},addEmptyLine(){const e={supplier_name:this.supplier_name};"total_line"!==this.accounting_mode&&(e["description"]=""),this.testing_data.push(e)},deleteRow(e){this.testing_data.splice(e,1)},Proceed(){return gi(this,void 0,void 0,(function*(){try{if(this.is_view_readonly)return;if(!this.supplier_name)return void this.showErrorToast(this.$t("missing_supplier_warning"));this.showLoading();const e=this.getLineItemsForPredictionAccount(),t={line_items:JSON.stringify(e)};yield this.getPredictions(t),this.test_clicked=!0}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.hideLoading()}}))},deletePredictionData(e){this.is_view_readonly||(this.supplier_name?(this.deletionItem=e,this.confirm_ledger_account_delete=!0):this.showErrorToast(this.$t("missing_supplier_warning")))},deleteSupplierLedgerAccount(){return gi(this,void 0,void 0,(function*(){try{if(this.is_view_readonly||0===(0,oe.Ns)(this.deletionItem))return;const e={supplier:this.supplier_name,ledger_account:this.deletionItem.account_obj.id};this.deletionItem.hasOwnProperty("description")&&(e["description"]=this.deletionItem.description),this.showLoading();const t=yield Vt.WM.deleteTrainingData(e);if(!1===t.success)throw{message:t.message};yield this.Proceed(),this.showSuccessToast(this.$t("selected_training_deleted")),this.confirm_ledger_account_delete=!1}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.hideLoading()}}))}},setup(){const e=(0,V.NF)(),{total_line_predictions:t,line_items_line_predictions:i,is_view_readonly:n,supplier_name:s,accounting_mode:o,predictions_by_mode:a}=(0,S.bP)(e),{getPredictions:l,getLineItemsForPredictionAccount:r}=e;return{predictions_by_mode:a,getLineItemsForPredictionAccount:r,total_line_predictions:t,line_items_line_predictions:i,getPredictions:l,accounting_mode:o,is_view_readonly:n,supplier_name:s,testing_data:(0,P.KR)([]),test_clicked:(0,P.KR)(!1),deletionItem:(0,P.KR)({}),confirm_ledger_account_delete:(0,P.KR)(!1)}}}),yi=(0,re.A)(vi,[["render",pi]]),fi=yi;me()(vi,"components",{QExpansionItem:Yt.A,QSpace:Zt.A,QSeparator:It.A,QCircularProgress:kt.A,QIcon:de.A,QTooltip:ze.A,QCardActions:Lt.A,QBtn:Ke.A,QDialog:Xe.A,QCard:vt.A,QCardSection:bt.A,QAvatar:wt.A});var bi=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const wi=(0,n.pM)({mixins:[q.A,X.A],props:{},components:{TrainingModel:ai,TestModel:fi},watch:{},computed:{},mounted:function(){},methods:{deleteAllTrainings(){return bi(this,void 0,void 0,(function*(){try{this.showLoading();const e={all:!0},t=yield Vt.WM.deleteTrainingData(e);if(!1===t.success)throw{message:t.message};this.clearPredictions(),this.showSuccessToast(this.$t("all_trainings_deleted")),this.confirm_all_training_delete=!1}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.hideLoading()}}))},deleteCurrentSupplierTraining(){return bi(this,void 0,void 0,(function*(){try{if(!this.supplier_name)throw{message:this.$t("supplier_not_found")};this.showLoading();const e={supplier:this.supplier_name},t=yield Vt.WM.deleteTrainingData(e);if(!1===t.success)throw{message:t.message};this.clearPredictions(),this.showSuccessToast(this.$t("supplier_training_deleted")),this.confirm_supplier_training_delete=!1}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t)}finally{this.hideLoading()}}))}},setup(){const e=(0,V.NF)(),{is_view_readonly:t,supplier_name:i}=(0,S.bP)(e),{clearPredictions:n}=e;return{clearPredictions:n,is_view_readonly:t,show_popup:(0,P.KR)(!1),supplier_name:i,confirm_all_training_delete:(0,P.KR)(!1),confirm_supplier_training_delete:(0,P.KR)(!1)}}});var xi=i(88672);const ki=(0,re.A)(wi,[["render",Tt],["__scopeId","data-v-12545fbf"]]),Ii=ki;me()(wi,"components",{QBtn:Ke.A,QTooltip:ze.A,QDialog:Xe.A,QCard:vt.A,QCardSection:bt.A,QAvatar:wt.A,QCardActions:Lt.A}),me()(wi,"directives",{ClosePopup:xi.A});const Li={key:0,class:"line-item-container ml-16 q-mr-sm"},Ai={class:"lineItems"},Fi={class:"row items-center table-header"},Ci={class:"",style:{width:"4%"}},Si={class:"header",style:{width:"8%"}},qi={class:"header",style:{width:"37%"}},Ei={class:"header",style:{width:"36%"}},Pi=(0,n.Lk)("div",{class:"",style:{width:"15%"}},null,-1),Mi={class:"row items-center q-mt-sm"},Di={style:{width:"3%"}},Oi={class:"q-ma-sm bg-primary primary-bg-text",style:{width:"22px",display:"inline-block"}},Qi=(0,n.Lk)("div",{style:{width:"97%"}},null,-1);function Ti(e,t,i,o,a,l){const r=(0,n.g2)("q-fab"),d=(0,n.g2)("TotalLineItem"),c=(0,n.g2)("q-separator"),u=(0,n.g2)("lineItem"),m=(0,n.g2)("q-tooltip"),h=(0,n.g2)("q-icon");return e.line_item_loaded&&e.accounts_loaded?((0,n.uX)(),(0,n.CE)("div",Li,[(0,n.Lk)("div",Ai,[(0,n.Lk)("div",Fi,[(0,n.Lk)("div",Ci,[(0,n.bF)(r,{square:"",flat:"",modelValue:e.fab1,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fab1=t),icon:"keyboard_arrow_up",class:"multi-fab",direction:"down",padding:"xs","active-icon":"keyboard_arrow_down","label-class":"",style:{width:"40px"}},null,8,["modelValue"])]),(0,n.Lk)("div",Si,(0,s.v_)(e.$t("pages.line_items_columns.POSITION")),1),(0,n.Lk)("div",qi,(0,s.v_)(e.$t("accounts")),1),(0,n.Lk)("div",Ei,(0,s.v_)(e.$t("amount_title")),1),Pi]),(0,n.bF)(d),(0,n.bF)(c),"line_items"===e.accounting_mode?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.lineItems,((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:e},["line_item"===e.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(u,{index:t},null,8,["index"]),(0,n.bF)(c,{class:"q-mt-sm"})],64)):(0,n.Q3)("",!0)],64)))),128)),(0,n.Lk)("div",Mi,[(0,n.Lk)("div",Di,[(0,n.Lk)("div",Oi,[(0,n.bF)(h,{name:"add",size:"22px",onClick:t[1]||(t[1]=t=>e.addLineItem()),onKeydown:t[2]||(t[2]=(0,Je.jR)((t=>e.addLineItem()),["enter"])),tabindex:"1",class:(0,s.C4)(["cursor-pointer",e.is_view_readonly?"disabled":""])},{default:(0,n.k6)((()=>[(0,n.bF)(m,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("add_new_line_item")),1)])),_:1})])),_:1},8,["class"])])]),Qi])],64)):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)}const Vi=["id","data-id"],$i=(0,n.Lk)("div",{class:"",style:{width:"4%"}},null,-1),Ki={class:"",style:{width:"8%"}},Xi={key:0},Ri={class:"account-container",style:{width:"37%"}},Bi={class:"dimensions",style:{"padding-right":"9px"}},Ni={style:{width:"51%"}},Wi={class:"row"},Ui={style:{width:"71%"}},ji={style:{width:"29%"}},zi={class:"q-ml-sm bg-primary primary-bg-text",style:{width:"22px",display:"inline-block"}},Hi={class:"splitted-line-items",style:{width:"100%"}},Gi={key:0,class:"row q-pt-sm"},Ji=(0,n.Lk)("div",{style:{width:"12%"}},null,-1),Yi={style:{width:"37%"}},Zi={class:"float-right q-mr-md"},en={style:{width:"51%"}},tn={key:0,style:{"margin-left":"12px"}};function nn(e,t,i,o,a,l){const r=(0,n.g2)("Account"),d=(0,n.g2)("Dimensions"),c=(0,n.g2)("Amount"),u=(0,n.g2)("SplitLineItemBtn"),m=(0,n.g2)("UnSplitLineItemBtn"),h=(0,n.g2)("AddChildLineItem"),_=(0,n.g2)("SplitedLineItems"),p=(0,n.g2)("q-tooltip"),g=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",{class:"row q-mt-sm",id:e.lineItems[e.index].id,"data-id":e.lineItems[e.index].id},[$i,(0,n.Lk)("div",Ki,[e.lineItems[e.index].hasOwnProperty("position")?((0,n.uX)(),(0,n.CE)("span",Xi,(0,s.v_)(e.lineItems[e.index].position),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Ri,[(0,n.bF)(r,{readonly:e.lineItems[e.index].readonly,onUpdateAccount:e.updateAccount,item:e.lineItems[e.index],index:e.index},null,8,["readonly","onUpdateAccount","item","index"]),(0,n.Lk)("div",Bi,[(0,n.bF)(d,{index:e.index},null,8,["index"])])]),(0,n.Lk)("div",Ni,[(0,n.Lk)("div",Wi,[(0,n.Lk)("div",Ui,[(0,n.bF)(c,{index:e.index},null,8,["index"])]),(0,n.Lk)("div",ji,[(0,n.bF)(u,{index:e.index},null,8,["index"]),(0,n.bF)(m,{index:e.index},null,8,["index"]),(0,n.Lk)("div",zi,[(0,n.bF)(h,{index:e.index},null,8,["index"])])])])])],8,Vi),(0,n.Lk)("div",Hi,[(0,n.bF)(_,{index:e.index},null,8,["index"])]),e.lineItems[e.index].split_items.length>0?((0,n.uX)(),(0,n.CE)("div",Gi,[Ji,(0,n.Lk)("div",Yi,[(0,n.Lk)("span",Zi,(0,s.v_)(e.$t("unsettled_amount"))+": ",1)]),(0,n.Lk)("div",en,[e.lineItems[e.index].hasOwnProperty("pending_amount")?((0,n.uX)(),(0,n.CE)("span",tn,(0,s.v_)(e.lineItems[e.index].pending_amount),1)):(0,n.Q3)("",!0),""!==e.lineItems[e.index].error?((0,n.uX)(),(0,n.Wv)(g,{key:1,flat:"",dense:"",name:"error",size:"20px",color:"red",class:"q-ml-sm"},{default:(0,n.k6)((()=>[(0,n.bF)(p,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.index].error),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],64)}const sn=["id","data-id"],on=(0,n.Lk)("div",{class:"",style:{width:"12%"}},null,-1),an={class:"account-container",style:{width:"37%"}},ln={class:"dimensions",style:{"padding-right":"9px"}},rn={style:{width:"36%"}},dn={style:{width:"15%"}},cn=(0,n.Lk)("img",{width:"20",src:"images/trash-bin-default.svg"},null,-1);function un(e,t,i,o,a,l){const r=(0,n.g2)("Account"),d=(0,n.g2)("Dimensions"),c=(0,n.g2)("Amount"),u=(0,n.g2)("Percent"),m=(0,n.g2)("q-icon");return(0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.lineItems[e.index].split_items,((t,i)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"row q-pt-sm",id:t.id,"data-id":t.id},[on,(0,n.Lk)("div",an,[(0,n.bF)(r,{readonly:t.readonly,onUpdateAccount:e.updateAccount,item:t,index:i},null,8,["readonly","onUpdateAccount","item","index"]),(0,n.Lk)("div",ln,[(0,n.bF)(d,{line_item_index:e.index,split_line_index:i},null,8,["line_item_index","split_line_index"])])]),(0,n.Lk)("div",rn,[(0,n.bF)(c,{line_item_index:e.index,split_line_index:i},null,8,["line_item_index","split_line_index"]),(0,n.bF)(u,{line_item_index:e.index,split_line_index:i},null,8,["line_item_index","split_line_index"])]),(0,n.Lk)("div",dn,[(0,n.bF)(m,{class:(0,s.C4)(["q-ml-sm cursor-pointer accounting-icon",e.is_view_readonly?"disabled":""]),tabindex:"1",color:"grey",size:"md",onClick:t=>e.deleteLineItem(i,e.index),onKeydown:(0,Je.jR)((t=>e.deleteLineItem(i,e.index)),["enter"])},{default:(0,n.k6)((()=>[cn])),_:2},1032,["onClick","onKeydown","class"])])],8,sn)))),128)}function mn(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-icon"),c=(0,n.g2)("q-input");return(0,n.uX)(),(0,n.Wv)(c,{tabindex:"1",class:"accouting-input column inline",style:{width:"70%"},outlined:"",modelValue:e.lineItems[e.line_item_index].split_items[e.split_line_index].amount,"onUpdate:modelValue":t[0]||(t[0]=t=>e.lineItems[e.line_item_index].split_items[e.split_line_index].amount=t),onKeyup:t[1]||(t[1]=(0,Je.jR)((t=>e.handleAmountEnter(e.lineItems[e.line_item_index].split_items[e.split_line_index])),["enter"])),disable:!!e.is_view_readonly},{append:(0,n.k6)((()=>[""!==e.lineItems[e.line_item_index].split_items[e.split_line_index]["amount_error"]?((0,n.uX)(),(0,n.Wv)(d,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(r,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.line_item_index].split_items[e.split_line_index]["amount_error"]),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["modelValue","disable"])}var hn=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const _n=(0,n.pM)({mixins:[],props:{line_item_index:{type:Number,required:!0},split_line_index:{type:Number,required:!0}},components:{},methods:{clearErrors(e){e.amount_error=""},validateAmountAndSetError(e,t){return t?!!(0,Pe.bA)(t)||(e.amount_error=this.$t("amount_invalid"),!1):(e.amount_error=this.$t("amount_is_empty"),!1)},validateAmountUpdateAndSetError(e,t,i){return i?!(t>i)||(e.amount_error=this.$t("amount_cannot_be_greater_than_parent_amount"),!1):(e.amount_error=this.$t("parent_amount_is_empty"),!1)},handleAmountEnter(e){return hn(this,void 0,void 0,(function*(){if(this.is_view_readonly)return;this.clearErrors(e);const t=e.amount;if(!this.validateAmountAndSetError(e,t))return;const i=this.lineItems[this.line_item_index].amount,n=[];n.push({key:t,value:t}),n.push({key:i,value:i});const s=yield this.formatMultiValues(n,this.amount_format_locale),o=this.searchValueByKey(t,s),a=parseFloat(o);if(!this.validateAmountAndSetError(e,a))return;e.amount_standard=a;const l=this.searchValueByKey(this.lineItems[this.line_item_index].amount,s),r=parseFloat(l);if(this.lineItems[this.line_item_index].amount_standard=r,!this.validateAmountUpdateAndSetError(e,a,r))return;const d=a/r*100;e.percentage=(yield this.formatValue(d.toFixed(2),"en_US",this.amount_format_locale))+"%",this.autFillEmptyLineItems(this.line_item_index)}))}},setup(){const e=(0,V.NF)(),{lineItems:t,amount_format_locale:i,is_view_readonly:n}=(0,S.bP)(e),s=(0,V.gP)(),{formatMultiValues:o,formatValue:a}=s,{searchValueByKey:l,autFillEmptyLineItems:r}=e;return{autFillEmptyLineItems:r,searchValueByKey:l,is_view_readonly:n,formatMultiValues:o,formatValue:a,amount_format_locale:i,lineItems:t}}}),pn=(0,re.A)(_n,[["render",mn]]),gn=pn;function vn(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-icon"),c=(0,n.g2)("q-input");return(0,n.uX)(),(0,n.Wv)(c,{tabindex:"1",class:"accouting-input q-pl-sm column inline",style:{width:"30%"},outlined:"",modelValue:e.lineItems[e.line_item_index].split_items[e.split_line_index].percentage,"onUpdate:modelValue":t[0]||(t[0]=t=>e.lineItems[e.line_item_index].split_items[e.split_line_index].percentage=t),onKeyup:t[1]||(t[1]=(0,Je.jR)((t=>e.handlePercdntEnter(e.lineItems[e.line_item_index].split_items[e.split_line_index])),["enter"])),disable:!!e.is_view_readonly},{append:(0,n.k6)((()=>[""!==e.lineItems[e.line_item_index].split_items[e.split_line_index]["percentage_error"]?((0,n.uX)(),(0,n.Wv)(d,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(r,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.line_item_index].split_items[e.split_line_index]["percentage_error"]),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["modelValue","disable"])}me()(_n,"components",{QInput:ei.A,QIcon:de.A,QTooltip:ze.A});var yn=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const fn=(0,n.pM)({mixins:[],props:{line_item_index:{type:Number,required:!0},split_line_index:{type:Number,required:!0}},components:{},methods:{clearErrors(e){e.percentage_error=""},validateAmountAndSetError(e,t){return t?!!(0,Pe.bA)(t)||(e.amount_error=this.$t("amount_invalid"),!1):(e.amount_error=this.$t("amount_is_empty"),!1)},validatePercentAndSetError(e,t){return t?!!(0,Pe.bA)(t)||(e.percentage_error=this.$t("percentage_invalid"),!1):(e.percentage_error=this.$t("percentage_is_empty"),!1)},validatePercentUpdateAndSetError(e,t){return t?!(t>100)||(e.percentage_error=this.$t("percentage_cannot_be_greater_than_100"),!1):(e.percentage_error=this.$t("percentage_is_empty"),!1)},handlePercdntEnter(e){return yn(this,void 0,void 0,(function*(){if(this.is_view_readonly)return;this.clearErrors(e);let t=this.lineItems[this.line_item_index].amount,i=e.percentage.replace("%","");if(!this.validateAmountAndSetError(e,t))return;const n=[];n.push({key:t,value:t}),n.push({key:i,value:i});const s=yield this.formatMultiValues(n,this.amount_format_locale),o=this.searchValueByKey(i,s),a=parseFloat(o);if(!this.validatePercentUpdateAndSetError(e,a))return;e.percent_float=a;const l=this.searchValueByKey(t,s),r=parseFloat(l);this.lineItems[this.line_item_index].amount_standard=r;const d=a/100*r,c=parseFloat(d.toFixed(2)),u=isNaN(c);u?e.amount="":(e.amount_standard=c,e.amount=yield this.formatValue(String(c),"en_US",this.amount_format_locale),this.autFillEmptyLineItems(this.line_item_index))}))}},setup(){const e=(0,V.NF)(),{lineItems:t,amount_format_locale:i,is_view_readonly:n}=(0,S.bP)(e),{searchValueByKey:s,autFillEmptyLineItems:o}=e,a=(0,V.gP)(),{formatMultiValues:l,formatValue:r}=a;return{autFillEmptyLineItems:o,searchValueByKey:s,is_view_readonly:n,formatMultiValues:l,formatValue:r,amount_format_locale:i,lineItems:t}}}),bn=(0,re.A)(fn,[["render",vn]]),wn=bn;me()(fn,"components",{QInput:ei.A,QIcon:de.A,QTooltip:ze.A});const xn={class:"ellipsis"},kn=["innerHTML"],In=["innerHTML"],Ln={class:"row full-width account-search-row q-mb-md back-white p-t-20"},An={class:"grid account-categories"},Fn={class:"content"};function Cn(e,t,i,o,a,l){const r=(0,n.g2)("q-item-label"),d=(0,n.g2)("q-item-section"),c=(0,n.g2)("q-item"),u=(0,n.g2)("q-tooltip"),m=(0,n.g2)("q-icon"),h=(0,n.g2)("q-select"),_=(0,n.g2)("q-input"),p=(0,n.g2)("DisplayAccounts"),g=(0,n.g2)("q-card-section"),v=(0,n.g2)("dialog-draggable");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(h,{tabindex:"1",class:"q-mr-sm accounting-select account-select",clearable:"","use-input":"",outlined:"",modelValue:e.localValue,"onUpdate:modelValue":t[1]||(t[1]=t=>e.localValue=t),loading:!e.accounts_loaded,options:e.filterAccounts,onInputValue:e.selectInputValue,onFilter:e.filterAccountsEvent,disable:e.isReadOnly()},{"selected-item":(0,n.k6)((e=>[(0,n.Lk)("div",xn,(0,s.v_)(e.opt.label),1)])),option:(0,n.k6)((t=>[(0,n.bF)(c,(0,s._B)((0,n.Ng)(t.itemProps)),{default:(0,n.k6)((()=>[(0,n.bF)(d,null,{default:(0,n.k6)((()=>[!1===t.opt.parent?((0,n.uX)(),(0,n.Wv)(r,{key:0,class:(0,s.C4)("pl-20 ")},{default:(0,n.k6)((()=>[(0,n.Lk)("span",{innerHTML:e.highlightOption(t.opt.label,e.input_value)},null,8,kn)])),_:2},1024)):((0,n.uX)(),(0,n.Wv)(r,{key:1},{default:(0,n.k6)((()=>[(0,n.Lk)("span",{innerHTML:e.highlightOption(t.opt.label,e.input_value)},null,8,In)])),_:2},1024))])),_:2},1024)])),_:2},1040)])),append:(0,n.k6)((()=>[""!==e.account_error?((0,n.uX)(),(0,n.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(u,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.account_error),1)])),_:1})])),_:1})):(0,n.Q3)("",!0),e.view_template===e.view_types.ln?((0,n.uX)(),(0,n.Wv)(m,{key:1,flat:"",dense:"",size:"24px",class:"cursor-pointer",name:"list",onClick:t[0]||(t[0]=(0,Je.D$)((t=>e.openAccountDialog()),["stop","prevent"]))},{default:(0,n.k6)((()=>[(0,n.bF)(u,{anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("select_category_manually")),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["modelValue","loading","options","onInputValue","onFilter","disable"]),(0,n.bF)(v,{modelValue:e.display_accounts_dialog,"onUpdate:modelValue":t[3]||(t[3]=t=>e.display_accounts_dialog=t),"full-width":"",onKeydown:(0,Je.jR)(e.closeDialog,["esc"]),title:e.$t("select_category_manually"),onOnHide:e.closeDialog,width:e.popup_width},{default:(0,n.k6)((()=>[(0,n.bF)(g,{class:"account-container"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",Ln,[(0,n.bF)(_,{modelValue:e.search_account,"onUpdate:modelValue":t[2]||(t[2]=t=>e.search_account=t),outlined:"",dense:"",class:"col-12",placeholder:e.$t("pages.user.search")+" ("+e.$t("after_typing_press_enter")+")",clearable:"",onClear:e.clearManualAccountsSearch,onKeyup:(0,Je.jR)(e.searchAccounts,["enter"])},{append:(0,n.k6)((()=>[(0,n.bF)(m,{name:"search",onClick:e.searchAccounts},null,8,["onClick"])])),_:1},8,["modelValue","placeholder","onClear","onKeyup"])]),(0,n.Lk)("div",An,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.dialogFilteredAccounts,((t,i)=>((0,n.uX)(),(0,n.CE)("div",{key:i,class:"item"},[(0,n.Lk)("div",Fn,[(0,n.bF)(p,{onAccountSelected:e.accountSelected,nodes:t},null,8,["onAccountSelected","nodes"])])])))),128))])])),_:1})])),_:1},8,["modelValue","onKeydown","title","onOnHide","width"])],64)}var Sn=i(10145);const qn={key:0,class:"childern account-categories-ul"};function En(e,t,i,o,a,l){const r=(0,n.g2)("AccountCategory");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("span",{class:"account-link row cursor-pointer",onClick:t[0]||(t[0]=t=>e.accountSelected(e.nodes.value))},(0,s.v_)(e.nodes.label),1),e.nodes.children.length>0?((0,n.uX)(),(0,n.CE)("ul",qn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.nodes.children,((t,i)=>((0,n.uX)(),(0,n.CE)("li",{key:i},[(0,n.bF)(r,{onAccountSelected:e.accountSelected,nodes:t},null,8,["onAccountSelected","nodes"])])))),128))])):(0,n.Q3)("",!0)],64)}const Pn=(0,n.pM)({name:"AccountCategory",props:{nodes:{type:Object,required:!0}},emits:["accountSelected"],methods:{accountSelected(e){this.$emit("accountSelected",e)}},setup(){return{}}}),Mn=(0,re.A)(Pn,[["render",En]]),Dn=Mn,On=(0,n.pM)({mixins:[],props:{item:{type:Object,required:!0},readonly:{type:Boolean,default:!1},index:{type:Number,required:!0},child_index:{type:Number}},components:{dialogDraggable:Sn.A,DisplayAccounts:Dn},emits:["update-account"],computed:{account_error:function(){return String(this.item.account_error)},show_auto_detect:function(){let e=!1;return this.hasTotalPredictions()&&(e=!0),this.hasLineItemsPredictions()&&(e=!0),e},localValue:{get(){return this.item.account},set(e){this.$emit("update-account",{index:this.index,value:e})}}},mounted(){this.input_value="",this.popup_width=this.calculateWidthForPopuup(),window.addEventListener("resize",this.calculateWidthForPopuup)},unmounted:function(){window.removeEventListener("resize",this.calculateWidthForPopuup)},methods:{calculateWidthForPopuup(){let e="800";const t=document.querySelector(".accounting-area");if(!t)return e;const i=t.offsetWidth-300;return i<=0?e:String(i)},closeDialog(){this.dialogFilteredAccounts=this.categorized_accounts,this.display_accounts_dialog=!1},isReadOnly(){return!!this.is_view_readonly||(!!Boolean(this.item.readonly)||!!(this.item.hasOwnProperty("split_items")&&this.item.split_items.length>0))},filterAccountsEvent(e,t,i){t(e?()=>{this.filterAccounts=this.accountFilterByAnyValue(e)}:()=>{this.filterAccounts=this.accounts})},searchAccounts(){if(!this.search_account||0===this.search_account.length)return this.dialogFilteredAccounts=this.categorized_accounts,void this.afterAccountsRendered();const e=this.search_account.toLowerCase(),t=this.accounts.filter((t=>t.label.toLowerCase().indexOf(e)>-1));this.dialogFilteredAccounts=this.getAccountAsCategories(t),this.afterAccountsRendered()},openAccountDialog(){this.search_account="",this.display_accounts_dialog=!0,this.afterAccountsRendered()},afterAccountsRendered(){setTimeout((()=>{this.resizeAllGridItems()}),0)},clearManualAccountsSearch(){this.search_account="",this.dialogFilteredAccounts=this.categorized_accounts,this.afterAccountsRendered()},accountSelected(e){const t=this.accounts.filter((t=>t.value.toLowerCase().indexOf(e)>-1));t.length>0&&(this.localValue=t[0]),this.closeDialog()},resizeAllGridItems(){const e=document.getElementsByClassName("item");for(let t=0;t<e.length;t++)this.resizeGridItem(e[t])},resizeGridItem(e){const t=document.getElementsByClassName("grid")[0];if(!t)return;const i=parseInt(window.getComputedStyle(t).getPropertyValue("grid-auto-rows")),n=parseInt(window.getComputedStyle(t).getPropertyValue("grid-row-gap")),s=e.querySelector(".content").offsetHeight,o=Math.ceil((s+n)/(i+n));e.style.gridRowEnd="span "+o},selectInputValue(e){this.input_value=e}},setup(){const e=(0,V.NF)(),{categorized_accounts:t,accounts:i,accounts_loaded:n,is_view_readonly:s,accountFilterByAnyValue:o,total_line_predictions:a,line_items_line_predictions:l,accounting_mode:r}=(0,S.bP)(e),{hasTotalPredictions:d,hasLineItemsPredictions:c,getAccountAsCategories:u,highlightOption:m}=e,h=(0,P.KR)(e.accounts),_=(0,P.KR)(e.categorized_accounts),p=(0,V.WN)(),{view_template:g,view_types:v}=(0,S.bP)(p);return{highlightOption:m,view_types:v,view_template:g,getAccountAsCategories:u,categorized_accounts:t,hasTotalPredictions:d,hasLineItemsPredictions:c,accounting_mode:r,total_line_predictions:a,line_items_line_predictions:l,is_view_readonly:s,filterAccounts:h,dialogFilteredAccounts:_,accounts_loaded:n,accounts:i,accountFilterByAnyValue:o,display_accounts_dialog:(0,P.KR)(!1),popup_width:(0,P.KR)("800"),search_account:(0,P.KR)(""),input_value:(0,P.KR)("")}}}),Qn=(0,re.A)(On,[["render",Cn],["__scopeId","data-v-ec2e9c04"]]),Tn=Qn;me()(On,"components",{QSelect:ti.A,QItem:ii.A,QItemSection:ni.A,QItemLabel:si.A,QIcon:de.A,QTooltip:ze.A,QCardSection:bt.A,QInput:ei.A});const Vn={key:0,class:"row items-center q-mt-sm dimension-container"},$n={key:0,class:"q-pr-sm text-container"};function Kn(e,t,i,o,a,l){const r=(0,n.g2)("Dimension");return(0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.lineItems[e.line_item_index].split_items[e.split_line_index].dimensions,((t,i)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:i},["p"!==t.rule.toLowerCase()?((0,n.uX)(),(0,n.CE)("div",Vn,[0===i?((0,n.uX)(),(0,n.CE)("div",$n,(0,s.v_)(e.$t("dimensions"))+": ",1)):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,s.C4)(0===i?"input-container":" input-100 ")},[(0,n.bF)(r,{onUpdateDimension:e.updateDimension,item:t,index:i},null,8,["onUpdateDimension","item","index"])],2)])):(0,n.Q3)("",!0)],64)))),128)}const Xn={key:0,class:"text-red"},Rn={class:"ellipsis"},Bn=["innerHTML"],Nn=["innerHTML"],Wn={key:0,class:"text-red"},Un=["innerHTML"];function jn(e,t,i,o,a,l){const r=(0,n.g2)("q-item-label"),d=(0,n.g2)("q-item-section"),c=(0,n.g2)("q-item"),u=(0,n.g2)("q-tooltip"),m=(0,n.g2)("q-icon"),h=(0,n.g2)("q-select"),_=(0,n.g2)("q-input");return(0,n.uX)(),(0,n.CE)(n.FK,null,[e.hasList?((0,n.uX)(),(0,n.Wv)(h,{key:0,tabindex:"1",class:"accounting-select dimension-select",clearable:"","use-input":"",outlined:"",modelValue:e.localValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.localValue=t),loading:!e.accounts_loaded,options:e.dimension_options,onFilter:e.filterListEvent,onInputValue:e.selectInputValue,"emit-value":"","map-options":"",disable:e.is_view_readonly||e.dimension_readonly,label:e.item.name+("m"===e.item.rule.toLowerCase()?" *":"")},{label:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.item.name)+" ",1),"m"===e.item.rule.toLowerCase()?((0,n.uX)(),(0,n.CE)("span",Xn," *")):(0,n.Q3)("",!0)])),"selected-item":(0,n.k6)((e=>[(0,n.Lk)("div",Rn,(0,s.v_)(e.opt.label),1)])),option:(0,n.k6)((t=>[(0,n.bF)(c,(0,s._B)((0,n.Ng)(t.itemProps)),{default:(0,n.k6)((()=>[(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",{innerHTML:e.highlightOption(t.opt.label,e.input_value)},null,8,Bn)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),append:(0,n.k6)((()=>[""!==e.dimension_error?((0,n.uX)(),(0,n.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(u,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",{innerHTML:e.dimension_error},null,8,Nn)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["modelValue","loading","options","onFilter","onInputValue","disable","label"])):(0,n.Q3)("",!0),e.hasList?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(_,{key:1,class:"accouting-input column inline full-width dimension-input",outlined:"",label:e.item.name+("m"===e.item.rule.toLowerCase()?"*":""),modelValue:e.localValue,"onUpdate:modelValue":t[1]||(t[1]=t=>e.localValue=t),disable:!!e.is_view_readonly},{label:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.item.name)+" ",1),"m"===e.item.rule.toLowerCase()?((0,n.uX)(),(0,n.CE)("span",Wn," *")):(0,n.Q3)("",!0)])),append:(0,n.k6)((()=>[""!==e.dimension_error?((0,n.uX)(),(0,n.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(u,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",{innerHTML:e.dimension_error},null,8,Un)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["label","modelValue","disable"]))],64)}const zn=(0,n.pM)({mixins:[],props:{item:{type:Object,required:!0},readonly:{type:Boolean,default:!1},index:{type:Number,required:!0},account:{type:Object,required:!0}},watch:{dimension_dropdowns:{deep:!0,handler:function(e,t){this.setDropDownOptions()}}},components:{},computed:{dimension_error:function(){return String(this.item.error)},localValue:{get(){return String(this.item.value)},set(e){this.$emit("update-dimension",{index:this.index,value:e})}},hasList:function(){return 0!==(0,oe.Ns)(this.account)&&(this.view_template==this.view_types.m3?this.hasDimensionByAccount():!!(this.dimension_dropdowns.hasOwnProperty(this.item.id)&&this.dimension_dropdowns[this.item.id].length>0))}},mounted:function(){this.dimension_value=this.item.value,this.input_value="",this.setDropDownOptions()},methods:{setDropDownOptions(){if(0!==(0,oe.Ns)(this.account)){if(this.view_template!=this.view_types.m3)return this.dimension_dropdowns.hasOwnProperty(this.item.id)&&this.dimension_dropdowns[this.item.id].length>0?(this.all_dimension_options=this.dimension_dropdowns[this.item.id],void this.setDimensionOptions()):void this.resetOptions();this.getDimenionOptionbyAccount()}else this.resetOptions()},resetOptions(){this.all_dimension_options=[],this.dimension_options=this.all_dimension_options},setDimensionOptions(){this.dimension_options=JSON.parse(JSON.stringify(this.all_dimension_options))},hasDimensionByAccount(){let e=!1;const t=this.isRangeDimension();return t&&this.isRangeDimensionHasOptions()&&(e=!0),e||t||!this.isGeneralDimension()||(e=!0),e},isGeneralDimension(){return!!(this.dimension_general_dropdowns.hasOwnProperty(this.item.id)&&this.dimension_general_dropdowns[this.item.id].length>0)},isRangeDimensionHasOptions(){return!(!this.dimension_dropdowns.hasOwnProperty(this.account.value)||!this.dimension_dropdowns[this.account.value].hasOwnProperty(this.item.id))},isRangeDimension(){return!(!this.dimension_rules.hasOwnProperty(this.account.value)||!this.dimension_rules[this.account.value].hasOwnProperty(this.item.id))},getDimenionOptionbyAccount(){if(!this.hasDimensionByAccount())return void this.resetOptions();const e=this.isRangeDimension();e&&this.isRangeDimensionHasOptions()&&(this.all_dimension_options=this.dimension_dropdowns[this.account.value][this.item.id]),!e&&this.isGeneralDimension()&&(this.all_dimension_options=this.dimension_general_dropdowns[this.item.id]),this.setDimensionOptions()},filterListEvent(e,t,i){t(e?()=>{const t=e.toLowerCase();let i=this.all_dimension_options.filter((e=>e.label.toLowerCase().startsWith(t)));0===i.length&&(i=this.all_dimension_options.filter((e=>e.label.toLowerCase().indexOf(t)>-1))),this.dimension_options=i}:()=>{this.setDimensionOptions()})},selectInputValue(e){this.input_value=e}},setup(){const e=(0,V.NF)(),{dimension_dropdowns:t,dimension_rules:i,accounts_loaded:n,is_view_readonly:s,dimension_general_dropdowns:o}=(0,S.bP)(e),{highlightOption:a}=e,l=(0,V.WN)(),{view_template:r,view_types:d}=(0,S.bP)(l);return{highlightOption:a,view_types:d,view_template:r,is_view_readonly:s,dimension_dropdowns:t,dimension_general_dropdowns:o,accounts_loaded:n,dimension_rules:i,dimension_options:(0,P.KR)([]),all_dimension_options:(0,P.KR)([]),dimension_value:(0,P.KR)(""),input_value:(0,P.KR)("")}}}),Hn=(0,re.A)(zn,[["render",jn]]),Gn=Hn;me()(zn,"components",{QSelect:ti.A,QItem:ii.A,QItemSection:ni.A,QItemLabel:si.A,QIcon:de.A,QTooltip:ze.A,QInput:ei.A});const Jn=(0,n.pM)({mixins:[],props:{line_item_index:{type:Number,required:!0},split_line_index:{type:Number,required:!0}},computed:{hasDimensions:function(){return!(!this.lineItems[this.line_item_index].split_items[this.split_line_index].hasOwnProperty("dimensions")||void 0===this.lineItems[this.line_item_index].split_items[this.split_line_index].dimensions)}},components:{Dimension:Gn},methods:{updateDimension(e){if(!e.hasOwnProperty("index")||!e.hasOwnProperty("value"))return;let t=e.value;void 0!==t&&null!==t||(t=""),this.lineItems[this.line_item_index].split_items[this.split_line_index].dimensions[e.index].error="",this.lineItems[this.line_item_index].split_items[this.split_line_index].dimensions[e.index].value=t}},setup(){const e=(0,V.NF)(),{lineItems:t,dimensions:i,is_view_readonly:n}=(0,S.bP)(e);return{is_view_readonly:n,dimensions:i,lineItems:t}}}),Yn=(0,re.A)(Jn,[["render",Kn],["__scopeId","data-v-14cf72fa"]]),Zn=Yn,es=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{Account:Tn,Amount:gn,Dimensions:Zn,Percent:wn},methods:{updateAccount(e){if(this.is_view_readonly)return;if(!e.hasOwnProperty("index")||!e.hasOwnProperty("value"))return;const t=e.index,i=e.value;this.updateAccountInStore(this.index,t,i)},validateAmountAndSetError(e,t){return t?!!(0,Pe.bA)(t)||(e.amount_error=this.$t("amount_invalid"),!1):(e.amount_error=this.$t("amount_is_empty"),!1)},deleteLineItem(e,t){if(!this.is_view_readonly){try{this.lineItems[t].split_items.splice(e,1)}catch(i){}this.calculateTotalByMode()}}},setup(){const e=(0,V.NF)(),{lineItems:t,is_view_readonly:i}=(0,S.bP)(e),{calculateTotalByMode:n,getDimensionsForAccount:s,validateLine:o,updateAccount:a}=e;return{updateAccountInStore:a,validateLine:o,calculateTotalByMode:n,is_view_readonly:i,lineItems:t,getDimensionsForAccount:s}}}),ts=(0,re.A)(es,[["render",un]]),is=ts;me()(es,"components",{QIcon:de.A});const ns={key:0,class:"q-pr-sm text-container"};function ss(e,t,i,o,a,l){const r=(0,n.g2)("Dimension");return e.hasDimensions?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(e.lineItems[e.index].dimensions,((t,i)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:i},["p"!==t.rule.toLowerCase()?((0,n.uX)(),(0,n.CE)("div",{key:0,class:(0,s.C4)(["row items-center q-mt-sm dimension-container",e.expert_mode?"export-mode":""])},[0===i?((0,n.uX)(),(0,n.CE)("div",ns,(0,s.v_)(e.$t("dimensions"))+": ",1)):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,s.C4)(0===i?"input-container":" input-100 ")},[(0,n.bF)(r,{readonly:e.lineItems[e.index].readonly,onUpdateDimension:e.updateDimension,item:t,index:i,account:e.lineItems[e.index].account},null,8,["readonly","onUpdateDimension","item","index","account"])],2)],2)):(0,n.Q3)("",!0)],64)))),128)):(0,n.Q3)("",!0)}const os=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},computed:{hasDimensions:function(){return!(!this.lineItems[this.index].hasOwnProperty("dimensions")||void 0===this.lineItems[this.index].dimensions)},setDimensionList(){return!0}},components:{Dimension:Gn},methods:{updateDimension(e){if(!e.hasOwnProperty("index")||!e.hasOwnProperty("value"))return;let t=e.value;void 0!==t&&null!==t||(t=""),this.lineItems[this.index].dimensions[e.index].error="",this.lineItems[this.index].dimensions[e.index].value=t}},setup(){const e=(0,V.NF)(),{lineItems:t,dimensions:i,dimension_dropdowns:n,is_view_readonly:s,accounts_loaded:o,expert_mode:a}=(0,S.bP)(e);return{expert_mode:a,accounts_loaded:o,is_view_readonly:s,dimensions:i,lineItems:t,dimension_dropdowns:n}}}),as=(0,re.A)(os,[["render",ss],["__scopeId","data-v-4c594f82"]]),ls=as;function rs(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-icon"),c=(0,n.g2)("q-input");return(0,n.uX)(),(0,n.Wv)(c,{tabindex:"1",class:"accouting-input amount-input",outlined:"",modelValue:e.lineItems[e.index].amount,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.lineItems[e.index].amount=t),t[1]||(t[1]=t=>{e.amountUpdated()})],disable:e.isReadOnly()},{append:(0,n.k6)((()=>[""!==e.lineItems[e.index]["amount_error"]?((0,n.uX)(),(0,n.Wv)(d,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,n.k6)((()=>[(0,n.bF)(r,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.index]["amount_error"]),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1},8,["modelValue","disable"])}const ds=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{},methods:{isReadOnly(){return this.lineItems[this.index].split_items.length>0||(!(!this.lineItems[this.index].hasOwnProperty("amount_readonly")||!0!==this.lineItems[this.index].amount_readonly)||(!!Boolean(this.lineItems[this.index].readonly)||!!Boolean(this.is_view_readonly)))},clearlineItemAmountError(e){this.lineItems[e].amount_error=""},amountUpdated(){this.is_view_readonly||(this.clearlineItemAmountError(this.index),this.lineItems[this.index]||(this.lineItems[this.index].amount_error=this.$t("amount_is_empty")),(0,Pe.bA)(this.lineItems[this.index].amount)?this.calculateTotalByMode():this.lineItems[this.index].amount_error=this.$t("amount_invalid"))}},setup(){const e=(0,V.NF)(),{lineItems:t,amount_format_locale:i,is_view_readonly:n}=(0,S.bP)(e),{calculateTotalByMode:s}=e;return{calculateTotalByMode:s,is_view_readonly:n,amount_format_locale:i,lineItems:t}}}),cs=(0,re.A)(ds,[["render",rs]]),us=cs;function ms(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.Wv)(d,{tabindex:"1",name:"add",size:"22px",onClick:e.addChildLineItem,onKeydown:(0,Je.jR)(e.addChildLineItem,["enter"]),class:(0,s.C4)(["cursor-pointer",e.is_view_readonly||e.lineItems[e.index].readonly?"disabled":""])},{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("split_line_item")),1)])),_:1})])),_:1},8,["onClick","onKeydown","class"])}me()(ds,"components",{QInput:ei.A,QIcon:de.A,QTooltip:ze.A});const hs=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{},methods:{addChildLineItem(){if(this.is_view_readonly||!this.lineItems[this.index].amount||""===this.lineItems[this.index].amount||!0===this.lineItems[this.index].readonly)return;this.resetItem(this.index);const e=this.baseSplitLineItem();e.percentage="0%",this.lineItems[this.index].split_items.push(e),this.calculateTotalByMode()}},setup(){const e=(0,V.NF)(),{lineItems:t,is_view_readonly:i}=(0,S.bP)(e),{baseSplitLineItem:n,calculateTotalByMode:s,resetItem:o}=e;return{resetItem:o,calculateTotalByMode:s,is_view_readonly:i,baseSplitLineItem:n,lineItems:t}}}),_s=(0,re.A)(hs,[["render",ms]]),ps=_s;me()(hs,"components",{QIcon:de.A,QTooltip:ze.A});const gs=(0,n.Lk)("img",{width:"20",src:"images/split_accounting.svg"},null,-1);function vs(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-icon");return 0===e.lineItems[e.index].split_items.length?((0,n.uX)(),(0,n.Wv)(d,{key:0,class:(0,s.C4)(["q-ml-sm cursor-pointer accounting-icon",e.is_view_readonly||e.lineItems[e.index].readonly?"disabled":""]),tabindex:"1",color:"grey",size:"md",onClick:e.splitLineItem,onKeydown:(0,Je.jR)(e.splitLineItem,["enter"])},{default:(0,n.k6)((()=>[gs,(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("split_line_item")),1)])),_:1})])),_:1},8,["onClick","onKeydown","class"])):(0,n.Q3)("",!0)}var ys=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const fs=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{},methods:{splitLineItem(){return ys(this,void 0,void 0,(function*(){if(this.is_view_readonly||!this.lineItems[this.index].amount||""===this.lineItems[this.index].amount||!0===this.lineItems[this.index].readonly)return;this.resetItem(this.index);let e=yield this.formatValue(this.lineItems[this.index].amount,this.amount_format_locale);const t=parseFloat(e);let i=t/2;i=parseFloat(i.toFixed(2));let n=yield this.formatValue(String(i),"en_US",this.amount_format_locale);const s=this.baseSplitLineItem();s.percentage="50%",s.amount=n,this.lineItems[this.index].split_items.push(s);const o=this.baseSplitLineItem();o.percentage="50%",o.amount=n,this.lineItems[this.index].split_items.push(o),this.calculateTotalByMode()}))}},setup(){const e=(0,V.NF)(),{lineItems:t,amount_format_locale:i,is_view_readonly:n}=(0,S.bP)(e),{baseSplitLineItem:s,calculateTotalByMode:o,resetItem:a}=e,l=(0,V.gP)(),{formatValue:r}=l;return{resetItem:a,calculateTotalByMode:o,baseSplitLineItem:s,is_view_readonly:n,amount_format_locale:i,formatValue:r,lineItems:t}}}),bs=(0,re.A)(fs,[["render",vs]]),ws=bs;me()(fs,"components",{QIcon:de.A,QTooltip:ze.A});const xs=(0,n.Lk)("img",{width:"20",src:"images/split_done.svg"},null,-1);function ks(e,t,i,o,a,l){const r=(0,n.g2)("q-tooltip"),d=(0,n.g2)("q-icon");return e.lineItems[e.index].split_items.length>0?((0,n.uX)(),(0,n.Wv)(d,{key:0,class:(0,s.C4)(["q-ml-sm cursor-pointer accounting-icon",e.is_view_readonly||e.lineItems[e.index].readonly?"disabled":""]),tabindex:"1",color:"grey",size:"md",onClick:e.un_splitLineItem,onKeydown:(0,Je.jR)(e.un_splitLineItem,["enter"])},{default:(0,n.k6)((()=>[xs,(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("remove_line_item_split")),1)])),_:1})])),_:1},8,["onClick","onKeydown","class"])):(0,n.Q3)("",!0)}const Is=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{},methods:{un_splitLineItem(){this.is_view_readonly||!0===this.lineItems[this.index].readonly||(this.lineItems[this.index].split_items=[],this.calculateTotalByMode())}},setup(){const e=(0,V.NF)(),{lineItems:t,is_view_readonly:i}=(0,S.bP)(e),{calculateTotalByMode:n}=e;return{calculateTotalByMode:n,is_view_readonly:i,lineItems:t}}}),Ls=(0,re.A)(Is,[["render",ks]]),As=Ls;me()(Is,"components",{QIcon:de.A,QTooltip:ze.A});const Fs=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{SplitedLineItems:is,Dimensions:ls,Amount:us,Account:Tn,AddChildLineItem:ps,SplitLineItemBtn:ws,UnSplitLineItemBtn:As},methods:{updateAccount(e){this.is_view_readonly||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&this.updateAccountInStore(this.index,null,e.value)},updateAmount(e){this.is_view_readonly||null===this.index||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&(this.lineItems[this.index].amount=e.value)}},setup(){const e=(0,V.NF)(),{lineItems:t,is_view_readonly:i}=(0,S.bP)(e),{getDimensionsForAccount:n,validateLine:s,updateAccount:o}=e;return{updateAccountInStore:o,is_view_readonly:i,lineItems:t,getDimensionsForAccount:n,validateLine:s}}}),Cs=(0,re.A)(Fs,[["render",nn]]),Ss=Cs;me()(Fs,"components",{QIcon:de.A,QTooltip:ze.A});const qs=["id","data-id"],Es=(0,n.Lk)("div",{class:"",style:{width:"4%"}},null,-1),Ps={class:"",style:{width:"8%"}},Ms={class:"account-container",style:{width:"37%"}},Ds={class:"dimensions",style:{"padding-right":"9px"}},Os={style:{width:"51%"}},Qs={class:"row"},Ts={style:{width:"71%"}},Vs={style:{width:"29%"}},$s={class:"q-ml-sm bg-primary primary-bg-text",style:{width:"22px",display:"inline-block"}},Ks={class:"splitted-line-items total-line-item-area",style:{width:"100%"}},Xs={class:"row total-line-item-area q-pb-sm q-pt-md"},Rs=(0,n.Lk)("div",{style:{width:"12%"}},null,-1),Bs={style:{width:"37%"}},Ns={class:"float-right q-mr-md"},Ws={style:{width:"51%"}},Us={key:0,style:{"margin-left":"12px"}},js={class:"row total-line-item-area q-pb-sm"},zs=(0,n.Lk)("div",{style:{width:"12%"}},null,-1),Hs={style:{width:"37%"}},Gs={class:"float-right q-mr-md"},Js={style:{width:"51%"}},Ys={key:0,style:{"margin-left":"12px"}};function Zs(e,t,i,o,a,l){const r=(0,n.g2)("Account"),d=(0,n.g2)("Dimensions"),c=(0,n.g2)("Amount"),u=(0,n.g2)("SplitLineItemBtn"),m=(0,n.g2)("UnSplitLineItemBtn"),h=(0,n.g2)("AddChildLineItem"),_=(0,n.g2)("SplitedLineItems"),p=(0,n.g2)("q-tooltip"),g=(0,n.g2)("q-icon");return null!==e.header_index?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("div",{class:"row q-pt-sm total-line-item-area",id:e.lineItems[e.header_index].id,"data-id":e.lineItems[e.header_index].id},[Es,(0,n.Lk)("div",Ps,(0,s.v_)(e.$t("total")),1),(0,n.Lk)("div",Ms,[(0,n.bF)(r,{readonly:e.lineItems[e.header_index].readonly,onUpdateAccount:e.updateAccount,item:e.lineItems[e.header_index],index:e.header_index},null,8,["readonly","onUpdateAccount","item","index"]),(0,n.Lk)("div",Ds,[(0,n.bF)(d,{index:e.header_index},null,8,["index"])])]),(0,n.Lk)("div",Os,[(0,n.Lk)("div",Qs,[(0,n.Lk)("div",Ts,[(0,n.bF)(c,{index:e.header_index},null,8,["index"])]),(0,n.Lk)("div",Vs,[(0,n.bF)(u,{index:e.header_index},null,8,["index"]),(0,n.bF)(m,{index:e.header_index},null,8,["index"]),(0,n.Lk)("div",$s,[(0,n.bF)(h,{index:e.header_index},null,8,["index"])])])])])],8,qs),(0,n.Lk)("div",Ks,[(0,n.bF)(_,{index:e.header_index},null,8,["index"])]),(0,n.Lk)("div",Xs,[Rs,(0,n.Lk)("div",Bs,[(0,n.Lk)("span",Ns,(0,s.v_)(e.$t("recorded_bookings"))+": ",1)]),(0,n.Lk)("div",Ws,[e.lineItems[e.header_index].hasOwnProperty("lines_total_amount")?((0,n.uX)(),(0,n.CE)("span",Us,(0,s.v_)(e.lineItems[e.header_index].lines_total_amount),1)):(0,n.Q3)("",!0)])]),(0,n.Lk)("div",js,[zs,(0,n.Lk)("div",Hs,[(0,n.Lk)("span",Gs,(0,s.v_)(e.$t("unsettled_amount"))+": ",1)]),(0,n.Lk)("div",Js,[e.lineItems[e.header_index].hasOwnProperty("pending_amount")?((0,n.uX)(),(0,n.CE)("span",Ys,(0,s.v_)(e.lineItems[e.header_index].pending_amount),1)):(0,n.Q3)("",!0),""!==e.lineItems[e.header_index].error?((0,n.uX)(),(0,n.Wv)(g,{key:1,flat:"",dense:"",name:"error",size:"20px",color:"red",class:"q-ml-sm"},{default:(0,n.k6)((()=>[(0,n.bF)(p,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.header_index].error),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])])],64)):(0,n.Q3)("",!0)}const eo=(0,n.pM)({mixins:[],props:{},components:{SplitedLineItems:is,Dimensions:ls,Amount:us,Account:Tn,AddChildLineItem:ps,SplitLineItemBtn:ws,UnSplitLineItemBtn:As},mounted(){this.header_index=this.getTotalLineIndex()},methods:{updateAccount(e){this.is_view_readonly||null===this.header_index||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&(this.lineItems[this.header_index].account=e.value,this.lineItems[this.header_index].account_error="",this.updateAccountInStore(this.header_index,null,e.value))},updateAmount(e){this.is_view_readonly||null===this.header_index||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&(this.lineItems[this.header_index].amount=e.value)}},setup(){const e=(0,V.NF)(),{lineItems:t,getTotalLineIndex:i,is_view_readonly:n}=(0,S.bP)(e),{getDimensionsForAccount:s,validateLine:o,updateAccount:a}=e;return{updateAccountInStore:a,getDimensionsForAccount:s,is_view_readonly:n,getTotalLineIndex:i,lineItems:t,header_index:(0,P.KR)(null),validateLine:o}}}),to=(0,re.A)(eo,[["render",Zs]]),io=to;me()(eo,"components",{QIcon:de.A,QTooltip:ze.A});var no=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const so=(0,n.pM)({el:"#app",mixins:[q.A,E.A,X.A],components:{lineItem:Ss,TotalLineItem:io},watch:{},emits:["addLineItem"],mounted(){this.init()},unmounted:function(){},data(){return{}},methods:{init(){return no(this,void 0,void 0,(function*(){try{if(!(0,oe.jw)(this.accounting_error))return;yield this.getAccountsList()}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t),this.accounting_error=t}finally{this.resolveAccountLoadingPromise()}}))},addLineItem(){this.$emit("addLineItem")}},setup(){const e=(0,V.NF)(),{accounting_mode:t,lineItems:i,accounts_loaded:n,accounting_error:s}=(0,S.bP)(e),{getAccountsList:o}=e,a=(0,V.WN)(),{line_item_loaded:l}=(0,S.bP)(a),{resolveAccountLoadingPromise:r}=a;return{accounting_error:s,accounts_loaded:n,resolveAccountLoadingPromise:r,lineItems:i,accounting_mode:t,getAccountsList:o,line_item_loaded:l,fab1:(0,P.KR)(!1)}}});var oo=i(54782);const ao=(0,re.A)(so,[["render",Ti]]),lo=ao;me()(so,"components",{QFab:oo.A,QSeparator:It.A,QIcon:de.A,QTooltip:ze.A});const ro={class:"line-item-container ml-16 q-mr-sm"},co={class:"lineItems"},uo={class:"row items-center table-header"},mo={class:"",style:{width:"4%"}},ho={class:"header",style:{width:"8%"}},_o={class:"header",style:{width:"30%"}},po={class:"header",style:{width:"18%"}},go={class:"header",style:{width:"30%"}},vo=(0,n.Lk)("div",{class:"",style:{width:"15%"}},null,-1),yo=(0,n.Fv)('<div style="width:4%;height:34px;padding-top:10px;"><div class="box loading-shimmer" style="width:70%;"></div></div><div style="width:8%;height:34px;padding-top:10px;"><div class="box loading-shimmer" style="width:70%;"></div></div><div style="width:30%;height:34px;padding-top:10px;"><div class="box loading-shimmer" style="width:70%;"></div></div><div style="width:18%;height:34px;padding-top:10px;"><div class="box loading-shimmer" style="width:70%;"></div></div><div style="width:30%;height:34px;padding-top:10px;"><div class="box loading-shimmer" style="width:70%;"></div></div><div style="width:10%;height:34px;padding-top:10px;"><div class="box loading-shimmer" style="width:70%;"></div></div>',6),fo=[yo],bo={class:"row items-center q-mt-sm"},wo={style:{width:"3%"}},xo={class:"q-ma-sm bg-primary primary-bg-text",style:{width:"22px",display:"inline-block"}},ko=(0,n.Lk)("div",{style:{width:"97%"}},null,-1);function Io(e,t,i,o,a,l){const r=(0,n.g2)("q-fab"),d=(0,n.g2)("TotalLineItem"),c=(0,n.g2)("q-separator"),u=(0,n.g2)("lineItem"),m=(0,n.g2)("q-tooltip"),h=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)("div",ro,[(0,n.Lk)("div",co,[(0,n.Lk)("div",uo,[(0,n.Lk)("div",mo,[(0,n.bF)(r,{square:"",flat:"",modelValue:e.fab1,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fab1=t),icon:"keyboard_arrow_up",class:"multi-fab",direction:"down",padding:"xs","active-icon":"keyboard_arrow_down","label-class":"",style:{width:"40px"}},null,8,["modelValue"])]),(0,n.Lk)("div",ho,(0,s.v_)(e.$t("pages.line_items_columns.POSITION")),1),(0,n.Lk)("div",_o,(0,s.v_)(e.$t("accounts")),1),(0,n.Lk)("div",po,(0,s.v_)(e.$t("voucher_text")),1),(0,n.Lk)("div",go,(0,s.v_)(e.$t("amount_title")),1),vo]),e.accounts_loaded?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)(n.FK,{key:0},(0,n.pI)(4,(e=>(0,n.Lk)("div",{class:"row items-center total-line-item-area",key:e},fo))),64)),e.line_item_loaded?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.bF)(d),(0,n.bF)(c),"line_items"===e.accounting_mode?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.lineItems,((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:e},["line_item"===e.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(u,{index:t},null,8,["index"]),(0,n.bF)(c,{class:"q-mt-sm"})],64)):(0,n.Q3)("",!0)],64)))),128)),(0,n.Lk)("div",bo,[(0,n.Lk)("div",wo,[(0,n.Lk)("div",xo,[(0,n.bF)(h,{name:"add",size:"22px",onClick:t[1]||(t[1]=t=>e.addLineItem()),onKeydown:t[2]||(t[2]=(0,Je.jR)((t=>e.addLineItem()),["enter"])),tabindex:"1",class:(0,s.C4)(["cursor-pointer",e.is_view_readonly?"disabled":""])},{default:(0,n.k6)((()=>[(0,n.bF)(m,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.$t("add_new_line_item")),1)])),_:1})])),_:1},8,["class"])])]),ko])],64)):(0,n.Q3)("",!0)],64)):(0,n.Q3)("",!0)])])}const Lo=["id","data-id"],Ao=(0,n.Lk)("div",{class:"",style:{width:"4%"}},null,-1),Fo={class:"",style:{width:"8%"}},Co={key:0},So={class:"account-container",style:{width:"30%"}},qo={class:"dimensions",style:{"padding-right":"9px"}},Eo={style:{width:"18%"},class:"q-pr-sm"},Po={style:{width:"40%"}},Mo={class:"row"},Do={style:{width:"70%"}},Oo={style:{width:"29%"}},Qo={class:"q-ml-sm bg-primary primary-bg-text",style:{width:"22px",display:"inline-block"}},To={class:"splitted-line-items",style:{width:"100%"}},Vo={key:0,class:"row q-pt-sm"},$o=(0,n.Lk)("div",{style:{width:"12%"}},null,-1),Ko={style:{width:"37%"}},Xo={class:"float-right q-mr-md"},Ro={style:{width:"51%"}},Bo={key:0,style:{"margin-left":"12px"}};function No(e,t,i,o,a,l){const r=(0,n.g2)("Account"),d=(0,n.g2)("Dimensions"),c=(0,n.g2)("q-input"),u=(0,n.g2)("Amount"),m=(0,n.g2)("SplitLineItemBtn"),h=(0,n.g2)("UnSplitLineItemBtn"),_=(0,n.g2)("AddChildLineItem"),p=(0,n.g2)("SplitedLineItems"),g=(0,n.g2)("q-tooltip"),v=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",{class:"row q-mt-sm",id:e.lineItems[e.index].id,"data-id":e.lineItems[e.index].id},[Ao,(0,n.Lk)("div",Fo,[e.lineItems[e.index].hasOwnProperty("position")?((0,n.uX)(),(0,n.CE)("span",Co,(0,s.v_)(e.lineItems[e.index].position),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",So,[(0,n.bF)(r,{readonly:e.lineItems[e.index].readonly,onUpdateAccount:e.updateAccount,item:e.lineItems[e.index],index:e.index},null,8,["readonly","onUpdateAccount","item","index"]),(0,n.Lk)("div",qo,[(0,n.bF)(d,{index:e.index},null,8,["index"])])]),(0,n.Lk)("div",Eo,[(0,n.bF)(c,{class:"accouting-input column inline full-width",outlined:"",modelValue:e.lineItems[e.index].voucher_text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.lineItems[e.index].voucher_text=t),disable:e.lineItems[e.index].split_items.length>0||e.is_view_readonly},null,8,["modelValue","disable"])]),(0,n.Lk)("div",Po,[(0,n.Lk)("div",Mo,[(0,n.Lk)("div",Do,[(0,n.bF)(u,{index:e.index},null,8,["index"])]),(0,n.Lk)("div",Oo,[(0,n.bF)(m,{index:e.index},null,8,["index"]),(0,n.bF)(h,{index:e.index},null,8,["index"]),(0,n.Lk)("div",Qo,[(0,n.bF)(_,{index:e.index},null,8,["index"])])])])])],8,Lo),(0,n.Lk)("div",To,[(0,n.bF)(p,{index:e.index},null,8,["index"])]),e.lineItems[e.index].split_items.length>0?((0,n.uX)(),(0,n.CE)("div",Vo,[$o,(0,n.Lk)("div",Ko,[(0,n.Lk)("span",Xo,(0,s.v_)(e.$t("unsettled_amount"))+": ",1)]),(0,n.Lk)("div",Ro,[e.lineItems[e.index].hasOwnProperty("pending_amount")?((0,n.uX)(),(0,n.CE)("span",Bo,(0,s.v_)(e.lineItems[e.index].pending_amount),1)):(0,n.Q3)("",!0),""!==e.lineItems[e.index].error?((0,n.uX)(),(0,n.Wv)(v,{key:1,flat:"",dense:"",name:"error",size:"20px",color:"red",class:"q-ml-sm"},{default:(0,n.k6)((()=>[(0,n.bF)(g,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.index].error),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],64)}const Wo=["id","data-id"],Uo=(0,n.Lk)("div",{class:"",style:{width:"12%"}},null,-1),jo={class:"account-container",style:{width:"30%"}},zo={class:"dimensions",style:{"padding-right":"9px"}},Ho={style:{width:"18%"},class:"q-pr-sm"},Go={style:{width:"28%"}},Jo={style:{width:"12%"}},Yo=(0,n.Lk)("img",{width:"20",src:"images/trash-bin-default.svg"},null,-1);function Zo(e,t,i,o,a,l){const r=(0,n.g2)("Account"),d=(0,n.g2)("Dimensions"),c=(0,n.g2)("q-input"),u=(0,n.g2)("Amount"),m=(0,n.g2)("Percent"),h=(0,n.g2)("q-icon");return(0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.lineItems[e.index].split_items,((t,i)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"row q-pt-sm",id:t.id,"data-id":t.id},[Uo,(0,n.Lk)("div",jo,[(0,n.bF)(r,{readonly:t.readonly,onUpdateAccount:e.updateAccount,item:t,index:i},null,8,["readonly","onUpdateAccount","item","index"]),(0,n.Lk)("div",zo,[(0,n.bF)(d,{line_item_index:e.index,split_line_index:i},null,8,["line_item_index","split_line_index"])])]),(0,n.Lk)("div",Ho,[(0,n.bF)(c,{class:"accouting-input column inline full-width",outlined:"",modelValue:t.voucher_text,"onUpdate:modelValue":e=>t.voucher_text=e,disable:!!e.is_view_readonly},null,8,["modelValue","onUpdate:modelValue","disable"])]),(0,n.Lk)("div",Go,[(0,n.bF)(u,{line_item_index:e.index,split_line_index:i},null,8,["line_item_index","split_line_index"]),(0,n.bF)(m,{line_item_index:e.index,split_line_index:i},null,8,["line_item_index","split_line_index"])]),(0,n.Lk)("div",Jo,[(0,n.bF)(h,{class:(0,s.C4)(["q-ml-sm cursor-pointer accounting-icon",e.is_view_readonly?"disabled":""]),tabindex:"1",color:"grey",size:"md",onClick:t=>e.deleteLineItem(i,e.index),onKeydown:(0,Je.jR)((t=>e.deleteLineItem(i,e.index)),["enter"])},{default:(0,n.k6)((()=>[Yo])),_:2},1032,["onClick","onKeydown","class"])])],8,Wo)))),128)}const ea=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{Account:Tn,Amount:gn,Dimensions:Zn,Percent:wn},methods:{updateAccount(e){if(this.is_view_readonly)return;if(!e.hasOwnProperty("index")||!e.hasOwnProperty("value"))return;const t=e.index,i=e.value;this.updateAccountInStore(this.index,t,i)},validateAmountAndSetError(e,t){return t?!!(0,Pe.bA)(t)||(e.amount_error=this.$t("amount_invalid"),!1):(e.amount_error=this.$t("amount_is_empty"),!1)},deleteLineItem(e,t){if(!this.is_view_readonly){try{this.lineItems[t].split_items.splice(e,1)}catch(i){}this.calculateTotalByMode()}}},setup(){const e=(0,V.NF)(),{lineItems:t,is_view_readonly:i}=(0,S.bP)(e),{calculateTotalByMode:n,getDimensionsForAccount:s,validateLine:o,updateAccount:a}=e;return{updateAccountInStore:a,validateLine:o,calculateTotalByMode:n,is_view_readonly:i,lineItems:t,getDimensionsForAccount:s}}}),ta=(0,re.A)(ea,[["render",Zo]]),ia=ta;me()(ea,"components",{QInput:ei.A,QIcon:de.A});const na=(0,n.pM)({mixins:[],props:{index:{type:Number,required:!0}},components:{SplitedLineItems:ia,Dimensions:ls,Amount:us,Account:Tn,AddChildLineItem:ps,SplitLineItemBtn:ws,UnSplitLineItemBtn:As},methods:{updateAccount(e){this.is_view_readonly||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&this.updateAccountInStore(this.index,null,e.value)},updateAmount(e){this.is_view_readonly||null===this.index||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&(this.lineItems[this.index].amount=e.value)}},setup(){const e=(0,V.NF)(),{lineItems:t,is_view_readonly:i}=(0,S.bP)(e),{getDimensionsForAccount:n,validateLine:s,updateAccount:o}=e;return{updateAccountInStore:o,is_view_readonly:i,lineItems:t,getDimensionsForAccount:n,validateLine:s}}}),sa=(0,re.A)(na,[["render",No]]),oa=sa;me()(na,"components",{QInput:ei.A,QIcon:de.A,QTooltip:ze.A});const aa=["id","data-id"],la=(0,n.Lk)("div",{class:"",style:{width:"4%"}},null,-1),ra={class:"",style:{width:"8%"}},da={class:"account-container",style:{width:"30%"}},ca={class:"dimensions",style:{"padding-right":"9px"}},ua={style:{width:"18%"},class:"q-pr-sm"},ma={style:{width:"40%"}},ha={class:"row"},_a={style:{width:"70%"}},pa={style:{width:"29%"}},ga={class:"q-ml-sm bg-primary primary-bg-text",style:{width:"22px",display:"inline-block"}},va={class:"splitted-line-items total-line-item-area",style:{width:"100%"}},ya={class:"row total-line-item-area q-pb-sm q-pt-md"},fa=(0,n.Lk)("div",{style:{width:"12%"}},null,-1),ba={style:{width:"37%"}},wa={class:"float-right q-mr-md"},xa={style:{width:"51%"}},ka={key:0,style:{"margin-left":"12px"}},Ia={class:"row total-line-item-area q-pb-sm"},La=(0,n.Lk)("div",{style:{width:"12%"}},null,-1),Aa={style:{width:"37%"}},Fa={class:"float-right q-mr-md"},Ca={style:{width:"51%"}},Sa={key:0,style:{"margin-left":"12px"}};function qa(e,t,i,o,a,l){const r=(0,n.g2)("Account"),d=(0,n.g2)("Dimensions"),c=(0,n.g2)("q-input"),u=(0,n.g2)("Amount"),m=(0,n.g2)("SplitLineItemBtn"),h=(0,n.g2)("UnSplitLineItemBtn"),_=(0,n.g2)("AddChildLineItem"),p=(0,n.g2)("SplitedLineItems"),g=(0,n.g2)("q-tooltip"),v=(0,n.g2)("q-icon");return null!==e.header_index?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("div",{class:"row q-pt-sm total-line-item-area",id:e.lineItems[e.header_index].id,"data-id":e.lineItems[e.header_index].id},[la,(0,n.Lk)("div",ra,(0,s.v_)(e.$t("total")),1),(0,n.Lk)("div",da,[(0,n.bF)(r,{readonly:e.lineItems[e.header_index].readonly,onUpdateAccount:e.updateAccount,item:e.lineItems[e.header_index],index:e.header_index},null,8,["readonly","onUpdateAccount","item","index"]),(0,n.Lk)("div",ca,[(0,n.bF)(d,{index:e.header_index},null,8,["index"])])]),(0,n.Lk)("div",ua,[(0,n.bF)(c,{class:"accouting-input column inline full-width",outlined:"",modelValue:e.lineItems[e.header_index].voucher_text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.lineItems[e.header_index].voucher_text=t),disable:e.lineItems[e.header_index].split_items.length>0||e.is_view_readonly},null,8,["modelValue","disable"])]),(0,n.Lk)("div",ma,[(0,n.Lk)("div",ha,[(0,n.Lk)("div",_a,[(0,n.bF)(u,{index:e.header_index},null,8,["index"])]),(0,n.Lk)("div",pa,[(0,n.bF)(m,{index:e.header_index},null,8,["index"]),(0,n.bF)(h,{index:e.header_index},null,8,["index"]),(0,n.Lk)("div",ga,[(0,n.bF)(_,{index:e.header_index},null,8,["index"])])])])])],8,aa),(0,n.Lk)("div",va,[(0,n.bF)(p,{index:e.header_index},null,8,["index"])]),(0,n.Lk)("div",ya,[fa,(0,n.Lk)("div",ba,[(0,n.Lk)("span",wa,(0,s.v_)(e.$t("recorded_bookings"))+": ",1)]),(0,n.Lk)("div",xa,[e.lineItems[e.header_index].hasOwnProperty("lines_total_amount")?((0,n.uX)(),(0,n.CE)("span",ka,(0,s.v_)(e.lineItems[e.header_index].lines_total_amount),1)):(0,n.Q3)("",!0)])]),(0,n.Lk)("div",Ia,[La,(0,n.Lk)("div",Aa,[(0,n.Lk)("span",Fa,(0,s.v_)(e.$t("unsettled_amount"))+": ",1)]),(0,n.Lk)("div",Ca,[e.lineItems[e.header_index].hasOwnProperty("pending_amount")?((0,n.uX)(),(0,n.CE)("span",Sa,(0,s.v_)(e.lineItems[e.header_index].pending_amount),1)):(0,n.Q3)("",!0),""!==e.lineItems[e.header_index].error?((0,n.uX)(),(0,n.Wv)(v,{key:1,flat:"",dense:"",name:"error",size:"20px",color:"red",class:"q-ml-sm"},{default:(0,n.k6)((()=>[(0,n.bF)(g,{class:"bg-red",anchor:"bottom right",self:"top right"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.lineItems[e.header_index].error),1)])),_:1})])),_:1})):(0,n.Q3)("",!0)])])],64)):(0,n.Q3)("",!0)}const Ea=(0,n.pM)({mixins:[],props:{},components:{SplitedLineItems:ia,Dimensions:ls,Amount:us,Account:Tn,AddChildLineItem:ps,SplitLineItemBtn:ws,UnSplitLineItemBtn:As},mounted(){this.header_index=this.getTotalLineIndex()},methods:{updateAccount(e){this.is_view_readonly||null===this.header_index||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&(this.lineItems[this.header_index].account=e.value,this.lineItems[this.header_index].account_error="",this.updateAccountInStore(this.header_index,null,e.value))},updateAmount(e){this.is_view_readonly||null===this.header_index||e.hasOwnProperty("index")&&e.hasOwnProperty("value")&&(this.lineItems[this.header_index].amount=e.value)}},setup(){const e=(0,V.NF)(),{lineItems:t,getTotalLineIndex:i,is_view_readonly:n}=(0,S.bP)(e),{getDimensionsForAccount:s,validateLine:o,updateAccount:a}=e;return{updateAccountInStore:a,getDimensionsForAccount:s,is_view_readonly:n,getTotalLineIndex:i,lineItems:t,header_index:(0,P.KR)(null),validateLine:o}}}),Pa=(0,re.A)(Ea,[["render",qa]]),Ma=Pa;me()(Ea,"components",{QInput:ei.A,QIcon:de.A,QTooltip:ze.A});var Da=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const Oa=(0,n.pM)({el:"#app",mixins:[q.A,E.A,X.A],components:{lineItem:oa,TotalLineItem:Ma},watch:{},emits:["addLineItem"],mounted(){this.init()},unmounted:function(){},data(){return{}},methods:{init(){return Da(this,void 0,void 0,(function*(){try{if(!(0,oe.jw)(this.accounting_error))return;window.m3=this,yield this.populateAccunts()}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t),this.accounting_error=t}finally{this.resolveAccountLoadingPromise()}}))},populateAccunts(){return Da(this,void 0,void 0,(function*(){this.hasPoMatchData()?yield this.getPOM3AccountsList():yield this.getAccountsList()}))},getPOM3AccountsList(){return Da(this,void 0,void 0,(function*(){try{this.accounts_loaded=!1,this.accounts=[];const e=yield this.getM3POAccountsFromServer();if(0===e.length)throw{message:"No accounts found"};for(const[t,i]of e.entries()){if(!i.id)continue;const e=i.id+(i.description?" - "+i.description:"");this.accounts.push({value:i.id,id:i.id,flexdimensions:[],label:e})}this.accounts_loaded=!0}catch(e){throw e}}))},getAccountsList(){return Da(this,void 0,void 0,(function*(){try{this.accounts_loaded=!1,this.accounts=[];const e=yield this.getM3AccountsFromServer();if(0===e.length)throw{message:"No accounts found"};yield this.fetchDimensionRules();for(const[t,i]of e.entries()){if(!i.id)continue;const e=this.getDimensions(i),t=i.id+(i.description?" - "+i.description:"");this.accounts.push({value:i.id,id:i.id,flexdimensions:e,label:t})}this.generateDimensionDropdowns(),yield this.fetchDimensionDropdowns(),this.accounts_loaded=!0}catch(e){throw e}}))},getDimensions(e){const t=["dimension1","dimensionprofile"];this.dimensions=[];const i=[];for(const[n,s]of Object.entries(e))if(!t.includes(n)&&n.startsWith("dimension")){const t=n.split("dimension")[1];let o="o";const a="usage"+t;e.hasOwnProperty(a)&&"mandatory"===String(e[a]).toLowerCase()&&(o="m"),this.dimensions.push({rule:o,id:t,name:s,value:"",error:""}),i.push({rule:o,id:t,name:s,value:"",error:""})}return this.dimensions.sort(((e,t)=>e.id-t.id)),i.sort(((e,t)=>e.id-t.id)),i},fetchDimensionRules(){return Da(this,void 0,void 0,(function*(){try{const e=yield this.getM3DimensionRulesFromServer();this.dimension_rules={};for(const[t,i]of e.entries()){const e={};Object.keys(i).forEach((t=>{let n=t.trim().toLowerCase().replace(/\s+/g,"_");e[n]=i[t]}));const t=e["accounting_identity"],n=e["accounting_dimension"],s=e["to_accounting_identity"],o=e["from_accounting_identity"];t&&e["accounting_dimension"]&&(this.dimension_rules.hasOwnProperty(t)||(this.dimension_rules[t]={}),this.dimension_rules[t].hasOwnProperty(n)||(this.dimension_rules[t][n]=[]),this.dimension_rules[t][n].push({end:s,start:o}))}}catch(e){throw e}}))},generateDimensionDropdowns(){try{for(let[e,t]of Object.entries(this.dimension_rules)){const i=t;for(let[t,n]of Object.entries(i)){const i=this.generateCombinationByRanges(n);0!==i.length&&(this.dimension_dropdowns.hasOwnProperty(e)||(this.dimension_dropdowns[e]={}),this.dimension_dropdowns[e][t]=i)}}}catch(e){throw e}},fetchDimensionDropdowns(){return Da(this,void 0,void 0,(function*(){try{const e={},t=yield this.getM3DimensionsFromServer();if(0===t.length)return;Array.from(t).forEach(((t,i)=>{const n=t.dimension;if(!n||!t.description)return;e.hasOwnProperty(n)||(e[n]=[]);let s="";!t.hasOwnProperty("codevalue")||(0,oe.z)(t.codevalue)||(0,oe.jw)(t.codevalue)||(s+=t.codevalue+" - "),s+=t.description,e[n].push({value:t.id,label:s})}));let i={};for(const n in e){const t=e[n].sort(((e,t)=>e.label.localeCompare(t.label)));i[String(n)]=[...t]}this.dimension_general_dropdowns=i}catch(e){throw e}}))},getRangeKey(e){return e.start.toUpperCase().replace(/\s+/g,"_")+"_"+e.end.toUpperCase().replace(/\s+/g,"_")},generateCombinationByRanges(e){let t=[];try{for(const i of e){const e=this.getRangeKey(i);if(this.combination_by_range.hasOwnProperty(e)||(this.combination_by_range[e]=this.generateCombinations(i)),t.push(...this.combination_by_range[e]),t.length>this.max_combinations)throw new Error("Combination over load")}}catch(i){t=[]}return t},generateCombinations(e){let t=[];try{const i=e.start,n=e.end;if(i.length!==n.length)throw new Error("Combination over load");const s=[];for(let e=0;e<i.length;e++)if(i[e]===n[e])s.push([i[e]]);else{const t=i.charCodeAt(e),o=n.charCodeAt(e),a=[];if(t>o){for(let e=t;e<="Z".charCodeAt(0);e++)a.push(String.fromCharCode(e));for(let e="A".charCodeAt(0);e<=o;e++)a.push(String.fromCharCode(e))}else for(let e=t;e<=o;e++)a.push(String.fromCharCode(e));s.push(a)}return this.combine("",s,0,t),t}catch(i){throw new Error("Combination over load")}},combine(e,t,i,n){if(n.length>this.max_combinations)throw new Error("Combination over load");if(i!==t.length)for(let s of t[i])this.combine(e+s,t,i+1,n);else n.push({value:e,label:e})},addLineItem(){this.$emit("addLineItem")}},setup(){const e=(0,V.NF)(),{accounting_mode:t,lineItems:i,accounts:n,accounts_loaded:s,dimensions:o,dimension_dropdowns:a,accounting_error:l,dimension_rules:r,dimension_general_dropdowns:d}=(0,S.bP)(e),c=(0,V.WN)(),{line_item_loaded:u}=(0,S.bP)(c),{getM3AccountsFromServer:m,getM3DimensionsFromServer:h,resolveAccountLoadingPromise:_,getM3POAccountsFromServer:p,getM3DimensionRulesFromServer:g}=c,v=(0,V.R9)(),{hasPoMatchData:y}=v;return{getM3DimensionRulesFromServer:g,getM3POAccountsFromServer:p,hasPoMatchData:y,resolveAccountLoadingPromise:_,getM3DimensionsFromServer:h,getM3AccountsFromServer:m,dimension_general_dropdowns:d,dimension_rules:r,dimension_dropdowns:a,dimensions:o,accounts_loaded:s,accounting_error:l,lineItems:i,accounting_mode:t,line_item_loaded:u,accounts:n,fab1:(0,P.KR)(!1),combination_by_range:(0,P.KR)({}),max_combinations:20}}}),Qa=(0,re.A)(Oa,[["render",Io]]),Ta=Qa;me()(Oa,"components",{QFab:oo.A,QSeparator:It.A,QIcon:de.A,QTooltip:ze.A});var Va=i(41903),$a=i(43437),Ka=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{r(n.next(e))}catch(t){o(t)}}function l(e){try{r(n["throw"](e))}catch(t){o(t)}}function r(e){e.done?i(e.value):s(e.value).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const Xa=(0,n.pM)({el:"#app",mixins:[q.A,E.A,X.A],components:{MessageBanner:M.A,ImageComponent:D["default"],ErrorDocumentView:O.A,Loader:K.A,SetupValidation:qe,ExpertMode:Ii,ProceedBtn:Be,PredictionBtn:qt,LN_VIEW:lo,M3_VIEW:Ta,SaveBtn:Ge,SubHeader:Ne.A},watch:{accounting_error:{handler:function(e,t){this.is_view_readonly=""!==e}},processing:{handler:function(e,t){1==e?this.showLoading():this.hideLoading()}},data_loaded:{handler:function(e,t){1==e?this.hideLoading():this.showLoading()}},has_fetch_error:{handler:function(e,t){1==e?this.hideLoading():this.showLoading()}}},mounted(){this.init(),window.addEventListener("storage",this.storageChangeEvent)},unmounted:function(){window.removeEventListener("storage",this.storageChangeEvent)},data(){return{auto_accounting_types_setting:T.hv,line_item_columns:["POSITION","DESCRIPTION","ITEM_NUMBER"]}},beforeRouteLeave:function(e,t,i){this.resetDocStore(e.fullPath),this.resetAccountingStore(),this.resetAccountingTypeStore();const n=(0,V.R9)();n.$reset(),"function"===typeof this.missing_supplier_warning&&this.missing_supplier_warning(),i()},methods:{init(){return Ka(this,void 0,void 0,(function*(){try{if(this.accounting_error="",window.acc=this,this.connect(),this.processing=!0,this.docId=this.$route.params.id,this.doc_url=window.location.href,Va.A.remove("doc_info"),this.line_item_loaded=!1,yield this.getDocumentById(this.docId),!this.record||0===Object.keys(this.record).length||!1===this.record.success)return;yield this.startSettingsFetch(),this.verifyUserSettings(),this.setAccountingModeOptions(),this.handleReadOnlyView(),this.setAccountingVariables(),this.view_template=yield this.loadTemplateSettings(),yield this.startAccountAsyncOperation(),yield this.prepareDataForView(),this.handleMode(),this.data_loaded=!0}catch(e){const t=Q.t.getErrorMessage(e);this.showErrorToast(t),this.accounting_error=t}finally{this.processing=!1}}))},verifyUserSettings(){this.setup_error=!1;const e=this.verifyModuleSettings();if(e.length>0)throw this.setup_error=!0,new Error(this.$t("missing_auto_accounting_settings"))},storageChangeEvent(e){this.handleSessionStorageChange(e)},handleSessionStorageChange(e){return Ka(this,void 0,void 0,(function*(){try{this.handleStorageEvent(e);const t=yield this.loadTemplateSettings();t!==this.view_template&&(this.processing=!0,this.view_template=t,yield this.prepareDataForView())}catch(t){}finally{this.processing=!1}}))},handleReadOnlyView(){this.is_view_readonly=!1,T.B2.includes(this.record.status)&&(this.is_view_readonly=!0)},loadTemplateSettings(){return Ka(this,void 0,void 0,(function*(){const e=yield this.getSettingWithExpiry(this.auto_accounting_types_setting,"ln");let t=this.view_types.ln;return"m3"===e&&(t=this.view_types.m3),t}))},prepareDataForView(){return Ka(this,void 0,void 0,(function*(){this.line_item_loaded=!1,this.setLineItemsObj(),this.hasPoMatchData()&&(this.setPoTotalLineItem(),yield this.calculateMatchedTotal()),this.record.hasOwnProperty("accounting")&&this.loadSavedData(),this.line_item_loaded||this.prepareLineItems(),this.doAccountPredictions(),this.line_item_loaded=!0}))},prepareLineItems(){try{if(this.lineItems=[],this.hasPendingPoMatch())return this.setPendingPoTotalLineItem(),void(this.is_multi_match?this.disable_mode=!0:this.setPoMatchedLineItems());this.setTotallineItem(),this.setlineItems()}catch(e){}},doAccountPredictions(){return Ka(this,void 0,void 0,(function*(){try{if(!this.supplier_name)return;const e=this.getLineItemsForPredictionAccount();if(0===e.length)return;const t={line_items:JSON.stringify(e),source_locale:this.amount_format_locale,doc_id:this.docId};yield this.getPredictions(t)}catch(e){}}))},setPoMatchedLineItems(){return Ka(this,void 0,void 0,(function*(){try{if(!this.hasPoMatchData()||0===this.record.po_items.length||this.is_multi_match)return;this.buildPoLinesObj(this.record.po_items);const e=yield this.getMatchedLines();if(0===e.length)return;for(const[t,i]of e.entries()){const e=this.baseLineItem();e.id=i.table_line_id,e.amount=i.amount,e.amount_standard=i.amount_standard;const t=this.lineDataObj[i.table_line_id];for(const i of this.line_item_columns)t.columns.hasOwnProperty(i)&&(e[i.toLowerCase()]=t.columns[i].formatted_value);this.lineItems.push(e)}}catch(e){}}))},setPendingPoTotalLineItem(){const e=this.getbaseTotalLineItem();e.amount=this.pending_amount,e.amount_standard=this.pending_amount_standard,this.lineItems.push(e)},hasPendingPoMatch(){try{let e=parseFloat(this.pending_amount.replace(/[^0-9]/g,""));return!!(this.pending_amount&&""!=this.pending_amount&&e>0)}catch(e){return!0}},loadSavedData(){const e=this.record.accounting.line_items;if(this.accounting_mode=this.record.accounting.mode,this.line_item_loaded=!1,this.hasPendingPoMatch()&&this.is_multi_match&&(this.accounting_mode="total_line",this.disable_mode=!0),!Array.isArray(e)||0===e.length)return!1;const t=["line_item","total_line_item"];for(const[i,n]of e.entries()){let e=this.baseLineItem();"total_line_item"===n.type&&(e=this.getbaseTotalLineItem()),t.includes(n.type)&&(this.line_item_loaded=!0);const i=Object.assign(e,n);if(n.split_items.length>0)for(const[t,n]of i.split_items.entries()){let e=this.baseSplitLineItem();const s=Object.assign(e,n);i.split_items[t]=s}this.lineItems.push(e)}},hasLineItems(){return!(!this.record.tables||0==this.record.tables.length||!this.record.tables[0].hasOwnProperty("rows")||0==this.record.tables[0].rows.length)},setlineItems(){this.hasLineItems()&&Array.from(this.record.tables[0].rows).forEach(((e,t)=>{if(!0===e.is_deleted||!e.id)return;const i=this.baseLineItem();i.id=e.id;const n=new Map;n.set("NET_AMOUNT",""),n.set("TOTAL_AMOUNT","");const s={};Array.from(e.columns).forEach(((e,t)=>{this.line_item_columns.includes(e.name)&&(i[e.name.toLowerCase()]=e.formatted_value),n.has(e.name)&&(n.set(e.name,e.formatted_value),s[e.name]=e.value)}));for(const[o,a]of n.entries())if(""!==a){i.amount=a,i.amount_standard=s[o];break}this.lineItems.push(i)}))},setLineItemsObj(){if(!this.hasLineItems())return;let e={};Array.from(this.record.tables[0].rows).forEach(((t,i)=>{!0!==t.is_deleted&&t.id&&(e[t.id]=JSON.parse(JSON.stringify(t)),e[t.id]["columns"]=[],Array.from(t.columns).forEach(((i,n)=>{e[t.id].columns[i.name]=JSON.parse(JSON.stringify(i))})))})),Object.assign(this.lineDataObj,e)},setTotallineItem(){const e=this.getbaseTotalLineItem();this.record.fields&&Array.isArray(this.record.fields)&&this.record.fields.length>0&&this.record.fields.forEach(((t,i)=>{"total_net_amount"===t.name&&(e.amount=t.formatted_value,e.amount_standard=t.value)})),this.lineItems.push(e)},addLineItem(){if(this.is_view_readonly)return;const e=this.baseLineItem();e.id=(0,C.A)(),this.lineItems.push(e)},setAccountingVariables(){this.amount_format_locale=this.doc_amount_format_locale,this.setSupplier()},setSupplier(){this.supplier_name=this.supplier,this.supplier_name||(this.missing_supplier_warning=this.showWarningAlert(this.$t("missing_supplier_warning")))},emptyLineItems(){0===this.lineItems.length&&(this.empty_line_item=!0)},copyURL(){this.doc_url.trim().length>0&&(0,$.A)(this.doc_url).then((()=>{this.showSuccessToast(this.$t("link_copied_to_clipboard"))}))},closeDialog(e){this.empty_line_item=!1},addDummyData(){this.supplier_name="Fellow Consulting AG"},handleMode(){let e="total_line_item";"total_line"===this.accounting_mode&&(e="line_item"),this.disableLineItems(e),this.calculateTotalByMode()},disableLineItems(e="line_item"){Array.from(this.lineItems).forEach(((t,i)=>{t.error="",t.type===e?(t.readonly=!0,t.split_items=[],t.dimensions=[]):t.readonly=!1}))},setAccountingModeOptions(){this.accounting_mode_options=[{label:this.$t("split_by_total"),value:"total_line"},{label:this.$t("line_items"),value:"line_items"}]},toggleMenu(){this.is_view_readonly||(this.expert_mode=!this.expert_mode)},routeToBack(){try{if(history.state.back)return void this.$router.back();this.$router.push("/field_validation_v1/"+this.docId)}catch(e){this.$router.push("/field_validation_v1/"+this.docId)}}},setup(){const e=(0,V.q3)(),{record:t,error:i,doc_loaded:n,processing:s,auto_saving:o,auto_saved_done:a,amount_format_locale:l,supplier:r}=(0,S.bP)(e),{getDocumentById:d,saveDocument:c,resetDocStore:u}=e,m=(0,V.NF)(),{resetAccountingStore:h,calculateTotalByMode:_,getTotalLineIndex:p,checkTotalForEachLineItem:g,baseSplitLineItem:v,getPredictions:y,getLineItemsForPredictionAccount:f,getAccountsList:b}=m,{lineItems:w,amount_format_locale:x,is_view_readonly:k,accounting_mode:I,dimensions:L,accounts:A,dimension_dropdowns:F,supplier_name:C,categorized_accounts:q,expert_mode:E,accounting_error:M}=(0,S.bP)(m),D=(0,V.R9)(),{calculateMatchedTotal:O,setTotallineItem:Q,hasPoMatchData:T,buildPoLinesObj:$,getMatchedLines:K}=D,{total_net_amount:X,pending_amount:R,matched_total_amount:B,pending_amount_standard:N,lineDataObj:W,is_multi_match:U,PODataObj:j}=(0,S.bP)(D),z=(0,V.G6)(),{connect:H}=z,G=(0,V.Bu)(),{startSettingsFetch:J,getSettingWithExpiry:Y,handleStorageEvent:Z}=G,{user_settings:ee}=(0,S.bP)(G),te=(0,V.WN)(),{view_template:ie,view_types:ne,line_item_loaded:se}=(0,S.bP)(te),{baseLineItem:oe,getbaseTotalLineItem:ae,startAccountAsyncOperation:le,resetAccountingTypeStore:re,verifyModuleSettings:de}=te;return{verifyModuleSettings:de,user_settings:ee,startSettingsFetch:J,getMatchedLines:K,PODataObj:j,is_multi_match:U,buildPoLinesObj:$,lineDataObj:W,accounting_error:M,resetAccountingTypeStore:re,startAccountAsyncOperation:le,pending_amount_standard:N,getAccountsList:b,line_item_loaded:se,handleStorageEvent:Z,getbaseTotalLineItem:ae,baseLineItem:oe,getSettingWithExpiry:Y,view_template:ie,view_types:ne,supplier:r,categorized_accounts:q,getLineItemsForPredictionAccount:f,getPredictions:y,doc_amount_format_locale:l,baseSplitLineItem:v,hasPoMatchData:T,total_net_amount:X,pending_amount:R,matched_total_amount:B,calculateMatchedTotal:O,setPoTotalLineItem:Q,connect:H,dimensions:L,accounts:A,dimension_dropdowns:F,checkTotalForEachLineItem:g,getTotalLineIndex:p,accounting_mode:I,calculateTotalByMode:_,doc_loaded:n,is_view_readonly:k,resetAccountingStore:h,resetDocStore:u,amount_format_locale:x,saveDocument:c,lineItems:w,auto_saving:o,auto_saved_done:a,has_fetch_error:i,error_message:(0,P.KR)(""),getDocumentById:d,record:t,processing:s,docId:(0,P.KR)(""),splitterModel:(0,P.KR)(70),messageCategoryClass:(0,P.KR)("error-banner"),empty_line_item:(0,P.KR)(!1),doc_url:(0,P.KR)(""),data_loaded:(0,P.KR)(!1),accounting_mode_options:(0,P.KR)([]),show_setup_validation:(0,P.KR)(!1),disable_mode:(0,P.KR)(!1),supplier_name:C,expert_mode:E,missing_supplier_warning:{},setup_error_message:(0,P.KR)(""),setup_error:(0,P.KR)(!1),mdiShare:$a.YuT}}});var Ra=i(98072),Ba=i(28975),Na=i(23954),Wa=i(67156);const Ua=(0,re.A)(Xa,[["render",F],["__scopeId","data-v-193e74ae"]]),ja=Ua;me()(Xa,"components",{QBtn:Ke.A,QIcon:de.A,QSplitter:Ra.A,QBtnToggle:Ba.A,QBadge:Na.A,QTooltip:ze.A,QDialog:Xe.A,QCard:vt.A,QToolbar:yt.A,QToolbarTitle:ft.A,QCardSection:bt.A,QInput:ei.A,QFab:oo.A,QField:Wa.A}),me()(Xa,"directives",{ClosePopup:xi.A})}}]);