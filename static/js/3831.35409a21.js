"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[3831],{23831:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ia});var i=a(61758),l=a(58790);const o={class:"container"},s={class:"container"};function n(e,t,a,n,d,r){const c=(0,i.g2)("SubHeader"),u=(0,i.g2)("BackToSettings"),_=(0,i.g2)("q-separator"),f=(0,i.g2)("q-icon"),p=(0,i.g2)("q-avatar"),m=(0,i.g2)("q-item-section"),h=(0,i.g2)("FieldMasterData"),g=(0,i.g2)("q-card-section"),b=(0,i.g2)("q-card"),k=(0,i.g2)("q-expansion-item"),v=(0,i.g2)("LovMasterData"),F=(0,i.g2)("q-list");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(c,{name:"field_master_data",onSearch:!1,label:e.$t("pages.master_data_fields.master_data_fields")},null,8,["label"]),(0,i.bF)(u,{back_to_rotue:"/settings/fields/"+String(e.$route.params.type)},null,8,["back_to_rotue"]),(0,i.bF)(g,{class:"items-center"},{default:(0,i.k6)((()=>[(0,i.bF)(F,{bordered:"",class:"rounded-borders full-width"},{default:(0,i.k6)((()=>[(0,i.bF)(k,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,i.k6)((()=>[(0,i.bF)(m,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(f,{size:"25px",class:"black_to_white",name:"img:settings/doc.svg"})])),_:1})])),_:1}),(0,i.bF)(m,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("lookup_master_data")),1)])),_:1})])),default:(0,i.k6)((()=>[(0,i.bF)(_),(0,i.bF)(b,{class:"page-background"},{default:(0,i.k6)((()=>[(0,i.bF)(g,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",o,[(0,i.bF)(h)])])),_:1})])),_:1})])),_:1}),(0,i.bF)(k,{"expand-separator":"","header-class":"highlighted-back"},{header:(0,i.k6)((()=>[(0,i.bF)(m,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(f,{size:"25px",class:"black_to_white",name:"img:settings/doc.svg"})])),_:1})])),_:1}),(0,i.bF)(m,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("lov_master_data")),1)])),_:1})])),default:(0,i.k6)((()=>[(0,i.bF)(_),(0,i.bF)(b,{class:"page-background"},{default:(0,i.k6)((()=>[(0,i.bF)(g,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",s,[(0,i.bF)(v)])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})],64)}var d=a(95488),r=a(60894),c=a(29104);const u={class:"row"},_={class:"col-sm-12 col-md-12 col-lg-12 q-pb-md"},f={class:"col-sm-12 col-md-12 col-lg-12"},p={style:{"margin-top":"3px","text-transform":"capitalize"}},m={class:"text-red-14"},h={class:"full-width"},g={class:"table-header-text"},b={class:"text-left",style:{width:"25%"}},k={class:"text-left",style:{width:"25%"}},v={class:"text-left"},F={class:"text-center",style:{width:"5%"}},y={class:"text-left",style:{width:"2%"}},C={key:0},L={class:"text-left"},w={class:"text-capitalize q-pr-sm"},x={class:"text-left"},A={class:"text-capitalize"},q={class:"text-left"},D={class:"text-capitalize"},$={class:"text-center"},T={class:"text-capitalize"},S={class:"text-left"},V={class:"text-red-14"},E={class:"text-h6"},Q={class:"text-h6"};function R(e,t,a,o,s,n){const d=(0,i.g2)("f-btn"),r=(0,i.g2)("q-badge"),R=(0,i.g2)("q-space"),U=(0,i.g2)("q-item-section"),I=(0,i.g2)("q-item"),N=(0,i.g2)("q-separator"),K=(0,i.g2)("q-list"),W=(0,i.g2)("q-menu"),O=(0,i.g2)("q-btn"),M=(0,i.g2)("q-card-actions"),X=(0,i.g2)("q-icon"),P=(0,i.g2)("q-markup-table"),z=(0,i.g2)("q-card-section"),J=(0,i.g2)("q-card"),B=(0,i.g2)("q-expansion-item"),j=(0,i.g2)("CreateLovForm"),Y=(0,i.g2)("q-dialog"),H=(0,i.g2)("LovFieldPopUp"),G=(0,i.g2)("q-toolbar-title"),Z=(0,i.g2)("q-toolbar"),ee=(0,i.g2)("q-input"),te=(0,i.g2)("Loader"),ae=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",u,[(0,i.Lk)("div",_,[(0,i.bF)(d,{label:e.$t("create_lov_lookup_config"),icon:"add",onClick:e.createConfig,class:"float-right"},null,8,["label","onClick"])]),(0,i.Lk)("div",f,[(0,i.bF)(K,{bordered:""},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.lov_configurations,((a,o)=>((0,i.uX)(),(0,i.Wv)(B,{key:a.id,"expand-separator":"","header-class":"highlighted-back ",onClick:t=>e.getFields(a)},{header:(0,i.k6)((()=>[(0,i.Lk)("span",p,[(0,i.eW)((0,l.v_)(a.lookup_name.replaceAll("_"," "))+" ",1),a.org_id===e.DEFAULT?((0,i.uX)(),(0,i.Wv)(r,{key:0,transparent:"",align:"middle",color:"orange"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("default")),1)])),_:1})):(0,i.Q3)("",!0)]),(0,i.bF)(R),(0,i.bF)(O,{flat:"",dense:"",round:"",onClick:t[0]||(t[0]=(0,c.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,i.k6)((()=>[(0,i.bF)(W,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,i.k6)((()=>[(0,i.bF)(K,{dense:"",style:{"min-width":"100px"}},{default:(0,i.k6)((()=>[(0,i.bF)(I,{clickable:"",onClick:t=>e.toggleActivationStatus(a)},{default:(0,i.k6)((()=>[(0,i.bF)(U,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(a.is_active?e.$t("deactivate"):e.$t("activate")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i.bF)(N),(0,i.bF)(I,{clickable:"",onClick:t=>e.prepareDataToDuplicate(a)},{default:(0,i.k6)((()=>[(0,i.bF)(U,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("duplicate")),1)])),_:1})])),_:2},1032,["onClick"]),(0,i.bF)(N),(0,i.bF)(I,{clickable:"",onClick:t=>e.editConfig(a)},{default:(0,i.k6)((()=>[(0,i.bF)(U,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(a.org_id==e.DEFAULT?e.$t("view"):e.$t("edit")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i.bF)(N),a.org_id!=e.DEFAULT?((0,i.uX)(),(0,i.Wv)(I,{key:0,clickable:""},{default:(0,i.k6)((()=>[(0,i.bF)(U,{onClick:t=>e.deletedConfigConfirmDialog(a.id,o)},{default:(0,i.k6)((()=>[(0,i.Lk)("span",m,(0,l.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,i.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),default:(0,i.k6)((()=>[(0,i.bF)(J,null,{default:(0,i.k6)((()=>[(0,i.bF)(M,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{icon:"add",label:e.$t("create"),onClick:t=>e.createField(a),class:"q-mr-sm"},null,8,["label","onClick"])])),_:2},1024),(0,i.bF)(z,{style:"height: auto; min-height: 3vh;"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",h,[(0,i.bF)(P,{dense:"",flat:"",class:"dashboard-table-style back-white dashboard-table-header-sticky"},{default:(0,i.k6)((()=>[(0,i.Lk)("thead",null,[(0,i.Lk)("tr",g,[(0,i.Lk)("th",b,(0,l.v_)(e.$t("pages.master_data_fields.lookup_field")),1),(0,i.Lk)("th",k,(0,l.v_)(e.$t("filter_field")),1),(0,i.Lk)("th",v,(0,l.v_)(e.$t("filter_value")),1),(0,i.Lk)("th",F,(0,l.v_)(e.$t("required")),1),(0,i.Lk)("th",y,(0,l.v_)(e.$t("actions")),1)])]),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.lookup_fields[a.id],((o,s)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:o.id},[o&&Object.keys(o).length>0?((0,i.uX)(),(0,i.CE)("tr",C,[(0,i.Lk)("td",L,[(0,i.Lk)("span",w,(0,l.v_)(e.convertLabel(o.lookup_field)),1),o.org_id===e.DEFAULT?((0,i.uX)(),(0,i.Wv)(r,{key:0,transparent:"",align:"middle",color:"orange"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("default")),1)])),_:1})):(0,i.Q3)("",!0)]),(0,i.Lk)("td",x,[(0,i.Lk)("span",A,(0,l.v_)(o.matching_field?o.matching_field.label:o.filter_field_id),1)]),(0,i.Lk)("td",q,[(0,i.Lk)("span",D,(0,l.v_)(o.filter_value),1)]),(0,i.Lk)("td",$,[(0,i.Lk)("span",T,[(0,i.bF)(X,{size:"sm",name:o.is_required?"check_circle":"cancel",color:o.is_required?"green":"red"},null,8,["name","color"])])]),(0,i.Lk)("td",S,[(0,i.bF)(O,{flat:"",dense:"",round:"",onClick:t[1]||(t[1]=(0,c.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,i.k6)((()=>[(0,i.bF)(W,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,i.k6)((()=>[(0,i.bF)(K,{dense:"",style:{"min-width":"100px"}},{default:(0,i.k6)((()=>[(0,i.bF)(I,{clickable:"",onClick:t=>e.editData(a,o)},{default:(0,i.k6)((()=>[(0,i.bF)(U,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(o.org_id==e.DEFAULT?e.$t("view"):e.$t("edit")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i.bF)(N,{inset:""}),o.org_id!=e.DEFAULT?((0,i.uX)(),(0,i.Wv)(I,{key:0,clickable:""},{default:(0,i.k6)((()=>[(0,i.bF)(U,{onClick:t=>e.deletedConfirmDialog(a.id,o.id,s)},{default:(0,i.k6)((()=>[(0,i.Lk)("span",V,(0,l.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,i.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])):(0,i.Q3)("",!0)],64)))),128))])])),_:2},1024)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])]),(0,i.bF)(Y,{modelValue:e.show_lov_configuration_popup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.show_lov_configuration_popup=t)},{default:(0,i.k6)((()=>[(0,i.bF)(j,{mode:e.current_mode,configuration_id:e.current_config_id,configuration:e.current_record,tables_list:e.tables_list,onUpdateLovList:e.updateLovList},null,8,["mode","configuration_id","configuration","tables_list","onUpdateLovList"])])),_:1},8,["modelValue"]),(0,i.bF)(Y,{modelValue:e.show_lov_master_data_popup,"onUpdate:modelValue":t[3]||(t[3]=t=>e.show_lov_master_data_popup=t)},{default:(0,i.k6)((()=>[(0,i.bF)(H,{configuration_id:e.current_config_id,mode:e.current_mode,field_id:e.current_field_id,fieldConfig:e.fieldConfig,lookup_dataset_name:e.current_record.lookup_dataset_name,tableColumnList:e.tableColumns,isTable:e.current_record&&"line"==e.current_record.context,onUpdateLovFieldList:e.updateLovFieldList},null,8,["configuration_id","mode","field_id","fieldConfig","lookup_dataset_name","tableColumnList","isTable","onUpdateLovFieldList"])])),_:1},8,["modelValue"]),(0,i.bF)(Y,{modelValue:e.deleteConfirm,"onUpdate:modelValue":t[5]||(t[5]=t=>e.deleteConfirm=t)},{default:(0,i.k6)((()=>[(0,i.bF)(J,{class:"dialog_style"},{default:(0,i.k6)((()=>[(0,i.bF)(z,{class:"flex justify-center items-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",E,[(0,i.bF)(X,{name:"warning",size:"2em",class:"bg-primary icon_circle"})])])),_:1}),(0,i.bF)(z,{class:"q-pt-none q-mt-sm text-md text-center text-bold text_style"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("record_confirmation")),1)])),_:1}),(0,i.bF)(M,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(O,{label:e.$t("cancel"),color:"grey-6"},null,8,["label"]),[[ae]]),(0,i.bF)(O,{label:e.$t("delete"),color:"red",onClick:t[4]||(t[4]=t=>e.deleteField(e.activeItem.config_id,e.activeItem.field_id,e.activeItem.index))},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.bF)(Y,{modelValue:e.deleteConfigConfirm,"onUpdate:modelValue":t[7]||(t[7]=t=>e.deleteConfigConfirm=t)},{default:(0,i.k6)((()=>[(0,i.bF)(J,{class:"dialog_style"},{default:(0,i.k6)((()=>[(0,i.bF)(z,{class:"flex justify-center items-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",Q,[(0,i.bF)(X,{name:"warning",size:"2em",class:"bg-primary icon_circle"})])])),_:1}),(0,i.bF)(z,{class:"q-pt-none q-mt-sm text-md text-center text-bold text_style"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("record_confirmation")),1)])),_:1}),(0,i.bF)(M,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(O,{label:e.$t("cancel"),color:"grey-6"},null,8,["label"]),[[ae]]),(0,i.bF)(O,{label:e.$t("delete"),color:"red",onClick:t[6]||(t[6]=t=>e.deleteConfig(e.activeConfigItem.config_id,e.activeConfigItem.index))},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.bF)(Y,{modelValue:e.showDuplicateConfigDlg,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showDuplicateConfigDlg=t)},{default:(0,i.k6)((()=>[(0,i.bF)(J,{class:"dialog_style"},{default:(0,i.k6)((()=>[(0,i.bF)(Z,{class:"secondary-toolbar"},{default:(0,i.k6)((()=>[(0,i.bF)(G),(0,i.bo)((0,i.bF)(O,{flat:"",round:"",dense:"","text-color":"white",icon:"close"},null,512),[[ae]])])),_:1}),(0,i.bF)(z,null,{default:(0,i.k6)((()=>[(0,i.bF)(ee,{outlined:"",dense:"",modelValue:e.current_record.lookup_name,"onUpdate:modelValue":t[8]||(t[8]=t=>e.current_record.lookup_name=t),label:e.$t("pages.master_data_fields.lookup_name")},null,8,["modelValue","label"])])),_:1}),(0,i.bF)(M,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(O,{label:e.$t("cancel"),color:"grey-6"},null,8,["label"]),[[ae]]),(0,i.bF)(O,{label:e.$t("done"),color:"primary",onClick:t[9]||(t[9]=t=>e.duplicateConfig())},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.bF)(te)],64)}var U=a(1659),I=a(24622),N=a(76956),K=a(38734),W=a(8420),O=a(18505),M=a(82204),X=a(64775),P=a(94124),z=a(11470);const J={class:"text-weight-bold"},B={class:"row"},j={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},Y={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},H={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},G={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"};function Z(e,t,a,o,s,n){const d=(0,i.g2)("q-toolbar-title"),r=(0,i.g2)("q-btn"),u=(0,i.g2)("q-toolbar"),_=(0,i.g2)("q-select"),f=(0,i.g2)("q-item-label"),p=(0,i.g2)("q-item-section"),m=(0,i.g2)("q-item"),h=(0,i.g2)("q-input"),g=(0,i.g2)("q-checkbox"),b=(0,i.g2)("q-card-section"),k=(0,i.g2)("f-btn"),v=(0,i.g2)("q-card-actions"),F=(0,i.g2)("q-card"),y=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.Wv)(F,{style:{"min-width":"58vw"}},{default:(0,i.k6)((()=>[(0,i.bF)(u,{class:"secondary-toolbar text-white"},{default:(0,i.k6)((()=>[(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",J,(0,l.v_)("edit"==e.mode?e.$t("pages.master_data_fields.edit_master_data_fields"):e.$t("pages.master_data_fields.create_master_data_fields")),1)])),_:1}),(0,i.bo)((0,i.bF)(r,{flat:"",round:"",dense:"",icon:"close"},null,512),[[y]])])),_:1}),(0,i.Lk)("form",{onSubmit:t[4]||(t[4]=(0,c.D$)(((...t)=>e.save&&e.save(...t)),["prevent","stop"]))},[(0,i.bF)(b,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",B,[(0,i.Lk)("div",j,[(0,i.bF)(_,{readonly:e.isReadonly,"use-input":"",clearable:"",outlined:"",dense:"","emit-value":"","map-options":"",onFilter:e.filterFieldsEvent,modelValue:e.currentData["lookup_field"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentData["lookup_field"]=t),options:e.filteredFieldsList,label:e.$t("pages.master_data_fields.lookup_field"),class:"q-mr-sm"},null,8,["readonly","onFilter","modelValue","options","label"])]),(0,i.Lk)("div",Y,[(0,i.bF)(_,{readonly:e.isReadonly,"use-input":"",clearable:"",outlined:"",dense:"","emit-value":"","map-options":"",onFilter:e.filterValidationFieldsEvent,modelValue:e.currentData["filter_field_id"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentData["filter_field_id"]=t),options:e.filteredSourceList,label:e.$t("filter_field"),"option-value":"id"},{"selected-item":(0,i.k6)((e=>[(0,i.eW)((0,l.v_)(e.opt.title),1)])),option:(0,i.k6)((e=>[(0,i.bF)(m,(0,l._B)((0,i.Ng)(e.itemProps)),{default:(0,i.k6)((()=>[(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.title)+" ( "+(0,l.v_)(e.opt.field_name)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["readonly","onFilter","modelValue","options","label"])]),(0,i.Lk)("div",H,[(0,i.bF)(h,{outlined:"",dense:"",readonly:e.isReadonly,modelValue:e.currentData.filter_value,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentData.filter_value=t),label:e.$t("filter_value"),class:"q-mr-sm"},null,8,["readonly","modelValue","label"])]),(0,i.Lk)("div",G,[(0,i.bF)(g,{disable:e.isReadonly,dense:"","use-input":"",modelValue:e.currentData["is_required"],"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentData["is_required"]=t),label:e.$t("required")},null,8,["disable","modelValue","label"])])])])),_:1}),(0,i.bF)(v,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(k,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[y]]),e.isReadonly?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(k,{key:0,label:"edit"==e.mode?e.$t("save"):e.$t("create"),type:"submit",class:"q-mr-sm"},null,8,["label"]))])),_:1})],32)])),_:1})}var ee=function(e,t,a,i){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function s(e){try{d(i.next(e))}catch(t){o(t)}}function n(e){try{d(i["throw"](e))}catch(t){o(t)}}function d(e){e.done?a(e.value):l(e.value).then(s,n)}d((i=i.apply(e,t||[])).next())}))};const te=(0,i.pM)({name:"LovFieldPopUp",mixins:[I.A],props:{configuration_id:{type:String,required:!0},mode:{type:String,default:"add"},field_id:{type:String,default:""},lookup_dataset_name:{type:String,default:""},tableColumnList:{type:Array,default:()=>[]},isTable:{type:Boolean,default:!1},fieldConfig:{type:Object,default:()=>({})}},emits:["updateLovFieldList"],mounted(){this.init()},methods:{init(){this.filteredFieldsList=JSON.parse(JSON.stringify(this.fields_lookup_mapping[this.lookup_dataset_name].fields)),this.validation_fields.forEach((e=>{e.rows.forEach((e=>{e.forEach((e=>{this.all_validation_fields.some((t=>t.id===e.id))||this.all_validation_fields.push(e)}))}))})),this.prepareModel(),this.isReadonly="view"==this.mode},save(){return ee(this,void 0,void 0,(function*(){try{let e={};const t=yield z.bg.saveLovFieldConfig(this.configuration_id,this.field_id,this.currentData);e="edit"===this.mode?this.currentData:t.data,this.show_lov_master_data_popup=!1,this.showSuccessToast(this.$t("pages.messages.operation_sucessfull")),this.$emit("updateLovFieldList",this.configuration_id,this.field_id,e)}catch(e){this.showErrorToast(e.message)}}))},filterFieldsEvent(e,t,a){const i=JSON.parse(JSON.stringify(this.fields_lookup_mapping[this.lookup_dataset_name].fields));t(e?()=>{const t=e.toLowerCase();this.filteredFieldsList=i.filter((e=>e.value.toLowerCase().startsWith(t)))}:()=>{this.filteredFieldsList=i})},filterValidationFieldsEvent(e,t,a){t((()=>{const t=e.toLowerCase();let a=this.all_validation_fields;this.isTable&&(a=this.tableColumnList),this.filteredSourceList=a.filter((e=>e.title.toLowerCase().startsWith(t)))}))},prepareModel(){this.currentData={lookup_field:"",filter_value:"",is_required:!1,filter_field_id:""},"add"!=this.mode&&(this.currentData=JSON.parse(JSON.stringify(this.fieldConfig)))}},setup(){const e=(0,P.O0)(),{validation_fields:t,all_validation_fields:a,fields_lookup_mapping:i,show_lov_master_data_popup:l}=(0,U.bP)(e),o=(0,P.Ox)(),{search_operators:s}=(0,U.bP)(o);return{fields_lookup_mapping:i,all_validation_fields:a,validation_fields:t,show_lov_master_data_popup:l,currentData:(0,K.KR)({}),current_field:(0,K.KR)({}),filteredFieldsList:(0,K.KR)([]),filteredSourceList:(0,K.KR)([]),isReadonly:(0,K.KR)(!1),docType:(0,K.KR)(""),search_operators:s}}});var ae=a(12807),ie=a(23316),le=a(36914),oe=a(39150),se=a(56384),ne=a(44189),de=a(94940),re=a(90124),ce=a(25173),ue=a(13796),_e=a(67837),fe=a(80460),pe=a(62669),me=a(88672),he=a(98582),ge=a.n(he);const be=(0,ae.A)(te,[["render",Z],["__scopeId","data-v-44148f29"]]),ke=be;ge()(te,"components",{QCard:ie.A,QToolbar:le.A,QToolbarTitle:oe.A,QBtn:se.A,QCardSection:ne.A,QSelect:de.A,QItem:re.A,QItemSection:ce.A,QItemLabel:ue.A,QInput:_e.A,QCheckbox:fe.A,QCardActions:pe.A}),ge()(te,"directives",{ClosePopup:me.A});const ve={class:"text-weight-bold text-white"},Fe={class:"row"},ye={class:"col-sm-6 col-md-6 col-lg-6"},Ce={class:"col-sm-6 col-md-6 col-lg-6"},Le={class:"row q-pb-md"},we={class:"col-sm-6 col-md-6 col-lg-6"},xe={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},Ae={class:"row"},qe={key:0,class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},De={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},$e={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},Te={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"};function Se(e,t,a,o,s,n){const d=(0,i.g2)("q-toolbar-title"),r=(0,i.g2)("q-btn"),c=(0,i.g2)("q-toolbar"),u=(0,i.g2)("q-input"),_=(0,i.g2)("q-item-label"),f=(0,i.g2)("q-item-section"),p=(0,i.g2)("q-item"),m=(0,i.g2)("q-select"),h=(0,i.g2)("q-card-section"),g=(0,i.g2)("f-btn"),b=(0,i.g2)("q-card-actions"),k=(0,i.g2)("q-card"),v=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.Wv)(k,{style:{"min-width":"45vw"}},{default:(0,i.k6)((()=>[(0,i.bF)(c,{class:"secondary-toolbar"},{default:(0,i.k6)((()=>[(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",ve,(0,l.v_)("edit"==e.mode?e.$t("pages.master_data_fields.edit_master_data_config"):e.$t("pages.master_data_fields.create_master_data_config")),1)])),_:1}),(0,i.bo)((0,i.bF)(r,{flat:"",round:"",dense:"","text-color":"white",icon:"close"},null,512),[[v]])])),_:1}),(0,i.bF)(h,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",Fe,[(0,i.Lk)("div",ye,[(0,i.bF)(u,{outlined:"",dense:"",readonly:"",modelValue:e.configuration_data.doc_type,"onUpdate:modelValue":t[0]||(t[0]=t=>e.configuration_data.doc_type=t),label:e.$t("document_type"),class:"q-mr-sm"},null,8,["modelValue","label"])]),(0,i.Lk)("div",Ce,[(0,i.bF)(u,{outlined:"",dense:"",readonly:e.isReadonly,modelValue:e.configuration_data.lookup_name,"onUpdate:modelValue":t[1]||(t[1]=t=>e.configuration_data.lookup_name=t),label:e.$t("lookup_lov_name"),rules:[t=>!t.includes(" ")||e.$t("pages.custom_master_data.no_spaces_error")]},null,8,["readonly","modelValue","label","rules"])])]),(0,i.Lk)("div",Le,[(0,i.Lk)("div",we,[(0,i.bF)(m,{modelValue:e.configuration_data.lookup_dataset_name,"onUpdate:modelValue":t[2]||(t[2]=t=>e.configuration_data.lookup_dataset_name=t),options:e.filtered_master_data_types,readonly:e.isReadonly,outlined:"",onFilter:e.filterDataSetNames,"use-input":"",label:e.$t("lookup_lov_dataset_name"),dense:"",clearable:"","emit-value":"","map-options":"",class:"q-mr-sm"},{option:(0,i.k6)((e=>[(0,i.bF)(p,(0,l._B)((0,i.Ng)(e.itemProps)),{default:(0,i.k6)((()=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.bF)(_,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"selected-item":(0,i.k6)((e=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.bF)(_,{class:"ellipsis text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue","options","readonly","onFilter","label"])]),(0,i.Lk)("div",xe,[(0,i.bF)(m,{modelValue:e.configuration_data.context_type,"onUpdate:modelValue":t[3]||(t[3]=t=>e.configuration_data.context_type=t),options:e.context_type_options,readonly:e.isReadonly,outlined:"",label:e.$t("pages.master_data_fields.context_type"),dense:"","emit-value":"","map-options":"",class:"q-mr-sm"},null,8,["modelValue","options","readonly","label"])])]),(0,i.Lk)("div",Ae,["line"==e.configuration_data.context_type?((0,i.uX)(),(0,i.CE)("div",qe,[(0,i.bF)(m,{modelValue:e.configuration_data.context_detail,"onUpdate:modelValue":[t[4]||(t[4]=t=>e.configuration_data.context_detail=t),t[5]||(t[5]=t=>e.loadOutFieldsData())],options:e.tables_list,readonly:e.isReadonly,outlined:"",label:e.$t("pages.master_data_fields.context_detail"),dense:"","emit-value":"","map-options":""},null,8,["modelValue","options","readonly","label"])])):(0,i.Q3)("",!0),(0,i.Lk)("div",De,[(0,i.bF)(u,{outlined:"",dense:"",modelValue:e.configuration_data.lookup_label_field,"onUpdate:modelValue":t[6]||(t[6]=t=>e.configuration_data.lookup_label_field=t),label:e.$t("lookup_label_field"),class:"q-mr-sm"},null,8,["modelValue","label"])]),(0,i.Lk)("div",$e,[(0,i.bF)(u,{outlined:"",dense:"",modelValue:e.configuration_data.lookup_value_field,"onUpdate:modelValue":t[7]||(t[7]=t=>e.configuration_data.lookup_value_field=t),label:e.$t("lookup_value_field "),class:"q-mr-sm"},null,8,["modelValue","label"])]),(0,i.Lk)("div",Te,[(0,i.bF)(m,{dense:"","emit-value":"","map-options":"",outlined:"",modelValue:e.configuration_data.out_field_id,"onUpdate:modelValue":t[8]||(t[8]=t=>e.configuration_data.out_field_id=t),options:e.out_fields,readonly:e.isReadonly,label:e.$t("out_field"),class:"q-mr-sm"},null,8,["modelValue","options","readonly","label"])])])])),_:1}),(0,i.bF)(b,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(g,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[v]]),e.isReadonly?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(g,{key:0,label:"edit"==e.mode?e.$t("save"):e.$t("create"),onClick:e.save,class:"q-mr-sm"},null,8,["label","onClick"]))])),_:1})])),_:1})}var Ve=a(66715),Ee=function(e,t,a,i){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function s(e){try{d(i.next(e))}catch(t){o(t)}}function n(e){try{d(i["throw"](e))}catch(t){o(t)}}function d(e){e.done?a(e.value):l(e.value).then(s,n)}d((i=i.apply(e,t||[])).next())}))};const Qe=(0,i.pM)({mixins:[I.A],props:{configuration_id:{type:String,default:""},configuration:{type:Object,default:()=>({})},mode:{type:String,default:"add"},tables_list:{type:Array,default:()=>[]}},emits:["updateLovList"],mounted(){this.init()},methods:{init(){return Ee(this,void 0,void 0,(function*(){this.isReadonly="view"==this.mode,this.configuration_data.doc_type=this.$route.params.type.toString(),yield this.getMasterDataTypesAndFields(),this.filtered_master_data_types=this.master_data_types,this.out_fields=JSON.parse(JSON.stringify(this.all_validation_fields)),this.prepareForm()}))},prepareForm(){this.configuration_data={doc_type:"",lookup_name:"",context_type:"header",context_detail:"",lookup_label_field:"",lookup_value_field:"",out_field_id:""},this.configuration_id&&(this.configuration_data.doc_type=this.configuration.doc_type,this.configuration_data.lookup_name=this.configuration.lookup_name,this.configuration_data.context_type=this.configuration.context,this.configuration_data.out_field_id=this.configuration.out_field_id,this.configuration_data.context_detail=this.configuration.context_detail,this.configuration_data.lookup_label_field=this.configuration.lookup_label_field,this.configuration_data.lookup_value_field=this.configuration.lookup_value_field,this.configuration_data.lookup_dataset_name=this.configuration.lookup_dataset_name)},filterDataSetNames(e,t,a){t((()=>{const t=e.toLowerCase();this.filtered_master_data_types=this.master_data_types.filter((e=>e.label.toLowerCase().startsWith(t)))}))},validInputs(){if(this.configuration_data.lookup_name.includes(" "))return this.showErrorToast(Ve.i18n.t("pages.custom_master_data.no_spaces_error")),!1;if(!this.configuration_data.lookup_dataset_name)return this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!1;if(""==this.configuration_data.lookup_name)return this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!1;if("line"==this.configuration_data.context_type){if(!this.configuration_data.context_detail)return this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!1}else this.configuration_data.context_detail="";return this.configuration_data.lookup_value_field||this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!0},save(){return Ee(this,void 0,void 0,(function*(){const e=this.validInputs();if(e&&!this.isReadonly)try{let e=yield z.bg.saveConfiguration(this.configuration_id,this.configuration_data);if(!e.success)throw{message:e.message};this.showSuccessToast(this.$t("success")),this.configuration_id?this.$emit("updateLovList",this.configuration_id,this.configuration_data):this.$emit("updateLovList",this.configuration_id,e.data),this.getDataSetFields(this.configuration_data.lookup_dataset_name)}catch(t){const e=X.t.getErrorMessage(t);this.showErrorToast(e)}finally{this.show_lov_configuration_popup=!1}}))},loadOutFieldsData(){return Ee(this,void 0,void 0,(function*(){this.configuration_data.out_field_id="","line"==this.configuration_data.context_type&&this.configuration_data.context_detail?(yield this.loadTableColumnName(this.configuration_data.context_detail),this.out_fields=JSON.parse(JSON.stringify(this.tableColumns))):this.out_fields=JSON.parse(JSON.stringify(this.all_validation_fields))}))}},setup(){const e=(0,P.O0)(),{getDataSetFields:t,loadTableColumnName:a}=e,{show_lov_configuration_popup:i,tableColumns:l,all_validation_fields:o}=(0,U.bP)(e),s=(0,P.ML)(),{getMasterDataTypesAndFields:n}=s,{master_data_types:d}=(0,U.bP)(s);return{isReadonly:(0,K.KR)(!1),getDataSetFields:t,loadTableColumnName:a,getMasterDataTypesAndFields:n,tableColumns:l,master_data_types:d,all_validation_fields:o,show_lov_configuration_popup:i,out_fields:(0,K.KR)([]),filtered_master_data_types:(0,K.KR)([]),configuration_data:(0,K.KR)({doc_type:"",lookup_name:"",lookup_dataset_name:"",context_type:"header",context_detail:"",lookup_label_field:"",lookup_value_field:"",out_field_id:""}),context_type_options:[{label:"HEADER",value:"header"},{label:"LINE",value:"line"}]}}}),Re=(0,ae.A)(Qe,[["render",Se]]),Ue=Re;ge()(Qe,"components",{QCard:ie.A,QToolbar:le.A,QToolbarTitle:oe.A,QBtn:se.A,QCardSection:ne.A,QInput:_e.A,QSelect:de.A,QItem:re.A,QItemSection:ce.A,QItemLabel:ue.A,QCardActions:pe.A}),ge()(Qe,"directives",{ClosePopup:me.A});var Ie=function(e,t,a,i){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function s(e){try{d(i.next(e))}catch(t){o(t)}}function n(e){try{d(i["throw"](e))}catch(t){o(t)}}function d(e){e.done?a(e.value):l(e.value).then(s,n)}d((i=i.apply(e,t||[])).next())}))};const Ne=(0,i.pM)({el:"app",mixins:[I.A,O.A],components:{Loader:W.A,LovFieldPopUp:ke,CreateLovForm:Ue},data(){return{DEFAULT:N.qN,fieldList:(0,K.KR)([]),tables_list:(0,K.KR)([]),showDuplicateConfigDlg:(0,K.KR)(!1)}},mounted(){this.docType=this.$route.params.type,this.loadConfigurations(),this.prepareTableList(),this.prepareValidationData()},methods:{loadConfigurations(){return Ie(this,void 0,void 0,(function*(){yield this.getLookUpConfigurations();for(const[e,t]of Object.entries(this.lov_configurations))this.getDataSetFields(t.lookup_dataset_name)}))},getLookUpConfigurations(){return Ie(this,void 0,void 0,(function*(){try{this.showLoading();const e=yield z.bg.getLookupLovConfiguration(this.docType);this.lov_configurations=e.data}catch(e){}finally{this.hideLoading()}}))},updateLovList(e,t){if(!e)return void this.lov_configurations.push(t);const a=this.lov_configurations.find((t=>t.id===e));a&&(a.doc_type=t.doc_type,a.match_all=t.match_all,a.lookup_name=t.lookup_name,a.conflict_handle=t.conflict_handle,a.lookup_dataset_name=t.lookup_dataset_name)},updateLovFieldList(e,t,a){if(!e)throw{e:this.$t("pages.messages.error_internal_occur")};if(!t)return this.lookup_fields[e].push(a),void this.saveClick(e);const i=this.lookup_fields[e].find((e=>e.id===t));i&&(i.is_required=a.is_required,i.filter_value=a.filter_value,i.lookup_field=a.lookup_field,i.filter_field_id=a.filter_field_id),this.saveClick(e)},saveClick(e){this.matchFields(e)},deleteConfig(e,t){return Ie(this,void 0,void 0,(function*(){try{const a=yield z.bg.deleteLovLookupConfiguration(e);if(!1===a.success)throw{message:a.message};this.lov_configurations.splice(t,1),this.deleteConfigConfirm=!this.deleteConfigConfirm,this.showSuccessToast(this.$t("pages.messages.DELETED_SUCCESSFULLY"))}catch(a){const e=X.t.getErrorMessage(a);this.showErrorToast(e)}}))},deleteField(e,t,a){return Ie(this,void 0,void 0,(function*(){try{const i=yield z.bg.deleteLovConfigField(e,t);if(!i.success)throw{message:i.message};this.lookup_fields[e].splice(a,1),this.deleteConfirm=!1,this.showSuccessToast(this.$t("pages.messages.DELETED_SUCCESSFULLY"))}catch(i){const e=X.t.getErrorMessage(i);this.showErrorToast(e)}}))},createConfig(){this.current_mode="add",this.show_lov_configuration_popup=!0},toggleActivationStatus(e){return Ie(this,void 0,void 0,(function*(){try{this.showLoading();const t=yield z.bg.toggleLovActivationStatus(e.id);if(!t.success)throw{message:t.message};this.showSuccessToast(this.$t("success")),e.is_active=!e.is_active}catch(t){}finally{this.hideLoading()}}))},prepareDataToDuplicate(e){this.showDuplicateConfigDlg=!0,this.current_record=JSON.parse(JSON.stringify(e)),this.current_record.lookup_name=e.lookup_name.replaceAll("_"," ")+" (copy)"},duplicateConfig(){return Ie(this,void 0,void 0,(function*(){try{if(this.showLoading(),!this.current_record.lookup_name)return void this.showErrorToast(this.$t("pages.messages.NAME_MANDATORY"));this.showDuplicateConfigDlg=!1;const e=yield z.bg.duplicateLovConfig(this.current_record.id,this.current_record.lookup_name);if(!e.success)throw{message:e.message};yield this.loadConfigurations(),this.showSuccessToast(this.$t("success"))}catch(e){}finally{this.hideLoading()}}))},editConfig(e){this.current_config_id=e.id,this.current_mode=e.org_id==N.qN?"view":"edit",this.current_record=e,this.show_lov_configuration_popup=!0},createField(e){this.current_config_id=e.id,this.current_record=e,this.current_field_id="",this.fieldConfig={},this.current_mode="add",this.show_lov_master_data_popup=!0},editData(e,t){this.current_config_id=e.id,this.current_record=e,this.current_field_id=t.id,this.fieldConfig=t,this.current_mode=t.org_id==N.qN?"view":"edit",this.show_lov_master_data_popup=!0},getFields(e){return Ie(this,void 0,void 0,(function*(){const t=e.id;try{if(this.lookup_fields[t]||(yield this.getFieldsForConfiguration(t)),"line"==e.context&&e.context_detail)return yield this.loadTableColumnName(e.context_detail),void this.prepareDataforColumns(t,e.context_detail);this.matchFields(t)}catch(a){}}))},getFieldsForConfiguration(e){return Ie(this,void 0,void 0,(function*(){try{yield z.bg.getLovFieldsForConfiguration(e).then((t=>{this.lookup_fields[e]=t.data}))}catch(t){}}))},matchFields(e){this.lookup_fields[e].forEach((e=>{this.all_validation_fields.find((t=>{this.validation_fields_sorted.includes(t)||this.validation_fields_sorted.push(t),t.id===e.filter_field_id&&(e.matching_field=t)}))}))},prepareDataforColumns(e,t){this.lookup_fields[e].forEach((e=>{for(const a of this.tableColumnList[t])a.id===e.filter_field_id&&(e.matching_field=a)}))},deletedConfigConfirmDialog(e,t){this.deleteConfigConfirm=!0,this.activeConfigItem={config_id:e,index:t}},deletedConfirmDialog(e,t,a){this.deleteConfirm=!0,this.activeItem={config_id:e,field_id:t,index:a}},convertLabel(e){return(0,M.C5)(e)},prepareTableList(){return Ie(this,void 0,void 0,(function*(){this.tables_list=[],this.tables_list.push({value:"",label:this.$t("select_table")});try{let e=yield z.p5.getTable(this.docType);if(e.data&&!e.success)throw{message:e.data.message};e.data.forEach((e=>{this.tables_list.push({value:e.table_name,label:e.table_name})}))}catch(e){throw{message:this.$t("pages.messages.error_internal_occur")}}}))},prepareValidationData(){return Ie(this,void 0,void 0,(function*(){if(!(this.validation_fields.length>0))try{const e={doc_type:this.docType},t=yield z.bg.getFieldSettingsByType(e);this.validation_fields=t.field_setting,this.preapreValidationFields()}catch(e){throw this.showErrorToast(e),{message:e}}}))},preapreValidationFields(){this.validation_fields.forEach((e=>{e.rows.forEach((e=>{e.forEach((e=>{this.fields[e.id]||(e.label=e.field_name,e.value=e.id,this.fields[e.id]=e,this.all_validation_fields.push(e))}))}))}))}},setup(){const e=(0,P.O0)(),{getDataSetFields:t,loadTableColumnName:a}=e,{fields_lookup_mapping:i,validation_fields:l,all_validation_fields:o,validation_fields_sorted:s,show_lov_master_data_popup:n,show_lov_configuration_popup:d,tableColumnList:r,tableColumns:c}=(0,U.bP)(e);return{fields_lookup_mapping:i,getDataSetFields:t,loadTableColumnName:a,all_validation_fields:o,validation_fields_sorted:s,lov_configurations:(0,K.KR)([]),show_lov_configuration_popup:d,show_lov_master_data_popup:n,validation_fields:l,lookup_fields:(0,K.KR)([]),fields:{},current_mode:(0,K.KR)("add"),current_config_id:(0,K.KR)(""),current_field_id:(0,K.KR)(""),fieldConfig:(0,K.KR)({}),current_record:(0,K.KR)({}),docType:(0,K.KR)(""),deleteConfirm:(0,K.KR)(!1),deleteConfigConfirm:(0,K.KR)(!1),activeItem:(0,K.KR)({config_id:null,field_id:null,index:null}),activeConfigItem:(0,K.KR)({config_id:null,index:null}),tableColumnList:r,tableColumns:c}}});var Ke=a(53999),We=a(88841),Oe=a(23954),Me=a(93676),Xe=a(84436),Pe=a(10386),ze=a(857),Je=a(50492),Be=a(82156);const je=(0,ae.A)(Ne,[["render",R],["__scopeId","data-v-7d304cf8"]]),Ye=je;ge()(Ne,"components",{QList:Ke.A,QExpansionItem:We.A,QBadge:Oe.A,QSpace:Me.A,QBtn:se.A,QMenu:Xe.A,QItem:re.A,QItemSection:ce.A,QSeparator:Pe.A,QCard:ie.A,QCardActions:pe.A,QCardSection:ne.A,QMarkupTable:ze.A,QIcon:Je.A,QDialog:Be.A,QToolbar:le.A,QToolbarTitle:oe.A,QInput:_e.A}),ge()(Ne,"directives",{ClosePopup:me.A});const He={class:"row"},Ge={class:"col-sm-12 col-md-12 col-lg-12 q-pb-md"},Ze={class:"col-sm-12 col-md-12 col-lg-12"},et={style:{"margin-top":"3px","text-transform":"capitalize"}},tt={class:"text-red-14"},at={class:"full-width"},it={class:"table-header-text"},lt={class:"text-left",style:{width:"25%"}},ot={class:"text-left",style:{width:"25%"}},st={class:"text-left"},nt={class:"text-center",style:{width:"5%"}},dt={class:"text-center",style:{width:"5%"}},rt={class:"text-left",style:{width:"2%"}},ct={key:0},ut={class:"text-left"},_t={class:"text-capitalize q-pr-sm"},ft={class:"text-left"},pt={key:0},mt={key:1},ht={class:"text-left"},gt={class:"text-capitalize"},bt={class:"text-center"},kt={class:"text-capitalize"},vt={class:"text-center"},Ft={class:"text-capitalize"},yt={class:"text-left"},Ct={class:"text-red-14"},Lt={class:"text-h6"},wt={class:"text-h6"};function xt(e,t,a,o,s,n){const d=(0,i.g2)("f-btn"),r=(0,i.g2)("q-badge"),u=(0,i.g2)("q-space"),_=(0,i.g2)("q-item-section"),f=(0,i.g2)("q-item"),p=(0,i.g2)("q-separator"),m=(0,i.g2)("q-list"),h=(0,i.g2)("q-menu"),g=(0,i.g2)("q-btn"),b=(0,i.g2)("q-card-actions"),k=(0,i.g2)("q-icon"),v=(0,i.g2)("q-markup-table"),F=(0,i.g2)("q-card-section"),y=(0,i.g2)("q-card"),C=(0,i.g2)("q-expansion-item"),L=(0,i.g2)("LookupConfigurationPopUp"),w=(0,i.g2)("q-dialog"),x=(0,i.g2)("FieldPopUp"),A=(0,i.g2)("q-toolbar-title"),q=(0,i.g2)("q-toolbar"),D=(0,i.g2)("q-input"),$=(0,i.g2)("Loader"),T=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",He,[(0,i.Lk)("div",Ge,[(0,i.bF)(d,{label:e.$t("pages.master_data_fields.create_lookup_config"),icon:"add",onClick:e.createConfig,class:"float-right"},null,8,["label","onClick"])]),(0,i.Lk)("div",Ze,[(0,i.bF)(m,{bordered:""},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.lookup_configurations,((a,o)=>((0,i.uX)(),(0,i.Wv)(C,{key:a.id,"expand-separator":"","header-class":"highlighted-back ",onClick:t=>e.getFields(a)},{header:(0,i.k6)((()=>[(0,i.Lk)("span",et,[(0,i.eW)((0,l.v_)(a.lookup_name.replaceAll("_"," "))+" ",1),a.org_id===e.DEFAULT?((0,i.uX)(),(0,i.Wv)(r,{key:0,transparent:"",align:"middle",color:"orange"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("default")),1)])),_:1})):(0,i.Q3)("",!0)]),(0,i.bF)(u),(0,i.bF)(g,{flat:"",dense:"",round:"",onClick:t[0]||(t[0]=(0,c.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,i.k6)((()=>[(0,i.bF)(h,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,i.k6)((()=>[(0,i.bF)(m,{dense:"",style:{"min-width":"100px"}},{default:(0,i.k6)((()=>[(0,i.bF)(f,{clickable:"",onClick:t=>e.toggleActivationStatus(a)},{default:(0,i.k6)((()=>[(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(a.is_active?e.$t("deactivate"):e.$t("activate")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i.bF)(p),(0,i.bF)(f,{clickable:"",onClick:t=>e.prepareDataToDuplicate(a)},{default:(0,i.k6)((()=>[(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("duplicate")),1)])),_:1})])),_:2},1032,["onClick"]),(0,i.bF)(p),(0,i.bF)(f,{clickable:"",onClick:t=>e.editConfig(a)},{default:(0,i.k6)((()=>[(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(a.org_id==e.DEFAULT?e.$t("view"):e.$t("edit")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i.bF)(p),a.org_id!=e.DEFAULT?((0,i.uX)(),(0,i.Wv)(f,{key:0,clickable:""},{default:(0,i.k6)((()=>[(0,i.bF)(_,{onClick:t=>e.DeletedConfigConfirmDialog(a.id,o)},{default:(0,i.k6)((()=>[(0,i.Lk)("span",tt,(0,l.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,i.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),default:(0,i.k6)((()=>[(0,i.bF)(y,null,{default:(0,i.k6)((()=>[(0,i.bF)(b,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{icon:"add",label:e.$t("create"),onClick:t=>e.createField(a),class:"q-mr-sm"},null,8,["label","onClick"])])),_:2},1024),(0,i.bF)(F,{style:"height: auto; min-height: 3vh;"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",at,[(0,i.bF)(v,{dense:"",flat:"",class:"dashboard-table-style back-white dashboard-table-header-sticky"},{default:(0,i.k6)((()=>[(0,i.Lk)("thead",null,[(0,i.Lk)("tr",it,[(0,i.Lk)("th",lt,(0,l.v_)(e.$t("pages.master_data_fields.lookup_field")),1),(0,i.Lk)("th",ot,(0,l.v_)(e.$t("pages.master_data_fields.validation_field")),1),(0,i.Lk)("th",st,(0,l.v_)(e.$t("pages.master_data_fields.parent_field")),1),(0,i.Lk)("th",nt,(0,l.v_)(e.$t("pages.master_data_fields.is_searchable")),1),(0,i.Lk)("th",dt,(0,l.v_)(e.$t("pages.master_data_fields.auto_trigger")),1),(0,i.Lk)("th",rt,(0,l.v_)(e.$t("actions")),1)])]),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.lookup_fields[a.id],((o,s)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:o.id},[o&&Object.keys(o).length>0?((0,i.uX)(),(0,i.CE)("tr",ct,[(0,i.Lk)("td",ut,[(0,i.Lk)("span",_t,(0,l.v_)(e.convertLabel(o.lookup_field)),1),o.org_id===e.DEFAULT?((0,i.uX)(),(0,i.Wv)(r,{key:0,transparent:"",align:"middle",color:"orange"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("default")),1)])),_:1})):(0,i.Q3)("",!0)]),(0,i.Lk)("td",ft,[o.matching_field?((0,i.uX)(),(0,i.CE)("span",pt,(0,l.v_)(o.matching_field.title)+" ( "+(0,l.v_)(o.matching_field.field_name)+")",1)):((0,i.uX)(),(0,i.CE)("span",mt,(0,l.v_)(e.$t("No Match")),1))]),(0,i.Lk)("td",ht,[(0,i.Lk)("span",gt,(0,l.v_)(o.parent_field_id?o.parent_field.title+"("+o.parent_field.field_name+")":e.$t("none")),1)]),(0,i.Lk)("td",bt,[(0,i.Lk)("span",kt,[(0,i.bF)(k,{size:"sm",name:o.is_searchable?"check_circle":"cancel",color:o.is_searchable?"green":"red"},null,8,["name","color"])])]),(0,i.Lk)("td",vt,[(0,i.Lk)("span",Ft,[(0,i.bF)(k,{size:"sm",name:o.auto_trigger?"check_circle":"cancel",color:o.auto_trigger?"green":"red"},null,8,["name","color"])])]),(0,i.Lk)("td",yt,[(0,i.bF)(g,{flat:"",dense:"",round:"",onClick:t[1]||(t[1]=(0,c.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,i.k6)((()=>[(0,i.bF)(h,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,i.k6)((()=>[(0,i.bF)(m,{dense:"",style:{"min-width":"100px"}},{default:(0,i.k6)((()=>[(0,i.bF)(f,{clickable:"",onClick:t=>e.editData(a,o)},{default:(0,i.k6)((()=>[(0,i.bF)(_,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(o.org_id==e.DEFAULT?e.$t("view"):e.$t("edit")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i.bF)(p,{inset:""}),o.org_id!=e.DEFAULT?((0,i.uX)(),(0,i.Wv)(f,{key:0,clickable:""},{default:(0,i.k6)((()=>[(0,i.bF)(_,{onClick:t=>e.DeletedConfirmDialog(a.id,o.id,s)},{default:(0,i.k6)((()=>[(0,i.Lk)("span",Ct,(0,l.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,i.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])):(0,i.Q3)("",!0)],64)))),128))])])),_:2},1024)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])]),(0,i.bF)(w,{modelValue:e.show_configuration_popup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.show_configuration_popup=t)},{default:(0,i.k6)((()=>[(0,i.bF)(L,{mode:e.current_mode,configuration_id:e.current_config_id,tables_list:e.tables_list},null,8,["mode","configuration_id","tables_list"])])),_:1},8,["modelValue"]),(0,i.bF)(w,{modelValue:e.show_master_data_popup,"onUpdate:modelValue":t[3]||(t[3]=t=>e.show_master_data_popup=t)},{default:(0,i.k6)((()=>[(0,i.bF)(x,{configuration_id:e.current_config_id,mode:e.current_mode,field_id:e.current_field_id,lookup_dataset_name:e.current_record.lookup_dataset_name,tableColumnList:e.tableColumns,isTable:e.current_record&&"line"==e.current_record.context,saveClick:e.saveClick},null,8,["configuration_id","mode","field_id","lookup_dataset_name","tableColumnList","isTable","saveClick"])])),_:1},8,["modelValue"]),(0,i.bF)(w,{modelValue:e.deleteConfirm,"onUpdate:modelValue":t[5]||(t[5]=t=>e.deleteConfirm=t)},{default:(0,i.k6)((()=>[(0,i.bF)(y,{class:"dialog_style"},{default:(0,i.k6)((()=>[(0,i.bF)(F,{class:"flex justify-center items-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",Lt,[(0,i.bF)(k,{name:"warning",size:"2em",class:"bg-primary icon_circle"})])])),_:1}),(0,i.bF)(F,{class:"q-pt-none q-mt-sm text-md text-center text-bold text_style"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("record_confirmation")),1)])),_:1}),(0,i.bF)(b,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(g,{label:e.$t("cancel"),color:"grey-6"},null,8,["label"]),[[T]]),(0,i.bF)(g,{label:e.$t("delete"),color:"red",onClick:t[4]||(t[4]=t=>e.deleteEvent(e.activeItem.config_id,e.activeItem.field_id,e.activeItem.index))},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.bF)(w,{modelValue:e.deleteConfigConfirm,"onUpdate:modelValue":t[7]||(t[7]=t=>e.deleteConfigConfirm=t)},{default:(0,i.k6)((()=>[(0,i.bF)(y,{class:"dialog_style"},{default:(0,i.k6)((()=>[(0,i.bF)(F,{class:"flex justify-center items-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",wt,[(0,i.bF)(k,{name:"warning",size:"2em",class:"bg-primary icon_circle"})])])),_:1}),(0,i.bF)(F,{class:"q-pt-none q-mt-sm text-md text-center text-bold text_style"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.$t("record_confirmation")),1)])),_:1}),(0,i.bF)(b,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(g,{label:e.$t("cancel"),color:"grey-6"},null,8,["label"]),[[T]]),(0,i.bF)(g,{label:e.$t("delete"),color:"red",onClick:t[6]||(t[6]=t=>e.deleteConfig(e.activeConfigItem.config_id,e.activeConfigItem.index))},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.bF)(w,{modelValue:e.showDuplicateConfigDlg,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showDuplicateConfigDlg=t)},{default:(0,i.k6)((()=>[(0,i.bF)(y,{class:"dialog_style"},{default:(0,i.k6)((()=>[(0,i.bF)(q,{class:"secondary-toolbar"},{default:(0,i.k6)((()=>[(0,i.bF)(A),(0,i.bo)((0,i.bF)(g,{flat:"",round:"",dense:"","text-color":"white",icon:"close"},null,512),[[T]])])),_:1}),(0,i.bF)(F,null,{default:(0,i.k6)((()=>[(0,i.bF)(D,{outlined:"",dense:"",modelValue:e.current_record.lookup_name,"onUpdate:modelValue":t[8]||(t[8]=t=>e.current_record.lookup_name=t),label:e.$t("pages.master_data_fields.lookup_name")},null,8,["modelValue","label"])])),_:1}),(0,i.bF)(b,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(g,{label:e.$t("cancel"),color:"grey-6"},null,8,["label"]),[[T]]),(0,i.bF)(g,{label:e.$t("done"),color:"primary",onClick:t[9]||(t[9]=t=>e.duplicateConfig())},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.bF)($)],64)}a(10239);const At={class:"text-weight-bold"},qt={class:"row"},Dt={class:"row q-py-md"},$t={class:"row q-py-md"};function Tt(e,t,a,o,s,n){const d=(0,i.g2)("q-toolbar-title"),r=(0,i.g2)("q-btn"),u=(0,i.g2)("q-toolbar"),_=(0,i.g2)("q-select"),f=(0,i.g2)("q-item-label"),p=(0,i.g2)("q-item-section"),m=(0,i.g2)("q-item"),h=(0,i.g2)("q-checkbox"),g=(0,i.g2)("q-card-section"),b=(0,i.g2)("f-btn"),k=(0,i.g2)("q-card-actions"),v=(0,i.g2)("q-card"),F=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.Wv)(v,{style:{"min-width":"58vw"}},{default:(0,i.k6)((()=>[(0,i.bF)(u,{class:"secondary-toolbar text-white"},{default:(0,i.k6)((()=>[(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",At,(0,l.v_)("edit"==this.mode?e.$t("pages.master_data_fields.edit_master_data_fields"):e.$t("pages.master_data_fields.create_master_data_fields")),1)])),_:1}),(0,i.bo)((0,i.bF)(r,{flat:"",round:"",dense:"",icon:"close"},null,512),[[F]])])),_:1}),(0,i.Lk)("form",{onSubmit:t[6]||(t[6]=(0,c.D$)(((...t)=>e.save&&e.save(...t)),["prevent","stop"]))},[(0,i.bF)(g,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",qt,[(0,i.bF)(_,{readonly:e.isReadonly,clearable:"",outlined:"",dense:"","use-input":"",onFilter:e.filterFieldsEvent,modelValue:e.currentData["lookup_field"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentData["lookup_field"]=t),options:e.filteredFieldsList,label:e.$t("pages.master_data_fields.lookup_field"),style:{width:"49%","margin-right":"1%"},required:!e.currentData["lookup_field"]},null,8,["readonly","onFilter","modelValue","options","label","required"]),(0,i.bF)(_,{readonly:e.isReadonly,clearable:"",outlined:"",dense:"",onFilter:e.filterValidationFieldsEvent,"use-input":"",modelValue:e.currentData["validation_field"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentData["validation_field"]=t),options:e.filteredSourceList,label:e.$t("pages.master_data_fields.validation_field"),style:{width:"50%"},required:!e.currentData["validation_field"]},{"selected-item":(0,i.k6)((e=>[(0,i.eW)((0,l.v_)(e.opt.title),1)])),option:(0,i.k6)((e=>[(0,i.bF)(m,(0,l._B)((0,i.Ng)(e.itemProps)),{default:(0,i.k6)((()=>[(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.title)+" ( "+(0,l.v_)(e.opt.field_name)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["readonly","onFilter","modelValue","options","label","required"])]),(0,i.Lk)("div",Dt,[(0,i.bF)(_,{readonly:e.isReadonly,clearable:"",outlined:"",dense:"",onFilter:e.filterValidationFieldsEvent,"use-input":"",modelValue:e.currentData["parent_field"],"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentData["parent_field"]=t),options:e.filteredSourceList,label:e.$t("pages.master_data_fields.parent_field"),style:{width:"49%","margin-right":"1%"}},{option:(0,i.k6)((e=>[(0,i.bF)(m,(0,l._B)((0,i.Ng)(e.itemProps)),{default:(0,i.k6)((()=>[(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.title)+" ( "+(0,l.v_)(e.opt.field_name)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"selected-item":(0,i.k6)((e=>[(0,i.eW)((0,l.v_)(e.opt.title),1)])),_:1},8,["readonly","onFilter","modelValue","options","label"]),(0,i.bF)(_,{readonly:e.isReadonly,clearable:"",outlined:"",dense:"",onFilter:e.filterValidationFieldsEvent,"use-input":"","emit-value":"","map-options":"",modelValue:e.currentData["search_operator"],"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentData["search_operator"]=t),options:e.search_operators,label:e.$t("pages.master_data_fields.search_operator"),style:{width:"50%"}},null,8,["readonly","onFilter","modelValue","options","label"])]),(0,i.Lk)("div",$t,[(0,i.bF)(h,{disable:e.isReadonly,dense:"","use-input":"",modelValue:e.currentData["auto_trigger"],"onUpdate:modelValue":t[4]||(t[4]=t=>e.currentData["auto_trigger"]=t),label:e.$t("pages.master_data_fields.auto_trigger"),style:{"margin-right":"15%"}},null,8,["disable","modelValue","label"]),(0,i.bF)(h,{disable:e.isReadonly,dense:"","use-input":"",modelValue:e.currentData["is_searchable"],"onUpdate:modelValue":t[5]||(t[5]=t=>e.currentData["is_searchable"]=t),label:e.$t("pages.master_data_fields.is_searchable")},null,8,["disable","modelValue","label"])])])),_:1}),(0,i.bF)(k,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(b,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[F]]),e.isReadonly?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(b,{key:0,label:"edit"==this.mode?e.$t("save"):e.$t("create"),type:"submit",class:"q-mr-sm"},null,8,["label"]))])),_:1})],32)])),_:1})}const St=(0,i.pM)({name:"MasterDataPopUp",mixins:[I.A],props:{configuration_id:{type:String,required:!0},mode:{type:String,default:"add"},field_id:{type:String,default:""},lookup_dataset_name:{type:String,default:""},saveClick:{type:Function,required:!0},tableColumnList:{type:[],default:[]},isTable:{type:Boolean,default:!1}},setup(){const e=(0,P.O0)(),{UpdateFields:t,CreateFields:a,getFieldsForConfiguration:i}=e,{lookup_fields:l,validation_fields:o,validation_fields_sorted:s,all_validation_fields:n,fields_lookup_mapping:d,show_master_data_popup:r}=(0,U.bP)(e),c=(0,P.Ox)(),{search_operators:u}=(0,U.bP)(c);return{fields_lookup_mapping:d,lookup_fields:l,UpdateFields:t,CreateFields:a,getFieldsForConfiguration:i,validation_fields_sorted:s,all_validation_fields:n,validation_fields:o,show_master_data_popup:r,currentData:(0,K.KR)({}),current_field:(0,K.KR)({}),filteredFieldsList:(0,K.KR)([]),filteredSourceList:(0,K.KR)([]),isReadonly:(0,K.KR)(!1),docType:(0,K.KR)(""),search_operators:u}},mounted(){this.filteredFieldsList=JSON.parse(JSON.stringify(this.fields_lookup_mapping[this.lookup_dataset_name].fields)),this.validation_fields.forEach((e=>{e.rows.forEach((e=>{e.forEach((e=>{this.all_validation_fields.some((t=>t.id===e.id))||this.all_validation_fields.push(e)}))}))})),this.prepareModel(),this.isReadonly="view"==this.mode},methods:{save(){try{if("edit"===this.mode)return void this.UpdateFields(this.configuration_id,this.field_id,this.currentData).then((async e=>{this.show_master_data_popup=!1,this.showSuccessToast(this.$t("pages.messages.operation_sucessfull")),await this.getFieldsForConfiguration(this.configuration_id),this.saveClick(this.configuration_id)})).catch((e=>{this.showErrorToast(e.message)}));if("add"===this.mode)return void this.CreateFields(this.configuration_id,this.currentData).then((e=>{this.show_master_data_popup=!1,this.showSuccessToast(this.$t("pages.messages.operation_sucessfull")),this.lookup_fields[this.configuration_id].push(e.data),this.saveClick(this.configuration_id)})).catch((e=>{this.showErrorToast(e.message)}))}catch(e){}finally{this.show_master_data_popup=!1}},filterFieldsEvent(e,t,a){const i=JSON.parse(JSON.stringify(this.fields_lookup_mapping[this.lookup_dataset_name].fields));t(e?()=>{const t=e.toLowerCase();this.filteredFieldsList=i.filter((e=>e.value.toLowerCase().startsWith(t)))}:()=>{this.filteredFieldsList=i})},filterValidationFieldsEvent(e,t,a){t((()=>{const t=e.toLowerCase();let a=this.all_validation_fields;this.isTable&&(a=this.tableColumnList),this.filteredSourceList=a.filter((e=>e.title.toLowerCase().startsWith(t)))}))},prepareModel(){this.currentData={lookup_field:"",validation_field:"",parent_field:"",auto_trigger:!1,is_searchable:!1,search_operator:""},"add"!=this.mode&&this.lookup_fields[this.configuration_id].forEach((e=>{if(e.id===this.field_id){this.current_field=e,this.currentData.auto_trigger=e.auto_trigger,this.currentData.is_searchable=e.is_searchable,this.currentData.validation_field=e.matching_field,this.currentData.search_operator=e.search_operator;let t=this.all_validation_fields;this.isTable&&(t=this.tableColumnList);const a=this.fields_lookup_mapping[this.lookup_dataset_name].fields.find((t=>t.value===e.lookup_field)),i=t.find((t=>t.id===e.parent_field_id));this.currentData.lookup_field=a,this.currentData.parent_field=i}}))}}}),Vt=(0,ae.A)(St,[["render",Tt],["__scopeId","data-v-23189628"]]),Et=Vt;ge()(St,"components",{QCard:ie.A,QToolbar:le.A,QToolbarTitle:oe.A,QBtn:se.A,QCardSection:ne.A,QSelect:de.A,QItem:re.A,QItemSection:ce.A,QItemLabel:ue.A,QCheckbox:fe.A,QCardActions:pe.A}),ge()(St,"directives",{ClosePopup:me.A});const Qt={class:"text-weight-bold text-white"},Rt={class:"row"},Ut={class:"col-sm-6 col-md-6 col-lg-6"},It={class:"col-sm-6 col-md-6 col-lg-6"},Nt={class:"row q-pb-md"},Kt={class:"col-sm-6 col-md-6 col-lg-6"},Wt={class:"col-sm-6 col-md-6 col-lg-6"},Ot={class:"row"},Mt={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},Xt={key:0,class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"},Pt={class:"col-sm-6 col-md-6 col-lg-6 q-pb-md"};function zt(e,t,a,o,s,n){const d=(0,i.g2)("q-toolbar-title"),r=(0,i.g2)("q-btn"),c=(0,i.g2)("q-toolbar"),u=(0,i.g2)("q-input"),_=(0,i.g2)("q-item-label"),f=(0,i.g2)("q-item-section"),p=(0,i.g2)("q-item"),m=(0,i.g2)("q-select"),h=(0,i.g2)("q-toggle"),g=(0,i.g2)("q-card-section"),b=(0,i.g2)("f-btn"),k=(0,i.g2)("q-card-actions"),v=(0,i.g2)("q-card"),F=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.Wv)(v,{style:{"min-width":"45vw"}},{default:(0,i.k6)((()=>[(0,i.bF)(c,{class:"secondary-toolbar"},{default:(0,i.k6)((()=>[(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",Qt,(0,l.v_)("edit"==this.mode?e.$t("pages.master_data_fields.edit_master_data_config"):e.$t("pages.master_data_fields.create_master_data_config")),1)])),_:1}),(0,i.bo)((0,i.bF)(r,{flat:"",round:"",dense:"","text-color":"white",icon:"close"},null,512),[[F]])])),_:1}),(0,i.bF)(g,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",Rt,[(0,i.Lk)("div",Ut,[(0,i.bF)(u,{outlined:"",dense:"",readonly:"",modelValue:e.configuration_data.doc_type,"onUpdate:modelValue":t[0]||(t[0]=t=>e.configuration_data.doc_type=t),label:e.$t("document_type"),class:"q-mr-sm"},null,8,["modelValue","label"])]),(0,i.Lk)("div",It,[(0,i.bF)(u,{outlined:"",dense:"",readonly:e.isReadonly,modelValue:e.configuration_data.lookup_name,"onUpdate:modelValue":t[1]||(t[1]=t=>e.configuration_data.lookup_name=t),label:e.$t("pages.master_data_fields.lookup_name"),rules:[t=>!t.includes(" ")||e.$t("pages.custom_master_data.no_spaces_error")]},null,8,["readonly","modelValue","label","rules"])])]),(0,i.Lk)("div",Nt,[(0,i.Lk)("div",Kt,[(0,i.bF)(m,{modelValue:e.configuration_data.lookup_dataset_name,"onUpdate:modelValue":t[2]||(t[2]=t=>e.configuration_data.lookup_dataset_name=t),options:e.filtered_master_data_types,readonly:e.isReadonly,outlined:"",onFilter:e.filterDatasetNames,"use-input":"",label:e.$t("pages.master_data_fields.lookup_dataset_name"),dense:"",clearable:"","emit-value":"","map-options":"",class:"q-mr-sm"},{option:(0,i.k6)((e=>[(0,i.bF)(p,(0,l._B)((0,i.Ng)(e.itemProps)),{default:(0,i.k6)((()=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.bF)(_,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"selected-item":(0,i.k6)((e=>[(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.bF)(_,{class:"ellipsis text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue","options","readonly","onFilter","label"])]),(0,i.Lk)("div",Wt,[(0,i.bF)(m,{modelValue:e.configuration_data.conflict_handle,"onUpdate:modelValue":t[3]||(t[3]=t=>e.configuration_data.conflict_handle=t),options:e.conflict_handle_options,readonly:e.isReadonly,outlined:"",label:e.$t("pages.master_data_fields.conflict_handle"),dense:"","emit-value":"","map-options":""},null,8,["modelValue","options","readonly","label"])])]),(0,i.Lk)("div",Ot,[(0,i.Lk)("div",Mt,[(0,i.bF)(m,{modelValue:e.configuration_data.context_type,"onUpdate:modelValue":t[4]||(t[4]=t=>e.configuration_data.context_type=t),options:e.context_type_options,readonly:e.isReadonly,outlined:"",label:e.$t("pages.master_data_fields.context_type"),dense:"","emit-value":"","map-options":"",class:"q-mr-sm"},null,8,["modelValue","options","readonly","label"])]),"line"==e.configuration_data.context_type?((0,i.uX)(),(0,i.CE)("div",Xt,[(0,i.bF)(m,{modelValue:e.configuration_data.context_detail,"onUpdate:modelValue":t[5]||(t[5]=t=>e.configuration_data.context_detail=t),options:e.tables_list,readonly:e.isReadonly,outlined:"",label:e.$t("pages.master_data_fields.context_detail"),dense:"","emit-value":"","map-options":""},null,8,["modelValue","options","readonly","label"])])):(0,i.Q3)("",!0),(0,i.Lk)("div",Pt,[(0,i.bF)(h,{disable:e.isReadonly,modelValue:e.configuration_data.match_all,"onUpdate:modelValue":t[6]||(t[6]=t=>e.configuration_data.match_all=t),label:e.$t("lbl_match_all")},null,8,["disable","modelValue","label"])])])])),_:1}),(0,i.bF)(k,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(b,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[F]]),e.isReadonly?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(b,{key:0,label:"edit"==this.mode?e.$t("save"):e.$t("create"),onClick:e.save,class:"q-mr-sm"},null,8,["label","onClick"]))])),_:1})])),_:1})}const Jt=(0,i.pM)({mixins:[I.A],props:{configuration_id:{type:String,required:!1},mode:{type:String,default:"add"},tables_list:{type:[],default:[]}},async mounted(){this.isReadonly="view"==this.mode,this.configuration_data.doc_type=this.$route.params.type.toString(),("edit"==this.mode||this.isReadonly)&&this.getConfiguration(this.configuration_id),await this.getMasterDataTypesAndFields(),this.filtered_master_data_types=this.master_data_types},methods:{filterDatasetNames(e,t,a){t((()=>{const t=e.toLowerCase();this.filtered_master_data_types=this.master_data_types.filter((e=>e.label.toLowerCase().startsWith(t)))}))},getConfiguration(e){this.lookup_configurations.find((t=>{t.id==e&&(this.configuration_data.lookup_name=t.lookup_name,this.configuration_data.conflict_handle=t.conflict_handle,this.configuration_data.lookup_dataset_name=t.lookup_dataset_name,this.configuration_data.match_all=!!t.match_all&&t.match_all,this.configuration_data.context_type=t.context,this.configuration_data.context_detail=t.context_detail)}))},validInputs(){if(this.configuration_data.lookup_name.includes(" "))return this.showErrorToast(Ve.i18n.t("pages.custom_master_data.no_spaces_error")),!1;if(!this.configuration_data.lookup_dataset_name)return this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!1;if(""==this.configuration_data.lookup_name)return this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!1;if("line"==this.configuration_data.context_type){if(!this.configuration_data.context_detail)return this.showErrorToast(Ve.i18n.t("directscan.fill_all_fields")),!1}else this.configuration_data.context_detail="";return!0},async save(){const e=this.validInputs();if(e&&!this.isReadonly)try{let e;if(e="edit"==this.mode?await this.UpdateConfiguration(this.configuration_id,this.configuration_data):await this.CreateConfiguration(this.configuration_data),!e.success)throw{message:e.message};this.showSuccessToast(this.$t("success")),this.show_configuration_popup=!1,this.getDataSetFields(this.configuration_data.lookup_dataset_name)}catch(t){const e=X.t.getErrorMessage(t);this.showErrorToast(e)}}},setup(){const e=(0,P.O0)(),{CreateConfiguration:t,UpdateConfiguration:a,getDataSetFields:i}=e,{lookup_configurations:l,lookup_fields:o,validation_fields:s,validation_fields_sorted:n,show_configuration_popup:d,show_master_data_popup:r}=(0,U.bP)(e),c=(0,P.ML)(),{getMasterDataTypesAndFields:u}=c,{master_data_types:_}=(0,U.bP)(c);return{isReadonly:(0,K.KR)(!1),getDataSetFields:i,CreateConfiguration:t,UpdateConfiguration:a,getMasterDataTypesAndFields:u,master_data_types:_,validation_fields_sorted:n,show_configuration_popup:d,lookup_configurations:l,validation_fields:s,lookup_fields:o,filtered_master_data_types:(0,K.KR)([]),configuration_data:(0,K.KR)({doc_type:"",lookup_name:"",match_all:!1,conflict_handle:"BEST_SCORE",context_type:"header",context_detail:""}),conflict_handle_options:N.RJ,context_type_options:[{label:"HEADER",value:"header"},{label:"LINE",value:"line"}]}}});var Bt=a(66908);const jt=(0,ae.A)(Jt,[["render",zt]]),Yt=jt;ge()(Jt,"components",{QCard:ie.A,QToolbar:le.A,QToolbarTitle:oe.A,QBtn:se.A,QCardSection:ne.A,QInput:_e.A,QSelect:de.A,QItem:re.A,QItemSection:ce.A,QItemLabel:ue.A,QToggle:Bt.A,QCardActions:pe.A}),ge()(Jt,"directives",{ClosePopup:me.A});const Ht=(0,i.pM)({el:"app",mixins:[I.A,O.A],components:{Loader:W.A,FieldPopUp:Et,LookupConfigurationPopUp:Yt},data(){return{DEFAULT:N.qN,tables_list:(0,K.KR)([]),showDuplicateConfigDlg:(0,K.KR)(!1)}},mounted(){this.loadConfigurations(),this.prepareTableList()},setup(){const e=(0,P.O0)(),{getLookUpConfigurations:t,getFieldsForConfiguration:a,deleteField:i,deleteLookupConfiguration:l,getDataSetFields:o}=e,{lookup_configurations:s,fields_lookup_mapping:n,lookup_fields:d,validation_fields:r,validation_fields_sorted:c,show_configuration_popup:u,show_master_data_popup:_}=(0,U.bP)(e);return{deleteField:i,getDataSetFields:o,getLookUpConfigurations:t,getFieldsForConfiguration:a,deleteLookupConfiguration:l,validation_fields_sorted:c,show_configuration_popup:u,show_master_data_popup:_,fields_lookup_mapping:n,lookup_configurations:s,validation_fields:r,lookup_fields:d,current_mode:(0,K.KR)("add"),current_config_id:(0,K.KR)(""),current_field_id:(0,K.KR)(""),current_record:(0,K.KR)({}),docType:(0,K.KR)(""),deleteConfirm:(0,K.KR)(!1),deleteConfigConfirm:(0,K.KR)(!1),activeItem:(0,K.KR)({config_id:null,field_id:null,index:null}),activeConfigItem:(0,K.KR)({config_id:null,index:null}),tableColumnList:(0,K.KR)({}),tableColumns:(0,K.KR)([])}},methods:{async loadConfigurations(){this.docType=this.$route.params.type.toString(),await this.getLookUpConfigurations(this.docType);for(const[e,t]of Object.entries(this.lookup_configurations))this.getDataSetFields(t.lookup_dataset_name)},saveClick(e){this.matchFields(e)},async deleteConfig(e,t){try{const a=await this.deleteLookupConfiguration(e);if(!1===a.success)throw{message:a.message};this.lookup_configurations.splice(t,1),this.deleteConfigConfirm=!this.deleteConfigConfirm,this.showSuccessToast(this.$t("pages.messages.DELETED_SUCCESSFULLY"))}catch(a){const e=X.t.getErrorMessage(a);this.showErrorToast(e)}},async deleteEvent(e,t,a){try{const i=await this.deleteField(e,t);if(!i.success)throw{message:i.message};this.lookup_fields[e].splice(a,1),this.deleteConfirm=!this.deleteConfirm,this.showSuccessToast(this.$t("pages.messages.DELETED_SUCCESSFULLY"))}catch(i){const e=X.t.getErrorMessage(i);this.showErrorToast(e)}},createConfig(){this.current_mode="add",this.show_configuration_popup=!0},async toggleActivationStatus(e){try{this.showLoading();const t=await z.bg.toggleActivationStatus(e.id);if(!t.success)throw{message:t.message};this.showSuccessToast(this.$t("success")),e.is_active=!e.is_active}catch(t){}finally{this.hideLoading()}},prepareDataToDuplicate(e){this.showDuplicateConfigDlg=!0,this.current_record=JSON.parse(JSON.stringify(e)),this.current_record.lookup_name=e.lookup_name.replaceAll("_"," ")+" (copy)"},async duplicateConfig(){try{if(this.showLoading(),!this.current_record.lookup_name)return void this.showErrorToast(this.$t("pages.messages.NAME_MANDATORY"));this.showDuplicateConfigDlg=!1;const e=await z.bg.duplicateConfig(this.current_record.id,this.current_record.lookup_name);if(!e.success)throw{message:e.message};await this.loadConfigurations(),this.showSuccessToast(this.$t("success"))}catch(e){}finally{this.hideLoading()}},editConfig(e){this.current_config_id=e.id,this.current_mode=e.org_id==N.qN?"view":"edit",this.current_record=e,this.show_configuration_popup=!0},createField(e){this.current_config_id=e.id,this.current_record=e,this.current_field_id="",this.current_mode="add",this.show_master_data_popup=!0,"line"==e.context&&e.context_detail&&this.loadTableColumnName(e.context_detail)},editData(e,t){this.current_config_id=e.id,this.current_record=e,this.current_field_id=t.id,this.current_mode=t.org_id==N.qN?"view":"edit",this.show_master_data_popup=!0,"line"==e.context_type&&e.context_detail&&this.loadTableColumnName(e.context_detail)},async loadTableColumnName(e){try{if(Object.keys(this.tableColumnList).length>0&&this.tableColumnList[e].length>0)return void(this.tableColumns=this.tableColumnList[e]);this.tableColumnList[e]=[];const t=await z.p5.getDocumentTableColumns(e);if(t.data&&!t.success)throw{message:t.data.message};for(const a of t.data)this.tableColumnList[e].push({value:a.column_name,label:this.$t(a.column_name),title:this.$t(a.column_name),field_name:a.column_name,id:a.id});this.tableColumns=this.tableColumnList[e]}catch(t){throw{message:this.$t("pages.messages.error_internal_occur")}}},async getFields(e){const t=e.id;try{if(this.lookup_fields[t])return;if(await this.getFieldsForConfiguration(t),"line"==e.context&&e.context_detail)return await this.loadTableColumnName(e.context_detail),void this.prepareDataforColumns(t,e.context_detail);if(this.validation_fields.length>0)return;const a={doc_type:this.docType};await z.bg.getFieldSettingsByType(a).then((e=>{this.validation_fields=e.field_setting,this.matchFields(t)})).catch((e=>{this.showErrorToast(e)}))}catch(a){}},matchFields(e){this.lookup_fields[e].forEach((e=>{this.validation_fields.find((t=>{t.rows.find((t=>{1==t.length?(this.validation_fields_sorted.includes(t[0])||this.validation_fields_sorted.push(t[0]),t[0].id===e.field_id&&(e.matching_field=t[0]),t[0].id===e.parent_field_id&&(e.parent_field=t[0])):t.length>1&&t.forEach((t=>{this.validation_fields_sorted.includes(t)||this.validation_fields_sorted.push(t),t.id===e.field_id&&(e.matching_field=t),t.id===e.parent_field_id&&(e.parent_field=t)}))}))}))}))},prepareDataforColumns(e,t){this.lookup_fields[e].forEach((e=>{for(const a of this.tableColumnList[t])a.id===e.field_id&&(e.matching_field=a),a.id===e.parent_field_id&&(e.parent_field=a)}))},DeletedConfigConfirmDialog(e,t){this.deleteConfigConfirm=!this.deleteConfigConfirm,this.activeConfigItem={config_id:e,index:t}},DeletedConfirmDialog(e,t,a){this.deleteConfirm=!this.deleteConfirm,this.activeItem={config_id:e,field_id:t,index:a}},convertLabel(e){return(0,M.C5)(e)},async prepareTableList(){this.tables_list=[],this.tables_list.push({value:"",label:this.$t("select_table")});try{let e=await z.p5.getTable(this.docType);if(e.data&&!e.success)throw{message:e.data.message};e.data.forEach((e=>{this.tables_list.push({value:e.table_name,label:e.table_name})}))}catch(e){throw{message:this.$t("pages.messages.error_internal_occur")}}}}}),Gt=(0,ae.A)(Ht,[["render",xt],["__scopeId","data-v-7c10f8ad"]]),Zt=Gt;ge()(Ht,"components",{QList:Ke.A,QExpansionItem:We.A,QBadge:Oe.A,QSpace:Me.A,QBtn:se.A,QMenu:Xe.A,QItem:re.A,QItemSection:ce.A,QSeparator:Pe.A,QCard:ie.A,QCardActions:pe.A,QCardSection:ne.A,QMarkupTable:ze.A,QIcon:Je.A,QDialog:Be.A,QToolbar:le.A,QToolbarTitle:oe.A,QInput:_e.A}),ge()(Ht,"directives",{ClosePopup:me.A});const ea=(0,i.pM)({name:"masfter-data",components:{SubHeader:d.A,LovMasterData:Ye,BackToSettings:r.A,FieldMasterData:Zt},data(){return{}},methods:{}});var ta=a(3952);const aa=(0,ae.A)(ea,[["render",n]]),ia=aa;ge()(ea,"components",{QCardSection:ne.A,QList:Ke.A,QExpansionItem:We.A,QSeparator:Pe.A,QItemSection:ce.A,QAvatar:ta.A,QIcon:Je.A,QCard:ie.A})}}]);