"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[6090],{86090:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$e});var o=i(61758),a=i(58790);const s=e=>((0,o.Qi)("data-v-6de08dac"),e=e(),(0,o.jt)(),e),n={class:"col-12 border-bottom-bdbdbd q-pb-sm"},l={class:"row"},d={class:"col-6 items-center"},c={class:"text-h6 text-bold text-primary flex items-center"},r=s((()=>(0,o.Lk)("img",{src:"images/invoice_details.svg",class:"icon-size"},null,-1))),v={class:"invoice-number-padd"},u={class:"col-6 items-center",style:{"padding-top":"13px"}},h={class:"q-ml-xs q-mr-sm"},_={key:0,class:"col-12 mt-4 q-pa-lg text-blue-grey-5"},p={class:"row mb-4"},k={class:"col-3 text-bold"},m={class:"col-3"},g={class:"col-3 text-bold"},f={class:"col-3 text-uppercase"},b={class:"row mb-4"},L={class:"col-3 text-bold"},y={class:"col-3"},w={class:"col-3 text-bold"},$={class:"col-3 text-uppercase"},P={class:"row mb-4"},x={class:"col-3 text-bold"},A={class:"col-3"},I={class:"col-3 text-bold"},T={class:"col-3"},q={class:"row mb-4"},S={class:"col-3 text-bold"},D={class:"col-3"},F={class:"col-3 text-bold"},C={class:"col-3"},Q={class:"row mb-4"},W={class:"col-3 text-bold"},M={class:"col-3"},X={class:"col-3 text-bold"},j={class:"col-3"},E={class:"row mb-4"},K={class:"col-3 text-bold"},O={class:"col-3"},Y={class:"col-3 text-bold"},z={class:"col-3"},B={class:"col-12 iframe-padding"},R={class:"mx-12 q-card mt-10"},V=["src"],Z=s((()=>(0,o.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1)));function H(e,t,i,s,H,N){const G=(0,o.g2)("SubHeader"),J=(0,o.g2)("BackToSettings"),U=(0,o.g2)("q-icon"),ee=(0,o.g2)("q-tooltip"),te=(0,o.g2)("f-btn"),ie=(0,o.g2)("q-badge"),oe=(0,o.g2)("q-skeleton"),ae=(0,o.g2)("q-card-actions"),se=(0,o.g2)("q-card"),ne=(0,o.g2)("q-inner-loading");return(0,o.uX)(),(0,o.CE)(o.FK,null,[e.$route.fullPath.includes("/share")?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(G,{key:0,name:"invoice dashboard",label:e.$t("invoices"),back_to_link:"/invoice/dashboard"},null,8,["label"])),e.$route.fullPath.includes("/share")?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(J,{key:1,label:e.$t("invoices"),back_to_rotue:"/invoice/dashboard"},null,8,["label"])),(0,o.Lk)("div",{class:(0,a.C4)(["row q-px-lg q-pb-lg",e.$route.fullPath.includes("/share")?"share-content":"invoice-content"])},[(0,o.bF)(se,{class:"col-12 container-padding"},{default:(0,o.k6)((()=>[(0,o.bF)(ae,{class:"row"},{default:(0,o.k6)((()=>{var t,i,s,Z,H,N,G,J,ae,se,ne,le,de,ce,re;return[(0,o.Lk)("div",n,[(0,o.Lk)("div",l,[(0,o.Lk)("div",d,[(0,o.Lk)("div",c,[r,(0,o.Lk)("span",v,(0,a.v_)(e.$t("invoice"))+" #"+(0,a.v_)(null===(t=e.invoice_details)||void 0===t?void 0:t.alternate_document_id),1)])]),(0,o.Lk)("div",u,[(0,o.bF)(te,{class:"float-right",onClick:e.shareLinkInvoice},{default:(0,o.k6)((()=>[(0,o.bF)(U,{name:e.mdiShare},null,8,["name"]),(0,o.Lk)("span",h,(0,a.v_)(e.$t("share")),1),(0,o.bF)(ee,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("copy_public_url")),1)])),_:1})])),_:1},8,["onClick"])])])]),e.invoice_details?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.Lk)("div",p,[(0,o.Lk)("div",k,(0,a.v_)(e.$t("invoice_number"))+" :",1),(0,o.Lk)("div",m,(0,a.v_)(null===(i=e.invoice_details)||void 0===i?void 0:i.alternate_document_id),1),(0,o.Lk)("div",g,(0,a.v_)(e.$t("status"))+" :",1),(0,o.Lk)("div",f,[(null===(s=e.invoice_details)||void 0===s?void 0:s.status)?((0,o.uX)(),(0,o.Wv)(ie,{key:0,transparent:"",align:"middle",color:e.statusColor(null===(Z=e.invoice_details)||void 0===Z?void 0:Z.status)},{default:(0,o.k6)((()=>{var t;return[(0,o.eW)((0,a.v_)(null===(t=e.invoice_details)||void 0===t?void 0:t.status),1)]})),_:1},8,["color"])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",b,[(0,o.Lk)("div",L,(0,a.v_)(e.$t("supplier_name"))+" :",1),(0,o.Lk)("div",y,(0,a.v_)(null===(H=e.invoice_details)||void 0===H?void 0:H.supplier_name),1),(0,o.Lk)("div",w,(0,a.v_)(e.$t("paid_status"))+" :",1),(0,o.Lk)("div",$,[(0,o.bF)(ie,{transparent:"",align:"middle",color:e.statusColor(null!==(G=null===(N=e.invoice_details)||void 0===N?void 0:N.paid_status)&&void 0!==G?G:"Open")},{default:(0,o.k6)((()=>{var t,i;return[(0,o.eW)((0,a.v_)((null===(t=e.invoice_details)||void 0===t?void 0:t.paid_status)?null===(i=e.invoice_details)||void 0===i?void 0:i.paid_status:"Open"),1)]})),_:1},8,["color"])])]),(0,o.Lk)("div",P,[(0,o.Lk)("div",x,(0,a.v_)(e.$t("total_amount"))+" :",1),(0,o.Lk)("div",A,(0,a.v_)(null===(J=e.invoice_details)||void 0===J?void 0:J.extended_amount),1),(0,o.Lk)("div",I,(0,a.v_)(e.$t("invoice_details_date"))+" :",1),(0,o.Lk)("div",T,(0,a.v_)(e.formatDateTimeZone(null===(ae=e.invoice_details)||void 0===ae?void 0:ae.invoice_date,!0)),1)]),(0,o.Lk)("div",q,[(0,o.Lk)("div",S,(0,a.v_)(e.$t("purchase_order"))+"# :",1),(0,o.Lk)("div",D,(0,a.v_)(null===(se=e.invoice_details)||void 0===se?void 0:se.purchase_order_number),1),(0,o.Lk)("div",F,(0,a.v_)(e.$t("invoice_due_date"))+" :",1),(0,o.Lk)("div",C,(0,a.v_)(e.formatDateTimeZone(null===(ne=e.invoice_details)||void 0===ne?void 0:ne.invoice_due_date,!0)),1)]),(0,o.Lk)("div",Q,[(0,o.Lk)("div",W,(0,a.v_)(e.$t("discount_term"))+" :",1),(0,o.Lk)("div",M,(0,a.v_)(null===(le=e.invoice_details)||void 0===le?void 0:le.discount_term),1),(0,o.Lk)("div",X,(0,a.v_)(e.$t("payment_method"))+" :",1),(0,o.Lk)("div",j,(0,a.v_)(e.showPaymentMethodLabel(null===(de=e.invoice_details)||void 0===de?void 0:de.payment_method)),1)]),(0,o.Lk)("div",E,[(0,o.Lk)("div",K,(0,a.v_)(e.$t("electronic_payment"))+"# :",1),(0,o.Lk)("div",O,(0,a.v_)(e.displayLastSixDigits(null===(ce=e.invoice_details)||void 0===ce?void 0:ce.electronic_payment_number)),1),(0,o.Lk)("div",Y,(0,a.v_)(e.$t("payment_date"))+" :",1),(0,o.Lk)("div",z,(0,a.v_)(e.formatDateTimeZone(null===(re=e.invoice_details)||void 0===re?void 0:re.payment_date,!0)),1)])])):(0,o.Q3)("",!0),(0,o.Lk)("div",B,[(0,o.Lk)("div",R,[e.skeletonLoad?((0,o.uX)(),(0,o.Wv)(oe,{key:1,style:{width:"100%"},animated:!1,width:"100%",height:"700px",class:"custom-skeleton"})):((0,o.uX)(),(0,o.CE)("iframe",{key:0,id:"preview_frame",src:e.iframe_path,title:"file preview",width:"100%",height:"700px"},null,8,V))])])]})),_:1})])),_:1})],2),(0,o.bF)(ne,{showing:e.loading,style:{"z-index":"2"}},{default:(0,o.k6)((()=>[Z])),_:1},8,["showing"])],64)}var N=i(38734),G=i(95488),J=i(60894),U=i(94124),ee=i(1659),te=i(62488),ie=i(43437),oe=i(78652),ae=i(24622),se=i(64775),ne=i(68450),le=i(46162),de=i(82303),ce=i(46736),re=i(18698),ve=function(e,t,i,o){function a(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function n(e){try{d(o.next(e))}catch(t){s(t)}}function l(e){try{d(o["throw"](e))}catch(t){s(t)}}function d(e){e.done?i(e.value):a(e.value).then(n,l)}d((o=o.apply(e,t||[])).next())}))};const ue=(0,o.pM)({mixins:[ae.A,ce.A],components:{SubHeader:G.A,BackToSettings:J.A},mounted(){this.init()},methods:{init(){return ve(this,void 0,void 0,(function*(){yield this.getDetails()}))},getDetails(){var e;return ve(this,void 0,void 0,(function*(){try{this.preview_path="",this.loading=!0;const i=this.$route.params.id;if(this.id=i,this.$route.fullPath.includes("/share")&&this.$route.query.token){this.token=this.$route.query.token;try{const t=yield de.A.get(`${le.VA}/supplier_invoice/share/get_details?token=${this.token}`);t&&(this.invoice_details=null===(e=null===t||void 0===t?void 0:t.data)||void 0===e?void 0:e.data),this.getPreviewSharePath(this.token)}catch(t){}}else i&&(yield this.getInvoiceDetails(i)),yield this.getPreviewPathInvoice()}catch(t){}finally{this.loading=!1}}))},getPreviewSharePath(e){return ve(this,void 0,void 0,(function*(){try{const i=this.invoice_details.preview_path;if((0,ne.z)(i)&&(0,ne.jw)(i))return;try{this.skeletonLoad=!0;const t=this.invoice_details.alternate_document_id,o=yield de.A.get(`${le.VA}/resource/get_file/${t}?path=${i}&download=false&token=${e}`,{responseType:"blob"});if("application/json"==o.headers["content-type"])return setTimeout((()=>{this.getInvoicePdfFile()}),5e3);const a=o.config.url;this.iframe_path=a}catch(t){}finally{this.skeletonLoad=!1}}catch(t){}}))},getPreviewPathInvoice(){return ve(this,void 0,void 0,(function*(){try{if(!(0,ne.z)(this.preview_path)&&!(0,ne.jw)(this.preview_path))return void this.getInvoicePdfFile();try{this.skeletonLoad=!0;const e=this.$route.params.id;e&&(yield this.getPreviewPath(e),yield this.getInvoicePdfFile())}catch(e){}finally{this.skeletonLoad=!1}}catch(e){const t=se.t.getErrorMessage(e),i=document.getElementById("preview_frame"),o=i.contentDocument;o&&(o.write("<h1>Error</h1><p>Oops!  "+t+".</p>"),o.close())}}))},getInvoicePdfFile(){return ve(this,void 0,void 0,(function*(){try{if((0,ne.z)(this.preview_path)||(0,ne.jw)(this.preview_path))return;const t=(0,U._6)();yield t.getTokenQueryParam();const{tokenQueryParam:i}=t;try{this.skeletonLoad=!0;const e=yield de.A.get(`${le.VA}/resource/get_file/${this.invoice_id_path}?path=${this.preview_path}&download=false&${i}`,{responseType:"blob"});if("application/json"==e.headers["content-type"])return setTimeout((()=>{this.getInvoicePdfFile()}),5e3);const t=e.config.url;this.iframe_path=t}catch(e){}finally{this.skeletonLoad=!1}}catch(t){}}))},statusColor(e){return e?(0,te.qY)(e.toLowerCase())||"primary":""},shareLinkInvoice(){return ve(this,void 0,void 0,(function*(){const e=this.$route.fullPath;if(e.includes("/share"))this.shareLink=window.location,(0,oe.A)(this.shareLink).then((()=>{this.showSuccessToast(this.$t("copy_to_clipboard"))}));else try{if(this.id){let e=yield this.getInvoiceShareToken(this.id);if(e){const t=window.location.origin;this.shareLink=`${t}/supplier_invoice/share/get_details?token=${e}`,(0,oe.A)(this.shareLink).then((()=>{this.showSuccessToast(this.$t("copy_to_clipboard"))}))}return}}catch(t){}}))},displayLastSixDigits(e){let t;return t=e&&e.length>6?e.slice(-6):e,t},formatDate(e){return e?ce.A.methods.formatDateWithPattern(e,"DD.MM.YYYY"):""},showPaymentMethodLabel(e){let t;const i=re.paymentMtdAPOptions.find((t=>t.value===e));return t=i?i.label:"",t}},data(){return{shareLink:(0,N.KR)(""),skeletonLoad:(0,N.KR)(!1),iframe_path:(0,N.KR)(""),id:(0,N.KR)(""),token:(0,N.KR)("")}},setup(){const e=(0,U.LN)(),{loading:t,invoice_details:i,preview_path:o,invoice_id_path:a}=(0,ee.bP)(e),{getInvoiceDetails:s,getPreviewPath:n,getInvoiceShareToken:l}=e,d=(0,U.Bu)(),{datePattern:c,dateFormatOnly:r}=d;return{loading:t,invoice_details:i,preview_path:o,invoice_id_path:a,getInvoiceDetails:s,datePattern:c,dateFormatOnly:r,getPreviewPath:n,getInvoiceShareToken:l,mdiShare:ie.YuT}}});var he=i(12807),_e=i(23316),pe=i(62669),ke=i(50492),me=i(97410),ge=i(23954),fe=i(43820),be=i(39035),Le=i(98582),ye=i.n(Le);const we=(0,he.A)(ue,[["render",H],["__scopeId","data-v-6de08dac"]]),$e=we;ye()(ue,"components",{QCard:_e.A,QCardActions:pe.A,QIcon:ke.A,QTooltip:me.A,QBadge:ge.A,QSkeleton:fe.Ay,QInnerLoading:be.A})}}]);