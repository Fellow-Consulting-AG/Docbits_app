"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[5842],{45842:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ke});var i=s(83673),o=s(62323),r=s(98880);const l={class:"container no-padding back highlighted-back"},a={class:"secondary-c-text text-h6 q-pt-md q-pb-md"},n=(0,i._)("img",{width:"24",src:"back_new.svg"},null,-1),d={style:{"vertical-align":"middle","margin-left":"10px","font-size":"20px",cursor:"pointer"}},u={class:"q-ml-auto q-mr-lg"},c={class:"container"},m={class:"full-width"},p=["onClick"],_={class:"q-ml-sm"},h={class:"text-weight-bold"},g={class:"table-container col-sm-12 col-md-12 col-lg-12 min-height-300"},w=(0,i._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function f(e,t,s,f,b,y){const v=(0,i.up)("SubHeader"),U=(0,i.up)("q-icon"),C=(0,i.up)("q-btn"),q=(0,i.up)("q-td"),O=(0,i.up)("q-table"),W=(0,i.up)("q-avatar"),Z=(0,i.up)("q-card-section"),R=(0,i.up)("q-card-actions"),k=(0,i.up)("q-card"),T=(0,i.up)("q-dialog"),x=(0,i.up)("Create"),E=(0,i.up)("q-toolbar-title"),L=(0,i.up)("q-toolbar"),Q=(0,i.up)("UsersList"),S=(0,i.up)("q-inner-loading"),N=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(v,{name:"sub_organizations",label:e.$t("sub_organizations"),display_help_link:!1},null,8,["label"]),(0,i._)("div",l,[(0,i._)("div",a,[(0,i.Wm)(C,{flat:"",rounded:"",color:"primary",to:"/settings"},{default:(0,i.w5)((()=>[(0,i.Wm)(U,{class:"text-red-13",size:"sm"},{default:(0,i.w5)((()=>[n])),_:1}),(0,i._)("label",d,(0,o.zw)(e.$t("layout.settings")),1)])),_:1})]),(0,i._)("div",u,[(0,i.Wm)(C,{color:"primary",class:"float-right",icon:"add",label:e.$t("new"),onClick:t[0]||(t[0]=t=>e.display_create_dialog=!0)},null,8,["label"])])]),(0,i._)("div",c,[(0,i._)("div",m,[(0,i.Wm)(O,{class:"",rows:e.rows,"no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),columns:e.columns,"row-key":"name",flat:"",bordered:"","table-header-class":"text-uppercase","rows-per-page-options":[0]},{"body-cell-name":(0,i.w5)((e=>[(0,i.Wm)(q,{props:e},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.row.name),1)])),_:2},1032,["props"])])),"body-cell-action":(0,i.w5)((t=>[(0,i.Wm)(q,{props:t},{default:(0,i.w5)((()=>[(0,i.Wm)(C,{outline:"",color:"primary",label:e.$t("pages.settings.manage_users"),class:"q-mr-sm",onClick:s=>e.manageUsers(t.row)},null,8,["label","onClick"]),(0,i.Wm)(C,{flat:"",color:"primary",class:""},{default:(0,i.w5)((()=>[(0,i._)("img",{class:"img-fluid mb-14 black_to_white",width:"30",height:"30",src:"trash-bin-default.svg",alt:"",onClick:s=>{e.delete_id=t.row.id,e.delete_confirm=!0}},null,8,p)])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,i.w5)((()=>[])),_:1},8,["rows","no-data-label","columns"])])]),(0,i.Wm)(T,{modelValue:e.delete_confirm,"onUpdate:modelValue":t[2]||(t[2]=t=>e.delete_confirm=t),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{icon:"warning",color:"primary"})])),_:1}),(0,i.Wm)(Z,{class:"row items-center"},{default:(0,i.w5)((()=>[(0,i._)("span",_,(0,o.zw)(e.$t("pages.messages.MSG_DELETE")),1)])),_:1}),(0,i.Wm)(R,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(C,{flat:"",label:e.$t("pages.user.cancel"),color:"primary"},null,8,["label"]),[[N]]),(0,i.wy)((0,i.Wm)(C,{flat:"",label:e.$t("pages.user.done"),color:"primary",onClick:t[1]||(t[1]=t=>e.deleteRow())},null,8,["label"]),[[N]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.Wm)(T,{modelValue:e.display_create_dialog,"onUpdate:modelValue":t[3]||(t[3]=t=>e.display_create_dialog=t),persistent:"",onKeydown:t[4]||(t[4]=(0,r.D2)((t=>e.display_create_dialog=!1),["esc"]))},{default:(0,i.w5)((()=>[(0,i.Wm)(x)])),_:1},8,["modelValue"]),(0,i.Wm)(T,{modelValue:e.display_users_dialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.display_users_dialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[6]||(t[6]=(0,r.D2)((t=>e.display_users_dialog=!1),["esc"]))},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{style:{width:"700px","max-width":"1060px",height:"600px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(L,{class:"secondary-toolbar"},{default:(0,i.w5)((()=>[(0,i.Wm)(E,null,{default:(0,i.w5)((()=>[(0,i._)("span",h,(0,o.zw)(e.selectedName)+" "+(0,o.zw)(e.$t("users")),1)])),_:1}),(0,i.wy)((0,i.Wm)(C,{flat:"",round:"",dense:"",icon:"close"},null,512),[[N]])])),_:1}),(0,i.Wm)(Z,{class:"row items-center q-pb-none"}),(0,i.Wm)(Z,null,{default:(0,i.w5)((()=>[(0,i._)("div",g,[(0,i.Wm)(Q,{sub_org_id:e.selectedId},null,8,["sub_org_id"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.Wm)(S,{showing:e.processing},{default:(0,i.w5)((()=>[w])),_:1},8,["showing"])],64)}var b=s(77378),y=s(61959);const v={class:"text-weight-bold"},U={style:{"margin-bottom":"20px"},class:"row full-width mb-10 mt-8"},C={class:"full-width"},q={class:"row full-width mb-10 mt-8",style:{"margin-bottom":"20px"}},O={class:"full-width"},W=(0,i._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function Z(e,t,s,l,a,n){const d=(0,i.up)("q-toolbar-title"),u=(0,i.up)("q-btn"),c=(0,i.up)("q-toolbar"),m=(0,i.up)("q-tooltip"),p=(0,i.up)("q-icon"),_=(0,i.up)("q-input"),h=(0,i.up)("q-card-section"),g=(0,i.up)("q-card-actions"),w=(0,i.up)("q-inner-loading"),f=(0,i.up)("q-card"),b=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(f,{style:{width:"600px"}},{default:(0,i.w5)((()=>[(0,i._)("form",{onSubmit:t[2]||(t[2]=(0,r.iM)(((...t)=>e.submitNewColumFrom&&e.submitNewColumFrom(...t)),["prevent","stop"]))},[(0,i.Wm)(c,{class:"text-white secondary-toolbar"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i._)("span",v,(0,o.zw)(e.$t("create_sub_org")),1)])),_:1}),(0,i.wy)((0,i.Wm)(u,{flat:"",round:"",dense:"",icon:"close"},null,512),[[b]])])),_:1}),(0,i.Wm)(h,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i._)("div",U,[(0,i._)("div",C,[(0,i.Wm)(_,{outlined:"",tabindex:"0",class:(0,o.C_)("full-width "+(!e.new_model["validate"]||e.new_model["required_error"]?"column-error-border":"")),modelValue:e.new_model["name"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.new_model["name"]=t),label:e.$t("field_name"),hint:e.message},{append:(0,i.w5)((()=>[!e.new_model["validate"]||e.new_model["required_error"]?((0,i.wg)(),(0,i.j4)(p,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{class:"bg-red line-error-tooltip"},{default:(0,i.w5)((()=>[e.new_model["validate"]?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Uk)((0,o.zw)(e.message),1)],64)),e.new_model["required_error"]?((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Uk)((0,o.zw)(e.$t("field_required")),1)],64)):(0,i.kq)("",!0)])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1},8,["class","modelValue","label","hint"])])]),(0,i._)("div",q,[(0,i._)("div",O,[(0,i.Wm)(_,{modelValue:e.new_model["description"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.new_model["description"]=t),outlined:"",type:"textarea",autogrow:"",label:e.$t("description")},null,8,["modelValue","label"])])])])),_:1}),(0,i.Wm)(g,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(u,{class:"highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[b]]),(0,i.Wm)(u,{type:"submit",color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,i.Wm)(w,{showing:e.loading},{default:(0,i.w5)((()=>[W])),_:1},8,["showing"])])),_:1})}var R=s(29938),k=s(80579),T=function(e,t,s,i){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function l(e){try{n(i.next(e))}catch(t){r(t)}}function a(e){try{n(i["throw"](e))}catch(t){r(t)}}function n(e){e.done?s(e.value):o(e.value).then(l,a)}n((i=i.apply(e,t||[])).next())}))};const x=(0,i.aZ)({el:"#app",mixins:[b.Z],props:{},components:{},data(){return{message:this.$t("only_characters")}},setup(){let e={};return{new_model:(0,y.iH)(e),loading:(0,y.iH)(!1)}},watch:{},mounted(){this.setNewModel()},methods:{setNewModel(){this.new_model["name"]="",this.new_model["description"]="",this.new_model["validate"]=!0,this.new_model["required_error"]=!1},submitNewColumFrom(){return T(this,void 0,void 0,(function*(){try{if(!this.validateRow(this.new_model))return;this.loading=!0,yield this.saveNewRow()}catch(e){return null!=e&&"object"==typeof e&&e.hasOwnProperty("message")?void this.showErrorToast(e.message):void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},saveNewRow(){return T(this,void 0,void 0,(function*(){const e={name:this.new_model["name"],description:this.new_model["description"]},t=yield k.pm.create(e);if(!t.id)throw new Error("Failed to create new record");this.setNewModel();const s=new CustomEvent("row_added",{detail:t});document.dispatchEvent(s),this.showSuccessToast("Record Created successfully")}))},validateRow(e){let t=!0;return e["name"]&&0!=e["name"].length?(0,R.mf)(e["name"])?t:(e.validate=!1,!1):(e.required_error=!0,!1)}}});var E=s(74260),L=s(10151),Q=s(39570),S=s(13747),N=s(2165),$=s(25589),V=s(64689),H=s(24554),I=s(5363),z=s(99367),D=s(66941),A=s(60677),j=s(7518),F=s.n(j);const M=(0,E.Z)(x,[["render",Z]]),P=M;F()(x,"components",{QCard:L.Z,QToolbar:Q.Z,QToolbarTitle:S.Z,QBtn:N.Z,QCardSection:$.Z,QInput:V.Z,QIcon:H.Z,QTooltip:I.Z,QCardActions:z.Z,QInnerLoading:D.Z}),F()(x,"directives",{ClosePopup:A.Z});const Y=(0,i._)("img",{class:"img-fluid mb-14 black_to_white",width:"24",height:"24",src:"trash-bin-default.svg",alt:""},null,-1),J=(0,i._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function B(e,t,s,l,a,n){const d=(0,i.up)("q-icon"),u=(0,i.up)("q-input"),c=(0,i.up)("q-space"),m=(0,i.up)("q-btn"),p=(0,i.up)("q-td"),_=(0,i.up)("q-tr"),h=(0,i.up)("q-table"),g=(0,i.up)("AddUser"),w=(0,i.up)("q-dialog"),f=(0,i.up)("q-inner-loading");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(h,{class:"sticky-header-table",style:(0,o.j5)({height:e.table_height+"px"}),rows:e.rows,"no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),columns:e.columns,"rows-per-page-options":[0],"row-key":"id",filter:e.filter,loading:e.loading},{top:(0,i.w5)((()=>[(0,i.Wm)(u,{outlined:"",debounce:"300",color:"primary",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t),dense:""},{append:(0,i.w5)((()=>[(0,i.Wm)(d,{name:"search"})])),_:1},8,["modelValue"]),(0,i.Wm)(c),(0,i.Wm)(m,{color:"primary",label:e.$t("pages.user.add_user"),style:{height:"40px"},onClick:t[1]||(t[1]=t=>e.openUserDlg())},null,8,["label"])])),body:(0,i.w5)((t=>[(0,i.Wm)(_,{props:t,id:t.key},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.cols,(s=>((0,i.wg)(),(0,i.iD)(i.HY,{key:s.name},["action"===s.name?((0,i.wg)(),(0,i.j4)(p,{key:0,style:{width:"30%"}},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{size:"18px",class:"float-right","no-caps":"",flat:"",dense:"",onClick:s=>e.removeUser(t.row.id)},{default:(0,i.w5)((()=>[Y])),_:2},1032,["onClick"])])),_:2},1024)):(0,i.kq)("",!0),"user_name"===s.name?((0,i.wg)(),(0,i.j4)(p,{key:1,style:{width:"70%"}},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(t.row.user_name),1)])),_:2},1024)):(0,i.kq)("",!0)],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["style","rows","no-data-label","columns","filter","loading"]),(0,i.Wm)(w,{modelValue:e.add_users_dialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.add_users_dialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[3]||(t[3]=(0,r.D2)((t=>e.add_users_dialog=!1),["esc"]))},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{sub_org_id:e.sub_org_id},null,8,["sub_org_id"])])),_:1},8,["modelValue"]),(0,i.Wm)(f,{showing:e.processing||e.user_list_loading},{default:(0,i.w5)((()=>[J])),_:1},8,["showing"])],64)}var K=s(72113),G=s(60727),X=s(45401),ee=s(10321);const te={class:"text-weight-bold"},se={class:"table-container col-sm-12 col-md-12 col-lg-12"},ie={class:"table-container col-sm-12 col-md-12 col-lg-12"};function oe(e,t,s,r,l,a){const n=(0,i.up)("q-toolbar-title"),d=(0,i.up)("q-btn"),u=(0,i.up)("q-toolbar"),c=(0,i.up)("q-card-section"),m=(0,i.up)("q-item-section"),p=(0,i.up)("q-item"),_=(0,i.up)("q-select"),h=(0,i.up)("q-checkbox"),g=(0,i.up)("q-card-actions"),w=(0,i.up)("q-card"),f=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(w,{style:{width:"700px","max-width":"1060px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{class:"text-white secondary-toolbar"},{default:(0,i.w5)((()=>[(0,i.Wm)(n,null,{default:(0,i.w5)((()=>[(0,i._)("span",te,(0,o.zw)(e.$t("pages.user.add_user")),1)])),_:1}),(0,i.wy)((0,i.Wm)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[f]])])),_:1}),(0,i.Wm)(c,{class:"row items-center q-pb-none"}),(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i._)("div",se,[(0,i.Wm)(_,{outlined:"",loading:e.user_list_loading,modelValue:e.selected_user_id,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selected_user_id=t),options:e.filterUsersList,"use-input":"","emit-value":"","map-options":"",onFilter:e.filterUserbykeyword,label:e.$t("select_user")},{"no-option":(0,i.w5)((()=>[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,{class:"text-grey"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:1},8,["loading","modelValue","options","onFilter","label"])])])),_:1}),(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i._)("div",ie,[(0,i.Wm)(h,{label:e.$t("remove_from_other_groups"),modelValue:e.remove_from_others,"onUpdate:modelValue":t[1]||(t[1]=t=>e.remove_from_others=t),size:"50px",color:"grey-6"},null,8,["label","modelValue"])])])),_:1}),(0,i.Wm)(g,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(d,{class:"highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[f]]),(0,i.Wm)(d,{onClick:t[2]||(t[2]=t=>e.addUserToSubOrg()),color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})])),_:1})}var re=function(e,t,s,i){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function l(e){try{n(i.next(e))}catch(t){r(t)}}function a(e){try{n(i["throw"](e))}catch(t){r(t)}}function n(e){e.done?s(e.value):o(e.value).then(l,a)}n((i=i.apply(e,t||[])).next())}))};const le=(0,i.aZ)({el:"#app",mixins:[b.Z,X.Z],props:{sub_org_id:{type:String,default:""}},components:{},data(){return{}},setup(){const e=(0,G.At)(),{user_list_loading:t,usersList:s}=(0,ee.Jk)(e),i=(0,y.iH)(e.usersList);return{filterUsersList:i,usersList:s,remove_from_others:(0,y.iH)(!1),selected_user_id:(0,y.iH)(""),user_list_loading:t}},methods:{addUserToSubOrg(){return re(this,void 0,void 0,(function*(){if(this.selected_user_id){this.showLoading();try{const e={sub_org_id:this.sub_org_id,user_id:String(this.selected_user_id),remove_from_others:String(this.remove_from_others)},t=yield k.pm.addUserToSubOrg(e);if(!1===t.success)return void this.showErrorToast(t.message);this.dispatchEvents(),this.showSuccessToast("Record Created successfully"),this.selected_user_id=""}catch(e){if(e.message)return void this.showErrorToast(e.message);this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}else this.showErrorToast(this.$t("select_user"))}))},dispatchEvents(){const e=new CustomEvent("user_added",{detail:this.selected_user_id});document.dispatchEvent(e);const t=new CustomEvent("update_current_user_orgs",{detail:this.selected_user_id});document.dispatchEvent(t)},filterUserbykeyword(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.filterUsersList=this.usersList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}:()=>{this.filterUsersList=this.usersList})}}});var ae=s(72448),ne=s(83414),de=s(52035),ue=s(65735);const ce=(0,E.Z)(le,[["render",oe]]),me=ce;F()(le,"components",{QCard:L.Z,QToolbar:Q.Z,QToolbarTitle:S.Z,QBtn:N.Z,QCardSection:$.Z,QSelect:ae.Z,QItem:ne.Z,QItemSection:de.Z,QCheckbox:ue.Z,QCardActions:z.Z}),F()(le,"directives",{ClosePopup:A.Z});var pe=function(e,t,s,i){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function l(e){try{n(i.next(e))}catch(t){r(t)}}function a(e){try{n(i["throw"](e))}catch(t){r(t)}}function n(e){e.done?s(e.value):o(e.value).then(l,a)}n((i=i.apply(e,t||[])).next())}))};const _e=(0,i.aZ)({mixins:[X.Z,b.Z,K.Z],components:{AddUser:me},props:{sub_org_id:{type:String,default:""}},data(){return{}},mounted:function(){this.init(),document.addEventListener("user_added",this.userAdded)},methods:{init(){return pe(this,void 0,void 0,(function*(){try{this.processing=!0,yield this.prepareTableData(),yield this.prepareUsersDropdown()}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}}))},userAdded(e){e&&e.detail&&(this.add_users_dialog=!1,this.addNewUserToListView(e.detail))},addNewUserToListView(e){const t=JSON.parse(JSON.stringify(this.usersMap.get(e)));t["user_name"]=t.first_name+" "+t.last_name,this.rows.push(t)},prepareTableData(){return pe(this,void 0,void 0,(function*(){yield this.getGroupUsers(),this.prepareTableColumns(),this.prepareTableRows()}))},getGroupUsers(){return pe(this,void 0,void 0,(function*(){let e=null;this.processing=!0;try{if(e=yield k.pm.getSubOrgUsers(this.sub_org_id),!e)throw e;this.sub_org_users=e}catch(t){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}}))},prepareTableColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"user_name",label:this.$t("name"),field:"name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareTableRows(){this.rows=[];for(let e of this.sub_org_users)e["user_name"]=e.first_name+" "+e.last_name;this.rows=this.sub_org_users},removeUser(e){return pe(this,void 0,void 0,(function*(){this.processing=!0;try{yield k.pm.deleteUserFromSubOrg(this.sub_org_id,String(e));this.removeUserFromListView(e);const t=new CustomEvent("sub_org_user_removed",{detail:{user_id:e,sub_org_id:this.sub_org_id}});document.dispatchEvent(t),this.showSuccessToast(this.$t("user_removed_from_group"))}catch(t){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}}))},removeUserFromListView(e){const t=this.rows.findIndex((t=>t.id===e));-1!==t&&this.rows.splice(t,1)},openUserDlg(){this.add_users_dialog=!0}},setup(){const e=(0,y.iH)("");let t=[];const s=(0,y.iH)(t),i=(0,G.At)(),{usersMap:o,user_list_loading:r}=(0,ee.Jk)(i),{prepareUsersDropdown:l}=i;return{user_list_loading:r,prepareUsersDropdown:l,filter:e,columns:s,usersMap:o,rows:(0,y.iH)(t),loading:(0,y.iH)(!1),sub_org_users:(0,y.iH)([]),add_users_dialog:(0,y.iH)(!1),processing:(0,y.iH)(!1)}}});var he=s(17132),ge=s(62025),we=s(18186),fe=s(83884),be=s(46778);const ye=(0,E.Z)(_e,[["render",B]]),ve=ye;F()(_e,"components",{QTable:he.Z,QInput:V.Z,QIcon:H.Z,QSpace:ge.Z,QBtn:N.Z,QTr:we.Z,QTd:fe.Z,QDialog:be.Z,QInnerLoading:D.Z});var Ue=s(13873),Ce=s(63230),qe=s(91949),Oe=function(e,t,s,i){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function l(e){try{n(i.next(e))}catch(t){r(t)}}function a(e){try{n(i["throw"](e))}catch(t){r(t)}}function n(e){e.done?s(e.value):o(e.value).then(l,a)}n((i=i.apply(e,t||[])).next())}))};const We=(0,i.aZ)({el:"#app",mixins:[b.Z],components:{SubHeader:Ue.Z,Create:P,UsersList:ve},data(){return{dialog:!1,current_user_id:""}},mounted(){this.initView(),document.addEventListener("row_added",this.rowAdded),document.addEventListener("update_current_user_orgs",this.updateCurrentUserOrganizations),document.addEventListener("sub_org_user_removed",this.subOrgUserRemoved)},methods:{initView(){return Oe(this,void 0,void 0,(function*(){try{this.processing=!0,yield this.getList(),this.prepareColumns(),this.current_user_id=(0,qe.Y4)("id"),yield this.getSubOrgId()}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}}))},rowAdded(e){e&&e.detail&&(this.display_create_dialog=!1,this.addNewRow(e.detail),this.resetSubOrgsList())},deleteRow(){return Oe(this,void 0,void 0,(function*(){try{if(!this.delete_id)return;this.processing=!0,yield k.pm["delete"](this.delete_id);let e=-1;this.rows.forEach(((t,s)=>{t["id"]===this.delete_id&&(e=s)})),-1!==e&&delete this.rows[e],yield this.updateCurrentUserSubOrgs(this.delete_id),yield this.resetSubOrgsList(),this.delete_id=""}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}}))},getList(){return Oe(this,void 0,void 0,(function*(){const e=yield k.pm.getAll();this.prepareRows(e)}))},prepareColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"name",label:"Name",field:"name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareRows(e){if(e){this.rows=[];for(let[t,s]of Object.entries(e)){const e=s;this.addNewRow(e)}}},addNewRow(e){let t=Object.assign({},e);return this.rows.push(t),this.rows.length.toString()},manageUsers(e){this.selectedId=e.id,this.selectedName=e.name,this.display_users_dialog=!0},updateCurrentUserSubOrgs(e){return Oe(this,void 0,void 0,(function*(){const t=e===this.sub_org_id;if(t&&(Ce.r.setSubOrgId(""),yield this.refreshUserOrganizations(),yield this.getSubOrgId()),!t){const t=Ce.r.getSubOrgbyId(e);t&&0!==Object.keys(t).length&&(yield this.refreshUserOrganizations())}}))},subOrgUserRemoved(e){e&&e.detail&&e.detail.user_id===this.current_user_id&&this.removeSubOrgFromCurrentUserList(e.detail)},removeSubOrgFromCurrentUserList(e){return Oe(this,void 0,void 0,(function*(){const t=yield this.getSubOrgId();t==e.sub_org_id&&(yield Ce.r.setSubOrgId("")),this.refreshUserOrganizations()}))},updateCurrentUserOrganizations(e){e&&e.detail&&e.detail===this.current_user_id&&this.refreshUserOrganizations()}},setup(){const e=(0,G.LM)(),{getSubOrgId:t,refreshUserOrganizations:s}=e,{sub_org_id:i}=(0,ee.Jk)(e),o=(0,G.At)(),{resetSubOrgsList:r}=o;return{resetSubOrgsList:r,sub_org_id:i,refreshUserOrganizations:s,getSubOrgId:t,display_users_dialog:(0,y.iH)(!1),display_create_dialog:(0,y.iH)(!1),selectedId:(0,y.iH)(""),selectedName:(0,y.iH)(""),columns:(0,y.iH)([]),rows:(0,y.iH)([]),delete_confirm:(0,y.iH)(!1),delete_id:(0,y.iH)(""),processing:(0,y.iH)(!1)}}});var Ze=s(75096);const Re=(0,E.Z)(We,[["render",f]]),ke=Re;F()(We,"components",{QBtn:N.Z,QIcon:H.Z,QTable:he.Z,QTd:fe.Z,QDialog:be.Z,QCard:L.Z,QCardSection:$.Z,QAvatar:Ze.Z,QCardActions:z.Z,QToolbar:Q.Z,QToolbarTitle:S.Z,QInnerLoading:D.Z}),F()(We,"directives",{ClosePopup:A.Z})}}]);