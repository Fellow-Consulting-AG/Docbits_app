"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[8984],{68984:(e,t,s)=>{s.r(t),s.d(t,{default:()=>It});var o=s(61758),a=s(58790);const l=e=>((0,o.Qi)("data-v-30997bb5"),e=e(),(0,o.jt)(),e),i={class:"full-width sub-header mobile-only"},d={class:"row",style:{padding:"10px 12px"}},r={class:"left-side q-mr-auto ml-24"},n={class:"q-mr-auto"},c={class:"cursor-pointer text-caption"},u={key:0,class:"row highlighted-back q-pl-md q-pr-md q-pb-md"},m={key:1,class:"row approval-conatiner"},h={class:"col-xs-12 col-sm-12 col-md-3 col-lg-3 q-pl-sm",id:"left_section",ref:"left_section"},p={class:"full-width scroll-area-height-approval"},_={key:0,class:"back-white q-pa-md gray-border",style:{"border-radius":"5px","margin-right":"8px"}},g={class:"row"},v={class:"q-mr-auto"},f={class:"text-h6 text-weight-bold"},k={class:"panel-right"},b={class:"text-h6 text-weight-bold"},w={class:"row"},y={class:"q-mr-auto ml-30"},L=l((()=>(0,o.Lk)("div",{class:"panel-right"},null,-1))),F={class:"q-pr-sm full-width small-hide"},C={class:"col-xs-12 col-sm-12 col-md-5 col-lg-6 q-pl-sm back-white gray-border",style:{"border-radius":"5px"}},x={class:"full-width q-ma-sm approval-area-height-right scrolle-y"},A={class:"invisible absolute position-absolute"},q={class:"row"},V={class:"q-mr-auto"},$={class:"page-numbers"},S=l((()=>(0,o.Lk)("div",{class:"panel-middle mobile-hide"},null,-1))),I={class:"panel-right mobile-hide"},E={class:"doc-name"},D={class:"full-width approval-area-height-middle"},R={class:"full-width full-height",id:"image_container",style:{position:"relative"}},M={class:"col-sm-12 col-md-4 col-lg-3 q-pl-sm"},Q={class:"full-width q-ma-sm approval-area-height-right scrolle-y"},z={class:"full-width white-inputs"},K={class:"full-width full-height"},P={class:"row"},U={class:"secondary-c-text text-h6 text-weight-bold"},T={class:"full-width"},W={class:"row"},X={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},B={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},N={class:"row full-width"},H={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},O={class:"row full-width"},j={class:"col-xs-6 col-sm-6 col-md-6 col-lg-6"},G={class:"col-xs-6 col-sm-6 col-md-6 col-lg-6 pl-20"},Y={class:"row full-width"},J={class:"col-xs-4 col-sm-4 col-md-4 col-lg-4"},Z={class:"col-xs-4 col-sm-4 col-md-4 col-lg-4 pl-20"},ee={class:"col-xs-4 col-sm-4 col-md-4 col-lg-4 pl-20"},te=l((()=>(0,o.Lk)("div",{class:"border-top-bdbdbd q-mt-md q-mb-md"},null,-1))),se={class:"row full-width"},oe={class:"row full-width"},ae={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},le={class:"row full-width"},ie={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},de={class:"row full-width"},re={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},ne=l((()=>(0,o.Lk)("div",{class:"border-top-bdbdbd q-mt-md q-mb-md"},null,-1))),ce={key:0,class:"row full-width"},ue={class:"row full-width"},me={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},he={class:"row full-width"},pe={class:"row full-width"},_e={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},ge={key:0},ve={key:1},fe={class:"row q-pt-sm"},ke={class:"secondary-c-text text-h6 text-weight-bold"},be=l((()=>(0,o.Lk)("div",{class:"border-top-bdbdbd q-mb-md"},null,-1))),we={class:"row full-width"},ye=l((()=>(0,o.Lk)("div",null,"Comment",-1))),Le={class:"q-pt-none"},Fe={class:"footer-filename"},Ce={class:"footer-status-message"},xe={class:"cursor-pointer"},Ae={class:"footer-status-message"},qe={class:"footer-status-message"},Ve={key:1,class:"row"},$e={class:"row q-ml-sm back-white custom-border",style:{width:"138px"}},Se=["src"],Ie=["src"],Ee={class:"footer-status-message q-px-sm"};function De(e,t,s,l,De,Re){const Me=(0,o.g2)("q-icon"),Qe=(0,o.g2)("BackToSettings"),ze=(0,o.g2)("ErrorDocumentView"),Ke=(0,o.g2)("DocumentLogs"),Pe=(0,o.g2)("q-tooltip"),Ue=(0,o.g2)("AnnotationView"),Te=(0,o.g2)("q-input"),We=(0,o.g2)("f-btn"),Xe=(0,o.g2)("q-btn"),Be=(0,o.g2)("q-page-sticky"),Ne=(0,o.g2)("q-space"),He=(0,o.g2)("q-bar"),Oe=(0,o.g2)("q-card-section"),je=(0,o.g2)("q-card"),Ge=(0,o.g2)("q-dialog"),Ye=(0,o.g2)("Loader"),Je=(0,o.g2)("q-separator"),Ze=(0,o.g2)("q-item-section"),et=(0,o.g2)("q-item"),tt=(0,o.g2)("q-list"),st=(0,o.g2)("q-menu"),ot=(0,o.g2)("q-toolbar"),at=(0,o.g2)("q-footer"),lt=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",i,[(0,o.Lk)("div",d,[(0,o.Lk)("span",r,[(0,o.Lk)("div",n,[(0,o.Lk)("span",{class:"cursor-pointer text-uppercase",onClick:t[0]||(t[0]=(...t)=>e.routeToListPendingApproval&&e.routeToListPendingApproval(...t))},[(0,o.bF)(Me,{class:"cursor-pointer",onClick:e.nextImage,name:"chevron_left",size:"sm"},null,8,["onClick"]),(0,o.eW)(" "+(0,a.v_)(e.$t("pending_approval_list")),1)]),(0,o.Lk)("span",c," - "+(0,a.v_)(e.pending_approval_doc_count)+" "+(0,a.v_)(e.$t("invoices_for_release")),1)])])])]),(0,o.bF)(Qe,{back_to_rotue:"/dashboard",label:"dashboard"}),e.error?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(ze)])):((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",h,[(0,o.Lk)("div",p,[e.isModelReady()?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.Lk)("div",g,[(0,o.Lk)("div",v,[(0,o.Lk)("span",f,[e.prev_record?((0,o.uX)(),(0,o.Wv)(Me,{key:0,class:"cursor-pointer",name:"navigate_before",size:"sm",onClick:t[1]||(t[1]=t=>e.routeTo("prev"))})):(0,o.Q3)("",!0),e.readonlyModel["total_amount"]?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)((0,a.v_)(e.readonlyModel["total_amount"].formatted_value),1)],64)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",k,[(0,o.Lk)("span",b,[e.readonlyModel["invoice_date"]?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,a.v_)(e.readonlyModel["invoice_date"].formatted_value),1)],64)):(0,o.Q3)("",!0),e.next_record?((0,o.uX)(),(0,o.Wv)(Me,{key:1,class:"cursor-pointer",name:"navigate_next",size:"sm",onClick:t[2]||(t[2]=t=>e.routeTo("next"))})):(0,o.Q3)("",!0)])])]),(0,o.Lk)("div",w,[(0,o.Lk)("div",y,[e.readonlyModel["payment_terms"]?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,a.v_)(e.readonlyModel["payment_terms"].formatted_value),1)],64)):(0,o.Q3)("",!0)]),L])])):(0,o.Q3)("",!0),(0,o.Lk)("div",F,[(0,o.bF)(Ke,{docId:e.docId,list_data:e.doc_logs},null,8,["docId","list_data"])])])],512),(0,o.Lk)("div",C,[(0,o.Lk)("div",x,[(0,o.Lk)("div",A,[(0,o.Lk)("div",q,[(0,o.Lk)("div",V,[(0,o.bF)(Me,{class:"up-arrow cursor-pointer",onClick:e.prevImage,name:"expand_less",size:"sm"},{default:(0,o.k6)((()=>[(0,o.bF)(Pe,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("previous")),1)])),_:1})])),_:1},8,["onClick"]),(0,o.bF)(Me,{class:"down-arrow cursor-pointer",onClick:e.nextImage,name:"expand_more",size:"sm"},{default:(0,o.k6)((()=>[(0,o.bF)(Pe,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("next")),1)])),_:1})])),_:1},8,["onClick"]),(0,o.Lk)("span",$,(0,a.v_)(e.currentPage())+"/"+(0,a.v_)(e.images.length)+" "+(0,a.v_)(e.$t("page_number_text")),1)]),S,(0,o.Lk)("div",I,[(0,o.Lk)("span",{class:"cursor-pointer q-mr-md text-uppercase",onClick:t[3]||(t[3]=(...t)=>e.downloadFile&&e.downloadFile(...t))},(0,a.v_)(e.$t("download")),1),(0,o.Lk)("span",E,(0,a.v_)(e.record.filename),1)])])]),(0,o.Lk)("div",D,[(0,o.Lk)("div",R,[(0,o.bF)(Ue,{ref:"child_comp",enableEditing:e.enable_editing,cropUrl:e.image+"?"+this.tokenQueryParam,width:e.imageWidth,screenmode:e.screenmode,selectFont:e.selectFont,selectFontSize:e.selectFontSize,selectColor:e.selectColor,onLoad:e.getImageDetails},null,8,["enableEditing","cropUrl","width","screenmode","selectFont","selectFontSize","selectColor","onLoad"])])])])]),(0,o.Lk)("div",M,[(0,o.Lk)("div",Q,[(0,o.Lk)("div",z,[(0,o.Lk)("div",K,[(0,o.Lk)("div",P,[(0,o.Lk)("span",U,(0,a.v_)(e.$t("auto_detect")),1)]),e.isModelReady()?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("div",T,[(0,o.Lk)("div",W,[(0,o.Lk)("div",X,(0,a.v_)(e.$t("belegtyp")),1),(0,o.Lk)("div",B,[e.record.doc_type?((0,o.uX)(),(0,o.Wv)(Te,{key:0,outlined:"","data-name":e.doc_type,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.record.doc_type,"onUpdate:modelValue":t[4]||(t[4]=t=>e.record.doc_type=t)},null,8,["data-name","modelValue"])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",N,[(0,o.Lk)("div",H,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("payment_terms")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.payment_terms,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.readonlyModel["payment_terms"].formatted_value,"onUpdate:modelValue":t[5]||(t[5]=t=>e.readonlyModel["payment_terms"].formatted_value=t)},null,8,["data-name","modelValue"])])])]),(0,o.Lk)("div",O,[(0,o.Lk)("div",j,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("invoice_date")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.invoice_date,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.readonlyModel["invoice_date"].formatted_value,"onUpdate:modelValue":t[6]||(t[6]=t=>e.readonlyModel["invoice_date"].formatted_value=t)},null,8,["data-name","modelValue"])])]),(0,o.Lk)("div",G,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("order_date")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.order_date,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.readonlyModel["order_date"].formatted_value,"onUpdate:modelValue":t[7]||(t[7]=t=>e.readonlyModel["order_date"].formatted_value=t)},null,8,["data-name","modelValue"])])])]),(0,o.Lk)("div",Y,[(0,o.Lk)("div",J,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("total_amount")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.total_amount,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.readonlyModel["total_amount"].formatted_value,"onUpdate:modelValue":t[8]||(t[8]=t=>e.readonlyModel["total_amount"].formatted_value=t)},null,8,["data-name","modelValue"])])]),(0,o.Lk)("div",Z,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("currency")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.currency,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.readonlyModel["currency"].formatted_value,"onUpdate:modelValue":t[9]||(t[9]=t=>e.readonlyModel["currency"].formatted_value=t)},null,8,["data-name","modelValue"])])]),(0,o.Lk)("div",ee,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("tax_amount")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.tax_amount,disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.readonlyModel["tax_amount"].formatted_value,"onUpdate:modelValue":t[10]||(t[10]=t=>e.readonlyModel["tax_amount"].formatted_value=t)},null,8,["data-name","modelValue"])])])])]),te,(0,o.Lk)("div",se,[(0,o.Lk)("div",oe,[(0,o.Lk)("div",ae,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("notes")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.notes,class:(0,a.C4)("full-width"),modelValue:e.model["notes"],"onUpdate:modelValue":[t[11]||(t[11]=t=>e.model["notes"]=t),t[12]||(t[12]=t=>{e.inputValueChanges("notes",t)})],type:"textarea",autogrow:""},null,8,["data-name","modelValue"])])])]),(0,o.Lk)("div",le,[(0,o.Lk)("div",ie,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("kostenstelle")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.kostenstelle,class:(0,a.C4)("input-field full-width"),modelValue:e.model["kostenstelle"],"onUpdate:modelValue":[t[13]||(t[13]=t=>e.model["kostenstelle"]=t),t[14]||(t[14]=t=>{e.inputValueChanges("kostenstelle",t)})]},null,8,["data-name","modelValue"])])])]),(0,o.Lk)("div",de,[(0,o.Lk)("div",re,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("kostentrager")),1),(0,o.Lk)("div",null,[(0,o.bF)(Te,{outlined:"","data-name":e.kostentrager,class:(0,a.C4)("input-field full-width"),modelValue:e.model["kostentrager"],"onUpdate:modelValue":[t[15]||(t[15]=t=>e.model["kostentrager"]=t),t[16]||(t[16]=t=>{e.inputValueChanges("kostentrager",t)})]},null,8,["data-name","modelValue"])])])])]),ne,e.second_approval&&e.record.first_approver?((0,o.uX)(),(0,o.CE)("div",ce,[(0,o.Lk)("div",ue,[(0,o.Lk)("div",me,[(0,o.Lk)("div",null,(0,a.v_)(e.$t("first_approver")),1),(0,o.Lk)("div",null,[e.record.doc_type?((0,o.uX)(),(0,o.Wv)(Te,{key:0,outlined:"",disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.model["first_approver"],"onUpdate:modelValue":t[17]||(t[17]=t=>e.model["first_approver"]=t)},null,8,["modelValue"])):(0,o.Q3)("",!0)])])])])):(0,o.Q3)("",!0),(0,o.Lk)("div",he,[(0,o.Lk)("div",pe,[(0,o.Lk)("div",_e,[e.second_approval&&e.record.first_approver?((0,o.uX)(),(0,o.CE)("div",ge,(0,a.v_)(e.$t("releases_person")),1)):((0,o.uX)(),(0,o.CE)("div",ve,(0,a.v_)(e.$t("first_approver")),1)),(0,o.Lk)("div",null,[e.record.doc_type?((0,o.uX)(),(0,o.Wv)(Te,{key:0,outlined:"",disable:!0,class:(0,a.C4)("input-field full-width"),modelValue:e.model["assigned_to"],"onUpdate:modelValue":t[18]||(t[18]=t=>e.model["assigned_to"]=t)},null,8,["modelValue"])):(0,o.Q3)("",!0)])])])]),(0,o.Lk)("div",fe,[(0,o.Lk)("span",ke,(0,a.v_)(e.$t("actions")),1)]),be,(0,o.Lk)("div",we,[(0,o.bF)(We,{label:e.$t("save"),class:"full-width q-mb-sm",onClick:e.saveData},null,8,["label","onClick"]),(0,o.bF)(We,{appearance:"secondary",label:e.$t("request_release"),class:"full-width q-mb-sm",onClick:e.acceptRequest},null,8,["label","onClick"]),(0,o.bF)(We,{appearance:"negative-tertiary",label:e.$t("reject"),class:"full-width",onClick:e.rejectRequest},null,8,["label","onClick"])])],64)):(0,o.Q3)("",!0)])])])]),(0,o.bF)(Be,{position:"bottom-right",offset:[8,8],class:"hidden small-only"},{default:(0,o.k6)((()=>[(0,o.bF)(Xe,{fab:"",icon:"chat",color:"primary",padding:"sm",onClick:t[19]||(t[19]=t=>e.chatWindow=!0)})])),_:1})])),(0,o.bF)(Ge,{modelValue:e.chatWindow,"onUpdate:modelValue":t[20]||(t[20]=t=>e.chatWindow=t),position:"bottom"},{default:(0,o.k6)((()=>[(0,o.bF)(je,{class:"full-width"},{default:(0,o.k6)((()=>[(0,o.bF)(He,{class:"bg-primary text-white"},{default:(0,o.k6)((()=>[ye,(0,o.bF)(Ne),(0,o.bo)((0,o.bF)(Xe,{dense:"",flat:"",icon:"close"},null,512),[[lt]])])),_:1}),(0,o.bF)(Oe,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",Le,[(0,o.bF)(Ke,{docId:e.docId,list_data:e.doc_logs},null,8,["docId","list_data"])])])),_:1}),(0,o.bF)(Oe,{class:"q-pt-none"})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(Ye),(0,o.bF)(at,{class:"validation-status-bar back-white"},{default:(0,o.k6)((()=>[(0,o.bF)(ot,{class:(0,a.C4)(["row justify-start",""==e.current_sidebar?"":"opened-right-padding"])},{default:(0,o.k6)((()=>[(0,o.Lk)("span",Fe,(0,a.v_)(e.record.filename),1),(0,o.bF)(Xe,{size:"md",flat:"",dense:"",class:"q-ml-xs",onClick:e.downloadFile},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{name:"download",style:{color:"#8a8a8a"}})])),_:1},8,["onClick"]),(0,o.bF)(Je,{vertical:"",class:"q-mx-md"}),(0,o.Lk)("span",Ce,[e.second_approval?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,a.v_)(e.$t("second_approval")),1)],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)((0,a.v_)(e.$t("first_approval")),1)],64))]),(0,o.bF)(Je,{vertical:"",class:"q-mx-md"}),(0,o.Lk)("span",xe,(0,a.v_)(e.pending_approval_doc_count)+" "+(0,a.v_)(e.$t("invoices_for_release")),1),(0,o.bF)(Je,{vertical:"",class:"q-mx-md"}),(0,o.Lk)("span",Ae,(0,a.v_)(e.currentDisplayedMessage),1),(0,o.bF)(Ne),e.record.table_blocked?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(Je,{vertical:"",class:"q-mx-md"}),(0,o.bF)(Me,{class:"text-blue",style:{"font-size":"22px"},name:"info"}),(0,o.Lk)("span",qe,(0,a.v_)(e.$t("block_supplier_warning")),1)],64)):(0,o.Q3)("",!0),(0,o.bF)(Xe,{dense:"",class:"q-mr-sm custom-border back-white",flat:"",size:"12px",onClick:t[21]||(t[21]=t=>{e.showStampMenu=!0,e.showFontMenu=!1,e.screenmode="stamp"})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{name:"img:annotation/stamp_icon.svg",class:"icon-grey-svg"}),(0,o.bF)(Pe,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("annotation.stamp_annotation")),1)])),_:1})])),_:1}),(0,o.bF)(Xe,{size:"12px",dense:"",flat:"",class:"q-mr-sm custom-border back-white",onClick:t[22]||(t[22]=t=>{e.showFontMenu=!0,e.showStampMenu=!1,e.screenmode="annotate"})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{name:"text_format",class:"icon-grey"}),(0,o.bF)(Pe,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("annotation.text_annotation")),1)])),_:1})])),_:1}),(0,o.Lk)("div",null,[(0,o.bF)(Xe,{size:"12px",flat:"",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[23]||(t[23]=t=>{e.selectColor="#000000",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{color:"black",name:"title"})])),_:1}),(0,o.bF)(Xe,{flat:"",size:"12px",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[24]||(t[24]=t=>{e.selectColor="#f44336",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{color:"red",name:"title"})])),_:1}),(0,o.bF)(Xe,{flat:"",size:"12px",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[25]||(t[25]=t=>{e.selectColor="#4caf50",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{color:"green",name:"title"})])),_:1}),(0,o.bF)(Xe,{flat:"",size:"12px",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[26]||(t[26]=t=>{e.selectColor="#2196f3",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{color:"blue",name:"title"})])),_:1}),(0,o.bF)(Xe,{flat:"",size:"12px",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[27]||(t[27]=t=>{e.selectColor="#ffeb3b",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{color:"yellow",name:"title"})])),_:1})]),e.showStampMenu?((0,o.uX)(),(0,o.CE)("div",Ve,[(0,o.Lk)("div",$e,[(0,o.Lk)("img",{class:"q-px-sm",src:e.stamp_dir+e.selectedStamp+e.stamp_ext,style:{width:"100px"}},null,8,Se),(0,o.bF)(Xe,{dense:"",flat:""},{default:(0,o.k6)((()=>[(0,o.bF)(Me,{name:"expand_more",class:"icon-grey"}),(0,o.bF)(st,null,{default:(0,o.k6)((()=>[(0,o.bF)(tt,{style:{"min-width":"80px"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.sortedStamps,(t=>(0,o.bo)(((0,o.uX)(),(0,o.Wv)(et,{key:t,clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(Ze,{onClick:s=>e.selectedStamp=t},{default:(0,o.k6)((()=>[(0,o.Lk)("img",{width:"80",src:e.stamp_dir+t+e.stamp_ext},null,8,Ie)])),_:2},1032,["onClick"])])),_:2},1024)),[[lt]]))),128))])),_:1})])),_:1})])),_:1})]),(0,o.bF)(Xe,{label:e.$t("doc2light.pages.add"),class:"q-ml-sm",color:"primary",unelevated:"",onClick:t[28]||(t[28]=t=>e.stampAddClicked())},null,8,["label"])])):(0,o.Q3)("",!0),(0,o.bF)(Je,{vertical:"",class:"q-mx-xs"}),(0,o.bF)(Xe,{disable:1==e.page,icon:"keyboard_arrow_up",flat:"",class:"validation-view-page-button icon-grey",onClick:t[29]||(t[29]=t=>e.prevImage())},null,8,["disable"]),(0,o.Lk)("span",Ee,(0,a.v_)(e.currentPage())+"/"+(0,a.v_)(e.images.length),1),(0,o.bF)(Xe,{disable:e.page==e.images.length,icon:"keyboard_arrow_down",flat:"",class:"validation-view-page-button icon-grey",onClick:t[30]||(t[30]=t=>e.nextImage())},null,8,["disable"])])),_:1},8,["class"])])),_:1})],64)}var Re=s(82303),Me=s(1659),Qe=s(24622),ze=s(38734),Ke=s(68450),Pe=s(46162),Ue=s(96056),Te=s(8420),We=s(14907),Xe=s(45022),Be=s(18505),Ne=s(61715),He=s(76956),Oe=s(12566),je=s(96075),Ge=s(60894),Ye=s(6315),Je=s(94124),Ze=s(8903),et=s(85487),tt=s(23537),st=function(e,t,s,o){function a(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function i(e){try{r(o.next(e))}catch(t){l(t)}}function d(e){try{r(o["throw"](e))}catch(t){l(t)}}function r(e){e.done?s(e.value):a(e.value).then(i,d)}r((o=o.apply(e,t||[])).next())}))};const ot=document.querySelector.bind(document);let at;const lt=(0,o.pM)({el:"#app",mixins:[Be.A,Qe.A,Ue.A],components:{Loader:Te.A,DocumentLogs:Ne.A,AnnotationView:Ye.A,ErrorDocumentView:Oe.A,BackToSettings:Ge.A},watch:{doc_status:{deep:!0,handler:function(){this.checkValidStatus()}}},data(){return{default_stamp:Ze.EO,stamp_ext:Ze.K_,sortedStamps:[],stamps:Ze.dA,stamp_dir:Ze.Ul,docId:"",imageHeight:0,imageWidth:0,showArticlePage:!1,loading:!1,chatWindow:(0,ze.KR)(!1),enableExportButton:!1,allowedDoctypes:He.Gk,filter_status:"validated_pending_approval",readonly_model_required_fields:["currency","tax_amount","invoice_date","payment_terms","invoice_date","order_date","total_amount"],model_required_fields:["kostenstelle","kostentrager","notes","assigned_to"]}},beforeRouteLeave:function(e,t,s){this.record={},s()},mounted:function(){let e=this.$route.params.id,t=Xe.A.getItem("selected_language");t&&(this.locale=t),this.selectedStamp=this.default_stamp,this.sortStampsByLanguage(),this.getDocAnnotations(e),window.addEventListener("resize",this.windowResize),document.body.addEventListener("click",this.mouseClicked,!0),this.init(),document.addEventListener("new_log",this.addNewLog);for(let s=1;s<=80;s++)this.fontSizes.push(s.toString()+"pt")},unmounted:function(){window.removeEventListener("resize",this.windowResize),document.removeEventListener("new_log",this.addNewLog)},methods:{init(){return st(this,void 0,void 0,(function*(){this.isSecondApproval(),this.$route.params.id||this.$router.push("/dashboard"),this.second_approval&&(this.filter_status="approved_pending_second_approval"),this.docId=this.$route.params.id,this.initRequiredFields(),yield this.getInvoiceDataByDocId(this.docId),this.renderDocumentLog(),this.renderPendingRecordsCountView(),this.renderNextPrevLinkBtns(),yield this.makeReadOnlyModel(),yield this.makeEditableModel(),this.getAssignToUsers(),He.B2.includes(this.record.status)&&(this.isReadOnly=!0),this.handleImageBaseURL(),this.image=this.baseUrl+"/"+(0,je.v)(this.record.images[0].path),this.images=(0,je.m)(this.record.images);let e=ot("#image_container");this.imageWidth=e.offsetWidth,this.imageHeight=e.offsetHeight,this.getImageDetails()}))},sortStampsByLanguage(){let e=this.$i18n.locale,t=[];"en-us"==e&&(e="en"),this.stamps.forEach((s=>{"de"!=e&&"en"!=e&&(e="en"),s.includes(e)&&t.push(s)})),this.selectedStamp=t[0],this.sortedStamps=t},isSecondApproval(){this.$route.params.second_approval&&"true"===this.$route.params.second_approval&&(this.second_approval=!0)},getInvoiceDataByDocId(e){return st(this,void 0,void 0,(function*(){try{if(yield this.getDocumentById(e),!this.record.doc_id)return void this.showErrorToast(this.$t("pages.messages.INVALID_DOCUMENT"))}catch(t){return void this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}}))},initRequiredFields(){this.readonly_model_required_fields.forEach(((e,t)=>{let s=this.createEmptyField(e,"text");this.readonlyModel[e]=s})),this.model_required_fields.forEach(((e,t)=>{this.model[e]=""}))},makeReadOnlyModel(){return new Promise(((e,t)=>{let s={};if(void 0!==this.record){this.record.fields.forEach(((e,t)=>{s[e.name]=e}));let e=[];e=this.record.layout.groups,e.forEach(((e,t)=>{e.rows.forEach(((e,t)=>{e.forEach(((e,t)=>{let o=e.field_name,a=s[o];a||(a=this.createEmptyField(o,e.input_type)),this.readonlyModel[o]=a,this.readOnlyfieldsDef[o]=e}))}))}))}e("done")}))},makeEditableModel(){return new Promise(((e,t)=>{if(void 0!==this.record){for(const[e,t]of Object.entries(this.record))this.model[e]=t;this.setPrevAssignee()}e("done")}))},setPrevAssignee(){this.prev_assignee=this.record.assigned_to},createEmptyField(e,t){let s="checkbox"!=t&&"";return{confidence:0,name:e,value:s,formatted_value:s,content:s}},getAssignToUsers(){return st(this,void 0,void 0,(function*(){yield this.dropdownStore.prepareUsersDropdown(),this.usersList=this.dropdownStore.usersList,this.model["assigned_to"]=this.getUserFullName(this.record.assigned_to),this.setPreviousApprover()}))},setPreviousApprover(){this.second_approval&&this.record.first_approver&&(this.model["first_approver"]=this.getUserFullName(this.record.first_approver))},filterUserList(e,t,s){try{if(""===e)return void t((()=>{this.usersList=this.dropdownStore.usersList}));t((()=>{const t=e.toLowerCase();this.usersList=this.dropdownStore.usersList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}))}catch(o){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),s()}},getUserFullName(e){let t=this.dropdownStore.usersList.filter((t=>t.value==e));return t[0].label},isModelReady(){return 0!==(0,Ke.Ns)(this.model)},goHelp(){window.open("https://docs.cloudintegration.eu/")},inputValueChanges(e,t){try{this.record[e]=t}catch(s){}},setApiData(e){this.record=e,this.$forceUpdate()},windowResize(){let e=ot("#image_container");this.imageWidth=e.offsetWidth,this.imageHeight=e.offsetHeight,this.$forceUpdate(),setTimeout((()=>{this.getImageDetails()}),20)},getImageDetails(){at=ot("#screenshot"),at&&(this.imageWidth=at.offsetWidth,this.imageHeight=at.offsetHeight)},currentPage(){return this.page},prevImage(){let e=this.page-1,t=this.getImagePath(e);this.updateImage(e,t)},nextImage(){let e=this.page+1,t=this.getImagePath(e);this.updateImage(e,t)},getImagePath(e){let t="";for(const[s,o]of Object.entries(this.images)){let s=o;s.pageNumber===e&&(t=s.path)}return t},updateImage(e,t){t&&""!==t&&(this.image=this.baseUrl+"/"+(0,je.v)(t),this.page=e)},handleImageBaseURL(){this.record.images[0]&&this.record.images[0].path.match(/doc2/g)&&(this.baseUrl=Pe.VA)},updateApiData(e){e.detail&&(this.record=e.detail)},saveData(){return st(this,void 0,void 0,(function*(){try{if(this.isReadOnly)return;if(!this.validateData())return;this.showLoading();const e=yield this.saveDocument(this.docId);if(!1===e.success)return this.showErrorToast(this.$t("pages.messages.error_internal_occur")),void this.showErrorToast(e.message);this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),this.setPrevAssignee(),this.assign_user_error=!1}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},validateData(){let e=!0;return(0,Ke.z)(this.record.assigned_to)&&(this.assign_user_error=!0,e=!1),e},acceptRequest(){let e=this.images.length,t=this.getImagePath(e);if(this.updateImage(e,t),this.page===this.images.length){let e="de"===this.locale?"approved_stamp_de":"approved_stamp_en";this.$refs.child_comp.addStampAnnotation(e)}this.record.first_approver=this.record.assigned_to,this.updateRequest("approve")},rejectRequest(){this.second_approval||delete this.record.first_approver,this.updateRequest("reject")},updateRequest(e){return st(this,void 0,void 0,(function*(){try{if(this.isReadOnly)return;yield this.saveData(),this.showLoading();let t=new FormData;const s=(0,et.I)();let o;t.append("request_type",e),t.append("org_id",s);let a=yield(0,Pe.L3)();if(o=yield Re.A.post(Pe.FH.approve_or_reject_document+this.docId,t,{headers:{Authorization:a}}),!1===o.data.success)return this.showErrorToast(this.$t("pages.messages.error_internal_occur")),void this.showErrorToast(o.data.message);this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),this.$router.push("/dashboard")}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},verifyAssignee(){let e=!0;return this.prev_assignee!==this.record.assigned_to&&(e=!1),e},addNewLog(e){e&&e.detail&&this.renderDocumentLog()},renderDocumentLog(){return st(this,void 0,void 0,(function*(){try{yield this.getDocumentLogs()}catch(e){}finally{this.hideLoading()}}))},getDocumentLogs(){return st(this,void 0,void 0,(function*(){let e;this.doc_logs={};let t=new FormData;t.append("action_type","message"),t.append("org_id",(0,et.I)());let s=yield(0,Pe.L3)();if(e=yield Re.A.post(Pe.FH.get_document_log+this.docId,t,{headers:{Authorization:s}}),!e.data)throw{message:"no logs from server"};e.data.forEach((e=>{this.doc_logs[e.id.toString()+"_ID"]=e}))}))},downloadFile(){let e=Pe.VA+"/resource/document/"+this.docId+"/"+this.docId+".pdf?"+this.tokenQueryParam;if(e){var t=document.createElement("a");t.download=this.record.filename,t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},routeToListPendingApproval(){this.removeDashboardFilters(),this.$router.push("/dashboard")},renderPendingRecordsCountView(){return st(this,void 0,void 0,(function*(){try{let e,t="?filter=current-year&skip=0&limit=100&status="+this.filter_status,s=yield(0,Pe.L3)();if(e=yield Re.A.get((0,et.MV)(Pe.FH.get_dashboard_data+t),{headers:{Authorization:s}}),!e.data.documents)throw{message:"no pending documents from server"};this.pending_approval_doc_count=e.data.documents.length,this.pending_approval_doc_count<0&&(this.pending_approval_doc_count=0)}catch(e){}finally{this.hideLoading()}}))},renderNextPrevLinkBtns(){return st(this,void 0,void 0,(function*(){try{let e,t=yield(0,Pe.L3)();if(e=yield Re.A.get((0,et.MV)(Pe.FH.get_next_document+this.docId+"?doc_type="+this.record.doc_type+"&status="+this.filter_status+"&sort_attr=created_on"),{headers:{Authorization:t}}),!1===e.data.success)throw{message:"cannot get response related to next or prev record"};e.data.has_next&&e.data.next_id&&(this.next_record=e.data.next_id),e.data.has_previous&&e.data.previous_id&&(this.prev_record=e.data.previous_id)}catch(e){}finally{this.hideLoading()}}))},checkValidStatus(){this.doc_status!==this.filter_status&&(this.error=!0,this.error_message="invalid_status")},routeTo(e){let t="ready-for-approval";this.second_approval&&(t="ready-for-second-approval"),"prev"===e&&this.prev_record&&this.$router.push({path:"/"+t+"/"+this.prev_record,replace:!0}),"next"===e&&this.next_record&&this.$router.push("/"+t+"/"+this.next_record)},updateValue(e,t){"font"==e?this.selectFont=t:"color"==e?this.selectColor=t:"size"==e&&(this.selectFontSize=t)},stampAddClicked(){this.$refs.child_comp.addTemplateAnnotation(this.selectedStamp)}},setup(){const e=(0,We.A)();let t={},s=[];const o=(0,Je.cY)();let{locale:a}=(0,tt.s9)({useScope:"global"});const l=(0,Je.q3)(),{getDocumentById:i,getDocAnnotations:d,saveDocument:r}=l,{record:n,doc_status:c,error:u,error_message:m,page:h}=(0,Me.bP)(l),p=(0,Je.fX)(),{removeSavedFilters:_,saveFilters:g}=p,v=(0,Je._6)(),{tokenQueryParam:f}=(0,Me.bP)(v);return v.getTokenQueryParam(),{locale:(0,ze.KR)(a),saveDocument:r,tokenQueryParam:f,removeDashboardFilters:_,savedDashboardFilters:g,doc_status:c,page:h,error:u,error_message:m,getDocumentById:i,record:n,dropdownStore:o,fields:t,image:"",images:s,baseUrl:Pe.VA,isReadOnly:!1,model:(0,ze.KR)({}),fieldsDef:(0,ze.KR)({}),readOnlyfieldsDef:(0,ze.KR)({}),readonlyModel:(0,ze.KR)({}),usersList:(0,ze.KR)([]),prev_assignee:(0,ze.KR)(null),assign_user_error:(0,ze.KR)(!1),doc_logs:(0,ze.KR)({}),pending_approval_doc_count:(0,ze.KR)(0),next_record:(0,ze.KR)(""),prev_record:(0,ze.KR)(""),second_approval:(0,ze.KR)(!1),showNotification(t){e.notify({message:t,color:"primary",position:"top"})},getDocAnnotations:d,showFontMenu:(0,ze.KR)(!0),showStampMenu:(0,ze.KR)(!1),selectColor:(0,ze.KR)("#000000"),selectFont:(0,ze.KR)("Helvetica"),fontlist:["Helvetica","Times New Roman","Arimo","Caladea","Carlito","Cousine","Liberation Serif","Arial"],selectFontSize:(0,ze.KR)(20),fontSizes:[],showDoc:(0,ze.KR)(!1),selectedStamp:(0,ze.KR)(""),screenmode:(0,ze.KR)("annotate")}}});var it=s(12807),dt=s(50492),rt=s(56384),nt=s(97410),ct=s(67837),ut=s(94940),mt=s(13718),ht=s(82156),pt=s(23316),_t=s(18670),gt=s(93676),vt=s(44189),ft=s(57092),kt=s(36914),bt=s(10386),wt=s(84436),yt=s(53999),Lt=s(90124),Ft=s(25173),Ct=s(1444),xt=s(67156),At=s(42315),qt=s(88672),Vt=s(98582),$t=s.n(Vt);const St=(0,it.A)(lt,[["render",De],["__scopeId","data-v-30997bb5"]]),It=St;$t()(lt,"components",{QIcon:dt.A,QBtn:rt.A,QTooltip:nt.A,QInput:ct.A,QSelect:ut.A,QPageSticky:mt.A,QDialog:ht.A,QCard:pt.A,QBar:_t.A,QSpace:gt.A,QCardSection:vt.A,QFooter:ft.A,QToolbar:kt.A,QSeparator:bt.A,QMenu:wt.A,QList:yt.A,QItem:Lt.A,QItemSection:Ft.A,QSlider:Ct.A,QField:xt.A,QTable:At.A}),$t()(lt,"directives",{ClosePopup:qt.A})}}]);