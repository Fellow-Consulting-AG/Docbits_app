"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[9878],{89878:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Pt});var i=s(61758);function a(t,e,s,a,n,o){const r=(0,i.g2)("SideMenu"),l=(0,i.g2)("newUpdateError"),u=(0,i.g2)("router-view"),c=(0,i.g2)("q-page-container"),d=(0,i.g2)("q-layout");return(0,i.uX)(),(0,i.Wv)(d,{view:"lHh lpR lFf"},{default:(0,i.k6)((()=>[(0,i.bF)(r),(0,i.bF)(c,null,{default:(0,i.k6)((()=>[(0,i.bF)(l),((0,i.uX)(),(0,i.Wv)(u,{key:t.$route.fullPath}))])),_:1})])),_:1})}var n=s(50411),o=s(23537),r=s(1659),l=s(45022),u=s(24622),c=s(38734),d=s(46162),h=s(18505),g=s(76956),p=s(58790);const _=t=>((0,i.Qi)("data-v-15198ce0"),t=t(),(0,i.jt)(),t),b={key:0},k=["src"],m={key:1},f=["src"],v=_((()=>(0,i.Lk)("img",{src:"icons/LOGO.svg",target:"_blank",rel:"noopener noreferrer"},null,-1))),y={class:"text-capitalize"},w={class:"fixed-bottom"},A={key:0},L={class:"text-capitalize"},C={key:1},F={class:"text-capitalize"},S={class:"text-center q-pt-md ellipsis q-px-sm"},I={class:"q-mini-drawer-hide drawer-close"};function E(t,e,s,a,n,o){const r=(0,i.g2)("q-avatar"),l=(0,i.g2)("q-badge"),u=(0,i.g2)("InvoiceIcon"),c=(0,i.g2)("q-icon"),d=(0,i.g2)("q-tooltip"),h=(0,i.g2)("q-item-section"),g=(0,i.g2)("q-item"),_=(0,i.g2)("q-separator"),E=(0,i.g2)("q-list"),q=(0,i.g2)("UserDropDown"),T=(0,i.g2)("q-menu"),x=(0,i.g2)("q-btn"),D=(0,i.g2)("q-drawer"),W=(0,i.gN)("ripple");return t.isDashboardRoute?((0,i.uX)(),(0,i.Wv)(D,{key:0,modelValue:t.drawer,"onUpdate:modelValue":e[4]||(e[4]=e=>t.drawer=e),"show-if-above":"",mini:!t.drawer||t.miniState,width:250,breakpoint:500,bordered:"",class:"highlighted-back"},{default:(0,i.k6)((()=>[t.isMobile()?((0,i.uX)(),(0,i.CE)("div",b,[(0,i.bF)(r,{class:"cursor-pointer big-fellow-icon",square:"",onClick:e[0]||(e[0]=e=>t.drawer=!t.drawer)},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{src:t.$q.dark.isActive?"images/docbits-black.svg":"images/docbits.svg",target:"_blank",rel:"noopener noreferrer",class:"icon-width"},null,8,k)])),_:1})])):((0,i.uX)(),(0,i.CE)("div",m,[t.miniState?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(r,{key:0,class:"cursor-pointer big-fellow-icon",square:"",onClick:e[1]||(e[1]=e=>t.miniState=!0)},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{src:t.$q.dark.isActive?"images/docbits-black.svg":"images/docbits.svg",target:"_blank",rel:"noopener noreferrer",class:"icon-width"},null,8,f)])),_:1})),t.miniState?((0,i.uX)(),(0,i.Wv)(r,{key:1,square:"",class:"cursor-pointer small-fellow-icon",onClick:e[2]||(e[2]=e=>t.miniState=!1)},{default:(0,i.k6)((()=>[v])),_:1})):(0,i.Q3)("",!0)])),(0,i.bF)(E,{padding:"",class:(0,p.C4)(["scroll-menu",t.isMobile()?"":"thin-scrollbar"])},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.menuList,((e,s)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:s},[(0,i.bo)(((0,i.uX)(),(0,i.Wv)(g,{clickable:"",onClick:s=>t.navigateTo(e.to),active:t.isActive(e.to),"active-class":"active-text",id:e.name},{default:(0,i.k6)((()=>[(0,i.bF)(h,{avatar:""},{default:(0,i.k6)((()=>["tasks"==e.name&&t.task_count>0?((0,i.uX)(),(0,i.Wv)(l,{key:0,color:"red",style:{position:"absolute","z-index":"1",top:"4px",right:"4px"},label:t.task_count},null,8,["label"])):(0,i.Q3)("",!0),"invoice_dashboard"===e.name?((0,i.uX)(),(0,i.Wv)(u,{key:1,isActive:!!t.isActive(e.to)},null,8,["isActive"])):((0,i.uX)(),(0,i.Wv)(c,{key:2,color:t.isActive(e.to)?"primary":t.$q.dark.isActive?"grey-3":"grey-8",name:e.icon},null,8,["color","name"])),(0,i.bF)(d,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.$t(e.label).toLowerCase()),1)])),_:2},1024)])),_:2},1024),(0,i.bF)(h,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",y,(0,p.v_)(t.$t(e.label).toLowerCase()),1)])),_:2},1024)])),_:2},1032,["onClick","active","id"])),[[W]]),e.separator?((0,i.uX)(),(0,i.Wv)(_,{key:"sep"+s})):(0,i.Q3)("",!0)],64)))),128))])),_:1},8,["class"]),(0,i.Lk)("div",w,[(0,i.bF)(_),(0,i.bF)(E,{padding:""},{default:(0,i.k6)((()=>[t.isMobile()?((0,i.uX)(),(0,i.CE)("div",C,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.bottomItems,((e,s)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:s},["notifications"!==e.name&&"user"!==e.name?(0,i.bo)(((0,i.uX)(),(0,i.Wv)(g,{key:0,clickable:"",onClick:s=>t.navigateTo(e.to),active:t.isActive(e.to),"active-class":"active-text",id:e.name},{default:(0,i.k6)((()=>[(0,i.bF)(h,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{color:t.isActive(e.to)?"primary":t.$q.dark.isActive?"grey-3":"grey-8",name:e.icon},null,8,["color","name"]),(0,i.bF)(d,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.$t(e.label).toLowerCase()),1)])),_:2},1024)])),_:2},1024),(0,i.bF)(h,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",F,(0,p.v_)(t.$t(e.label).toLowerCase()),1)])),_:2},1024)])),_:2},1032,["onClick","active","id"])),[[W]]):(0,i.Q3)("",!0)],64)))),128)),(0,i.bF)(_),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(g,{clickable:"",onClick:t.logout},{default:(0,i.k6)((()=>[(0,i.bF)(h,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{class:"icon-grey",name:"power_settings_new"})])),_:1}),(0,i.bF)(h,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.$t("layout.logout")),1)])),_:1})])),_:1},8,["onClick"])),[[W]])])):((0,i.uX)(),(0,i.CE)("div",A,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.bottomItems,((e,s)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:s},[(0,i.bo)(((0,i.uX)(),(0,i.Wv)(g,{clickable:"",onClick:s=>t.navigateTo(e.to),active:t.isActive(e.to),"active-class":"active-text",id:e.name},{default:(0,i.k6)((()=>[(0,i.bF)(h,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{color:t.isActive(e.to)?"primary":t.$q.dark.isActive?"grey-3":"grey-8",name:e.icon},null,8,["color","name"]),(0,i.bF)(d,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.$t(e.label).toLowerCase()),1)])),_:2},1024)])),_:2},1024),(0,i.bF)(h,null,{default:(0,i.k6)((()=>[(0,i.Lk)("span",L,(0,p.v_)(t.$t(e.label).toLowerCase()),1)])),_:2},1024),"user"==e.name?((0,i.uX)(),(0,i.Wv)(T,{key:0,style:{"border-radius":"10px"},class:"no-shadow gray-border",anchor:"bottom right",self:"bottom left",offset:[0,0]},{default:(0,i.k6)((()=>[(0,i.bF)(q)])),_:1})):(0,i.Q3)("",!0)])),_:2},1032,["onClick","active","id"])),[[W]]),e.separator?((0,i.uX)(),(0,i.Wv)(_,{key:"sep"+s})):(0,i.Q3)("",!0)],64)))),128))]))])),_:1}),(0,i.bF)(_),(0,i.Lk)("div",null,[(0,i.Lk)("p",S,(0,p.v_)(t.app_version),1),(0,i.bF)(d,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.app_version),1)])),_:1})])]),(0,i.Lk)("div",I,[(0,i.bF)(x,{dense:"",round:"",unelevated:"",class:"highlighted-back menu-close-button",icon:"chevron_left",onClick:e[3]||(e[3]=e=>t.miniState=!0)})])])),_:1},8,["modelValue","mini"])):(0,i.Q3)("",!0)}var q=s(6044),T=s(11470);const x={id:"clip-path"},D={id:"clip-path-2"},W={id:"Gruppe_838","data-name":"Gruppe 838",transform:"translate(0.025 0.041)"},Q={id:"Gruppe_837","data-name":"Gruppe 837",transform:"translate(0 0)","clip-path":"url(#clip-path)"},$={id:"Gruppe_840","data-name":"Gruppe 840"},P={id:"Gruppe_839","data-name":"Gruppe 839","clip-path":"url(#clip-path-2)"};function R(t,e,s,a,n,o){return(0,i.uX)(),(0,i.CE)("svg",{id:"Gruppe_841","data-name":"Gruppe 841",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"20",height:"23",viewBox:"0 0 24 31.491",class:(0,p.C4)(t.isActive?"color-primary":t.$q.dark.isActive?"color-dark-grey":"color-light-grey")},[(0,i.Lk)("defs",null,[(0,i.Lk)("clipPath",x,[(0,i.Lk)("rect",{id:"Rechteck_493","data-name":"Rechteck 493",width:"23.972",height:"31.435",class:(0,p.C4)(t.isActive?"color-primary":t.$q.dark.isActive?"color-dark-grey":"color-light-grey")},null,2)]),(0,i.Lk)("clipPath",D,[(0,i.Lk)("rect",{id:"Rechteck_494","data-name":"Rechteck 494",width:"24",height:"31.491",class:(0,p.C4)(t.isActive?"color-primary":t.$q.dark.isActive?"color-dark-grey":"color-light-grey")},null,2)])]),(0,i.Lk)("g",W,[(0,i.Lk)("g",Q,[(0,i.Lk)("path",{id:"Pfad_710","data-name":"Pfad 710",d:"M126.644,3.134c.246.2.509.371.737.586q2.888,2.713,5.753,5.441c.276.263.505.574.756.863l-.05.081h-6.773c-.443,0-.511-.069-.511-.518V3.18l.084-.048",transform:"translate(-110.332 -2.736)",class:(0,p.C4)(t.isActive?"color-primary":t.$q.dark.isActive?"color-dark-grey":"color-light-grey")},null,2)])]),(0,i.Lk)("g",$,[(0,i.Lk)("g",P,[(0,i.Lk)("path",{id:"Pfad_711","data-name":"Pfad 711",d:"M24,27.285V9.228H16.71A2.16,2.16,0,0,1,14.4,6.922V.005H3.6A3.389,3.389,0,0,0,.011,3.583C.01,11.7.023,19.814,0,27.929a3.437,3.437,0,0,0,2.884,3.515c.027,0,.052.029.078.044H21.045l0,0c.175-.047.353-.09.527-.14a3.4,3.4,0,0,0,2.419-3.113C24,27.92,24,27.6,24,27.285M8.485,9.15C8.14,9.076,7.778,9.077,7.436,9a2.97,2.97,0,0,1-.388-5.654.508.508,0,0,0,.4-.577c-.017-.516.253-.8.678-.791s.674.285.667.81a.488.488,0,0,0,.379.547,2.873,2.873,0,0,1,1.919,2.578.707.707,0,0,1-.577.853.667.667,0,0,1-.767-.709,1.626,1.626,0,1,0-3.2.467,1.613,1.613,0,0,0,1.485,1.2,2.993,2.993,0,0,1,2.961,2.238,5.808,5.808,0,0,1,.109.634,3,3,0,0,1-1.9,2.895c-.3.111-.421.233-.411.563.015.5-.268.812-.67.815s-.692-.3-.673-.8c.012-.328-.109-.45-.4-.57a2.875,2.875,0,0,1-1.9-2.594c-.041-.5.2-.824.618-.856.388-.03.663.239.734.718A1.623,1.623,0,1,0,8.485,9.15m1.962,14a.926.926,0,0,1-1.013.831H5.129a.924.924,0,1,1,0-1.843H9.434a.926.926,0,0,1,1.013,1.013m8.981-4.641a.937.937,0,0,1-.941.559h-6.7l0,0q-3.334.007-6.668,0a.917.917,0,0,1-.886-1.327.908.908,0,0,1,.873-.517H18.5a.921.921,0,0,1,.923,1.286",transform:"translate(0 0.001)",class:(0,p.C4)(t.isActive?"color-primary":t.$q.dark.isActive?"color-dark-grey":"color-light-grey")},null,2)])])],2)}const K=(0,i.pM)({name:"InvoiceIcon",props:{isActive:{type:Boolean,required:!0}}});var O=s(12807);const M=(0,O.A)(K,[["render",R],["__scopeId","data-v-1f438770"]]),X=M;var z=s(29104);const U={class:"user-item-initials"},B={class:"user-profile-name"},H={class:""},N={class:"q-ml-sm"};function G(t,e,s,a,n,o){const r=(0,i.g2)("q-avatar"),l=(0,i.g2)("q-item-section"),u=(0,i.g2)("q-icon"),c=(0,i.g2)("q-item"),d=(0,i.g2)("q-list"),h=(0,i.g2)("q-menu"),g=(0,i.g2)("q-separator"),_=(0,i.g2)("LanguageDropdown"),b=(0,i.g2)("DarkMode"),k=(0,i.g2)("EditProfile"),m=(0,i.g2)("q-dialog"),f=(0,i.g2)("q-card-section"),v=(0,i.g2)("f-btn"),y=(0,i.g2)("q-card-actions"),w=(0,i.g2)("q-card"),A=(0,i.gN)("ripple"),L=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(d,{bordered:"",class:(0,p.C4)(t.isSupplierUser()?"user-fixed-height":t.is_sub_org?"user-max-height":"user-fixed-height")},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.organizations,((e,s)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:s},[(0,i.bF)(c,{clickable:e.sub_organisations.length>0},{default:(0,i.k6)((()=>[(0,i.bF)(l,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(r,{size:"32px",class:"user-avatar-background"},{default:(0,i.k6)((()=>[(0,i.Lk)("span",U,(0,p.v_)(t.getInitials(this.userFullName)),1)])),_:1})])),_:1}),(0,i.bF)(l,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.Lk)("span",B,(0,p.v_)(this.userFullName),1),(0,i.Lk)("span",H,(0,p.v_)(e.name.toLowerCase()),1)])),_:2},1024),e.sub_organisations.length>0?((0,i.uX)(),(0,i.Wv)(l,{key:0,side:""},{default:(0,i.k6)((()=>[(0,i.bF)(u,{name:"keyboard_arrow_right"})])),_:1})):(0,i.Q3)("",!0),e.sub_organisations.length>0?((0,i.uX)(),(0,i.Wv)(h,{key:1,anchor:"top end",self:"top start",offset:[1,0],style:{"border-radius":"10px"},class:"no-shadow gray-border"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{bordered:""},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.sub_organisations,((e,s)=>(0,i.bo)(((0,i.uX)(),(0,i.Wv)(c,{key:s,clickable:"",onClick:s=>t.setSubOrg(e),active:e.id===t.sub_org_id},{default:(0,i.k6)((()=>[(0,i.bF)(l,{avatar:""},{default:(0,i.k6)((()=>[e.id===t.sub_org_id?((0,i.uX)(),(0,i.Wv)(u,{key:0,name:"check"})):(0,i.Q3)("",!0)])),_:2},1024),(0,i.bF)(l,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(e.name.toLowerCase()),1)])),_:2},1024)])),_:2},1032,["onClick","active"])),[[A]]))),128))])),_:2},1024)])),_:2},1024)):(0,i.Q3)("",!0)])),_:2},1032,["clickable"]),(0,i.bF)(g),e.sub_organisations.length>0?((0,i.uX)(),(0,i.Wv)(c,{key:0,class:"highlighted-back"},{default:(0,i.k6)((()=>[(0,i.bF)(l,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(u,{class:"icon-grey",name:"img:settings/firmeninformation.svg"})])),_:1}),(0,i.bF)(l,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.getSubOrgName(e.sub_organisations)),1)])),_:2},1024)])),_:2},1024)):(0,i.Q3)("",!0),(0,i.bF)(g),(0,i.bF)(_),(0,i.bF)(b)],64)))),128)),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(c,{clickable:"",onClick:e[0]||(e[0]=e=>t.profileDialog=!0)},{default:(0,i.k6)((()=>[(0,i.bF)(l,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(u,{class:"icon-grey",name:"settings"})])),_:1}),(0,i.bF)(l,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.$t("pages.user.settings").toLowerCase()),1)])),_:1})])),_:1})),[[A]]),(0,i.bF)(g),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(c,{clickable:"",onClick:e[1]||(e[1]=t=>this.logout())},{default:(0,i.k6)((()=>[(0,i.bF)(l,{avatar:""},{default:(0,i.k6)((()=>[(0,i.bF)(u,{class:"icon-grey",name:"power_settings_new"})])),_:1}),(0,i.bF)(l,{class:"text-capitalize"},{default:(0,i.k6)((()=>[(0,i.eW)((0,p.v_)(t.$t("layout.logout")),1)])),_:1})])),_:1})),[[A]])])),_:1},8,["class"]),(0,i.bF)(m,{modelValue:t.profileDialog,"onUpdate:modelValue":e[2]||(e[2]=e=>t.profileDialog=e),onKeydown:e[3]||(e[3]=(0,z.jR)((e=>t.profileDialog=!1),["esc"]))},{default:(0,i.k6)((()=>[(0,i.bF)(k)])),_:1},8,["modelValue"]),(0,i.bF)(m,{modelValue:t.refresh_warning,"onUpdate:modelValue":e[6]||(e[6]=e=>t.refresh_warning=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)((()=>[(0,i.bF)(w,null,{default:(0,i.k6)((()=>[(0,i.bF)(f,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,i.k6)((()=>[(0,i.bF)(r,{icon:"warning",color:"primary","text-color":"white"})])),_:1}),(0,i.bF)(f,{class:"row items-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("span",N,(0,p.v_)(t.$t("change_lost_warning")),1)])),_:1}),(0,i.bF)(y,{align:"right"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.bF)(v,{appearance:"cancel",label:t.$t("cancel"),onClick:e[4]||(e[4]=e=>t.refresh_warning=!1)},null,8,["label"]),[[L]]),(0,i.bF)(v,{"data-cy":"done",label:t.$t("proceed"),onClick:e[5]||(e[5]=e=>t.refreshSettings(!0))},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var V=s(45938),j=s(68130),J=s(84943),Y=s(94124),Z=s(73937),tt=s(34001),et=s(71016),st=function(t,e,s,i){function a(t){return t instanceof s?t:new s((function(e){e(t)}))}return new(s||(s=Promise))((function(s,n){function o(t){try{l(i.next(t))}catch(e){n(e)}}function r(t){try{l(i["throw"](t))}catch(e){n(e)}}function l(t){t.done?s(t.value):a(t.value).then(o,r)}l((i=i.apply(t,e||[])).next())}))};const it=(0,i.pM)({el:"#app",mixins:[q.A,h.A,u.A],props:{},components:{EditProfile:J.A,DarkMode:et.A,LanguageDropdown:tt.A},data(){return{is_sub_org:(0,c.KR)(!1)}},mounted:function(){this.init(),window.addEventListener("storage",this.storageChangeEvent)},unmounted:function(){window.removeEventListener("storage",this.storageChangeEvent)},methods:{getInitials(t){var e=t.split(" "),s=e[0].substring(0,1).toUpperCase();return e.length>1&&(s+=e[e.length-1].substring(0,1).toUpperCase()),s},init(){return st(this,void 0,void 0,(function*(){try{this.loading=!0,yield this.refreshSettings(),yield this.getSubOrgId(),this.refreshUserInfo(),this.getLanguageIfEmpty(),this.getDatePatterns(),this.getSubInfo()}catch(t){}finally{this.loading=!1}}))},storageChangeEvent(t){this.handleSessionStorageChange(t)},getSubOrgName(t){let e;return t.map((t=>{t.id===this.sub_org_id&&(e=t.name)})),e},getSubInfo(){this.organizations&&this.organizations.length>0?this.organizations.map((t=>{t.sub_organisations.length>0?this.is_sub_org=!0:this.is_sub_org=!1})):this.is_sub_org=!1},handleSessionStorageChange(t){return st(this,void 0,void 0,(function*(){try{this.handleStorageEvent(t),yield this.refreshAndGetSubOrgId()}catch(e){}}))},getDatePatterns(){return st(this,void 0,void 0,(function*(){this.date_pattern_loaded||(yield this.getDatePatternOptions())}))},setSubOrg(t){return st(this,void 0,void 0,(function*(){try{this.showLoading();const e=String(t.id);if(!e)return void this.showErrorToast("no organization selected");yield j.E.setSubOrgId(e),yield this.refreshAndGetSubOrgId(),this.$router.go(0)}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},refreshUserInfo(){this.profileDialog=!1;const t=(0,Z.Ky)("id");this.isUserAdmin=(0,Z.Ky)("is_organisation_admin"),t?this.updateUserName():this.logout()},refreshSettings(t=!1){return st(this,void 0,void 0,(function*(){if(yield this.startSettingsFetch(),this.refresh_warning=!1,!t)return;this.clearStorageForRefresh(),yield V.tH.fetch(),yield this.refreshUserOrganizations();const e=(0,Y.q3)();e.resetDocStore(this.$route.fullPath),this.$router.go(0)}))},refreshClicked(){const t=this.$route.path,e=["/dashboard","/setting"];e.includes(t)?this.refreshSettings(!0):this.refresh_warning=!0},hasSubOrganizations(){return!!(this.organizations[0]&&this.organizations[0].hasOwnProperty("sub_organisations")&&this.organizations[0].sub_organisations.length>0)}},setup(){const t=(0,Y.kH)(),{updateUserName:e,getUserOrganizations:s,getSubOrgId:i,refreshAndGetSubOrgId:a,refreshUserOrganizations:n}=t,{userFullName:o,organizations:l,sub_org_id:u,main_orgainzation:d}=(0,r.bP)(t),h=(0,Y.Bu)(),{setOrgSettings:g,handleStorageEvent:p,getOrgSettings:_,startSettingsFetch:b}=h,k=(0,Y.QJ)(),{getLanguageIfEmpty:m}=k,f=(0,Y.Sq)(),{getDatePatternOptions:v}=f,{date_pattern_loaded:y}=(0,r.bP)(f);return{startSettingsFetch:b,refreshUserOrganizations:n,refreshAndGetSubOrgId:a,getOrgSettings:_,handleStorageEvent:p,date_pattern_loaded:y,getDatePatternOptions:v,getLanguageIfEmpty:m,getUserOrganizations:s,setOrgSettings:g,updateUserName:e,getSubOrgId:i,settings_store:h,main_orgainzation:d,sub_org_id:u,userFullName:o,organizations:l,refresh_warning:(0,c.KR)(!1),profileDialog:(0,c.KR)(!1),isUserAdmin:(0,c.KR)(""),link:(0,c.KR)("inbox"),loading:(0,c.KR)(!1),isSupplierUser:Z.cq}}});var at=s(53999),nt=s(90124),ot=s(25173),rt=s(3952),lt=s(50492),ut=s(84436),ct=s(10386),dt=s(97410),ht=s(82156),gt=s(23316),pt=s(44189),_t=s(62669),bt=s(56384),kt=s(65265),mt=s(88672),ft=s(98582),vt=s.n(ft);const yt=(0,O.A)(it,[["render",G],["__scopeId","data-v-4dd778d2"]]),wt=yt;vt()(it,"components",{QList:at.A,QItem:nt.A,QItemSection:ot.A,QAvatar:rt.A,QIcon:lt.A,QMenu:ut.A,QSeparator:ct.A,QTooltip:dt.A,QDialog:ht.A,QCard:gt.A,QCardSection:pt.A,QCardActions:_t.A,QBtn:bt.A}),vt()(it,"directives",{Ripple:kt.A,ClosePopup:mt.A});var At=function(t,e,s,i){function a(t){return t instanceof s?t:new s((function(e){e(t)}))}return new(s||(s=Promise))((function(s,n){function o(t){try{l(i.next(t))}catch(e){n(e)}}function r(t){try{l(i["throw"](t))}catch(e){n(e)}}function l(t){t.done?s(t.value):a(t.value).then(o,r)}l((i=i.apply(t,e||[])).next())}))};const Lt=(0,i.pM)({name:"MainLayout",props:{is_supplier:{type:Boolean,default:!1}},components:{UserDropDown:wt,InvoiceIcon:X},beforeRouteLeave:function(t,e,s){this.unsubscribeToChannel("all_open_task_count"),s()},watch:{loading_settings:{handler:function(t,e){1==t&&0==e||this.init()}},websocketHasError:{handler:function(t,e){1==t&&(this.use_websocket=!1,this.handleWebsocketDelay())}},all_tasks_count_data_flag:{handler:function(t,e){0!=t&&(this.data_status="received",this.handleWebSocketResult(this.all_tasks_count))}}},mounted:function(){return At(this,void 0,void 0,(function*(){yield this.startSettingsFetch(),this.init(),document.addEventListener("keydown",this.keyDownEvent),document.addEventListener("refresh_view",this.getTaskCountListener)}))},unmounted(){document.removeEventListener("keydown",this.keyDownEvent),document.removeEventListener("refresh_view",this.getTaskCountListener)},methods:{init(){return At(this,void 0,void 0,(function*(){this.user_settings&&0!=Object.keys(this.user_settings).length&&(this.getUserDetailByKey(),this.prepareMenuItems(),this.user_settings[g.so]&&(yield this.getNotifications()),this.app_version="6.65.2.2".toString()||"0.0.0",this.handleTasks(),this.drawer=!this.isMobile())}))},isMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},isActive(t){return t==this.$route.fullPath},getUserDetailByKey(){let t=(0,Z.Ky)("organisations"),e=t[0];e&&("pending_ap_approval"===e.status?this.supplier_approval_status="pending_approval":this.supplier_approval_status=e.status)},prepareMenuItems(){if(this.menuList=[{label:"pages.screen2a.dashboard",name:"document_dashboard",icon:"description",separator:!1,to:"/dashboard"}],this.bottomItems=[{label:"layout.support",name:"support",icon:"support_agent",separator:!1,to:"/support"},{label:"user",name:"user",icon:"person",separator:!1,to:""}],(0,Z.cq)()){const t=(0,Z.Ky)("organisations")[0];"approved"===t.status&&this.bottomItems.splice(0,0,{label:"layout.settings",name:"settings",icon:"settings",separator:!0,to:"/setting"})}else this.bottomItems.splice(0,0,{label:"layout.settings",name:"settings",icon:"settings",separator:!0,to:"/setting"});this.handleSettingDependantMenu(),this.handleAsnDashbaordMenu(),this.handleTaskAndNotification(),this.is_supplier||this.menuAccessibleCheck()},handleAsnDashbaordMenu(){this.user_settings[this.asn_dashboard_setting]||(this.user_settings[this.asn_dashboard_setting]=!1);const t=this.user_settings[this.asn_dashboard_setting],e=this.menuList.findIndex((t=>"asn_dashboard"===t.name));-1===e&&t?(0,Z.cq)()||this.menuList.splice(1,0,{label:"advance_shipment_dashboard",name:"asn_dashboard",icon:"receipt_long",separator:!1,to:"/asn_shipment/dashboard"}):t||-1===e||this.menuList.splice(e,1)},handleTaskAndNotification(){this.user_settings[this.tasks_notification_setting]||(this.user_settings[this.tasks_notification_setting]=!1);const t=this.user_settings[this.tasks_notification_setting],e=this.menuList.findIndex((t=>"tasks"===t.name));-1===e&&t?(0,Z.cq)()||this.menuList.splice(1,0,{label:"tasks",name:"tasks",icon:"task_alt",separator:!1,to:"/tasks"}):t||-1===e||this.menuList.splice(e,1)},handleSettingDependantMenu(){(0,Z.sE)();this.user_settings[this.supplier_dashboard_setting]||(this.user_settings[this.supplier_dashboard_setting]=!1);let t=this.menuList.findIndex((t=>"supplier_dashboard"===t.name));const e=this.user_settings[this.supplier_dashboard_setting];e&&-1===t?(0,Z.cq)()||this.menuList.splice(1,0,{label:"supplier_management",name:"supplier_dashboard",icon:"people",separator:!1,to:"/supplier/dashboard"}):e||-1===t||this.menuList.splice(t,1),this.user_settings[this.workflow_builder_setting]?(0,Z.cq)()&&(this.user_settings[this.workflow_builder_setting]=!1):this.user_settings[this.workflow_builder_setting]=!1,this.user_settings[this.po_dashboard]||(this.user_settings[this.po_dashboard]=!1);const s=this.user_settings[this.po_dashboard];t=this.menuList.findIndex((t=>"purchase_order"===t.label)),-1===t&&s?(0,Z.cq)()||(0,Z.s5)()?"approved"==this.supplier_approval_status&&this.menuList.push({label:"purchase_order",name:"purchase_orders_and_invoices",icon:"shopping_cart",separator:!1,to:"/purchase-order"}):this.menuList.push({label:"purchase_order",name:"purchase_orders_and_invoices",icon:"shopping_cart",separator:!1,to:"/purchase-order"}):-1===t||s||this.menuList.splice(t,1),t=this.menuList.findIndex((t=>"workflow"===t.name));const i=this.user_settings[this.workflow_builder_setting];i&&-1===t?this.menuList.splice(1,0,{label:"workflow",name:"workflow",icon:"account_tree",separator:!1,to:"/workflows"}):i||-1===t||this.menuList.splice(t,1),this.user_settings[this.report_setting]||(this.user_settings[this.report_setting]=!1),t=this.menuList.findIndex((t=>"report"===t.name));const a=this.user_settings[this.report_setting];a&&-1===t?this.menuList.splice(1,0,{label:"layout.report",name:"report",icon:"query_stats",separator:!1,to:"/report"}):a||-1===t||this.menuList.splice(t,1),this.user_settings[this.invoice_dashboard_setting]||(this.user_settings[this.invoice_dashboard_setting]=!1);const n=this.user_settings[this.invoice_dashboard_setting],o=this.menuList.findIndex((t=>"invoice_dashboard"===t.name));-1===o&&n?(0,Z.cq)()||(0,Z.s5)()?"approved"==this.supplier_approval_status&&this.menuList.push({label:"invoice_dashboard",name:"invoice_dashboard",icon:"img:images/invoice.svg",separator:!1,to:"/invoice/dashboard"}):this.menuList.push({label:"invoice_dashboard",name:"invoice_dashboard",icon:"img:images/invoice.svg",separator:!1,to:"/invoice/dashboard"}):n||-1===o||this.menuList.splice(o,1),this.user_settings[g.aH.shipment_order_dashboard]||(this.user_settings[g.aH.shipment_order_dashboard]=!1);const r=this.user_settings[g.aH.shipment_order_dashboard];t=this.menuList.findIndex((t=>"shipment_order"===t.label)),-1===t&&r?(0,Z.cq)()||this.menuList.push({label:"shipment_order",name:"shipment_order",icon:"add_shopping_cart",separator:!1,to:"/shipment-order"}):-1===t||r||this.menuList.splice(t,1)},isDashboardRoute(){return"/dashboard"==this.$route.fullPath||"/supplier/dashboard"==this.$route.fullPath},keyDownEvent(t){"d"===t.key&&t.ctrlKey&&(this.miniState=!this.miniState)},navigateTo(t){t&&("/tasks"===t&&this.handleTasksFilters(),this.$router.push(t))},menuAccessibleCheck(){if((0,Z.cq)()){const t=["workflow","report","supplier_dashboard","asn_dashboard"],e=(0,Z.Ky)("organisations")[0];"approved"!==e.status&&t.push("purchase_orders_and_invoices");const s=this.menuList.filter((e=>-1==t.indexOf(e.name)));this.menuList=s}},handleTasks(){document.addEventListener("refreshTasks",this.getTaskCountListener),this.getTaskCount(),setInterval((()=>{this.getTaskCount()}),5e4)},terminateLongRunningTask(t,e){return new Promise(((s,i)=>{const a=setTimeout((()=>{i(new Error("Operation timed out")),this.handleWebsocketDelay()}),e);t.then((t=>{clearTimeout(a),s(t)})).catch((t=>{clearTimeout(a),i(t),this.handleWebsocketDelay()}))}))},getTaskCount(){const{CACHE_TN:t}=this.user_settings,e={cache:!1,ttl:0};if(t){let s=JSON.parse(t);e["cache"]=s.enabled,e["ttl"]=s.ttl}this.use_websocket?this.terminateLongRunningTask(this.getTaskCountByWebSocket(e),5e3):this.getTaskCountByHttpCall(e)},getTaskCountByWebSocket(t){return At(this,void 0,void 0,(function*(){try{this.data_status="fetching",this.all_tasks_count_data_flag=!1;const e=yield this.sendMessageToSocket("all_open_task_count",t);if(!e||!e.hasOwnProperty("data"))throw"Error in getting task count";this.task_count=e.data}catch(e){this.handleWebsocketDelay()}}))},getTaskCountByHttpCall(t){return At(this,void 0,void 0,(function*(){try{const e=yield T.Hg.getTotalTaskCount(t);e&&e.hasOwnProperty("success")&&e.success&&(this.task_count=e.data)}catch(e){}}))},getTaskCountListener(){this.getTaskCount()},handleTasksFilters(){const t=(0,Y.OP)();t.getSavedListSettings(),t.deleteItemInFiltersMap("keyword"),t.deleteItemInFiltersMap("status");const e=new CustomEvent("refresh_view",{});document.dispatchEvent(e)},logout(){q.A.methods.logout()},handleWebsocketDelay(){"received"!==this.data_status&&(this.use_websocket=!1,this.getTaskCount(),setTimeout(this.turnOnWebSocket,5e3))},turnOnWebSocket(){this.websocketHasError||(this.use_websocket=!0)},handleWebSocketResult(t){t&&(this.use_websocket=!0,this.task_count=t)}},data(){return{use_websocket:(0,c.KR)(!0),showIcons:!1,supportURL:d.cK,dark_mode_setting:g.up,menuList:(0,c.KR)([]),bottomItems:(0,c.KR)([]),supplier_dashboard_setting:g.t2,asn_dashboard_setting:g.fJ,tasks_notification_setting:g.so,workflow_builder_setting:g.$w,report_setting:g.EF,po_dashboard:g.aH.po_dashboard,invoice_dashboard_setting:g.wp}},setup(){const t=(0,Y.Bu)(),{user_settings:e,drawer:s,loading_settings:i}=(0,r.bP)(t),{startSettingsFetch:a}=t,n=(0,Y.iU)(),{total_unread_notifications:o}=(0,r.bP)(n),{getNotifications:l}=(0,Y.iU)(),u=(0,Y.OP)(),{total_records:d}=(0,r.bP)(u),{getTasks:h}=u,g=(0,c.KR)(""),p=(0,Y.G6)(),{all_tasks_count:_,isConnected:b,hasError:k,all_tasks_count_data_flag:m}=(0,r.bP)(p),{subscribeToChannel:f,unsubscribeToChannel:v,sendMessageByType:y}=p;return{total_unread_notifications:o,supplier_approval_status:g,startSettingsFetch:a,getNotifications:l,loading_settings:i,user_settings:e,drawer:s,getTasks:h,total_records:d,miniState:(0,c.KR)(!0),task_count:(0,c.KR)(0),app_version:(0,c.KR)("0.0.0"),data_status:(0,c.KR)(""),isConnected:b,all_tasks_count:_,websocketHasError:k,all_tasks_count_data_flag:m,subscribeToChannel:f,sendMessageToSocket:y,unsubscribeToChannel:v}}});var Ct=s(76056),Ft=s(23954);const St=(0,O.A)(Lt,[["render",E],["__scopeId","data-v-15198ce0"]]),It=St;vt()(Lt,"components",{QDrawer:Ct.A,QAvatar:rt.A,QList:at.A,QItem:nt.A,QItemSection:ot.A,QBadge:Ft.A,QIcon:lt.A,QTooltip:dt.A,QSeparator:ct.A,QMenu:ut.A,QBtn:bt.A}),vt()(Lt,"directives",{Ripple:kt.A});var Et=s(62103),qt=function(t,e,s,i){function a(t){return t instanceof s?t:new s((function(e){e(t)}))}return new(s||(s=Promise))((function(s,n){function o(t){try{l(i.next(t))}catch(e){n(e)}}function r(t){try{l(i["throw"](t))}catch(e){n(e)}}function l(t){t.done?s(t.value):a(t.value).then(o,r)}l((i=i.apply(t,e||[])).next())}))};const Tt=(0,i.pM)({name:"MainLayout",watch:{loading_settings:{handler:function(t,e){!1===t&&this.setDarkMode()}},"process.env.APP_VUE_CURRENT_VERSION":function(t,e){if(t){const t=(0,Y.Bu)();t.checkVersionUpdate()}}},unmounted(){document.removeEventListener("keydown",this.sendBack)},mounted:function(){document.addEventListener("keydown",this.sendBack),this.fillDocTypeAndSubTypesListIfEmpty(),this.initFontSize(),this.init(),this.app_version="6.65.2.2".toString()},methods:{isDashboardRoute(){return"/dashboard"==this.$route.fullPath||"/supplier/dashboard"==this.$route.fullPath},navigateTo(t){t&&this.$router.push(t)},init(){this.setDarkMode(),l.A.has("selected_language")&&(this.locale=l.A.getItem("selected_language"))},sendBack(t){"Escape"!==t.key||document.querySelector(".q-dialog")||"/dashboard"!=this.$route.path&&this.$router.go(-1)},setDarkMode(){return qt(this,void 0,void 0,(function*(){if(this.loading_settings)return;const t=yield this.getUserSettingWithExpiry(this.dark_mode_setting,!1);"true"!=t&&1!=t||this.$q.dark.set(!0),n.A.set(Boolean(t))}))},goHome(){this.$router.push("/dashboard")},supportIntegration(){this.$router.push("/support")},gotoSettings(){this.$router.push("/settings")},gotoReport(){this.$router.push("/report")},gotoCloud(){this.$router.push("/dashboard")},gotoWorkflow(){this.$router.push("/workflows")}},data(){return{showIcons:!1,supportURL:d.cK,dark_mode_setting:g.up}},components:{SideMenu:It,newUpdateError:Et.A},mixins:[h.A,u.A],setup(){let{locale:t}=(0,o.s9)({useScope:"global"});const e=(0,Y.cY)(),{fillDocTypeAndSubTypesListIfEmpty:s}=e,i=(0,Y.Bu)(),{user_settings:a,loading_settings:n}=(0,r.bP)(i),{getUserSettingWithExpiry:l}=i,u=(0,Y.Ml)(),{initFontSize:d}=u;return{loading_settings:n,getUserSettingWithExpiry:l,fillDocTypeAndSubTypesListIfEmpty:s,initFontSize:d,user_settings:a,settings_store:i,report:(0,c.KR)(!0),app_version:(0,c.KR)("0.0.0"),locale:(0,c.KR)(t),drawer:(0,c.KR)(!0),miniState:(0,c.KR)(!1),mode:(0,c.KR)("dashboard")}}});var xt=s(62008),Dt=s(8416),Wt=s(36914),Qt=s(45205);const $t=(0,O.A)(Tt,[["render",a],["__scopeId","data-v-011c28cb"]]),Pt=$t;vt()(Tt,"components",{QLayout:xt.A,QHeader:Dt.A,QToolbar:Wt.A,QIcon:lt.A,QPageContainer:Qt.A,QDialog:ht.A,QBtn:bt.A})}}]);