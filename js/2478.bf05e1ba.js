"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[2478],{52478:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Et});var o=i(61758),s=i(58790);const n=e=>((0,o.Qi)("data-v-33e79c10"),e=e(),(0,o.jt)(),e),r={class:"row q-pl-md q-pr-md highlighted-back field_validation"},a={class:"col-sm-5 col-md-5 col-lg-5"},l={class:"col secondary-c-text text-h6"},d={style:{"vertical-align":"middle","margin-left":"10px","font-size":"20px",cursor:"pointer"}},c={class:"col-sm-2 col-md-2 col-lg-2 q-ml-auto"},h={key:1,class:"row q-pl-md q-pr-md"},u={key:0,class:"full-width"},g={class:"row justify-center q-pl-md q-pr-md q-pt-md"},m={class:"secondary-c-text text-h6 text-weight-bold"},p={class:"row"},f={class:"page-numbers center-inner"},_={class:"full-width left-scroll-area-height scrolle-y q-pa-sm"},v=["data-id","src"],y={key:1},b={class:"q-pt-sm"},w={class:"image_control_panel p-t-4"},k={class:"row"},C={class:"panel-left col-sm-4 col-md-4 col-lg-4"},x={class:"row ellipsify"},F={class:"col-sm-8 col-md-8 col-lg-8",id:"buttonArea"},L={class:"right"},A=n((()=>(0,o.Lk)("img",{width:"24",src:"images/loupe.svg"},null,-1))),E={key:0},R=n((()=>(0,o.Lk)("img",{width:"24",src:"images/layout.svg"},null,-1))),S=n((()=>(0,o.Lk)("img",{width:"24",src:"images/costumer_care.svg"},null,-1))),D=n((()=>(0,o.Lk)("img",{width:"24",src:"images/ocr_icon.svg"},null,-1))),I=n((()=>(0,o.Lk)("img",{width:"24",src:"images/costumer_care.svg"},null,-1))),O=n((()=>(0,o.Lk)("img",{width:"24",src:"images/layout.svg"},null,-1))),T=n((()=>(0,o.Lk)("img",{width:"24",src:"images/ocr_icon.svg"},null,-1))),W={class:"full-width right-content-height",id:"image_container"},M={class:"full-width right-content-height",id:"image_scrolle",style:{position:"relative"}},B=n((()=>(0,o.Lk)("div",{class:"img-magnifier-glass"},null,-1))),q=["src","width"],V=["width","height","viewBox"],$={id:"marquee",ref:"marquee",x:"450",y:"420",width:"150",height:"150"},P={id:"boxes",ref:"boxes"},N={key:0,class:"full-width"},X={class:"row q-pl-sm q-pr-sm"},z={class:"col-sm-12 col-md-12 col-lg-12 secondary-c-text text-h6 q-pb-md text-weight-bold"},Q={class:"full-width"},H={class:"q-pa-sm"},K={class:"full-width medi-fields-content-height"},U={key:2,class:"row q-pl-md q-pr-md q-pb-md"},G=n((()=>(0,o.Lk)("div",{class:"text-h6 text-bold"},"Need help deciding?",-1))),Y={class:"row"},j={class:"q-ml-sm"},Z={class:"q-ml-sm"};function J(e,t,i,n,J,ee){const te=(0,o.g2)("DocumentLock"),ie=(0,o.g2)("MessageBanner"),oe=(0,o.g2)("SubHeader"),se=(0,o.g2)("q-icon"),ne=(0,o.g2)("q-btn"),re=(0,o.g2)("timeSpentTimer"),ae=(0,o.g2)("supportForm"),le=(0,o.g2)("q-resize-observer"),de=(0,o.g2)("q-tooltip"),ce=(0,o.g2)("keyboardShortcutInfoBtn"),he=(0,o.g2)("autoTesting"),ue=(0,o.g2)("q-item-section"),ge=(0,o.g2)("q-item-label"),me=(0,o.g2)("q-item"),pe=(0,o.g2)("q-list"),fe=(0,o.g2)("q-btn-dropdown"),_e=(0,o.g2)("q-splitter"),ve=(0,o.g2)("MediFieldsView"),ye=(0,o.g2)("ErrorDocumentView"),be=(0,o.g2)("Loader"),we=(0,o.g2)("q-space"),ke=(0,o.g2)("q-card-section"),Ce=(0,o.g2)("q-card"),xe=(0,o.g2)("q-dialog"),Fe=(0,o.g2)("selection-popup"),Le=(0,o.g2)("q-avatar"),Ae=(0,o.g2)("f-btn"),Ee=(0,o.g2)("q-card-actions"),Re=(0,o.g2)("SplitDocument"),Se=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(te,{document_version:e.document_version,trigger_document_lock:e.trigger_document_lock,doc_id:this.docId},null,8,["document_version","trigger_document_lock","doc_id"]),e.isReadOnly?((0,o.uX)(),(0,o.Wv)(ie,{key:0,message:e.error_message,messageCategoryClass:"error-banner"},null,8,["message"])):(0,o.Q3)("",!0),(0,o.bF)(oe,{name:"medi_order",onSearch:!1,label:e.$t("medi_order"),show_expiry_alert:!0},null,8,["label"]),(0,o.Lk)("div",r,[(0,o.Lk)("div",a,[(0,o.Lk)("div",l,[(0,o.bF)(ne,{flat:"",rounded:"","data-cy":"dashboard",color:"primary",onClick:e.goToDashboard},{default:(0,o.k6)((()=>[(0,o.bF)(se,{name:"fa-solid fa-circle-arrow-left",size:"sm"}),(0,o.Lk)("label",d,(0,s.v_)(e.$t("pages.screen2a.dashboard")),1)])),_:1},8,["onClick"])])]),(0,o.Lk)("div",c,[(0,o.bF)(re)])]),e.doc_fetch_error?((0,o.uX)(),(0,o.CE)("div",U,[(0,o.bF)(ye)])):((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",{class:(0,s.C4)(["q-mt-sm back-white","pages"==e.current_menu_data?"max-width-120":"max-width-250"]),id:"left_section",ref:"left_section"},["pages"===e.current_menu_data?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("div",g,[(0,o.Lk)("span",m,(0,s.v_)(e.$t("pages.screen2a.pages")),1)]),(0,o.Lk)("div",p,[(0,o.Lk)("div",f,(0,s.v_)(e.currentPage())+"/"+(0,s.v_)(e.images.length),1)]),(0,o.Lk)("div",_,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.images,((i,n)=>((0,o.uX)(),(0,o.CE)("img",{"data-id":n,key:n,src:e.baseUrl+"/"+i.path+"?"+e.tokenQueryParam,class:(0,s.C4)(["q-pa-xs shadow-5 full-width q-ma-sm cursor-pointer",n===e.page-1?"active":""]),style:{height:"auto"},onClick:t[0]||(t[0]=(...t)=>e.imageclicked&&e.imageclicked(...t))},null,10,v)))),128))])])):"support"===e.current_menu_data?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(ae)])):(0,o.Q3)("",!0)],2),(0,o.Lk)("div",{class:(0,s.C4)(["q-pl-sm","pages"==e.current_menu_data?"right_section_medi":"right_section_support"]),id:"right_section",ref:"right_section"},[(0,o.bF)(_e,{limits:[26,60],modelValue:e.imageFieldSplitter,"onUpdate:modelValue":[t[12]||(t[12]=t=>e.imageFieldSplitter=t),t[13]||(t[13]=t=>e.splitterChanged())],class:"medi-right-content-height"},{before:(0,o.k6)((()=>[(0,o.bF)(le,{onResize:e.onResize,debounce:0},null,8,["onResize"]),(0,o.Lk)("div",b,[(0,o.Lk)("div",w,[(0,o.Lk)("div",k,[(0,o.Lk)("div",C,[(0,o.Lk)("div",x,[(0,o.bF)(ne,{id:"menu_btn",round:"",icon:"chevron_left",size:"xs",class:"text-grey-6 toggler-right p-t-40",onClick:t[1]||(t[1]=t=>e.toggleMenu())}),(0,o.eW)(" "+(0,s.v_)(e.record.filename),1)])]),(0,o.Lk)("div",F,[(0,o.Lk)("div",L,[(0,o.bF)(ne,{flat:"",class:"p-4",onClick:e.zoomIn,icon:"img:images/zoom_in.svg",size:"14px"},{default:(0,o.k6)((()=>[(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)("Zoom in")])),_:1})])),_:1},8,["onClick"]),(0,o.bF)(ne,{flat:"",class:"p-4",onClick:e.zoomOut,icon:"img:images/zoom_out.svg",size:"14px"},{default:(0,o.k6)((()=>[(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)("Zoom out")])),_:1})])),_:1},8,["onClick"]),(0,o.bF)(ne,{flat:"",class:"p-4 icon-grey",icon:"download",onClick:t[2]||(t[2]=t=>e.downloadFile())}),(0,o.bF)(ne,{flat:"",id:"glassBtn",class:"p-4",size:"14px",onClick:e.initMagnifyGlass},{default:(0,o.k6)((()=>[A,(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("pages.screen2a.magnify")),1)])),_:1})])),_:1},8,["onClick"]),(0,o.Lk)("span",null,[(0,o.bF)(ce)]),e.showAllButtons?((0,o.uX)(),(0,o.CE)("span",E,[!0===this.is_admin?((0,o.uX)(),(0,o.Wv)(ne,{key:0,flat:"",id:"split_document",class:"float-right pr-6 pl-6",onClick:e.displaySplitDocumentView,icon:"img:images/split.svg",size:"14px"},{default:(0,o.k6)((()=>[(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("split_document_btn_tooltip")),1)])),_:1})])),_:1},8,["onClick"])):(0,o.Q3)("",!0),!0===this.is_admin?((0,o.uX)(),(0,o.Wv)(ne,{key:1,flat:"",class:"float-right pr-6 pl-6",size:"14px",onClick:t[3]||(t[3]=t=>e.goToLayoutTemplate())},{default:(0,o.k6)((()=>[R,(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)("Go to Layout Template")])),_:1})])),_:1})):(0,o.Q3)("",!0),!0===this.is_admin?((0,o.uX)(),(0,o.Wv)(ne,{key:2,flat:"",class:"float-right pr-6 pl-6",size:"14px",onClick:t[4]||(t[4]=t=>e.toggleSupportMenu())},{default:(0,o.k6)((()=>[S,(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("pages.support.create_ticket")),1)])),_:1})])),_:1})):(0,o.Q3)("",!0),!0===this.is_admin?((0,o.uX)(),(0,o.Wv)(ne,{key:3,flat:"",class:"float-right pr-6 pl-6",size:"14px",onClick:e.viewOCRDocument},{default:(0,o.k6)((()=>[D,(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("ocr_view")),1)])),_:1})])),_:1},8,["onClick"])):(0,o.Q3)("",!0),!0===this.is_debug?((0,o.uX)(),(0,o.Wv)(ne,{key:4,flat:"",icon:"adb",class:"p-4",size:"14px",onClick:t[5]||(t[5]=t=>e.enableOrDisableExportButton(!0))},{default:(0,o.k6)((()=>[(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.eW)("Debug Field Validations. Results will be displayed in the console after clicking it")])),_:1})])),_:1})):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),(0,o.Lk)("span",null,[(0,o.bF)(he,{onSetApiData:e.setApiData},null,8,["onSetApiData"])]),e.showAllButtons?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(fe,{key:1,flat:"",modelValue:e.dropdownModel,"onUpdate:modelValue":t[8]||(t[8]=t=>e.dropdownModel=t),"dropdown-icon":e.dropdownModel?"close":"more_vert",rounded:"",fab:!0,padding:"xs",class:"icon-grey q-mr-sm"},{default:(0,o.k6)((()=>[(0,o.bF)(pe,null,{default:(0,o.k6)((()=>[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(me,{clickable:"",onClick:t[6]||(t[6]=t=>e.toggleSupportMenu())},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{avatar:""},{default:(0,o.k6)((()=>[I])),_:1}),(0,o.bF)(ue,null,{default:(0,o.k6)((()=>[(0,o.bF)(ge,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("pages.support.create_ticket")),1)])),_:1})])),_:1})])),_:1})),[[Se]]),!0===e.is_admin?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(me,{key:0,clickable:"",onClick:t[7]||(t[7]=t=>e.goToLayoutTemplate())},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{avatar:""},{default:(0,o.k6)((()=>[O])),_:1}),(0,o.bF)(ue,null,{default:(0,o.k6)((()=>[(0,o.bF)(ge,null,{default:(0,o.k6)((()=>[(0,o.eW)("Go to Layout Template")])),_:1})])),_:1})])),_:1})),[[Se]]):(0,o.Q3)("",!0),!0===e.is_admin?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(me,{key:1,clickable:"",onClick:e.viewOCRDocument},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{avatar:""},{default:(0,o.k6)((()=>[T])),_:1}),(0,o.bF)(ue,null,{default:(0,o.k6)((()=>[(0,o.bF)(ge,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("ocr_view")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[Se]]):(0,o.Q3)("",!0),!0===e.is_admin?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(me,{key:2,clickable:"",onClick:e.displaySplitDocumentView},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{avatar:""},{default:(0,o.k6)((()=>[(0,o.bF)(se,{name:"splitscreen"})])),_:1}),(0,o.bF)(ue,null,{default:(0,o.k6)((()=>[(0,o.bF)(ge,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.$t("split_document_btn_tooltip")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[Se]]):(0,o.Q3)("",!0),!0===e.is_debug?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(me,{key:3,clickable:"",onClick:e.enableOrDisableExportButton},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{avatar:""},{default:(0,o.k6)((()=>[(0,o.bF)(se,{name:"adb"})])),_:1}),(0,o.bF)(ue,null,{default:(0,o.k6)((()=>[(0,o.bF)(ge,null,{default:(0,o.k6)((()=>[(0,o.eW)("Debug Field Validations.")])),_:1}),(0,o.bF)(ge,{caption:""},{default:(0,o.k6)((()=>[(0,o.eW)("Results will be displayed in the console after clicking it")])),_:1})])),_:1})])),_:1},8,["onClick"])),[[Se]]):(0,o.Q3)("",!0)])),_:1})])),_:1},8,["modelValue","dropdown-icon"]))])])])]),(0,o.Lk)("div",W,[(0,o.Lk)("div",M,[(0,o.bF)(_e,{horizontal:"",limits:[0,100],disable:!e.isExtenedPanel,modelValue:e.splitterModel,"onUpdate:modelValue":[t[11]||(t[11]=t=>e.splitterModel=t),e.handleScroll],class:"scroll-area-height-img-medi","after-class":(e.isExtenedPanel," q-pa-sm"),"before-class":" q-pa-sm img-magnifier-container","separator-class":(e.isExtenedPanel,"bg-black q-ma-sm")},{before:(0,o.k6)((()=>[B,(0,o.Lk)("img",{class:"screenshot",src:e.image+"?"+e.tokenQueryParam,width:e.imageWidth,id:"screenshot",ref:"screenshot",draggable:"false",onLoad:t[9]||(t[9]=t=>{e.imageLoaded=!0,e.getImageDetails()})},null,40,q),((0,o.uX)(),(0,o.CE)("svg",{width:e.imageWidth,height:e.imageHeight,viewBox:e.viewBox,id:"draw",ref:"draw",xmlns:"http://www.w3.org/2000/svg",style:{height:"auto","border-bottom":"5px dotted"}},[(0,o.Lk)("rect",$,null,512),(0,o.Lk)("g",P,null,512)],8,V))])),separator:(0,o.k6)((()=>[e.isExtenedPanel?((0,o.uX)(),(0,o.Wv)(ne,{key:0,disable:!e.isExtenedPanel,round:"",size:"xs",icon:"swap_vert",class:"text-grey-6 z-index-1",onClick:t[10]||(t[10]=t=>e.toggleSplitter())},null,8,["disable"])):(0,o.Q3)("",!0)])),after:(0,o.k6)((()=>[e.renderComponent&&e.hasApiData()?((0,o.uX)(),(0,o.CE)("div",N,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.formLayout,((t,i)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:`div-${i}`},[!0===t.is_panel_section_group?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,s.C4)(["display-inline-block",e.$refs["mediFieldsView"].getElementBorder(t)]),style:(0,s.Tr)("width:"+e.getElementWidth(t)+"%")},[(0,o.Lk)("div",X,[(0,o.Lk)("div",z,(0,s.v_)(t.title),1)]),(0,o.Lk)("div",Q,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.rows,((t,n)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:`div-${n}`},[e.isFieldHidden(t)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",{key:0,class:"q-pa-sm",style:(0,s.Tr)("width:"+e.getElementWidth(t)+"%")},[((0,o.uX)(),(0,o.Wv)((0,o.$y)(t.fieldType),{currentField:t,isReadOnly:!1,fieldName:t.name,groupIndex:i,onUpdateModel:e.$refs["mediFieldsView"].updateModel,onInputClicked:e.$refs["mediFieldsView"].showConnectionFromField,onInputValueChanges:e.$refs["mediFieldsView"].onInputValueChanges,onApplyFuzzySearch:e.$refs["mediFieldsView"].applyFuzzySearchWrapper},null,40,["currentField","fieldName","groupIndex","onUpdateModel","onInputClicked","onInputValueChanges","onApplyFuzzySearch"]))],4))],64)))),128))])],6)):(0,o.Q3)("",!0)],64)))),128))])):(0,o.Q3)("",!0)])),_:1},8,["disable","modelValue","after-class","separator-class","onUpdate:modelValue"])])])])])),after:(0,o.k6)((()=>[(0,o.Lk)("div",H,[(0,o.Lk)("div",K,[e.hasApiData()?((0,o.uX)(),(0,o.Wv)(ve,{key:0,ref:"mediFieldsView",isPanelSection:!1,renderOpenWindoIcon:!0,onOnFieldLoad:e.onFieldLoad,onHandleScroll:e.handleScroll,onSetDocVersion:e.setDocVersion,onSetSplitterModel:e.setSplitterModel,onShowConnectionFromField:e.showConnectionFromField,onRemoveOldMapiingsAndDrawNew:e.removeOldMapiingsAndDrawNew},null,8,["onOnFieldLoad","onHandleScroll","onSetDocVersion","onSetSplitterModel","onShowConnectionFromField","onRemoveOldMapiingsAndDrawNew"])):(0,o.Q3)("",!0)])])])),_:1},8,["modelValue"])],2)])),(0,o.bF)(be),(0,o.bF)(xe,{modelValue:e.showDialog,"onUpdate:modelValue":t[15]||(t[15]=t=>e.showDialog=t)},{default:(0,o.k6)((()=>[(0,o.bF)(Ce,null,{default:(0,o.k6)((()=>[(0,o.bF)(ke,{class:"row items-center q-pb-none"},{default:(0,o.k6)((()=>[G,(0,o.bF)(we),(0,o.bo)((0,o.bF)(ne,{icon:"close",flat:"",round:"",dense:""},null,512),[[Se]])])),_:1}),(0,o.bF)(ke,null,{default:(0,o.k6)((()=>[(0,o.eW)(" Don't think too much and just contact us to learn more about the application! ")])),_:1}),(0,o.Lk)("div",Y,[(0,o.bF)(we),(0,o.bF)(ne,{flat:"",color:"primary",label:"Contact us",onClick:t[14]||(t[14]=t=>e.goFormular())})])])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(xe,{modelValue:e.showSelectionPopupDialog,"onUpdate:modelValue":t[16]||(t[16]=t=>e.showSelectionPopupDialog=t),position:"top",persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(Fe,{data:e.selection_popup_data},null,8,["data"])])),_:1},8,["modelValue"]),(0,o.bF)(xe,{modelValue:e.confirm_supplier_unblock,"onUpdate:modelValue":t[17]||(t[17]=t=>e.confirm_supplier_unblock=t),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(Ce,null,{default:(0,o.k6)((()=>[(0,o.bF)(ke,{class:"row items-center"},{default:(0,o.k6)((()=>[(0,o.bF)(Le,{icon:"block",color:"primary","text-color":"white"}),(0,o.Lk)("span",j,(0,s.v_)(e.$t("unblock_supplier_confirmation")),1)])),_:1}),(0,o.bF)(Ee,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(Ae,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[Se]]),(0,o.bF)(Ae,{class:"q-mr-sm","data-cy":"setvatfield",label:e.$t("confirm"),onClick:e.enableBlockedSupplier},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(xe,{modelValue:e.deleteConfirmationDlg,"onUpdate:modelValue":t[19]||(t[19]=t=>e.deleteConfirmationDlg=t),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(Ce,null,{default:(0,o.k6)((()=>[(0,o.bF)(ke,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,o.k6)((()=>[(0,o.bF)(Le,{icon:"warning",color:"primary","text-color":"white"})])),_:1}),(0,o.bF)(ke,{class:"row items-center"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",Z,(0,s.v_)(e.$t("pages.messages.msg_delete")),1)])),_:1}),(0,o.bF)(Ee,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(ne,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[Se]]),(0,o.bo)((0,o.bF)(ne,{flat:"",label:e.$t("delete"),color:"primary",onClick:t[18]||(t[18]=t=>e.deleteRule(e.selectedInputObj))},null,8,["label"]),[[Se]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(xe,{modelValue:e.split_document,"onUpdate:modelValue":t[20]||(t[20]=t=>e.split_document=t),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(Re)])),_:1},8,["modelValue"])],64)}var ee=i(1659),te=i(6044),ie=i(24622),oe=i(45938),se=i(38734),ne=i(46162),re=i(96056),ae=i(89156),le=i(64233),de=i(14907),ce=i(18505),he=i(57366),ue=i(42300),ge=i(11470),me=i(31018),pe=i(53665),fe=i(81589),_e=i(25891),ve=i(93970),ye=i(39281),be=i(93829),we=i(68180),ke=i(68987),Ce=i(82080),xe=i(76956),Fe=i(98028),Le=i(12566),Ae=i(96075),Ee=i(13322),Re=i(46687),Se=i(72608),De=i(68450),Ie=i(64500),Oe=i(26471),Te=i(1595),We=i(18783),Me=i(7538),Be=i(72440),qe=i(21529),Ve=i(17866),$e=i(35519),Pe=i(40260),Ne=i(4995),Xe=i(91990),ze=i(84050),Qe=i(73937),He=function(e,t,i,o){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(t){n(t)}}function a(e){try{l(o["throw"](e))}catch(t){n(t)}}function l(e){e.done?i(e.value):s(e.value).then(r,a)}l((o=o.apply(e,t||[])).next())}))};let Ke=[],Ue={startX:0,startY:0,endX:0,endY:0};const Ge={x:0,y:0,width:0,height:0,connectionId:""};let Ye=0,je=0;const Ze=document.querySelector.bind(document);let Je,et,tt,it;const ot=(0,o.pM)({el:"#app",mixins:[ie.A,re.A,ce.A,le.A,he.A,ue.A,me.A,te.A,_e.A,Ce.A,Re.A,Ie.A,ze.A],components:{Loader:ae.A,autoTesting:pe.A,DocumentLock:fe.A,MessageBanner:ve.A,SelectionPopup:ye.A,Classification:be.A,MediFieldsView:Fe["default"],SplitDocument:ke.A,SubHeader:we.A,supportForm:Ee.A,ErrorDocumentView:Le.A,restartClassificationPopup:Oe.A,Label:We.A,CheckBox:Me.A,TextInput:Be.A,MultiCheckBox:qe.A,ExtractedTable:Ve.A,TableOfCheckboxes:$e.A,HorizontalSeparator:Pe.A,timeSpentTimer:Ne.A,keyboardShortcutInfoBtn:Xe.A},watch:{$route(e,t){if(!e.hasOwnProperty("path")||!t.hasOwnProperty("path"))return;const i=e.path.split("/"),o=t.path.split("/");i.length>2&&o.length>2&&i[1]===o[1]&&this.get_cached_data_id!=this.docId&&window.location.reload()}},data(){return{docId:"",contact:this.$t("confirm"),showDialog:!1,showExportDialog:!1,showArticlePage:!1,disableSelectionButton:!0,loading:!1,magnifyGlass:{},allowedDoctypes:xe.Gk,format_warning_dismiss:{},origin_warning_alert:{},selection_popup_data:{},showSelectionPopupDialog:!1,amount_fields_confidence_count:0,excluded_fields:["fields_group"],account_block:"",error_message:"",trigger_document_lock:(0,se.KR)(!1),split_document:(0,se.KR)(!1),showAllButtons:(0,se.KR)(!1),headerFabIcon:(0,se.KR)(!1),dropdownModel:(0,se.KR)(!1),imageLoaded:(0,se.KR)(!1)}},beforeRouteLeave:function(e,t,i){return He(this,void 0,void 0,(function*(){this.setDataToCache(),this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.removeMagnifier(),this.removeAllNotifications(),"function"===typeof this.format_warning_dismiss&&this.format_warning_dismiss(),"function"===typeof this.origin_warning_alert&&this.origin_warning_alert(),yield this.releaseDocLock({doc_id:this.record.doc_id}),this.record={},this.page=1,this.resetStoreOnRouteChange(),i()}))},showDialog1:function(){setTimeout((()=>{this.showDialog=!0}),2e3)},beforeMount:function(){this.renderComponent=!1,this.isExtenedPanel=!1},mounted:function(){it=this,this.showLoading(),this.init(),this.isDebugFlagHandler(),this.is_admin=(0,Qe.N6)(),window.addEventListener("resize",this.windowResize),document.body.addEventListener("click",this.mouseClicked,!0);const e=Ze(".img-magnifier-container");e&&e.addEventListener("scroll",this.handleScroll);const t=Ze(".q-splitter__after");t&&t.addEventListener("scroll",this.handleScroll),document.addEventListener("selection_popup_closed",this.selectionPopupClosed),window.addEventListener("beforeunload",this.unLockDoc)},unmounted:function(){window.removeEventListener("resize",this.windowResize),window.removeEventListener("beforeunload",this.unLockDoc),document.removeEventListener("selection_popup_closed",this.selectionPopupClosed),window.removeEventListener("keydown",this.keydownEvent),document.removeEventListener("removeSelectedAreaOnImage",this.removeSelectedAreaOnImage);const e=Ze(".img-magnifier-container");e&&e.removeEventListener("scroll",this.handleScroll);const t=Ze(".q-splitter__after");t&&t.removeEventListener("scroll",this.handleScroll);try{Je=Ze(".screenshot"),Je&&(Je.removeEventListener("dblclick",this.dblClickToSelect),Je.removeEventListener("pointerdown",this.startDrag))}catch(i){logError("something went wrong while unmount",i)}},methods:{downloadFile(){try{let e=ne.VA+"/resource/document/"+this.docId+"/"+this.docId+".pdf?"+this.tokenQueryParam;if(!e)return;fetch(e).then((e=>e.blob())).then((e=>{const t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download=this.record.filename,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)})).catch((e=>{logError("Error downloading file:",e)}))}catch(e){logError(e)}},toggleSupportMenu(){""==this.current_menu_data?(this.toggleMenu(),this.current_menu_data="support"):"support"==this.current_menu_data?this.current_menu_data="pages":"pages"==this.current_menu_data&&(this.current_menu_data="support",logInfo(this.current_menu_data))},init(){return He(this,void 0,void 0,(function*(){this.docId=this.$route.params.id,this.setAppType(),yield this.getInvoiceDataByDocId(this.docId),this.record&&0!==Object.keys(this.record).length&&!1!==this.record.success?(this.handleReadOnly(),this.handleDocLockSubscribe(),this.getSplitterValueFromStorage(),this.isReadOnly?(this.error_message=this.$t("pages.messages.READ_ONLY_MSG"),this.trigger_document_lock=!1):this.trigger_document_lock=!0,this.initPage()):this.hideLoading()}))},setAppType(){this.$route.params.id||this.goToDashboard(),setTimeout((()=>{this.showDialog=!1}),1e4)},handleDocLockSubscribe(){const e=(0,Te.oI)();e.$subscribe(((e,t)=>{this.isReadOnly=!this.doc_lock.success,this.handleReadOnly()}))},handleReadOnly(){if(xe.B2.includes(this.record.status))return void(this.isReadOnly=!0);const e=oe.tH.hasAccess("update");e||(this.isReadOnly=!0)},getInvoiceDataByDocId(e){return He(this,void 0,void 0,(function*(){try{if(this.get_cached_data_id===e&&(yield this.setRecordFromCache()))return;this.record=[],this.clearSelectedSessionStorage(),yield this.getDocumentById(e)}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(t)}}))},getConfidence(e){return e?e<1?(100*+e.toFixed(2)).toFixed(0):+e.toFixed(2):""},getLowerConfidence(e){if(e.confidence&&e.score){let t=e.confidence<1?(100*e.confidence.toFixed(2)).toFixed(0):e.confidence.toFixed(2),i=e.score<=1?(100*e.score.toFixed(2)).toFixed(0):e.score.toFixed(2);return t=Number(t),i=Math.floor(Number(i)),t<i?t:i}return e.confidence?e.confidence<1?(100*e.confidence.toFixed(2)).toFixed(0):e.confidence.toFixed(2):null},initPage(){this.handleFormatWarning(),this.docType=this.record.doc_type;let e=this.handleImageBaseURL(this.record.images);""!==e&&(this.baseUrl=e),this.setImage(),this.images=(0,Ae.m)(this.record.images),this.setDocVersion(),et=Ze("#marquee"),Je=Ze(".screenshot"),tt=Ze("#boxes"),et.classList.add("hide");let t=Ze("#image_container");this.imageWidth=t.offsetWidth,this.imageHeight=t.offsetHeight,this.viewBox="0 0 "+String(this.imageWidth)+" "+String(this.imageHeight),Je.addEventListener("dblclick",this.dblClickToSelect),Je.addEventListener("pointerdown",this.startDrag),window.addEventListener("keydown",this.keydownEvent),document.addEventListener("removeSelectedAreaOnImage",this.removeSelectedAreaOnImage),this.getAI_IndicatorData(),this.setShowAllButtonsPanel()},setShowAllButtonsPanel(){const e=Ze("#buttonArea");e.clientWidth>=300?this.showAllButtons=!0:this.showAllButtons=!1},setImage(){this.record.hasOwnProperty("classification")&&this.record.classification.hasOwnProperty("classification_page")&&(this.page=this.record.classification.classification_page),this.image=this.baseUrl+"/"+(0,Ae.v)(this.record.images[this.page-1].path)},isElementLoaded(e){return He(this,void 0,void 0,(function*(){while(null===document.querySelector(e))yield new Promise((e=>requestAnimationFrame(e)));return document.querySelector(e)}))},handleRectsElementsLoading(){const e=this.record;this.fields_pending_load_count=0,this.fields_loaded_count=0,Array.from(e.fields).forEach((e=>{this.page==e.page&&e.coords&&(this.fields_pending_load_count++,this.isElementLoaded("#"+e.name).then((e=>{this.fields_loaded_count++,this.fields_loaded_count==this.fields_pending_load_count&&this.prepareRectangles()})))}))},keydownEvent(e){try{"Escape"===e.key?(this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.restrictDrawing(),this.removeMagnifier()):"Enter"===e.key?(this.removeExistingConfirmationOverlays(),this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.connectionId=""):"ArrowDown"===e.key&&(this.removeExistingConfirmationOverlays(),this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.$refs["mediFieldsView"].selectNextField(this.connectionId),this.connectionId="")}catch(e){logInfo(e)}},getAI_IndicatorData(){return He(this,void 0,void 0,(function*(){try{let e;if(this.ai_fields=this.record&&this.record.fields&&Array.isArray(this.record.fields)?this.record.fields.length:0,!this.record.filter_values||!(this.record.filter_values.length>0)||!Array.isArray(this.record.filter_values))throw"getAI_IndicatorData () no filter_values or doc_type to proceed";let t="?doc_type="+this.record.doc_type+"&filter_values="+this.record.filter_values.join();if(e=yield ge.M8.get_ai_score(t),!e.success)throw e.message;if(!0===e.success){this.ai_rules=e.rules;const t=new CustomEvent("FV_gauge_calculation",{detail:e});document.dispatchEvent(t)}}catch(e){logError(e)}}))},imageclicked(e){this.connectionId="",this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.image=this.baseUrl+"/"+(0,Ae.v)(this.record.images[e.target.dataset.id].path),this.getImageDetails(),this.page=parseInt(e.target.dataset.id)+1},goToLineItems(){this.setDataToCache(),this.$router.push("/tbl_ext_v3/"+this.$route.params.id)},landing(){this.removeCache(),this.$router.push("/land")},startDrag(e){let t=0,i=0;if(1===e.button){const t=this.hitTest(e.layerX,e.layerY);return void(t&&(Ke.splice(Ke.indexOf(t),1),this.redraw()))}window.addEventListener("pointerup",this.stopDrag),Je.addEventListener("pointermove",this.moveDrag),et.classList.remove("hide"),Ye=e.layerX,je=e.layerY;let o="";Object.assign(Ge,{startX:Ye,startY:je,width:i,height:t,connectionId:o}),this.drawRect(et,Ge)},stopDrag(e){et.classList.add("hide"),window.removeEventListener("pointerup",this.stopDrag),Je.removeEventListener("pointermove",this.moveDrag),e.target===Je&&Ge.width&&Ge.height&&(this.connectionId&&(Ge.connectionId=this.connectionId),Ke.push(Object.assign({},Ge)),this.redraw(),this.restrictDrawing(),this.saveOverlayResult())},moveDrag(e){let t=e.layerX,i=e.layerY,o=e.layerX,s=e.layerY,n=Ye-t,r=je-i;n<0&&(n*=-1,t-=n),r<0&&(r*=-1,i-=r);let a="";Object.assign(Ue,{startX:Ye,startY:je,endX:o,endY:s}),Object.assign(Ge,{x:t,y:i,width:n,height:r,connectionId:a}),this.drawRect(et,Ge)},hitTest(e,t){return Ke.find((i=>e>=i.x&&t>=i.y&&e<=i.x+i.width&&t<=i.y+i.height))},redraw(){tt.innerHTML="",Ke.forEach((e=>{tt.appendChild(this.drawRect(document.createElementNS("http://www.w3.org/2000/svg","rect"),e))}))},drawRect(e,t){if("object"==typeof t){let i="cursor-pointer";const{x:o,y:s,width:n,height:r,connectionId:a}=t;if(e.setAttributeNS(null,"width",n),e.setAttributeNS(null,"height",r),e.setAttributeNS(null,"x",o),e.setAttributeNS(null,"y",s),e.setAttributeNS(null,"connectionId",a),a){e.setAttributeNS(null,"id",a+"_rect");let t=this.record.fields.filter((e=>a==e.name));const o=t.length>0?t.pop():{};o.hasOwnProperty("trocr_processor")&&""!=o.trocr_processor&&(i+=" extract_by_tcocr ")}e.setAttributeNS(null,"class",i),!1===this.isReadOnly&&e.addEventListener("click",this.showConnectionFromRect)}return e},getImageDetails(){return He(this,void 0,void 0,(function*(){if(0==this.renderComponent||0==this.imageLoaded)return;if(this.imageWidth=Je.offsetWidth,this.imageHeight=Je.offsetHeight,this.viewBox="0 0 "+String(this.imageWidth)+" "+String(this.imageHeight),yield this.$nextTick(),this.prepareRectangles(),!this.connectionId)return;if(this.isFreshStart)return this.isFreshStart=!1,void this.showConnectionFromField(this.connectionId);let e=this.getElementToConnect(Ze("#"+this.connectionId));e&&this.proceedForReactFinding(this.connectionId,e)}))},assignImageDimenions(){let e=Ze("#image_container");e&&(this.imageWidth=e.offsetWidth-12,this.imageHeight=e.offsetHeight-32),this.viewBox="0 0 "+String(this.imageWidth)+" "+String(this.imageHeight)},onFieldLoad(e,t){this.connectionId=e,this.isFreshStart=t,this.getImageDetails()},prepareRectangles(){const e=this.record;Ke=[],Array.from(e.fields).forEach((e=>{const t=Ze("#"+e.name);if(t){if(this.page==e.page&&e.coords&&e.coords[0]&&e.coords[0].hasOwnProperty("x")&&e.coords[0].hasOwnProperty("y")){let t=Math.round(this.imageWidth*e.coords[0].x),i=Math.round(this.imageHeight*e.coords[0].y),o=Math.round(this.imageWidth*e.coords[2].x),s=Math.round(this.imageHeight*e.coords[2].y),n=o-t||20,r=s-i||20;n<0&&(n*=-1,t-=n),r<0&&(r*=-1,i-=r),Ge.x=t,Ge.y=i,Ge.width=n,Ge.height=r,Ge.connectionId=e.name,Ke.push(Object.assign({},Ge))}e.page&&null!=e.page&&t.setAttribute("pageno",e.page)}})),this.redraw()},showConnectionFromRect(e){this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.restrictDrawing();const t=e.target.getAttribute("connectionId"),i=e.target,o=this.getElementToConnect(Ze("#"+t));this.scrollInToViewCenter(o),this.scrollInToViewCenter(i),document.documentElement.scrollTop=0,setTimeout((()=>{this.showConnection(t,i,o)}),50)},removeOverlayandLines(){this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays()},loadPageHavingReact(e){let t=this.getElementToConnect(Ze("#"+e));if(!t)return;let i=Number(t.getAttribute("pageno"));i=isNaN(i)?this.page:i;const o=i&&i!==this.page;return this.connectionId=e,o?(this.page=i,void(this.image=this.baseUrl+"/"+(0,Ae.v)(this.record.images[this.page-1].path))):t},showConnectionFromField(e){this.removeOverlayandLines(),this.restrictDrawing();let t=this.loadPageHavingReact(e);t&&this.proceedForReactFinding(e,t)},proceedForReactFinding(e,t){let i=Ze("#"+e+"_rect");i&&(this.scrollInToViewCenter(i),document.documentElement.scrollTop=0),setTimeout((()=>{i?(this.showConnection(e,i,t),this.connectionId=""):this.proceedIfReactNotFound(t)}),50)},proceedIfReactNotFound(e){if("ELECTRONIC_DOCUMENT"===this.record.extraction_method)return;this.componentType=e.getAttribute("child_type");let t="";if("checkbox"===this.componentType)t=e.getAttribute("aria-checked")?"true":"";else{let i=e.querySelector(this.componentType);i&&(t=i.value)}if(""!=t){this.showNotification(this.$t("pages.messages.SELECT_AREA_NO_COORDINATES"));const e=new CustomEvent("dispatch_status_bar_message",{detail:{message:this.$t("pages.messages.SELECT_AREA")}});document.dispatchEvent(e)}else{this.showNotification(this.$t("pages.messages.SELECT_AREA"));const e=new CustomEvent("dispatch_status_bar_message",{detail:{message:this.$t("pages.messages.SELECT_AREA")}});document.dispatchEvent(e)}this.enableDrawing()},showConnection(e,t,i){t&&i?(this.drawOverlay(e,t),t.classList.add("border"),this.connect(t,i,"#26a69a",2)):alert(this.$t("pages.messages.NO_MAPPING_AVAILABLE"))},drawOverlay(e,t){var i,o,s;if(this.isConfirmationBoxDisable)return;this.connectionId=e,this.removeExistingConfirmationOverlays();const n=Ze("#"+e);if(!n)return;let r;this.componentType=n.getAttribute("child_type");let a="";if("checkbox"===this.componentType)a=n.getAttribute("aria-label"),r="Un-Checked","true"===n.getAttribute("aria-checked")&&(r="Checked");else{const t=Ze("."+e);a=t.innerHTML;const i=n.querySelector(this.componentType);r=i.value}const l=this.getOffset(t),d=document.createElement("div");d.setAttribute("id","confirmation_overlay"),d.style.position="absolute",d.style.zIndex="99999",d.style.left=l.left+"px",d.style.top=(+l.top+ +l.height+6).toString()+"px",d.style.background="#e2e2e2",d.style.color="#898989",d.style.minHeight="80px",d.style.minWidth="100px",d.style.maxWidth="50%",d.style.textAlign="center",d.style.padding="5px 10px 5px 10px",d.style.letterSpacing="1px",d.style.borderRadius="7px",d.style.boxShadow="0 1px 2px rgba(0,0,0,0.07),\n      0 2px 4px rgba(0,0,0,0.07),\n      0 4px 8px rgba(0,0,0,0.07),\n      0 8px 16px rgba(0,0,0,0.07),\n      0 16px 32px rgba(0,0,0,0.07),\n      0 32px 64px rgba(0,0,0,0.07);";let c=this.getTrashIcon(e);d.innerHTML=`<div><b>${r}</b></div><div><b style='font-size: 9px'>${a}</b></div>\n                  <div>\n                  ${c}\n                  <span class='divOverlayWrong'>\n                    <i connectionId='${e}' style='display: inline-block;border-radius: 50px;box-shadow: 0px 0px 2px #888;padding: 0.5em 0.6em;' class='fa fa-times cursor-pointer'></i>\n                  </span>\n                  <span id='divOverlayCorrect'>\n                    <i style='display: inline-block;border-radius: 50px;box-shadow: 0px 0px 2px #888;padding: 0.5em 0.5em;' class='fas fa-check cursor-pointer'></i>\n                  </span></div>`,document.body.appendChild(d),null===(i=Ze("#divOverlayCorrect"))||void 0===i||i.addEventListener("click",(t=>{this.removeExistingConfirmationOverlays(),this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.$refs["mediFieldsView"].selectNextField(e)}));let h=document.getElementsByClassName("divOverlayWrong");Array.from(h).forEach((e=>{null===e||void 0===e||e.addEventListener("click",(e=>{this.connectionId=e.target.getAttribute("connectionId"),this.connectionId?(this.$refs["mediFieldsView"].initTempFieldDelete(),this.refreshCanvas(),this.$forceUpdate(),this.enableDrawing()):logError("connection id not found")}))})),null===(o=Ze("#deleteRuleFromConnection"))||void 0===o||o.addEventListener("click",(e=>{this.connectionId=e.target.getAttribute("connectionId"),this.connectionId?(this.deleteRuleFromConnection(),this.enableDrawing()):logError("connection id not found")}));try{const i=Ze("#confirmation_overlay"),o=null===(s=Ze("#confirmation_overlay"))||void 0===s?void 0:s.clientWidth,n=l.width,r=(+o-+n)/2;i.style.left=+l.left-+r+"px";let a=+t.getAttribute("width")+ +t.getAttribute("y")+i.offsetHeight;a>=Je.offsetHeight&&(d.style.top=(+l.top-6-+i.offsetHeight).toString()+"px");let c=null,h=this.getScoreDescription(this.fields[e]);null!=h&&""!==h&&(c={score:String(h),background:this.getColor(Number(h))}),c&&setTimeout((()=>{this.overlayForScore(i,c)}),10)}catch(u){}},overlayForScore(e,t){let i=t.score,o=t.background;const s=this.getOffset(e),n=document.createElement("div");n.setAttribute("id","score_overlay"),n.style.position="absolute",n.style.zIndex="99999",n.style.left=(+s.left+s.width-10).toString()+"px",n.style.top=(+s.top-20).toString()+"px",n.style.background=o,n.style.color="#898989",n.style.fontSize="14px",n.style.fontWeight="bold",n.style.letterSpacing="2px",n.style.cursor="pointer",n.style.padding="0.1em 0.6em",n.style.border="1px solid #f5f5f5",n.style.borderRadius="50px",n.innerHTML=`<div> <span  class='column-score-test' > ${i} </span> </div>`,document.body.appendChild(n)},getScoreDescription(e){let t="";return e&&e.hasOwnProperty("score_description")&&""!==e.score_description&&null!=e.score_description&&(t=e.score_description),String(t)},removeBordersFromRectangles(){let e=document.body.getElementsByTagName("rect");for(let t of e)t.classList.remove("border")},removeAllConnectionLines(){const e=Ze("#connection_line");e&&e.remove()},enableDrawing(e=!1){e&&(Ke.pop(),this.redraw());const t=Ze("#draw");null===t||void 0===t||t.classList.add("enableDrawingRectangle");const i=Ze(".screenshot");null===i||void 0===i||i.classList.add("cursor-crosshair")},restrictDrawing(){const e=Ze("#draw");null===e||void 0===e||e.classList.remove("enableDrawingRectangle");const t=Ze(".screenshot");null===t||void 0===t||t.classList.remove("cursor-crosshair")},cancelOverlayDiv(){Ke.pop(),this.redraw()},saveOverlayResult(){const e=Ke[Ke.length-1],t=Ke.filter((function(t,i,o){return t.connectionId!==e.connectionId}));Ke=[],Ke=JSON.parse(JSON.stringify(t)),Ke.push(e),this.redraw(),this.getTextByCoordinates(Ue)},connect(e,t,i,o){const s=this.getOffset(e),n=this.getOffset(t),r=s.left+s.width,a=s.top+s.height/2,l=n.left,d=n.top,c=Math.sqrt((l-r)*(l-r)+(d-a)*(d-a)),h=(r+l)/2-c/2,u=(a+d)/2-o/2,g=Math.atan2(a-d,r-l)*(180/Math.PI);this.removeAllConnectionLines();const m=document.createElement("div");m.setAttribute("id","connection_line"),m.style.cssText="z-index: 102;padding:0px; margin:0px; height:"+o+"px; background-color:"+i+"; line-height:1px; position:absolute; left:"+h+"px; top:"+u+"px; width:"+c+"px; -moz-transform:rotate("+g+"deg); -webkit-transform:rotate("+g+"deg); -o-transform:rotate("+g+"deg); -ms-transform:rotate("+g+"deg); transform:rotate("+g+"deg);",document.body.appendChild(m)},getOffset(e){const t=e.getBoundingClientRect();return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,width:t.width||e.offsetWidth,height:t.height||e.offsetHeight}},getTextByCoordinates(e){return He(this,void 0,void 0,(function*(){const t=this.record;let i,o=new FormData,s=e.startX/this.imageWidth,n=e.startY/this.imageHeight,r=e.endX/this.imageWidth,a=e.endY/this.imageHeight;o.append("x0",s.toString()),o.append("y0",n.toString()),o.append("x1",r.toString()),o.append("y1",a.toString()),o.append("doc_id",t.doc_id),o.append("page",this.page.toString()),o.append("field_name",this.connectionId),this.showLoading();try{i=yield ge.M8.get_field_value(o)}catch(d){return this.showErrorToast(this.$t("pages.messages.error_internal_occur")),void logError(d)}finally{this.hideLoading()}const l=i.data.coords;if(!l||0===l[0].x&&0===l[0].y&&""===i.data.formatted_value)return this.showErrorToast(this.$t("pages.messages.EMPTY_MAPPING_NOT_ALLOWED")),this.prepareRectangles(),void this.enableDrawing();this.$refs["mediFieldsView"].updateFieldData(i.data)}))},enableOrDisableExportButton(e){let t=[];this.record.fields.forEach(((i,o)=>{if(!1===i.is_valid&&!this.isFieldCalcualtedFromLayout(i.name)&&this.isfieldsNotDisplayed(i.name)){if(!e)return;t.push(this.$t("pages.screen2a."+i.name))}})),e&&this.printFieldsNeedToBeValidated(t)},printFieldsNeedToBeValidated(e){e?(logInfo("======================================="),logInfo("Following fields need to be validated"),logInfo(e.toString()),logInfo("=======================================")):logInfo("All fields are validated")},isFieldCalcualtedFromLayout(e){let t=!1;for(const i of this.formLayout)for(const o of i.rows)o.field_name==e&&o.calculation_formula&&(t=!0);return t},isfieldsNotDisplayed(e){let t=!0;return this.fieldsNotDisplayed.hasOwnProperty(e)&&(t=!1),t},setApiData(e){this.record=e,this.$forceUpdate()},setDocVersion(){this.document_version=this.record.document_version?this.record.document_version:1},windowResize(){this.assignImageDimenions(),setTimeout((()=>{this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.restrictDrawing(),this.getImageDetails(),this.removeMagnifier()}),20)},handleScroll(){this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays()},isButtonToggleDisable(){return!!xe.B2.includes(this.record.status)},deleteRuleConfirmation(e){this.deleteConfirmationDlg=!0,this.selectedInputObj=e},deleteRule(e){this.record.hasOwnProperty("clear_rules_fields_for_user")||(this.record.clear_rules_fields_for_user=[]),this.record.fields.forEach(((t,i)=>{t.name===e.field_name&&(this.record.clear_rules_fields_for_user.push(e.field_name),this.fields[e.field_name]=Object.assign(this.fields[e.field_name],{deleted:!0,color:null,value:"",confidence:0,formatted_value:"",content:null,validation_code:null,coords:null}),this.record.fields.splice(i,1))})),this.refreshCanvas()},refreshCanvas(){this.prepareRectangles(),this.$forceUpdate(),this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.getImageDetails(),this.redraw()},removeSelectedAreaOnImage(e){Ke.pop(),this.refreshCanvas(),this.restrictDrawing()},getCursorPos(e){var t,i=0,o=0;e=e||window.event;let s=Ze(".screenshot");return t=s.getBoundingClientRect(),i=e.pageX-t.left,o=e.pageY-t.top,i-=window.pageXOffset,o-=window.pageYOffset,{x:i,y:o}},removeMagnifier(){const e=Ze("#glassBtn");e&&e.classList.remove("glass-active");let t=document.querySelector(".img-magnifier-glass");t&&(t.style.display="none",t.classList.remove("enable-glass"),t.removeEventListener("pointermove",this.moveMagnifier));const i=Ze("#draw");i&&i.removeEventListener("pointermove",this.moveMagnifier),document.body.classList.remove("active"),this.magnifyGlass=null},mouseClicked(e){this.removeMagnifier()},currentPage(){return this.page},dblClickToSelect(e){Ue={startX:e.layerX,startY:e.layerY,endX:e.layerX,endY:e.layerY},this.getTextByCoordinates(Ue)},deleteRuleFromConnection(){let e={};e.field_name=this.connectionId,this.deleteRule(e)},getTrashIcon(e){let t=this.fields[e],i="";return t?(i=!t.deleted&&t.rule?`<span id='deleteRuleFromConnection'>\n          <i connectionId='${e}' style='display: inline-block;border-radius: 50px;box-shadow: 0px 0px 2px #888;padding: 0.5em 0.6em;' class='fa fa-trash'></i>\n          </span>`:`<span class='divOverlayWrong'>\n                    <i connectionId='${e}' style='display: inline-block;border-radius: 50px;box-shadow: 0px 0px 2px #888;padding: 0.5em 0.6em;' class='fa fa-trash'></i>\n                  </span>`,i):i},handleFormatWarning(){"XML_INVOICE"!=this.record.doc_type&&(this.format_warning_dismiss=this.showRulesNotFoundToast(this.record,window.location.href))},isDebugFlagHandler(){this.is_debug=!1,this.$route.query&&"true"===this.$route.query.is_debug&&(this.is_debug=!0)},viewOCRDocument(){let e=this.$router.resolve({path:"/ocr-document/"+this.docId+"/"+this.page});window.open(e.href,"_blank","location=yes,toolbar=yes,scrollbars=yes,resizable=yes,left=500,width=1500,height=1000")},displayConfidenceAndDeleteButton(e){return!this.fields[e.field_name].deleted&&this.fields[e.field_name].rule||this.getLowerConfidence(this.fields[e.field_name])},fieldValidationError(e){let t="REQUIRED";return e&&(t=e),t},renderTooltip(e){return!this.isReadOnly&&(!!this.fields[e].validation_code||!(!this.fields[e].is_required||""!=this.fields[e].formatted_value&&null!=this.fields[e].formatted_value))},hasApiData(){return 0!==(0,De.Ns)(this.record)},removeOldMapiingsAndDrawNew(e){this.removeBordersFromRectangles(),this.removeAllConnectionLines(),this.removeExistingConfirmationOverlays(),this.restrictDrawing(),this.prepareRectangles();let t=this.getElementToConnect(Ze("#"+e)),i=Ze("#"+e+"_rect");i&&t&&this.showConnection(e,i,t)},getElementToConnect(e){return this.componentType=e.getAttribute("child_type"),"checkbox"===this.componentType?e.querySelector(".q-checkbox__bg"):e},toggleSplitter(){this.splitterModel>=95?this.splitterModel=60:this.splitterModel=100},setSplitterModel(e){this.splitterModel=e},displaySplitDocumentView(){this.isReadOnly||(this.split_document=!0)},onResize(e){this.windowResize()},initMagnifyGlass(){let e=Ze(".screenshot"),t=document.querySelector(".img-magnifier-glass");if(!t)return;const i=3;t.style.display="block",t.style.backgroundImage="url('"+e.src+"')",t.style.backgroundRepeat="no-repeat",t.style.backgroundSize=e.width*i+"px "+e.height*i+"px";const o=3,s=t.offsetWidth/2,n=t.offsetHeight/2;this.magnifyGlass={Ix:e.offsetLeft,Iy:e.offsetTop,Zw:t.offsetWidth,Zh:t.offsetHeight,w:s,h:n,bw:o,ratio:e.naturalWidth/e.width};const r=Ze("#draw");r.removeEventListener("pointermove",this.moveMagnifier),t.removeEventListener("pointermove",this.moveMagnifier),r.addEventListener("pointermove",this.moveMagnifier),t.addEventListener("pointermove",this.moveMagnifier)},moveMagnifier(e){const t=3;var i,o,s;let n=document.querySelector(".img-magnifier-glass"),r=Ze(".screenshot");e.preventDefault(),i=this.getCursorPos(e),o=i.x,s=i.y,o>r.width-this.magnifyGlass.w/t&&(o=r.width-this.magnifyGlass.w/t),o<this.magnifyGlass.w/t&&(o=this.magnifyGlass.w/t),s>r.height-this.magnifyGlass.h/t&&(s=r.height-this.magnifyGlass.h/t),s<this.magnifyGlass.h/t&&(s=this.magnifyGlass.h/t),n.style.left=o-this.magnifyGlass.w+"px",n.style.top=s-this.magnifyGlass.h+"px",n.style.backgroundPosition="-"+(o*t-this.magnifyGlass.w+this.magnifyGlass.bw)+"px -"+(s*t-this.magnifyGlass.h+this.magnifyGlass.bw)+"px"},goToLayoutTemplate(){try{if(!this.doc_loaded)return;const e=Se.Z.getDetailViewRoute({doc_type_key:this.record.doc_type||"",layout_template_id:this.layout_template_id||"",sub_doc_type_key:this.record.sub_doc_type||""});e||logInfo("missing params for url"),window.open(e,"_blank").focus()}catch(e){logError(e)}},goToDashboard(){this.$router.push("/dashboard")},splitterChanged(){this.saveSplitterValueInStorage(),this.setShowAllButtonsPanel()},unLockDoc(e){this.releaseDocLock({doc_id:this.record.doc_id})}},setup(){const e=(0,de.A)(),t=(0,Te.q3)();t.$reset();const{record:i,get_cached_data_id:o,doc_loaded:s,confirmationForPoConnectionReset:n,error:r,notifications:a,layout_template_id:l}=(0,ee.bP)(t),{getDocumentById:d,setRecordFromCache:c,setDataToCache:h,removeCache:u}=t,g=(0,Te.uL)(),{formLayout:m,isExtenedPanel:p,renderComponent:f,docType:_}=(0,ee.bP)(g),{getElementWidth:v,isFieldHidden:y}=g;let b={},w=[],k=[],C=(0,se.KR)(!1),x=(0,se.KR)(!1),F=(0,se.KR)(!1);const L=(0,Te.oI)(),{releaseDocLock:A}=L,{doc_lock:E}=(0,ee.bP)(L),R=(0,Te.XB)(),{isConfirmationBoxDisable:S}=(0,ee.bP)(R),{resetStoreOnRouteChange:D}=R,I=(0,Te._6)(),{tokenQueryParam:O}=(0,ee.bP)(I);return I.getTokenQueryParam(),{isFieldHidden:y,setDataToCache:h,removeCache:u,get_cached_data_id:o,doc_loaded:s,resetStoreOnRouteChange:D,isConfirmationBoxDisable:S,setRecordFromCache:c,fields_pending_load_count:(0,se.KR)(0),fields_loaded_count:(0,se.KR)(0),notifications:a,getDocumentById:d,record:i,docType:_,confirmationForPoConnectionReset:n,doc_fetch_error:(0,se.KR)(r),doc_lock:E,releaseDocLock:A,page:(0,se.KR)(1),showTooltip:C,showTooltipWithHide:x,showTooltipWithClose:F,tableRows:w,fields:b,fieldsNotDisplayed:k,image:(0,se.KR)(""),layout:k,images:k,baseUrl:ne.VA,isReadOnly:(0,se.KR)(!1),current_menu_data:(0,se.KR)("pages"),componentType:"input",lineitem_count:0,lineitem_error:(0,se.KR)(!1),is_debug:(0,se.KR)(!1),tb_version:"default",document_version:(0,se.KR)(0),splitterModel:(0,se.KR)(60),imageFieldSplitter:(0,se.KR)(26),showNotification(t){e.notify({message:t,color:"primary",position:"top"})},doc_type_list:k,confirm_supplier_unblock:(0,se.KR)(!1),ai_rules:(0,se.KR)(0),ai_fields:(0,se.KR)(0),deleteConfirmationDlg:(0,se.KR)(!1),selectedInputObj:(0,se.KR)(k),textConfirmationMsg:(0,se.KR)(""),formLayout:m,isExtenedPanel:p,renderComponent:f,getElementWidth:v,tokenQueryParam:O,imageHeight:(0,se.KR)(0),imageWidth:(0,se.KR)(0),viewBox:(0,se.KR)("0 0 0 0"),connectionId:(0,se.KR)(""),isFreshStart:(0,se.KR)(!0),is_admin:(0,se.KR)(!1),layout_template_id:l}}});var st=i(12807),nt=i(56384),rt=i(50492),at=i(98072),lt=i(1096),dt=i(97410),ct=i(18301),ht=i(53999),ut=i(90124),gt=i(25173),mt=i(13796),pt=i(82156),ft=i(23316),_t=i(44189),vt=i(93676),yt=i(3952),bt=i(62669),wt=i(80460),kt=i(67156),Ct=i(42315),xt=i(88672),Ft=i(98582),Lt=i.n(Ft);const At=(0,st.A)(ot,[["render",J],["__scopeId","data-v-33e79c10"]]),Et=At;Lt()(ot,"components",{QBtn:nt.A,QIcon:rt.A,QSplitter:at.A,QResizeObserver:lt.A,QTooltip:dt.A,QBtnDropdown:ct.A,QList:ht.A,QItem:ut.A,QItemSection:gt.A,QItemLabel:mt.A,QDialog:pt.A,QCard:ft.A,QCardSection:_t.A,QSpace:vt.A,QAvatar:yt.A,QCardActions:bt.A,QCheckbox:wt.A,QField:kt.A,QTable:Ct.A}),Lt()(ot,"directives",{ClosePopup:xt.A})}}]);