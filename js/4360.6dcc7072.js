"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[4360],{24360:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ft});var a=s(61758),i=s(58790),r=s(29104);const o=e=>((0,a.Qi)("data-v-ea4f42a0"),e=e(),(0,a.jt)(),e),n={key:0,class:"row justify-center q-pa-lg"},l={key:1},d={key:0},u={key:0,class:"full-width"},c={class:"highlighted-back"},p={class:"q-pa-lg flex flex-center"},h={key:0},g={class:"text-center",colspan:"10"},_={class:"width-40"},m={class:"width-100-40 q-pt-xs"},f={key:0,class:"q-ml-sm"},v={class:"full-width dashboard-list-area"},b={class:"table-header-text back-white"},y=["onDragstart","onDrop","onDragover"],w={key:0,class:"q-pr-md"},k={key:2,class:"float-right q-pl-md"},C={class:"page-background"},x=o((()=>(0,a.Lk)("div",{class:"box loading-shimmer"},null,-1))),D=[x],E={key:1},F=["colspan"],L={class:"back-white flex justify-end"},R={class:"row",style:{"margin-right":"0"}},A={class:"flex float-right"},P={key:0},I=o((()=>(0,a.Lk)("td",{class:"text-center",colspan:"10"},null,-1))),S=[I],T={class:"q-ml-sm"},O={cellspacing:"0",cellpadding:"0",style:{border:"none",width:"100%"}},W={style:{width:"5%"}},$={style:{padding:"5%","text-align":"center"}},q={style:{width:"5%"}},Q={cellspacing:"5px",cellpadding:"5px",style:{border:"none",width:"100%"}},M={cellspacing:"0",cellpadding:"0",style:{border:"none",width:"100%"}},V={style:{width:"5%"}},G={style:{padding:"5%","text-align":"center"}},X={style:{width:"5%"}},z={cellspacing:"5px",cellpadding:"5px",style:{border:"none",width:"100%"}},N={style:{"text-align":"center"}},B={class:"q-ml-sm"};function K(e,t,s,o,x,I){const K=(0,a.g2)("SupplierApprovalStatus"),U=(0,a.g2)("SubHeader"),H=(0,a.g2)("MobileGrid"),j=(0,a.g2)("q-markup-table"),J=(0,a.g2)("q-pagination"),Z=(0,a.g2)("DashboardHeader"),Y=(0,a.g2)("q-separator"),ee=(0,a.g2)("q-icon"),te=(0,a.g2)("q-item-label"),se=(0,a.g2)("q-item-section"),ae=(0,a.g2)("q-item"),ie=(0,a.g2)("q-list"),re=(0,a.g2)("q-popup-proxy"),oe=(0,a.g2)("q-badge"),ne=(0,a.g2)("draggable"),le=(0,a.g2)("q-linear-progress"),de=(0,a.g2)("q-checkbox"),ue=(0,a.g2)("q-tooltip"),ce=(0,a.g2)("q-fab-action"),pe=(0,a.g2)("q-fab"),he=(0,a.g2)("ColumnOrderBy"),ge=(0,a.g2)("TableBody"),_e=(0,a.g2)("PaginationSettings"),me=(0,a.g2)("q-avatar"),fe=(0,a.g2)("q-card-section"),ve=(0,a.g2)("f-btn"),be=(0,a.g2)("q-card-actions"),ye=(0,a.g2)("q-card"),we=(0,a.g2)("q-dialog"),ke=(0,a.g2)("q-btn"),Ce=(0,a.g2)("DocAssignment"),xe=(0,a.g2)("Loader"),De=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)(a.FK,null,["pending_registration"===e.supplier_approval_status||"pending_supplier_input"===e.supplier_approval_status||"pending_approval"===e.supplier_approval_status||"rejected"===e.supplier_approval_status||"pending_ap_approval"===e.supplier_approval_status?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(K,{status:e.supplier_approval_status,supplier_as_org_id:e.supplier_as_org_id,supplier_lookup_record_id:e.supplier_lookup_record_id},null,8,["status","supplier_as_org_id","supplier_lookup_record_id"])])):((0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(U,{name:"dashboard",onSearch:!1,label:e.$t("pages.screen2a.dashboard"),show_expiry_alert:!0},null,8,["label"]),e.isMobile()?((0,a.uX)(),(0,a.CE)("div",d,[e.display_data&&e.display_data.length>0?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.bF)(H,{table_data:e.display_data,onRowClick:e.rowClick},null,8,["table_data","onRowClick"])])):((0,a.uX)(),(0,a.Wv)(j,{key:1,flat:"",class:"full-width"},{default:(0,a.k6)((()=>[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",c,[(0,a.Lk)("th",null,(0,i.v_)(e.$t("no_data_found")),1)])])])),_:1})),(0,a.Lk)("div",p,[e.display_data.length>0?((0,a.uX)(),(0,a.CE)("tr",h,[(0,a.Lk)("td",g,[(0,a.bF)(J,{modelValue:e.paginationCount,"onUpdate:modelValue":t[0]||(t[0]=t=>e.paginationCount=t),color:"primary",max:e.skip,"max-pages":6,"boundary-links":"",onClick:t[1]||(t[1]=t=>e.loadData())},null,8,["modelValue","max"])])])):(0,a.Q3)("",!0)])])):((0,a.uX)(),(0,a.CE)("div",{key:1,class:"dashboard-container dashboard-text-color dashboard-main",onDrop:t[16]||(t[16]=(...t)=>e.drop&&e.drop(...t)),onDragover:t[17]||(t[17]=(...t)=>e.allowDrop&&e.allowDrop(...t)),onDragleave:t[18]||(t[18]=(...t)=>e.dragLeave&&e.dragLeave(...t))},[(0,a.bF)(Z),(0,a.bF)(Y,{class:"seperator"}),e.isGroupingMode?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"row back-white grouping-header",onDrop:t[3]||(t[3]=t=>e.headerGroupDropEvent(t)),onDragover:t[4]||(t[4]=(...t)=>e.allowDrop&&e.allowDrop(...t))},[(0,a.Lk)("div",_,[(0,a.bF)(ee,{name:"switch_access_shortcut_add",size:"sm",class:"cursor-pointer"})]),(0,a.Lk)("div",m,[(0,a.bF)(ne,{modelValue:e.groupedColumns,"onUpdate:modelValue":t[2]||(t[2]=t=>e.groupedColumns=t),class:"dragArea","item-key":"name",group:{name:"groups",pull:!1,put:!0},sort:!0,"ghost-class":"sortable__ghost",onEnd:e.handleGroupChange},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.groupedColumns,((t,s)=>((0,a.uX)(),(0,a.Wv)(oe,{key:t.name,rounded:"",color:"primary",class:"q-mr-sm capitalize cursor-pointer"},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(t.label)+" ",1),t.group_by_type?((0,a.uX)(),(0,a.CE)("span",f," ("+(0,i.v_)(t.group_by_type)+")",1)):(0,a.Q3)("",!0),t.group_by_type?((0,a.uX)(),(0,a.Wv)(re,{key:1,anchor:"bottom end",self:"top end"},{default:(0,a.k6)((()=>[(0,a.bF)(ie,null,{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ae,{clickable:"",onClick:s=>{t.group_by_type="day",e.handleGroupChange()}},{default:(0,a.k6)((()=>[(0,a.bF)(se,null,{default:(0,a.k6)((()=>[(0,a.bF)(te,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("day")),1)])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[De]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ae,{clickable:"",onClick:s=>{t.group_by_type="week",e.handleGroupChange()}},{default:(0,a.k6)((()=>[(0,a.bF)(se,null,{default:(0,a.k6)((()=>[(0,a.bF)(te,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("week")),1)])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[De]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ae,{clickable:"",onClick:s=>{t.group_by_type="month",e.handleGroupChange()}},{default:(0,a.k6)((()=>[(0,a.bF)(se,null,{default:(0,a.k6)((()=>[(0,a.bF)(te,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("month")),1)])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[De]])])),_:2},1024)])),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(ee,{name:"close",color:"white",class:"q-ml-xs cursor-pointer",onClick:t=>e.removeGroup(s)},null,8,["onClick"])])),_:2},1024)))),128))])),_:1},8,["modelValue","onEnd"])])],32)):(0,a.Q3)("",!0),e.loading?((0,a.uX)(),(0,a.Wv)(le,{key:1,indeterminate:""})):(0,a.Q3)("",!0),(0,a.Lk)("div",v,[e.table_columns.length>0?((0,a.uX)(),(0,a.Wv)(j,{key:0,flat:"",id:"dashboard",class:(0,i.C4)(["dashboard-table-style back-white dashboard-table-height dashboard-table-header-sticky",e.display_data.length>0?"dashboard-min-height":""])},{default:(0,a.k6)((()=>[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",b,[(0,a.Lk)("th",null,[(0,a.bF)(de,{modelValue:this.headerCheckbox,"onUpdate:modelValue":[t[5]||(t[5]=e=>this.headerCheckbox=e),t[6]||(t[6]=t=>e.changeAction())],dense:""},null,8,["modelValue"]),(0,a.bF)(pe,{modelValue:this.headerFabIcon,"onUpdate:modelValue":t[11]||(t[11]=e=>this.headerFabIcon=e),disable:this.selectionList.length<1,"label-position":"top",flat:"","data-cy":"actions","external-label":"",icon:"more_vert",direction:"down",padding:"1px"},{default:(0,a.k6)((()=>[(0,a.bF)(ce,{onClick:t[7]||(t[7]=t=>e.deleteMultipalDocument()),padding:"7px","external-label":"","label-position":"top","data-cy":"delete",style:{background:"#b90713"},disable:e.isMultiDeleteButtonDisabled},{default:(0,a.k6)((()=>[(0,a.bF)(ee,{style:{padding:"1px 1px 1px 1px"},name:"img:images/trash-bin-default-white.svg",size:"20px"}),(0,a.bF)(ue,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.isMultiDeleteButtonDisabled?e.$t("could_not_delete"):e.$t("delete")),1)])),_:1})])),_:1},8,["disable"]),(0,a.bF)(ce,{onClick:t[8]||(t[8]=t=>e.restartMultipalDocExport()),padding:"7px","external-label":"","label-position":"top",style:{background:"#6479ff"},disable:e.isMultiRestartButtonDisabled},{default:(0,a.k6)((()=>[(0,a.bF)(ee,{style:{padding:"1px 1px 1px 1px"},name:"img:images/refresh.svg",size:"20px"}),(0,a.bF)(ue,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.isMultiRestartButtonDisabled?e.$t("could_not_restart"):e.$t("restart")),1)])),_:1})])),_:1},8,["disable"]),(0,a.bF)(ce,{onClick:t[9]||(t[9]=t=>e.multipleDocAssignment()),padding:"7px","external-label":"","label-position":"top",style:{background:"#6decb4"}},{default:(0,a.k6)((()=>[(0,a.bF)(ee,{style:{padding:"1px 1px 1px 1px"},name:"img:images/assign to.svg",size:"20px"}),(0,a.bF)(ue,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("assign2")),1)])),_:1})])),_:1}),(0,a.bF)(ce,{onClick:t[10]||(t[10]=t=>e.confirmMerge()),padding:"5px","external-label":"","label-position":"top",color:"deep-orange-6",icon:"merge"},{default:(0,a.k6)((()=>[(0,a.bF)(ue,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("merge")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","disable"])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.table_columns,((s,o)=>((0,a.uX)(),(0,a.CE)("th",{key:o,class:"documnetCol draggable",draggable:"true",onDragstart:t=>e.onDragStart(t,e.table_columns,o),onDrop:(0,r.D$)((t=>e.handleDrop(t,o)),["prevent"]),onDragover:(0,r.D$)((t=>e.onDragOver(t,o)),["prevent"]),onDragenter:t[12]||(t[12]=(0,r.D$)(((...t)=>e.onDragEnter&&e.onDragEnter(...t)),["prevent"])),onDragleave:t[13]||(t[13]=(0,r.D$)(((...t)=>e.onDragLeave&&e.onDragLeave(...t)),["prevent"])),style:(0,i.Tr)({cursor:e.getIsDragging?"pointer":"move"})},[s.hasOwnProperty("label")?((0,a.uX)(),(0,a.CE)("span",w,(0,i.v_)(e.$t(s.label)),1)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,i.v_)(e.$t(s.name)),1)],64)),s.sortable?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.bF)(he,{column_name:s.name},null,8,["column_name"])])):(0,a.Q3)("",!0)],44,y)))),128)),(0,a.Lk)("th",C,[(0,a.Lk)("span",null,(0,i.v_)(e.$t("actions")),1)])])]),(0,a.Lk)("tbody",null,[(0,a.bF)(ge,{parentIndexes:"",table_columns:e.table_columns,statusList:e.statusList,restartExportedInvoices:e.restartExportedInvoices,onCheckRowExistance:e.checkRowExistance,onRowClick:e.rowClick,onViewPurchaseOrder:e.viewPurchaseOrder,onOpenAssignmentDlg:e.openAssignmentDlg,onToFlowScreen:e.toFlowScreen,onDownloadFile:e.downloadFile,onDownloadZugferd:e.downloadZugferd,onDownloadPeppol:e.downloadPeppol,onDownloadAnnotated:e.downloadAnnotated,onDownloadPreviewFile:e.downloadPreviewFile,onGoToExport:e.goToExport,onRestartExport:e.restartExport,onRestartExportError:e.restartExportError,onReadyForDelete:e.readyForDelete,onSetErrorInfos:e.setErrorInfos,onLoadChildRowData:e.loadChildRowData,onSetLastVisitedParentsToCache:e.setLastVisitedParentsToCache},null,8,["table_columns","statusList","restartExportedInvoices","onCheckRowExistance","onRowClick","onViewPurchaseOrder","onOpenAssignmentDlg","onToFlowScreen","onDownloadFile","onDownloadZugferd","onDownloadPeppol","onDownloadAnnotated","onDownloadPreviewFile","onGoToExport","onRestartExport","onRestartExportError","onReadyForDelete","onSetErrorInfos","onLoadChildRowData","onSetLastVisitedParentsToCache"]),!0===e.show_table_loader?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(e.pageSize,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.table_columns.length+2,(e=>((0,a.uX)(),(0,a.CE)("td",{key:e},D)))),128))])))),128)):0===e.display_data.length&&!1===e.processing?((0,a.uX)(),(0,a.CE)("tr",E,[(0,a.Lk)("td",{class:"text-center",colspan:e.table_columns.length+2},(0,i.v_)(e.$t("no_document_found")),9,F)])):(0,a.Q3)("",!0)])])),_:1},8,["class"])):(0,a.Q3)("",!0),(0,a.Lk)("div",L,[(0,a.Lk)("div",R,[(0,a.bF)(_e,{class:"q-py-xs q-mr-md"}),(0,a.bF)(Y,{vertical:""}),(0,a.bF)(J,{modelValue:e.paginationCount,"onUpdate:modelValue":[t[14]||(t[14]=t=>e.paginationCount=t),t[15]||(t[15]=t=>e.loadData())],color:"primary",max:e.skip,class:"q-py-xs q-mx-md","max-pages":6,input:"","boundary-links":""},null,8,["modelValue","max"])])])]),(0,a.Lk)("div",A,[e.display_data.length>0?((0,a.uX)(),(0,a.CE)("tr",P,S)):(0,a.Q3)("",!0)])],32))])),(0,a.bF)(we,{modelValue:e.deleteInvoice,"onUpdate:modelValue":t[20]||(t[20]=t=>e.deleteInvoice=t),persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(ye,null,{default:(0,a.k6)((()=>[(0,a.bF)(fe,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,a.k6)((()=>[(0,a.bF)(me,{icon:"warning",color:"primary"})])),_:1}),(0,a.bF)(fe,{class:"row items-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("span",T,(0,i.v_)(e.$t("sure")),1)])),_:1}),(0,a.bF)(be,{align:"right"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(ve,{appearance:"cancel","data-cy":"cancel",label:e.$t("cancel")},null,8,["label"]),[[De]]),(0,a.bo)((0,a.bF)(ve,{label:e.$t("delete"),"data-cy":"delete-popup",onClick:t[19]||(t[19]=t=>e.deleteRecord(e.recordId))},null,8,["label"]),[[De]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(we,{modelValue:e.ErrorInfos,"onUpdate:modelValue":t[21]||(t[21]=t=>e.ErrorInfos=t)},{default:(0,a.k6)((()=>[(0,a.bF)(ye,null,{default:(0,a.k6)((()=>[(0,a.bF)(fe,{class:"row items-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("table",O,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",W,[(0,a.bF)(me,{icon:"error",color:"red-6",style:{margin:"3%"}})]),(0,a.Lk)("td",null,[(0,a.Lk)("div",$,[(0,a.Lk)("b",null,(0,i.v_)(this.ErrorText["row"]["filename"]),1)])]),(0,a.Lk)("td",q,[(0,a.bF)(me,{icon:"error",color:"red-6",style:{margin:"3%"}})])])])]),(0,a.Lk)("table",Q,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",null,[(0,a.Lk)("span",null,(0,i.v_)(e.$t("upload_failed")),1)])])])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(we,{modelValue:e.QualityConfirm,"onUpdate:modelValue":t[24]||(t[24]=t=>e.QualityConfirm=t)},{default:(0,a.k6)((()=>[(0,a.bF)(ye,null,{default:(0,a.k6)((()=>[(0,a.bF)(fe,{class:"row items-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("table",M,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",V,[(0,a.bF)(me,{icon:"warning",color:"yellow-6",style:{margin:"3%"}})]),(0,a.Lk)("td",null,[(0,a.Lk)("div",G,[(0,a.Lk)("b",null,(0,i.v_)(this.QualityText["row"]["filename"]),1)])]),(0,a.Lk)("td",X,[(0,a.bF)(me,{icon:"warning",color:"yellow-6",style:{margin:"3%"}})])])])]),(0,a.Lk)("table",z,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",N,[(0,a.Lk)("span",null,(0,i.v_)(e.$t("low_quality")),1)])])])]),(0,a.bF)(ke,{class:"button-1",onClick:t[22]||(t[22]=t=>e.restartExport(this.docrowID)),label:e.$t("run_anyway")},null,8,["label"]),(0,a.bF)(ke,{class:"button-2",onClick:t[23]||(t[23]=t=>{e.recordId=this.docrowID,e.deleteInvoice=!0,e.QualityConfirm=!1}),label:e.$t("delete")},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(we,{modelValue:e.assigneDialog,"onUpdate:modelValue":t[25]||(t[25]=t=>e.assigneDialog=t)},{default:(0,a.k6)((()=>[(0,a.bF)(Ce,{doc_ids:e.assignment_doc_ids},null,8,["doc_ids"])])),_:1},8,["modelValue"]),(0,a.bF)(we,{modelValue:e.confirmMergeDialog,"onUpdate:modelValue":t[27]||(t[27]=t=>e.confirmMergeDialog=t),persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(ye,null,{default:(0,a.k6)((()=>[(0,a.bF)(fe,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,a.k6)((()=>[(0,a.bF)(me,{icon:"warning",color:"primary","text-color":"white"})])),_:1}),(0,a.bF)(fe,{class:"row items-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("span",B,(0,i.v_)(e.$t("merge_doc_warning")),1)])),_:1}),(0,a.bF)(be,{align:"right"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(ve,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[De]]),(0,a.bo)((0,a.bF)(ve,{label:e.$t("done"),onClick:t[26]||(t[26]=t=>e.mergeDocuments())},null,8,["label"]),[[De]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(xe)],64)}var U=s(82303),H=s(1659),j=s(6044),J=s(24622),Z=s(46736),Y=s(66845),ee=s(45938),te=s(38734),se=s(68450),ae=s(46162),ie=s(96056),re=s(8420),oe=s(18505),ne=s(64233),le=s(24481),de=s(57366),ue=s(64775),ce=s(39231),pe=s(51476);const he=["data-index"],ge={class:"table-body"},_e={class:"q-pt-md"},me=["data-index"],fe={class:"table-body"},ve=["onClick"],be={class:"q-ml-auto",style:{display:"flex","justify-content":"right","padding-right":"16px"}},ye={style:{position:"relative",left:"60px"}},we={class:"dashboard-status"},ke={class:"q-ml-lg"},Ce={class:"q-ml-auto",style:{"padding-right":"16px"}},xe={class:"page-background"},De=["src"],Ee={class:"q-px-sm"},Fe=["innerHTML"],Le={class:"text-red-14"};function Re(e,t,s,o,n,l){const d=(0,a.g2)("f-btn"),u=(0,a.g2)("q-checkbox"),c=(0,a.g2)("q-tooltip"),p=(0,a.g2)("q-icon"),h=(0,a.g2)("q-badge"),g=(0,a.g2)("q-btn"),_=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item"),f=(0,a.g2)("q-separator"),v=(0,a.g2)("q-list"),b=(0,a.g2)("q-menu");return(0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tableRows,((s,o)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:s["id"]},[s.hasOwnProperty("count")?((0,a.uX)(),(0,a.CE)("tr",{key:0,"data-index":o},[(0,a.Lk)("td",ge,[(0,a.Lk)("div",{class:"display-flex",style:(0,i.Tr)("padding-left:"+e.getLeftPadding(!1)+"px")},[(0,a.bF)(d,{appearance:"tertiary",onClick:t=>e.handleRowExpension(s,o),icon:s.is_expend?"remove":"add",class:"q-mr-sm"},null,8,["onClick","icon"]),(0,a.Lk)("span",_e,(0,i.v_)(s["label"])+" ("+(0,i.v_)(s.count)+")",1)],4)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.table_columns,((e,t)=>((0,a.uX)(),(0,a.CE)("td",{key:t})))),128))],8,he)):((0,a.uX)(),(0,a.CE)("tr",{key:1,class:(0,i.C4)(e.setRowStyle(s)),"data-index":o},[(0,a.Lk)("td",fe,[(0,a.Lk)("div",{class:"display-flex",style:(0,i.Tr)("padding-left:"+e.getLeftPadding(!0)+"px")},[(0,a.bF)(u,{dense:"",modelValue:s["rowSelection"],"onUpdate:modelValue":[e=>s["rowSelection"]=e,t=>e.checkRowExistance(s)]},null,8,["modelValue","onUpdate:modelValue"]),s["locked_by"]?((0,a.uX)(),(0,a.Wv)(p,{key:0,name:"lock",style:{color:"#7a7a7a"},size:"22px",class:"mt-3 q-ml-sm"},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("doc_lock")),1)])),_:1})])),_:1})):(0,a.Q3)("",!0)],4)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.table_columns,((t,r)=>((0,a.uX)(),(0,a.CE)("td",{key:r,onClick:a=>"status"===t.name&&"error"===s["status"]?e.getErrorInfosWrapper(s):e.rowClickWrapper(s),class:(0,i.C4)([e.getClassesForColumn(s["status"],t.name),"text-weight-regular documnetCol table-body"])},["pages"===t.name?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("span",be,(0,i.v_)(s[t.name]?s[t.name]:"-"),1),s[t.name]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(s[t.name]),1)])),_:2},1024)):(0,a.Q3)("",!0)],64)):"priority"===t.name?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("span",ye,(0,i.v_)(s[t.name]?s[t.name]:"-"),1),s[t.name]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(s[t.name]),1)])),_:2},1024)):(0,a.Q3)("",!0)],64)):"status"===t.name?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.Lk)("span",we,[(0,a.bF)(h,{rounded:"",class:(0,i.C4)(e.getStatusClass(s["status"]))},null,8,["class"]),(0,a.Lk)("span",ke,(0,i.v_)(e.getLabelTranslation(s["status"])),1)]),(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.getLabelTranslation(s["status"])),1)])),_:2},1024),"error"===s["status"]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)(" Click over status to see more details ")])),_:1})):(0,a.Q3)("",!0)],64)):"doc_type"===t.name?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[(0,a.eW)((0,i.v_)(e.setDisplayDocType(s))+" ",1),(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.setDisplayDocType(s)),1)])),_:2},1024)],64)):"total_amount"===t.name||"total_net_amount"===t.name||"net_amount"===t.name?((0,a.uX)(),(0,a.CE)(a.FK,{key:4},[(0,a.Lk)("span",Ce,(0,i.v_)(s[t.name]),1),s[t.name]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(s[t.name]),1)])),_:2},1024)):(0,a.Q3)("",!0)],64)):-1!=e.dashboarDateColumns.indexOf(t.name)?((0,a.uX)(),(0,a.CE)(a.FK,{key:5},[(0,a.eW)((0,i.v_)(e.formatDateAccordingToPreference(s[t.name]))+" ",1),s[t.name]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.formatDateAccordingToPreference(s[t.name])),1)])),_:2},1024)):(0,a.Q3)("",!0)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:6},[(0,a.eW)((0,i.v_)(s[t.name]?s[t.name]:"-")+" ",1),s[t.name]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(s[t.name]),1)])),_:2},1024)):(0,a.Q3)("",!0)],64))],10,ve)))),128)),(0,a.Lk)("td",xe,[s.hasOwnProperty("po_match_status")&&!e.isMediUser()?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[s.hasOwnProperty("po_match_icon")?((0,a.uX)(),(0,a.Wv)(g,{key:0,round:"",flat:"",size:"10px",class:(0,i.C4)("po_not_matched"==s["po_match_icon"]?"cursor-not-allowed":""),style:{"pointer-events":"unset !important"},onClick:t=>{t.stopPropagation(),e.viewPurchaseOrderWrapper(s)}},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:"images/"+s["po_match_icon"]+".svg",width:"20"},null,8,De),(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t(s["po_match_status"])),1)])),_:2},1024)])),_:2},1032,["class","onClick"])):((0,a.uX)(),(0,a.Wv)(g,{key:1,round:"",flat:"",size:"10px",ripple:!1,style:{cursor:"default"},class:"invisible"}))],64)):(0,a.Q3)("",!0),(0,a.Lk)("span",Ee,[(0,a.Lk)("img",{src:"images/document_quality.svg",class:(0,i.C4)(["black_to_white vertical-middle",""==e.renderquality(s)?"invisible":""])},null,2),s["quality"]?((0,a.uX)(),(0,a.Wv)(c,{key:0},{default:(0,a.k6)((()=>[(0,a.Lk)("div",{class:"row",innerHTML:e.renderquality(s)},null,8,Fe)])),_:2},1024)):(0,a.Q3)("",!0)]),(0,a.bF)(g,{flat:"",dense:"",round:"",onClick:t[0]||(t[0]=(0,r.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,a.k6)((()=>[(0,a.bF)(b,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{dense:"",style:{"min-width":"100px"}},{default:(0,a.k6)((()=>["finished"!=s["status"]&&"workflow"!=s["status"]&&"running"!=s["status"]&&"restart_in_progress"!=s["status"]&&"error"!=s["status"]&&"pending_confirmation"!=s["status"]?((0,a.uX)(),(0,a.Wv)(m,{key:0,clickable:"",onClick:t=>e.rowClickWrapper(s)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:images/pencil-white.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("validate")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isDocReassignAble(s)?((0,a.uX)(),(0,a.Wv)(m,{key:1,clickable:"",onClick:t=>e.openAssignmentDlgWrapper(s["id"])},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:images/assign to.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("assign2")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(m,{clickable:"",onClick:t=>e.toFlowScreenWrapper(s.id)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:images/doc_flow.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("flow_screen")),1)])),_:1})])),_:2},1032,["onClick"]),(0,a.bF)(f,{inset:""}),e.isDocDownloadable(s)?((0,a.uX)(),(0,a.Wv)(m,{key:2,clickable:"",onClick:t=>e.downloadFile(s)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:settings/import-white.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("download")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isdownloadZugferd(s)?((0,a.uX)(),(0,a.Wv)(m,{key:3,clickable:"",onClick:t=>e.downloadZugferd(s)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:settings/import-white.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("download_zugferd")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isdownloadPeppol(s)?((0,a.uX)(),(0,a.Wv)(m,{key:4,clickable:"",onClick:t=>e.downloadPeppol(s)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:settings/import-white.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("download_peppol")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isdownloadAnnotated(s)?((0,a.uX)(),(0,a.Wv)(m,{key:5,clickable:"",onClick:t=>e.downloadAnnotated(s)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:settings/import-white.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("download_annotated")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.hasPreviewFile(s)?((0,a.uX)(),(0,a.Wv)(m,{key:6,clickable:"",onClick:t=>e.downloadPreviewFile(s)},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:settings/import-white.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("download_preview_files")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isExportAllowed(s["document_export_log"])?((0,a.uX)(),(0,a.Wv)(m,{key:7,clickable:"",onClick:t=>e.goToExportWrapper(s["document_export_log"])},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:e.getExportIcon(s["document_export_log"]),size:"xs",class:"invert",style:{"font-size":"14px"}},null,8,["name"])])),_:2},1024),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("go_to_export")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isDocRestartable(s)?((0,a.uX)(),(0,a.Wv)(m,{key:8,clickable:"",onClick:t=>e.restartExportWrapper(s["id"])},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:images/refresh.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("restart")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),e.isExportErrorRestart(s)?((0,a.uX)(),(0,a.Wv)(m,{key:9,clickable:"",onClick:t=>e.restartExportErrorWrapper(s["id"])},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:images/refresh.svg",size:"xs",class:"invert",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("restart_export")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(f,{inset:""}),e.isDocDeleteable(s)?((0,a.uX)(),(0,a.Wv)(m,{key:10,clickable:"",onClick:t=>e.readyForDeleteWrapper(s["id"])},{default:(0,a.k6)((()=>[(0,a.bF)(_,{avatar:"",class:"list-avatar"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"img:images/trash-bin-default-white.svg",size:"xs",class:"white-to-red",style:{"font-size":"14px"}})])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.Lk)("span",Le,(0,i.v_)(e.$t("delete")),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024),1==s["restart_allowed"]?((0,a.uX)(),(0,a.Wv)(p,{key:1,name:"priority_high",class:"headerError"},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.$t("document_restart_alert")),1)])),_:1})])),_:1})):(0,a.Q3)("",!0)])],10,me)),s.is_expend&&s._children?((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.componentName),{key:2,parentIndexes:e.getParentIndexes(o),table_columns:e.table_columns,statusList:e.statusList,restartExportedInvoices:e.restartExportedInvoices,onCheckRowExistance:e.checkRowExistance,onRowClick:e.rowClick,onViewPurchaseOrder:e.viewPurchaseOrder,onOpenAssignmentDlg:e.openAssignmentDlg,onToFlowScreen:e.toFlowScreen,onDownloadFile:e.downloadFile,onDownloadZugferd:e.downloadZugferd,onDownloadPeppol:e.downloadPeppol,onDownloadAnnotated:e.downloadAnnotated,onDownloadPreviewFile:e.downloadPreviewFile,onGoToExport:e.goToExport,onRestartExport:e.restartExport,onRestartExportError:e.restartExportError,onReadyForDelete:e.readyForDelete,onSetErrorInfos:e.setErrorInfos,onLoadChildRowData:e.loadChildRowData,onSetLastVisitedParentsToCache:e.setLastVisitedParentsToCache},null,40,["parentIndexes","table_columns","statusList","restartExportedInvoices","onCheckRowExistance","onRowClick","onViewPurchaseOrder","onOpenAssignmentDlg","onToFlowScreen","onDownloadFile","onDownloadZugferd","onDownloadPeppol","onDownloadAnnotated","onDownloadPreviewFile","onGoToExport","onRestartExport","onRestartExportError","onReadyForDelete","onSetErrorInfos","onLoadChildRowData","onSetLastVisitedParentsToCache"])):(0,a.Q3)("",!0)],64)))),128)}var Ae=s(45022),Pe=s(85487),Ie=s(94124),Se=s(76956),Te=function(e,t,s,a){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function o(e){try{l(a.next(e))}catch(t){r(t)}}function n(e){try{l(a["throw"](e))}catch(t){r(t)}}function l(e){e.done?s(e.value):i(e.value).then(o,n)}l((a=a.apply(e,t||[])).next())}))};const Oe=(0,a.pM)({name:"TableBody",mixins:[ne.A,le.A,ie.A,Z.A],emits:["checkRowExistance","rowClick","viewPurchaseOrder","openAssignmentDlg","toFlowScreen","downloadFile","downloadZugferd","downloadPeppol","downloadAnnotated","downloadPreviewFile","goToExport","restartExport","restartExportError","readyForDelete","setErrorInfos","loadChildRowData","setLastVisitedParentsToCache"],props:{table_columns:{type:Array,default:()=>[]},statusList:{type:Array,default:()=>[]},parentIndexes:{type:String,default:""},restartExportedInvoices:{type:Boolean,default:!1}},data(){return{dashboarDateColumns:Se.GK}},watch:{display_data:{deep:!0,handler:function(e,t){this.prepareTableRows()}}},mounted(){this.prepareTableRows()},methods:{getStatusClass(e){let t="";const s=this.statusList.hasOwnProperty(e);return t=s?this.statusList[e]["class"]:"bg-grey",t+=" dashboard-status-badge",t},prepareTableRows(){if(!this.parentIndexes)return void(this.tableRows=this.display_data);const e=this.getParentRows(this.parentIndexes.split(","));this.tableRows=e[e.length-1]._children},setRowStyle(e){if(e.hasOwnProperty("export_data_fetched")&&!0===e["export_data_fetched"])return"exported-row"},getLeftPadding(e){let t=0;return this.parentIndexes?(t=10*this.parentIndexes.split(",").length,t+=10,e&&(t+=30),t):t},getErrorInfosWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.getErrorInfos(e)},getErrorInfos(e){return Te(this,void 0,void 0,(function*(){let t=!1,s={};if("error"!==e["status"])return;let a=yield(0,ae.L3)();const i=yield U.A.get((0,Pe.MV)(ae.FH.get_error_infos),{headers:{Authorization:a},params:{doc_id:e["id"]}});return i["data"]["row"]=e,1===Object.keys(i).length?s={message:"None"}:(s=i["data"],t=!0),this.setErrorInfos(t,s),t}))},getClassesForColumn(e,t){let s="",a="running"===e?"enableDrawingRectangle":"cursor-pointer";return a+="filename"===t?" text-primary ":"",a+=t.includes("amount")?" text-right ":"",a+" "+s},setDisplayDocType(e){const t=this.getDocTypeForDisplay(e),s=this.displayDocType(t);return String(s)},renderquality(e){if(!this.user_settings["OCR_PERCENTAGE"]||!this.user_settings["OCR_PERCENTAGE"])return;let t="";if(e.hasOwnProperty("quality")){let s=this.$t("overall");const a=e["quality"];parseInt(e["quality"])<parseInt(this.user_settings["OCR_PERCENTAGE"])&&(t=s+' : <FONT COLOR="#AA0500">'+e["quality"]+"</FONT COLOR>"),parseInt(a)==parseInt(this.user_settings["OCR_PERCENTAGE"])&&(t=s+' : <FONT COLOR="#ffff00">'+e["quality"]+"</FONT COLOR>"),parseInt(a)>parseInt(this.user_settings["OCR_PERCENTAGE"])&&(t=s+' : <FONT COLOR="#00ff00">'+e["quality"]+"</FONT COLOR>")}return t},isDocReassignAble(e){const t=ee.tH.hasAccess("update",e),s=String(e["status"]);return t&&"finished"!=s&&"workflow"!=s&&"running"!=s&&"restart_in_progress"!=s},isdownloadZugferd(e){let t=!1;return this.isDocDownloadable(e)?(Se.B2.includes(e["status"])&&1==(0,Se.UJ)(e["doc_type"])&&1==e["has_zugferd"]&&(t=!0),t):t},isdownloadPeppol(e){let t=!1;return this.isDocDownloadable(e)?(Se.B2.includes(e["status"])&&1==(0,Se.UJ)(e["doc_type"])&&1==e["has_peppol"]&&(t=!0),t):t},isdownloadAnnotated(e){let t=!1;return this.isDocDownloadable(e)?(1==e["has_annotated_version"]&&(t=!0),t):t},isDocDownloadable(e){const t=ee.tH.hasAccess("view",e),s=String(e["status"]);return t&&"running"!=s&&"restart_in_progress"!=s},hasPreviewFile(e){return!(!e.hasOwnProperty("preview_file_path")||!e["preview_file_path"])},isExportAllowed(e){let t=this.getExportRecord(e);return!(!t||0===Object.keys(t).length)},getExportRecord(e){if(!e)return{};let t=Ae.A.getItem("login_source");if(!Ae.A.has("login_source")||null===t)return{};t=t.toLowerCase(),"infor"==t&&(t="idm");let s={};for(const a of e)if(t===a.export_application.toLowerCase()&&a.document_url){s=a;break}return s},getExportIcon(e){let t=this.getExportRecord(e);if(!t||0===Object.keys(t).length)return;let s="";return"FLOW2"==t.export_application&&(s="images/flow2_icon.svg"),"IDM"==t.export_application&&(s="images/idm_icon.svg"),"ZUGFERD"==t.export_application&&(s="images/zugferd-icon.svg"),"PEPPOL"==t.export_application&&(s="images/peppol-icon.svg"),s},isDocRestartable(e){const t=ee.tH.hasAccess("update",e);if(!t)return!1;const s=String(e["status"]),a=Boolean(e["restart_allowed"]);return!!this.restartExportedInvoices||("ready_for_validation"===s||"error"===s||"export_error"===s||1==a)},isDocDeleteable(e){const t=ee.tH.hasAccess("delete",e),s=String(e["status"]);return t&&"finished"!=s&&"workflow"!=s&&"running"!=s&&"restart_in_progress"!=s},isExportErrorRestart(e){const t=ee.tH.hasAccess("update",e);if(!t)return!1;const s=String(e["status"]),a=Boolean(e["restart_allowed"]);return!!this.restartExportedInvoices||("export_error"===s||1==a)},handleRowExpension(e,t){if(!e.is_expend&&!e.hasOwnProperty("_children")){const e=this.getParentIndexes(t);this.loadChildRowData(e)}e.is_expend=!e.is_expend},loadChildRowData(e){this.$emit("loadChildRowData",e)},rowClickWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.rowClick(e)},rowClick(e){this.$emit("rowClick",e)},checkRowExistance(e){this.$emit("checkRowExistance",e)},viewPurchaseOrderWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.viewPurchaseOrder(e)},viewPurchaseOrder(e){this.$emit("viewPurchaseOrder",e)},openAssignmentDlgWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.openAssignmentDlg(e)},openAssignmentDlg(e){this.$emit("openAssignmentDlg",e)},toFlowScreenWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.toFlowScreen(e)},toFlowScreen(e){this.$emit("toFlowScreen",e)},downloadFile(e){this.$emit("downloadFile",e)},downloadZugferd(e){this.$emit("downloadZugferd",e)},downloadPeppol(e){this.$emit("downloadPeppol",e)},downloadAnnotated(e){this.$emit("downloadAnnotated",e)},downloadPreviewFile(e){this.$emit("downloadPreviewFile",e)},goToExportWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.goToExport(e)},goToExport(e){this.$emit("goToExport",e)},restartExportWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.restartExport(e)},restartExport(e){this.$emit("restartExport",e)},restartExportErrorWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.restartExportError(e)},restartExportError(e){this.$emit("restartExportError",e)},readyForDeleteWrapper(e){this.setLastVisitedParentsToCache(this.parentIndexes),this.readyForDelete(e)},readyForDelete(e){this.$emit("readyForDelete",e)},setErrorInfos(e,t){this.$emit("setErrorInfos",e,t)},getParentIndexes(e){return this.parentIndexes?this.parentIndexes+","+e:e.toString()},setLastVisitedParentsToCache(e){this.$emit("setLastVisitedParentsToCache",e)}},setup(){const e="TableBody",t=(0,Ie.kH)(),{isMediUser:s}=t,a=(0,Ie.fX)(),{display_data:i}=(0,H.bP)(a),{getParentRows:r}=a,o=(0,Ie.Bu)(),{user_settings:n}=(0,H.bP)(o);return{isMediUser:s,display_data:i,user_settings:n,tableRows:(0,te.KR)([]),getParentRows:r,componentName:e}}});var We=s(12807),$e=s(80460),qe=s(50492),Qe=s(97410),Me=s(23954),Ve=s(56384),Ge=s(84436),Xe=s(53999),ze=s(90124),Ne=s(25173),Be=s(10386),Ke=s(98582),Ue=s.n(Ke);const He=(0,We.A)(Oe,[["render",Re]]),je=He;Ue()(Oe,"components",{QCheckbox:$e.A,QIcon:qe.A,QTooltip:Qe.A,QBadge:Me.A,QBtn:Ve.A,QMenu:Ge.A,QList:Xe.A,QItem:ze.A,QItemSection:Ne.A,QSeparator:Be.A});var Je=s(25891),Ze=s(80360),Ye=s(73937),et=s(14911),tt=s(37217),st=s(11470),at=s(86162),it=s(91236),rt=s(41903),ot=s(53500),nt=s(62488),lt=s(7722),dt=s(90954),ut=s(10739),ct=function(e,t,s,a){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function o(e){try{l(a.next(e))}catch(t){r(t)}}function n(e){try{l(a["throw"](e))}catch(t){r(t)}}function l(e){e.done?s(e.value):i(e.value).then(o,n)}l((a=a.apply(e,t||[])).next())}))};const pt=(0,a.pM)({el:"#app",mixins:[j.A,J.A,Z.A,ie.A,oe.A,le.A,ne.A,de.A,Je.A,ut.A],components:{draggable:ce.H,SupplierApprovalStatus:dt.A,PaginationSettings:lt.A,DashboardHeader:et.A,DocAssignment:tt.A,ColumnOrderBy:at.A,MobileGrid:Ze.A,TableBody:je,SubHeader:it.A,Loader:re.A},data(){return{all_invoice_data:[],InvoicesClearInterval:0,po_module_activate:!1,debounceSearchInputFunc:{},confirmMergeDialog:!1,filters_reset_after_restart_setting:Se.at,groupedColumns:(0,te.KR)([]),isGroupingMode:(0,te.KR)(!1),group_key:(0,te.KR)(Se.aH.group_key),availableGroupingColumns:(0,te.KR)([]),date_fields:["created_on","last_modified_on","invoice_date","delivery_date","order_date"]}},beforeRouteLeave:function(e,t,s){this.intervalManager(!1),this.unsubscribeToChannel("dashboard"),this.unsubscribeToChannel("pending_docs"),s()},mounted(){return ct(this,void 0,void 0,(function*(){try{yield this.startSettingsFetch(),this.initSettings(),yield this.getProfile(),this.getUserDetailByKey(),this.processing=!0,yield this.getSavedColumns(),this.handleTableColumns(!1),this.prepareStatusList(),yield this.getOrderBy(),this.po_module_activate=!0,this.getSavedFilters(),this.initGroups(),this.loadData(),this.clearSelectedSessionStorage(),this.intervalManager(!0),this.subscribeToDashboardChannel(),this.getDocTypeSettings(),this.$route.params.force_restart&&"force_restart"===this.$route.params.force_restart&&(this.restartExportedInvoices=!0),this.headerCheckbox=!1,document.addEventListener("reset_pages",this.resetPages),document.addEventListener("reset_filters",this.resetFilters),document.addEventListener("on_row_click",this.rowClickEvent),document.addEventListener("apply_filters",this.applyFilterEvent),document.addEventListener("assignment_success",this.assignmentSuccess),document.addEventListener("dashboard_refresh_data",this.refreshFilters),this.initailizeDragColumnsById("dashboard"),document.addEventListener("dashboard-column-drop",(e=>{this.saveSortedColumns(e.detail)})),this.debounceSearchInputFunc=(0,ot.A)((()=>{this.applyFilter()}),1e3)}catch(e){}finally{this.processing=!1}window.dash=this}))},unmounted:function(){document.removeEventListener("keydown",this.keyDownEvent),document.removeEventListener("reset_filters",this.resetFilters),document.removeEventListener("apply_filters",this.applyFilterEvent),document.removeEventListener("assignment_success",this.assignmentSuccess),document.removeEventListener("dashboard_refresh_data",this.refreshFilters),document.removeEventListener("dashboard-column-drop",(e=>{this.saveSortedColumns(e.detail)}))},watch:{headerCheckbox(){!1===this.headerCheckbox&&(this.headerFabIcon=!1,this.isMultiDeleteButtonDisabled=!1,this.isMultiRestartButtonDisabled=!1)},processing:{handler:function(e,t){1==e?this.showLoading():this.hideLoading()}},isConnected:{handler:function(e,t){this.use_websocket=!0,this.subscribeToDashboardChannel()}},websocketHasError:{handler:function(e,t){1==e&&(this.use_websocket=!1,this.handleWebsocketDelay())}},dashboard_data_flag:{handler:function(e,t){0!=e&&(this.data_status="received",this.handleWebSocketResult(this.dashboard_data))}}},methods:{saveSortedColumns(e){let t=JSON.parse(JSON.stringify(e)),s={};t.forEach(((e,t)=>{s[e.name]={name:e.name,label:e.label,order:t,sortable:e.sortable,selected:!1,translation_key:e.translation_key},e.doc_type_key&&(s[e.name].doc_type_key=e.doc_type_key)})),this.visible_columns=s,this.saveColumns(this.visible_columns)},getUserDetailByKey(){let e=(0,Ye.Ky)("organisations"),t=e[0];t&&("pending_ap_approval"===t.status?this.supplier_approval_status="pending_approval":this.supplier_approval_status=t.status,this.supplier_lookup_record_id=t.supplier_lookup_record_id?t.supplier_lookup_record_id:"supplier_lookup_record_id",this.supplier_as_org_id=t.supplier_as_org_id?t.supplier_as_org_id:"supplier_as_org_id")},initSettings(){this.user_settings[Se.Y$]&&(this.isGroupingMode=!0)},initGroups(){this.group_key=(0,pe.un)(this.group_key);const e=Ae.A.getItem(this.group_key);e&&(this.groupedColumns=JSON.parse(e))},applyFilterEvent(e){e&&e.detail&&!0===e.detail.reset_pagination&&(this.resetPagination=!0),this.applyFilter()},dashboardColumnsEvent(){this.dashboardColumnsUpdated()},dashboardColumnsUpdated(){return ct(this,void 0,void 0,(function*(){this.handleTableColumns(),yield this.applySavedFilters(),this.fetchInvoices(!0)}))},handleTableColumns(e=!0){try{this.processing=!0;const e=this.visible_columns;this.table_columns=[];for(const t in this.visible_columns)e[t].selected=!1,this.filtered_columns.includes(e[t].name)||(e[t].label=this.getColumnLabel(e[t]),this.table_columns.push(e[t]));this.table_columns.sort(((e,t)=>e.order-t.order))}catch(t){}finally{e&&(this.processing=!1)}},intervalManager(e){clearInterval(this.InvoicesClearInterval)},applySavedFilters(){return ct(this,void 0,void 0,(function*(){this.pageSize=Number(this.pagination_size),this.queryParams="?&skip="+this.startfrom+"&limit="+this.pageSize,this.queryParams+=(yield this.makeQueryParamFromFilters(!1)),this.resetPagination=!1}))},handleActions(e){return this.display_data.forEach(((t,s)=>{s!==e&&(t["fabAction"]=!1)})),!0},prepareStatusList(){this.statusList["new"]=[],this.statusList["new"]["value"]="new",this.statusList["new"]["class"]="bg-light-green-6",this.statusList["ready_for_review"]=[],this.statusList["ready_for_review"]["value"]="ready_for_review",this.statusList["ready_for_review"]["class"]="bg-amber-7",this.statusList["ready_for_validation"]=[],this.statusList["ready_for_validation"]["value"]="ready_for_validation",this.statusList["ready_for_validation"]["class"]="bg-amber-7",this.statusList["validating"]=[],this.statusList["validating"]["value"]="ready_for_validation",this.statusList["validating"]["class"]="bg-amber-7",this.statusList["validated_pending_export"]=[],this.statusList["validated_pending_export"]["value"]="validated_pending_export",this.statusList["validated_pending_export"]["class"]="bg-amber-7",this.statusList["pending_confirmation"]=[],this.statusList["pending_confirmation"]["value"]="pending_confirmation",this.statusList["pending_confirmation"]["class"]="bg-amber-7",this.statusList["finished"]=[],this.statusList["finished"]["value"]="finished",this.statusList["finished"]["class"]="bg-light-green-6",this.statusList["workflow"]=[],this.statusList["workflow"]["value"]="workflow",this.statusList["workflow"]["class"]="bg-light-green-6",this.statusList["completed"]=[],this.statusList["completed"]["value"]="completed",this.statusList["completed"]["class"]="bg-light-green-6",this.statusList["restarted"]=[],this.statusList["restarted"]["value"]="restarted",this.statusList["restarted"]["class"]="bg-blue-14",this.statusList["error"]=[],this.statusList["error"]["value"]="error",this.statusList["error"]["class"]="bg-red-13",this.statusList["export_error"]=[],this.statusList["export_error"]["value"]="error",this.statusList["export_error"]["class"]="bg-red-13",this.statusList["restart_export"]=[],this.statusList["restart_export"]["value"]="restart_export",this.statusList["restart_export"]["class"]="bg-blue-14",this.statusList["running"]=[],this.statusList["running"]["value"]="running",this.statusList["running"]["class"]="bg-blue-14",this.statusList["in_progress"]=[],this.statusList["in_progress"]["value"]="in_progress",this.statusList["in_progress"]["class"]="bg-blue-14",this.statusList["restart_in_progress"]=[],this.statusList["restart_in_progress"]["value"]="restart_in_progress",this.statusList["restart_in_progress"]["class"]="bg-blue-14",this.statusList["exporting"]=[],this.statusList["exporting"]["value"]="exporting",this.statusList["exporting"]["class"]="bg-blue-14"},resetPages(){this.resetPagination=!0},applyFilter(){return ct(this,void 0,void 0,(function*(){this.processing=!0,this.resetAllSelectedRows(),1==this.resetPagination&&(this.startfrom=0,this.paginationCount=1),this.resetPagination=!0,this.queryParams+=(yield this.makeQueryParamFromFilters()),""==this.queryParams&&this.removeSavedFilters(),this.queryParams="?&skip="+this.startfrom+"&limit="+this.pageSize,this.fetchInvoices(!0)}))},refreshFilters(e){let t=!1,s=!1;e&&e.detail&&e.detail.show_shimmer_loader&&(t=!0),e&&e.detail&&e.detail.refresh_cache&&(s=!0),this.all_invoice_data=[],this.display_data=[],this.selectionList=[],this.headerCheckbox=!1,this.fetchInvoices(!0,t,s)},fetchInvoices(e,t=!0,s=!1){return ct(this,void 0,void 0,(function*(){if(yield this.applySavedFilters(),this.isGroupingMode)return e&&(this.processing=!0),yield this.fetchInvoicesWithGrouping(e,t,s),void(this.processing=!1);yield this.fetchInvoicesWithoutGrouping(e,t,s)}))},fetchInvoicesWithGrouping(e,t=!0,s=!1){return ct(this,void 0,void 0,(function*(){const e=Ae.A.getItem(Se.aH.group_parent_indexes),t=Ae.A.getItem(Se.aH.group_parent_raw_where);if(e&&t)return yield this.fetchOpendGroupsData(e,t),Ae.A.remove(Se.aH.group_parent_indexes),void Ae.A.remove(Se.aH.group_parent_raw_where);let s=yield this.fetchGroupData([]);if(!1===s.success)throw this.showErrorToast(this.$t("pages.messages.error_internal_occur")),this.processing=!1,{message:s.message};this.updateDocumentStats(s),this.updateTableData(s)}))},fetchOpendGroupsData(e,t){return ct(this,void 0,void 0,(function*(){try{let s=yield this.prepareGroupingQueryParams(JSON.parse(t)),a=yield st.z6.fetchOpendGroupsData(s);this.prepareOpenGroupData(a,e)}catch(s){this.showErrorToast(this.$t("pages.messages.ERROR_FETCHING_INVOICES"))}}))},prepareGroupingQueryParams(e){return ct(this,void 0,void 0,(function*(){let t=[],s=this.getGroupBy(0);if(0!==(0,se.Ns)(s)){const e=[],t={};t[s.name]=s.hasOwnProperty("group_by_type")?s.group_by_type:"",e.push(t),this.queryParams+="&group_by="+JSON.stringify(e)}t.push(this.queryParams);let a=[];for(let i of e){a.push(i),yield this.applySavedFilters(),a.length>0&&(this.queryParams+="&raw_where="+JSON.stringify(a));let e=this.getGroupBy(a.length);if(0!==(0,se.Ns)(e)){const t=[],s={};s[e.name]=e.hasOwnProperty("group_by_type")?e.group_by_type:"",t.push(s),this.queryParams+="&group_by="+JSON.stringify(t)}t.push(this.queryParams)}return t}))},prepareOpenGroupData(e,t){this.updateTableData(e[0].data),e.shift();let s=0,a=[];const i=t.split(",");for(let r of e){const e=this.prepareGroupingData(r.data.documents);this.applyCustomFormatOnRows(e),a.push(i[s]),s++;const t=this.getParentRows(a);t[t.length-1]["_children"]=e}this.markGroupAsOpend(a,this.display_data)},markGroupAsOpend(e,t){if(!e||0==e.length)return;const s=Number(e[0]);e.shift();const a=t[s];a.is_expend=!0,this.markGroupAsOpend(e,a._children)},fetchInvoicesWithoutGrouping(e,t=!0,s=!1){return ct(this,void 0,void 0,(function*(){try{if(e&&(this.processing=!0),t&&(this.display_data=[],this.selectionList=[],this.headerCheckbox=!1,this.show_table_loader=!0),this.use_websocket)return void this.terminateLongRunningTask(this.getWebSocketDashboard(),5e3);{let e=yield st.z6.getList(this.queryParams);this.updateDocumentStats(e),this.updateTableData(e),this.processing=!1,setTimeout(this.turnOnWebSocket,5e3)}}catch(s){this.showErrorToast(this.$t("pages.messages.ERROR_FETCHING_INVOICES")),this.processing=!1}}))},handleWebsocketDelay(){"received"!==this.data_status&&(this.use_websocket=!1,this.fetchInvoices(!1),this.processing=!1,setTimeout(this.turnOnWebSocket,5e3))},turnOnWebSocket(){this.websocketHasError||(this.use_websocket=!0)},terminateLongRunningTask(e,t){return new Promise(((s,a)=>{const i=setTimeout((()=>{a(new Error("Operation timed out")),this.handleWebsocketDelay()}),t);e.then((e=>{clearTimeout(i),s(e)})).catch((e=>{clearTimeout(i),a(e),this.handleWebsocketDelay()}))}))},updateTableData(e){this.resultsCount=e.overview["results-count"],this.current_invoice_count=this.resultsCount;let t=this.resultsCount/this.pageSize;this.skip=Math.ceil(t);let s=[];e.documents&&(s=e.documents),this.groupedColumns&&this.groupedColumns.length>0&&(s=this.prepareGroupingData(s)),this.availableGroupingColumns=e.available_grouping_columns,this.display_data=s,this.applyCustomFormatOnRows(this.display_data),this.show_table_loader=!1,this.processing=!1},prepareGroupingData(e){if(e&&e.length>0&&e[0].hasOwnProperty("count")){const t=this.getFirstItemColumnName(JSON.parse(JSON.stringify(e[0])));for(let s of e)s.column_name=t,s.is_expend=!1,"status"==t?s["label"]=this.getLabelTranslation(s[t]):"doc_type"==t?s["label"]=this.displayDocType(s[t]):Se.GK.includes(t)?s["label"]=this.formatDateAccordingToPreference(s[t],!0):s["label"]=s[t]}return e},getFirstItemColumnName(e){return delete e.count,delete e.id,Object.keys(e)[0]},getDocTypeLabel(e){const t=this.getDocTypeForDisplay(e),s=this.displayDocType(t);return String(s)},updateDocumentStats(e){this.all_invoices=e.overview["all-invoices"],this.automatically_processed=e.overview["automatically-processed"],this.manually_processed=e.overview["manually-processed"],this.completed=e.overview["completed"],this.in_progress=e.overview["processing"],this.pending=e.overview["pending-user-input"],this.validated_pending_approval=e.overview["validated-pending-approval"],this.approved_pending_second_approval=e.overview["approved-pending-second-approval"],this.error=e.overview["error"]},applyCustomFormatOnRows(e){e.forEach((e=>{if(e["fabAction"]=!1,e["rowSelection"]=!1,e.hasOwnProperty("po_match_status")&&!(0,se.z)(e["po_match_status"])){const t=(0,nt.Wp)(e["po_match_status"]);(0,se.z)(t)||(e["po_match_icon"]=t)}}))},toRejectedScreen(e){this.$router.push("/rejected/"+e)},toFlowScreen(e){this.$router.push("/doc_flow/"+e)},toValidationScreen(e){rt.A.set("view_mod","edit"),this.$router.push("/field_validation_v1/"+e)},toInReviewScreen(e,t){this.$router.push("/in_review/"+e)},toPendingApprovalScreen(e,t){t.layout?this.model[Se.WE]?this.$router.push("/ready_for_approval_v3/"+e):this.$router.push("/ready-for-approval-v2/"+e):(rt.A.set("view_mod","edit"),this.$router.push("/ready-for-approval/"+e))},toPendingSecondApprovalScreen(e,t){t.layout?this.$router.push("/ready-for-second-approval-v2/"+e):(rt.A.set("view_mod","edit"),this.$router.push("/ready-for-second-approval/"+e))},toMediValidationScreen(e){this.$router.push("/field_validation/"+e)},toMediValidationV3Screen(e){this.$router.push("/medi_order_v3/"+e)},toDocumentErrorView(e){this.$router.push("/document_error/"+e["id"])},toDocumentClassifiyView(e){this.$router.push("/document_classifiy/"+e["id"])},toDocumentPdfView(e){this.$router.push("/document_pdf/"+e["filename"]+"/"+e["id"])},loadData(){this.resetPagination=!1,this.pageSize=Number(this.pagination_size),this.startfrom=this.pageSize*(this.paginationCount-1),this.applyFilter()},triggerWorkflow(e){return ct(this,void 0,void 0,(function*(){try{yield st.Bj.triggerWorkflow(e)}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}}))},deleteRecord(e){return ct(this,void 0,void 0,(function*(){let t;this.processing=!0;try{let s=yield(0,ae.L3)();t=yield U.A.delete((0,Pe.MV)(ae.FH.delete_document+e),{headers:{Authorization:s}}),yield this.fetchInvoices(!0),this.deleteInvoice=!1}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},viewRecord(e){rt.A.set("view_mod","view"),this.$router.push("/field_validation_v1/"+e)},restartExportError(e){return ct(this,void 0,void 0,(function*(){this.processing=!0;try{const t=yield st.z6.restartExport(e);if(!1===t.success)throw{message:t.message};this.resetFilters()}catch(t){const e=ue.t.getErrorMessage(t);this.showErrorToast(e)}finally{this.processing=!1}}))},restartExport(e){return ct(this,void 0,void 0,(function*(){let t;this.processing=!0;try{let s=yield(0,ae.L3)();t=yield U.A.get((0,Pe.MV)(ae.FH.restart_document+e),{headers:{Authorization:s}}),this.refreshDashboard(this.filters_reset_after_restart_setting)}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}this.QualityConfirm=!1}))},isStatusError(e){return"error"===e||"export_error"===e},rowClickEvent(e){const t=e.detail;this.rowClick(t)},rowClick(e){let t=e["id"]?e["id"]:e["doc_id"];e["id"]=t;let s=e["status"];e["doc_type"];this.isStatusError(s)?this.toDocumentErrorView(e):"classified"!==s?"validating"!==s&&"validated_pending_export"!==s&&"pending_watcher_export"!==s&&("pending_confirmation"!==s?"validated_pending_approval"!==s?"approved_pending_second_approval"!==s?"in_review"!==s?this.isMediUser()?this.handleMediRoutes(e):"rejected"!==s?Se.Yd.includes(s)&&(e.layout||"ready_for_validation"===s?this.toValidationScreen(t):Se.B2.includes(s)&&this.viewRecord(t)):this.toRejectedScreen(t):this.toInReviewScreen(t,e):this.toPendingSecondApprovalScreen(t,e):this.toPendingApprovalScreen(t,e):this.getQualityInfos(e)):this.toDocumentClassifiyView(e)},handleMediRoutes(e){e.layout?this.toMediValidationV3Screen(e["id"]):this.showErrorToast(this.$t("pages.messages.NO_LAYOUT_DEFINATION_FOUND"))},getClassesForColumn(e,t){let s="",a="running"===e?"enableDrawingRectangle":"cursor-pointer";return a+="filename"===t?" text-primary ":"",a+=t.includes("amount")?" text-right ":"","status"===t&&this.statusList.hasOwnProperty(e)&&(s=e?this.statusList[e].class:""),a+" "+s},openAssignmentDlg(e){this.assignment_doc_ids=[],this.assignment_doc_ids.push(e),this.assigneDialog=!0},isExportAllowed(e){let t=this.getExportRecord(e);return!(!t||0===Object.keys(t).length)},goToExport(e){let t=this.getExportRecord(e);t&&0!==Object.keys(t).length&&window.open(t.document_url)},getExportIcon(e){let t=this.getExportRecord(e);if(!t||0===Object.keys(t).length)return;let s="";return"FLOW2"==t.export_application&&(s="images/flow2_icon.svg"),"IDM"==t.export_application&&(s="images/idm_icon.svg"),"ZUGFERD"==t.export_application&&(s="images/zugferd-icon.svg"),"PEPPOL"==t.export_application&&(s="images/peppol-icon.svg"),s},getExportRecord(e){if(!e)return{};let t=Ae.A.getItem("login_source");if(!Ae.A.has("login_source")||null===t)return{};t=t.toLowerCase(),"infor"==t&&(t="idm");let s={};for(const a of e)if(t===a.export_application.toLowerCase()&&a.document_url){s=a;break}return s},viewPurchaseOrder(e){"po_not_matched"==e["po_match_icon"]&&null===e["table_version"]||(this.user_settings[Se.aH.po_auto_match_and_export]&&(this.execute_auto_export=!0),"v1"===e["table_version"]&&this.$router.push("/po-matching/"+e["id"]),"v3"===e["table_version"]&&this.$router.push("/po-matching-v3/"+e["id"]))},downloadFile(e){try{if(!e["doc_path"])return;let t=ae.VA+"/resource/"+e["doc_path"]+"?"+this.tokenQueryParam;if(!t)return;fetch(t).then((e=>e.blob())).then((t=>{const s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=e["filename"],document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)})).catch((e=>{}))}catch(t){}},resetFilters(){this.resetPagination=!0,this.quickFilterMap.clear(),this.applyFilter()},isdownloadZugferd(e){let t=!1;return this.isDocDownloadable(e)?(Se.B2.includes(e["status"])&&1==(0,Se.UJ)(e["doc_type"])&&1==e["has_zugferd"]&&(t=!0),t):t},downloadZugferd(e){let t=ae.VA+"/resource/document/"+e["id"]+"/"+e["id"]+"_zugferd.pdf?"+this.tokenQueryParam;if(t){var s=document.createElement("a");s.download=e["filename"],s.href=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},isdownloadPeppol(e){let t=!1;return this.isDocDownloadable(e)?(Se.B2.includes(e["status"])&&1==(0,Se.UJ)(e["doc_type"])&&1==e["has_peppol"]&&(t=!0),t):t},downloadPeppol(e){let t=ae.VA+"/resource/document/"+e["id"]+"/"+e["id"]+"_peppol.xml?"+this.tokenQueryParam;if(t){var s=document.createElement("a");s.download=e["filename"],s.href=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},isdownloadAnnotated(e){let t=!1;return this.isDocDownloadable(e)?(1==e["has_annotated_version"]&&(t=!0),t):t},downloadAnnotated(e){let t=ae.VA+"/resource/document/"+e["id"]+"/"+e["id"]+"_annotated.pdf?"+this.tokenQueryParam;t&&fetch(t).then((e=>e.blob())).then((t=>{const s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=e["filename"],document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)})).catch((e=>{}))},getErrorInfos(e){return ct(this,void 0,void 0,(function*(){if("error"!==e["status"])return;let t=yield(0,ae.L3)();const s=yield U.A.get((0,Pe.MV)(ae.FH.get_error_infos),{headers:{Authorization:t},params:{doc_id:e["id"]}});return s["data"]["row"]=e,1===Object.keys(s).length?(this.ErrorText={message:"None"},!1):(this.ErrorText=s["data"],this.ErrorInfos=!0,!0)}))},getQualityInfos(e){return ct(this,void 0,void 0,(function*(){if("pending_confirmation"==e["status"]){let t=yield(0,ae.L3)();const s=yield U.A.get((0,Pe.MV)(ae.FH.get_error_infos),{headers:{Authorization:t},params:{doc_id:e["id"]}});return s["data"]["row"]=e,1===Object.keys(s).length?(this.QualityText={message:"None"},!1):(this.QualityText=s["data"],this.QualityConfirm=!0,this.docrowID=s["data"]["row"]["id"],!0)}}))},allowDrop(e){e.preventDefault()},drop(e){e.preventDefault(),e.dataTransfer.files&&0!=e.dataTransfer.files.length&&this.uploadFiles(e.dataTransfer.files)},dragLeave(e){},uploadFiles(e){try{if(e&&e.length>10)return void this.showErrorToast(this.$t("pages.messages.MAX_DOC_UPLOAD_LIMIT"));const t=new CustomEvent("upload_files",{detail:{files:e}});document.dispatchEvent(t)}catch(t){}},changeAction(){!0===this.headerCheckbox?this.selectAllRows():this.resetAllSelectedRows()},selectAllRows(){this.isMultiDeleteButtonDisabled=!1,this.isMultiRestartButtonDisabled=!1,this.selectAllItems(this.display_data)},selectAllItems(e){for(let t of e){if(t.hasOwnProperty("_children")&&t._children.length>0){this.selectAllItems(t._children);continue}if(!t.hasOwnProperty("rowSelection"))continue;t["rowSelection"]=!0;const e=this.selectionList.find((e=>e===t.id));e||this.selectionList.push(t.id),!1===this.isMultiDeleteButtonDisabled&&(this.isMultiDeleteButtonDisabled=!this.isDocDeleteable(t)),!1===this.isMultiRestartButtonDisabled&&(this.isMultiRestartButtonDisabled=!this.isDocRestartable(t))}},resetAllSelectedRows(){this.selectionList=[],this.headerCheckbox=!1,this.isMultiDeleteButtonDisabled=!1,this.isMultiRestartButtonDisabled=!1,this.resetAllItems(this.display_data)},resetAllItems(e){for(let t of e)t.hasOwnProperty("_children")&&t._children.length>0?this.resetAllItems(t._children):t["rowSelection"]=!1},checkRowExistance(e){if(e.rowSelection)this.selectionList.push(e.id),!1===this.isMultiDeleteButtonDisabled&&(this.isMultiDeleteButtonDisabled=!this.isDocDeleteable(e)),!1===this.isMultiRestartButtonDisabled&&(this.isMultiRestartButtonDisabled=!this.isDocRestartable(e));else{const t=this.selectionList.indexOf(e.id);-1!==t&&this.selectionList.splice(t,1),this.selectionList.forEach((e=>{const t=this.findItemById(e,this.display_data);!1===this.isMultiDeleteButtonDisabled&&(this.isMultiDeleteButtonDisabled=!this.isDocDeleteable(t)),!1===this.isMultiRestartButtonDisabled&&(this.isMultiRestartButtonDisabled=!this.isDocRestartable(t))}))}},findItemById(e,t){for(let s of t){if(s.hasOwnProperty("_children")&&s._children.length>0)return this.findItemById(e,s._children);if(s.id==e)return s}},setRowStyle(e){if(e.hasOwnProperty("export_data_fetched")&&!0===e["export_data_fetched"])return"exported-row"},readyForDelete(e){this.recordId=e,this.deleteInvoice=!0},setErrorInfos(e,t){this.ErrorText=t,this.ErrorInfos=e},restartMultipalDocExport(){return ct(this,void 0,void 0,(function*(){try{this.processing=!0;const e=yield st.z6.restartDocuments(this.selectionList.join(","),this.restartExportedInvoices);if(!1===e.success)return void this.showErrorToast(e.data.message);this.headerCheckbox=!1,this.resetAllSelectedRows(),this.refreshDashboard(this.filters_reset_after_restart_setting)}catch(e){return void this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},refreshDashboard(e){return ct(this,void 0,void 0,(function*(){const t=yield this.getSettingWithExpiry(e);if(t){const e=new CustomEvent("reset_filters",{});return void document.dispatchEvent(e)}const s=new CustomEvent("dashboard_refresh_data",{});document.dispatchEvent(s)}))},multipleDocAssignment(){this.selectionList&&(this.assignment_doc_ids=this.selectionList,this.assigneDialog=!0)},confirmMerge(){this.selectionList&&this.selectionList.length>5?this.showErrorToast(this.$t("pages.messages.SELECTION_GREATER_THAN_FIVE")):this.selectionList&&(this.confirmMergeDialog=!0)},mergeDocuments(){return ct(this,void 0,void 0,(function*(){try{this.showLoading();const e=yield st.M8.mergeDocumnet(this.selectionList.toString());if(!1===e.success)return void this.showErrorToast(e.message);yield this.fetchInvoices(!0)}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},deleteMultipalDocument(){return ct(this,void 0,void 0,(function*(){if(!this.selectionList)return;let e;this.processing=!0;try{let t=new Map;if(t.set("doc_ids",this.selectionList.join(",")),e=yield st.v1.deleteRequest(ae.FH.delete_documents,t),!1===e.success)return void this.showErrorToast(e.data.message);this.selectionList.length,this.display_data.length,this.headerCheckbox=!1,this.resetAllSelectedRows(),this.loadData()}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},removeQuickFilter(e){this.quickFilterMap.delete(e),this.applyFilter()},isDocRestartable(e){const t=ee.tH.hasAccess("update",e);if(!t)return!1;const s=String(e["status"]),a=Boolean(e["restart_allowed"]);return!!this.restartExportedInvoices||("ready_for_validation"===s||"error"===s||"export_error"===s||1==a)},isExportErrorRestart(e){const t=ee.tH.hasAccess("update",e);if(!t)return!1;const s=String(e["status"]),a=Boolean(e["restart_allowed"]);return!!this.restartExportedInvoices||("export_error"===s||1==a)},isDocDeleteable(e){const t=ee.tH.hasAccess("delete",e),s=String(e["status"]);return t&&"finished"!=s&&"workflow"!=s&&"running"!=s&&"restart_in_progress"!=s},isDocReassignAble(e){const t=ee.tH.hasAccess("update",e),s=String(e["status"]);return t&&"finished"!=s&&"workflow"!=s&&"running"!=s&&"restart_in_progress"!=s},isDocDownloadable(e){const t=ee.tH.hasAccess("view",e),s=String(e["status"]);return t&&"running"!=s&&"restart_in_progress"!=s},setDisplayDocType(e){const t=this.getDocTypeForDisplay(e),s=this.displayDocType(t);return String(s)},assignmentSuccess(e){this.assigneDialog=!1,this.selectionList&&(this.headerCheckbox=!1,this.resetAllSelectedRows()),this.refreshFilters({detail:{show_shimmer_loader:!0,refresh_cache:!0}})},renderquality(e){if(!this.user_settings["OCR_PERCENTAGE"]||!this.user_settings["OCR_PERCENTAGE"])return;let t="";if(e.hasOwnProperty("quality")){let s=this.$t("overall");const a=e["quality"];parseInt(e["quality"])<parseInt(this.user_settings["OCR_PERCENTAGE"])&&(t=s+' : <FONT COLOR="#AA0500">'+e["quality"]+"</FONT COLOR>"),parseInt(a)==parseInt(this.user_settings["OCR_PERCENTAGE"])&&(t=s+' : <FONT COLOR="#ffff00">'+e["quality"]+"</FONT COLOR>"),parseInt(a)>parseInt(this.user_settings["OCR_PERCENTAGE"])&&(t=s+' : <FONT COLOR="#00ff00">'+e["quality"]+"</FONT COLOR>")}return t},handleWebSocketResult(e){e&&(this.use_websocket=!0,this.updateDocumentStats(e),this.updateTableData(e))},isStatsUpdated(e){if(this.all_invoices!==e.overview["all-invoices"])return!0},getWebSocketDashboard(){return ct(this,void 0,void 0,(function*(){try{const e={type:"dashboard",data:{}};let t=this.queryParams;t=t.replace("?","");const s=t.split("&");s.forEach((t=>{t=t.split("="),2===t.length&&(e.data[t[0]]=t[1])})),this.data_status="fetching",this.dashboard_data_flag=!1;const a=yield this.sendMessageToSocket(e.type,e.data);return this.updateDocumentStats(a),this.updateTableData(a),!0}catch(e){this.handleWebsocketDelay()}finally{this.processing=!1}}))},subscribeToDashboardChannel(){this.$route.path},hasPreviewFile(e){return!(!e.hasOwnProperty("preview_file_path")||!e["preview_file_path"])},downloadPreviewFile(e){try{if(!e["preview_file_path"])return;let s=ae.VA+"/"+e["preview_file_path"]+"?"+this.tokenQueryParam;if(!s)return;var t=document.createElement("a");t.download=e["filename"],t.href=s,document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(s){}},handleDragStart(e,t,s){e.dataTransfer.setData("application/json",JSON.stringify({columnIndex:s,columnInfo:t}))},handleDragOver(e){e.preventDefault()},handleColumSortEvent(e,t){e.preventDefault();const s=e.dataTransfer.getData("application/json");if(!s)return;const a=JSON.parse(s);if(t==a.columnIndex)return;let i=this.table_columns[a.columnIndex];this.table_columns.splice(a.columnIndex,1),this.table_columns.splice(t,0,i)},headerGroupDropEvent(e){e.preventDefault();const t=e.dataTransfer.getData("application/json");if(!t)return;const s=JSON.parse(t);!this.availableGroupingColumns||this.availableGroupingColumns.includes(s.columnInfo.name)?this.groupedColumns.some((e=>e.name===s.columnInfo.name))||(this.date_fields.includes(s.columnInfo.name)&&!s.columnInfo["group_by_type"]&&(s.columnInfo["group_by_type"]="month"),this.groupedColumns.push(s.columnInfo),this.setGroupsToCache(),this.resetAndFetchAgain()):this.showErrorToast("Grouping not allowed on this column")},setGroupsToCache(){this.groupedColumns&&this.groupedColumns.length>0?Ae.A.set(this.group_key,JSON.stringify(this.groupedColumns)):Ae.A.remove(this.group_key)},setLastVisitedParentsToCache(e){if(e){Ae.A.set(Se.aH.group_parent_indexes,e);const t=this.getParentRows(e.split(",")),s=this.getGroupingWhere(t);Ae.A.set(Se.aH.group_parent_raw_where,JSON.stringify(s))}},resetAndFetchAgain(){this.groupingWhereMap.clear(),this.getSavedFilters(),this.loadData()},handleGroupChange(){this.setGroupsToCache(),this.resetAndFetchAgain()},removeGroup(e){this.groupedColumns.splice(e,1),this.setGroupsToCache(),this.resetAndFetchAgain()},fetchGroupData(e){return ct(this,void 0,void 0,(function*(){let t;try{e.length>0&&(this.queryParams+="&raw_where="+JSON.stringify(e));let s=this.getGroupBy(e.length);if(0!==(0,se.Ns)(s)){const e=[],t={};t[s.name]=s.hasOwnProperty("group_by_type")?s.group_by_type:"",e.push(t),this.queryParams+="&group_by="+JSON.stringify(e)}t=yield st.z6.getListFromWarehouse(this.queryParams)}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{return t}}))},getGroupingWhere(e){let t=[];for(let s=0;s<e.length;s++){let a=e[s].column_name;const i={};if(this.date_fields.includes(a)){const e=this.groupedColumns.find((e=>e.name===a));e&&e.group_by_type?i["operator"]=e.group_by_type:i["operator"]="month"}i["field"]=a,i["value"]=e[s][a],t.push(i)}return t},getGroupBy(e){return e==this.groupedColumns.length?null:this.groupedColumns[e]},loadChildRowData(e){return ct(this,void 0,void 0,(function*(){this.loading=!0;const t=this.getParentRows(e.split(",")),s=this.getGroupingWhere(t);yield this.applySavedFilters();let a=yield this.fetchGroupData(s);if(!1===a.success)throw this.loading=!1,this.showErrorToast(this.$t("pages.messages.error_internal_occur")),{message:a.message};const i=this.prepareGroupingData(a.documents);this.persistWhereClause(a.documents,s,e),this.applyCustomFormatOnRows(i),t[t.length-1]["_children"]=i,this.loading=!1}))},persistWhereClause(e,t,s){e&&e.length>0&&e[0].hasOwnProperty("count")||this.groupingWhereMap.set(s,JSON.stringify(t))}},setup(){let e=[];const t=(0,Ie.fX)(),{quickFilterMap:s,all_invoices:a,automatically_processed:i,manually_processed:r,completed:o,in_progress:n,pending:l,validated_pending_approval:d,approved_pending_second_approval:u,error:c,processing:p,visible_columns:h,filtered_columns:g,pagination_size:_,current_invoice_count:m,paginationCount:f,display_data:v}=(0,H.bP)(t),{getSavedFilters:b,removeSavedFilters:y,saveFilters:w,makeQueryParamFromFilters:k,setDefaultFilters:C,getSavedColumns:x,getOrderBy:D,getColumnLabel:E,getParentRows:F,saveColumns:L}=t,R=(0,Ie.Bu)(),{user_settings:A,execute_auto_export:P,loading_settings:I}=(0,H.bP)(R),{getSettingWithExpiry:S,startSettingsFetch:T}=R,O=(0,Ie.G6)(),{dashboard_data:W,isConnected:$,hasError:q,dashboard_data_flag:Q}=(0,H.bP)(O),{subscribeToChannel:M,unsubscribeToChannel:V,sendMessageByType:G}=O,X=(0,Ie.kH)(),{isMediUser:z,getProfile:N}=X,B=(0,Ie._6)(),{tokenQueryParam:K}=(0,H.bP)(B);B.getTokenQueryParam();const U=(0,Ie.wt)(),{model:j}=(0,H.bP)(U),{getDocTypeSettings:J}=U;return{execute_auto_export:P,isMediUser:z,getProfile:N,startSettingsFetch:T,getDocTypeSettings:J,tokenQueryParam:K,current_invoice_count:m,dashboard_data_flag:Q,pagination_size:_,paginationCount:f,websocketHasError:q,isConnected:$,sendMessageToSocket:G,unsubscribeToChannel:V,subscribeToChannel:M,getSettingWithExpiry:S,saveColumns:L,processing:p,dashboard_data:W,user_settings:A,loading_settings:I,visible_columns:h,filtered_columns:g,getColumnLabel:E,getParentRows:F,getOrderBy:D,getSavedColumns:x,setDefaultFilters:C,makeQueryParamFromFilters:k,saveFilters:w,removeSavedFilters:y,getSavedFilters:b,quickFilterMap:s,assignment_doc_ids:(0,te.KR)([]),restartExportedInvoices:(0,te.KR)(!1),table_columns:(0,te.KR)([]),display_data:v,Popup:Y.A,statusList:e,pageSize:(0,te.KR)(20),skip:(0,te.KR)(1),startfrom:(0,te.KR)(0),resetPagination:!0,queryParams:"?filter=current-month&skip=0",deleteInvoice:(0,te.KR)(!1),recordId:"",resultsCount:(0,te.KR)(0),assigneDialog:(0,te.KR)(!1),ErrorInfos:(0,te.KR)(!1),ErrorText:(0,te.KR)(),QualityConfirm:(0,te.KR)(!1),QualityText:(0,te.KR)(),docrowID:(0,te.KR)(),headerCheckbox:(0,te.KR)(!1),is_any_checked:(0,te.KR)(!1),headerFabIcon:(0,te.KR)(!1),selectionList:(0,te.KR)([]),isMultiDeleteButtonDisabled:(0,te.KR)(!1),isMultiRestartButtonDisabled:(0,te.KR)(!1),showFlow:(0,te.KR)(!1),flow_doc_id:(0,te.KR)(""),use_websocket:(0,te.KR)(!0),show_table_loader:(0,te.KR)(!1),data_status:(0,te.KR)(""),all_invoices:a,automatically_processed:i,manually_processed:r,completed:o,in_progress:n,pending:l,validated_pending_approval:d,approved_pending_second_approval:u,error:c,supplier_approval_status:(0,te.KR)(""),supplier_lookup_record_id:(0,te.KR)(""),supplier_as_org_id:(0,te.KR)(""),model:j,loading:(0,te.KR)(!1),groupingWhereMap:(0,te.KR)(new Map)}}});var ht=s(857),gt=s(54700),_t=s(48975),mt=s(13796),ft=s(35859),vt=s(54782),bt=s(20284),yt=s(82156),wt=s(23316),kt=s(44189),Ct=s(3952),xt=s(62669),Dt=s(88672);const Et=(0,We.A)(pt,[["render",K],["__scopeId","data-v-ea4f42a0"]]),Ft=Et;Ue()(pt,"components",{QMarkupTable:ht.A,QPagination:gt.A,QSeparator:Be.A,QIcon:qe.A,QBadge:Me.A,QPopupProxy:_t.A,QList:Xe.A,QItem:ze.A,QItemSection:Ne.A,QItemLabel:mt.A,QLinearProgress:ft.A,QCheckbox:$e.A,QFab:vt.A,QFabAction:bt.A,QTooltip:Qe.A,QDialog:yt.A,QCard:wt.A,QCardSection:kt.A,QAvatar:Ct.A,QCardActions:xt.A,QBtn:Ve.A}),Ue()(pt,"directives",{ClosePopup:Dt.A})}}]);