"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[1219],{21219:(t,e,i)=>{i.r(e),i.d(e,{default:()=>lt});var a=i(83673),s=i(62323);const l=t=>((0,a.dD)("data-v-c0451c90"),t=t(),(0,a.Cn)(),t),o={class:"row bg-grey-2 q-pl-xl q-pr-md"},n={class:"secondary-c-text text-h6"},d=l((()=>(0,a._)("img",{width:"24",src:"back-primary.svg"},null,-1))),r={style:{"vertical-align":"middle","margin-left":"10px","font-size":"20px",cursor:"pointer"}},c={class:"row bg-grey-2 q-pl-xl q-pr-md q-pb-md"},h={class:"max-width-100",id:"left_section",ref:"left_section"},g={class:"full-width bg-white q-ma-sm scroll-area-height"},p={class:"row justify-center q-pl-md q-pr-md q-pt-md"},m={class:"secondary-c-text text-h6 text-weight-bold"},u={class:"full-width left-scroll-area-height scrolle-y q-pa-sm"},f=["data-id","src"],_={class:"right_section q-pl-sm",id:"right_section",ref:"right_section"},v={class:"row"},w={class:"col-xs-12 col-sm-5 col-md-5 col-lg-5 q-px-sm scroll-area-height"},b={class:"bg-white mb-4 image_control_panel"},y={class:"row"},D={class:"panel-left col-sm-6 col-md-6 col-lg-6"},k={class:"row"},x={class:"panel-middle col-sm-1 col-md-1 col-lg-1 mt-8"},I={class:"page-numbers"},L={class:"panel-right col-sm-5 col-md-5 col-lg-5"},C=l((()=>(0,a._)("img",{width:"24",height:"24",src:"ocr_icon.svg"},null,-1))),q=l((()=>(0,a._)("img",{width:"24",height:"24",src:"loupe.svg"},null,-1))),z={class:"full-width bg-white",id:"image_container",style:{height:"90%"}},M={class:"full-width full-height q-pa-sm scrolle-y",id:"image_scrolle",style:{position:"relative"}},Z=["src","width"],E={class:"col-xs-12 col-sm-7 col-md-7 col-lg-7"};function P(t,e,i,l,P,R){const W=(0,a.up)("q-icon"),O=(0,a.up)("q-btn"),U=(0,a.up)("q-tooltip"),T=(0,a.up)("MediFieldsView"),B=(0,a.up)("Loader");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a._)("div",n,[t.doc2AppMode?((0,a.wg)(),(0,a.j4)(O,{key:0,flat:"",rounded:"","data-cy":"dashboard",color:"primary",to:"/dashboard"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{class:"text-red-13",size:"sm"},{default:(0,a.w5)((()=>[d])),_:1}),(0,a._)("label",r,(0,s.zw)(t.$t("pages.screen2a.dashboard")),1)])),_:1})):(0,a.kq)("",!0)])]),(0,a._)("div",c,[(0,a._)("div",h,[(0,a._)("div",g,[(0,a._)("div",p,[(0,a._)("span",m,(0,s.zw)(t.$t("pages.screen2a.pages")),1)]),(0,a._)("div",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.images,((i,l)=>((0,a.wg)(),(0,a.iD)("img",{"data-id":l,key:l,src:t.baseUrl+"/"+i.path,class:(0,s.C_)(["q-pa-xs shadow-5 full-width q-ma-sm cursor-pointer",l===this.page-1?"active":""]),style:{height:"auto"},onClick:e[0]||(e[0]=(...e)=>t.imageclicked&&t.imageclicked(...e))},null,10,f)))),128))])])],512),(0,a._)("div",_,[(0,a._)("div",v,[(0,a._)("div",w,[(0,a._)("div",b,[(0,a._)("div",y,[(0,a._)("div",D,[(0,a._)("div",k,[(0,a.Wm)(O,{id:"menu_btn",round:"",icon:"chevron_right",size:"xs",class:"text-grey-6 toggler-right p-t-40",onClick:e[1]||(e[1]=e=>t.toggleMenu())}),(0,a.Uk)(" "+(0,s.zw)(t.apiData.filename),1)])]),(0,a._)("div",x,[(0,a._)("span",I,(0,s.zw)(t.currentPage())+"/"+(0,s.zw)(t.images.length),1)]),(0,a._)("div",L,[(0,a.Wm)(O,{flat:"",class:"float-right pr-6 pl-6",onClick:t.viewOCRDocument},{default:(0,a.w5)((()=>[C,(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("ocr_view")),1)])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(O,{flat:"",id:"glassBtn",class:"float-right pr-6 pl-6",onClick:t.startMagnifyGlass},{default:(0,a.w5)((()=>[q,(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("pages.screen2a.magnify")),1)])),_:1})])),_:1},8,["onClick"])])])]),(0,a._)("div",z,[(0,a._)("div",M,[(0,a._)("div",{id:"zoom",style:(0,s.j5)('background-image: url("'+t.image+' "); top: 51px;left: 506px; background-position: 268.297px 82.6934px;')},null,4),(0,a._)("img",{class:"screenshot",src:t.image,width:t.imageWidth,id:"screenshot",ref:"screenshot",draggable:"false",onLoad:e[2]||(e[2]=(...e)=>t.getImageDetails&&t.getImageDetails(...e))},null,40,Z)])])]),(0,a._)("div",E,[t.hasApiData()?((0,a.wg)(),(0,a.j4)(T,{key:0,data:t.apiData,renderOpenWindoIcon:!0},null,8,["data"])):(0,a.kq)("",!0)])])],512)]),(0,a.Wm)(B)],64)}var R=i(77378),W=i(61959),O=i(72113),U=i(45401),T=i(48825),B=i(49566),G=i(41891),H=i(98718),$=i(29938),A=i(80579),S=function(t,e,i,a){function s(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,l){function o(t){try{d(a.next(t))}catch(e){l(e)}}function n(t){try{d(a["throw"](t))}catch(e){l(e)}}function d(t){t.done?i(t.value):s(t.value).then(o,n)}d((a=a.apply(t,e||[])).next())}))};const Q=document.querySelector.bind(document);let V;const N=(0,a.aZ)({el:"#app",mixins:[U.Z,R.Z],components:{Loader:O.Z,MediFieldsView:H["default"]},watch:{},data(){return{page:1,docId:"",imageHeight:0,imageWidth:0,showArticlePage:!1,loading:!1,enableExportButton:!1,magnifyGlass:{},allowedDoctypes:G.rf,account_block:""}},beforeRouteLeave:function(t,e,i){this.removeMagnifier(),i()},mounted:function(){window.addEventListener("resize",this.windowResize),document.body.addEventListener("click",this.mouseClicked,!0),Q("#image_scrolle").addEventListener("scroll",this.handleScroll),window.aa=this,this.init()},unmounted:function(){window.removeEventListener("resize",this.windowResize)},methods:{init(){return S(this,void 0,void 0,(function*(){const t=(!0).toString();"true"===t.toLowerCase()&&(this.$route.params.id||this.$router.push("/dashboard"),this.doc2AppMode=!0),this.docId=this.$route.params.id,yield this.getInvoiceDataByDocId(this.docId),G.at.includes(this.apiData.status)&&(this.isReadOnly=!0),this.initPage()}))},getInvoiceDataByDocId(t){return S(this,void 0,void 0,(function*(){try{this.showLoading();const e={doc_id:t},i=yield A.U0.getById(e);i.doc_id?this.apiData=i:this.showErrorToast(this.$t("pages.messages.INVALID_DOCUMENT"))}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},goHelp(){window.open("https://docs.cloudintegration.eu/")},initPage(){this.handleImageBaseURL(),this.image=this.baseUrl+"/"+(0,B.Rl)(this.apiData.images[0].path),this.images=(0,B.PN)(this.apiData.images),this.handleLineItemsVisibilty();let t=Q("#image_container");this.imageWidth=t.offsetWidth,this.imageHeight=t.offsetHeight},handleLineItemsVisibilty(){const t=(!0).toString();"true"===t.toLowerCase()&&this.allowedDoctypes.indexOf(this.apiData.doc_type),this.account_block="",(this.apiData.hasOwnProperty("table_blocked")&&1==this.apiData.table_blocked||"true"==this.apiData.table_blocked)&&(this.account_block="table_blocked",this.showArticlePage=!1),(this.apiData.hasOwnProperty("table_extraction_disabled")&&1==this.apiData.table_extraction_disabled||"true"==this.apiData.table_extraction_disabled)&&(this.account_block="table_extraction_disabled",this.showArticlePage=!1),(this.apiData.hasOwnProperty("table_not_supported")&&1==this.apiData.table_not_supported||"true"==this.apiData.table_not_supported)&&(this.account_block="table_not_supported",this.showArticlePage=!1)},imageclicked(t){this.image=this.baseUrl+"/"+(0,B.Rl)(this.apiData.images[t.target.dataset.id].path),this.page=parseInt(t.target.dataset.id)+1},updateImportJson(t,e,i,a){let s=!1;this.apiData.fields.forEach(((a,l)=>{if(a.name===t){s=!0,a.hasOwnProperty("original")||(a["original"]=Object.assign({},a)),e&&(a.coords=e),i&&(a.page=i),a.is_valid=!0,a.is_validated=!0;let l=this.fields[t];return a.formatted_value=l.formatted_value,a.value=l.value,a.content=l.content,l.hasOwnProperty("api_save")&&l.api_save||(a.value=l.formatted_value),void(a.color="success-border-left")}})),s||(this.apiData.fields.push({}),this.apiData.fields[this.apiData.fields.length-1].name=t,this.apiData.fields[this.apiData.fields.length-1].content=this.fields[t].content,this.apiData.fields[this.apiData.fields.length-1].formatted_value=this.fields[t].formatted_value,this.apiData.fields[this.apiData.fields.length-1].value=this.fields[t].value,this.apiData.fields[this.apiData.fields.length-1].validation_code="",this.apiData.fields[this.apiData.fields.length-1].extraction_method=a,this.apiData.fields[this.apiData.fields.length-1].is_validated=!0,this.apiData.fields[this.apiData.fields.length-1].is_valid=!0,this.apiData.fields[this.apiData.fields.length-1].color="success-border-left",e&&(this.apiData.fields[this.apiData.fields.length-1].coords=e),i&&(this.apiData.fields[this.apiData.fields.length-1].page=i))},convertToUSValue(t){return t.replace(/,/g,".")},convertToDeValue(t){return t.toString().replace(/\./g,",")},setApiData(t){this.apiData=t,this.$forceUpdate()},windowResize(){let t=Q("#image_container");this.imageWidth=t.offsetWidth,this.imageHeight=t.offsetHeight,this.$forceUpdate(),setTimeout((()=>{this.getImageDetails(),this.removeMagnifier()}),20)},handleScroll(){},getImageDetails(){V=Q("#screenshot"),V&&(this.imageWidth=V.offsetWidth,this.imageHeight=V.offsetHeight),this.toggleMenu()},startMagnifyGlass(t){let e=document.getElementById("zoom");if(e.classList.contains("enable-glass"))return;let i=Q(".screenshot");const a=Q("#glassBtn");a.classList.add("glass-active"),e.classList.add("enable-glass"),e.style.backgroundImage="url("+i.src+")",this.magnifyGlass={Ix:i.offsetLeft,Iy:i.offsetTop,Zw:e.offsetWidth,Zh:e.offsetHeight,ratio:i.naturalWidth/i.width},i.addEventListener("pointermove",this.updateMagnifier),e.addEventListener("pointermove",this.updateMagnifier)},updateMagnifier(t){let e=document.getElementById("zoom");if(!e.classList.contains("enable-glass"))return;var i,a,s;t.preventDefault(),i=this.getCursorPos(t),a=i.x,s=i.y,document.body.classList.add("active");let l=50,o=20,n=o,d=l+30;e.style.top=i.y-this.magnifyGlass.Zh/2+l+"px",e.style.left=i.x-this.magnifyGlass.Zw/2+o+"px";let r=(this.magnifyGlass.Ix-a)*this.magnifyGlass.ratio+this.magnifyGlass.Zw/2-n,c=(this.magnifyGlass.Iy-s)*this.magnifyGlass.ratio+this.magnifyGlass.Zh/2-d,h=r+"px "+c+"px";e.style.backgroundPosition=h},getCursorPos(t){var e,i=0,a=0;t=t||window.event;let s=Q(".screenshot");return e=s.getBoundingClientRect(),i=t.pageX-e.left,a=t.pageY-e.top,i-=window.pageXOffset,a-=window.pageYOffset,{x:i,y:a}},removeMagnifier(){const t=Q("#glassBtn");t&&t.classList.remove("glass-active");const e=document.getElementById("zoom");e&&(e.classList.remove("enable-glass"),e.removeEventListener("pointermove",this.updateMagnifier,!1));let i=Q(".screenshot");i&&i.removeEventListener("pointermove",this.updateMagnifier,!1),document.body.classList.remove("active"),this.magnifyGlass=null},mouseClicked(t){this.removeMagnifier()},currentPage(){return this.page},handleImageBaseURL(){this.apiData.images[0]&&this.apiData.images[0].path.match(/doc2/g)&&(this.baseUrl="https://fellowkv2.cloudintegration.eu")},hasApiData(){return 0!==(0,$.v7)(this.apiData)},viewOCRDocument(){let t=this.$router.resolve({path:"/ocr-document/"+this.docId+"/"+this.page});window.open(t.href,"_blank","location=yes,toolbar=yes,scrollbars=yes,resizable=yes,left=500,width=1500,height=1000")},toFlowScreen(t){this.$router.push("/doc_flow/"+t)}},setup(){const t=(0,T.Z)();let e={},i=[];return{apiData:(0,W.iH)(i),fields:e,image:"",images:i,baseUrl:"https://api.docbits.com",isReadOnly:!1,doc2AppMode:(0,W.iH)(!1),showNotification(e){t.notify({message:e,color:"primary",position:"top"})}}}});var j=i(74260),F=i(39570),Y=i(2165),X=i(13747),J=i(24554),K=i(5363),tt=i(86115),et=i(17132),it=i(7518),at=i.n(it);const st=(0,j.Z)(N,[["render",P],["__scopeId","data-v-c0451c90"]]),lt=st;at()(N,"components",{QToolbar:F.Z,QBtn:Y.Z,QToolbarTitle:X.Z,QIcon:J.Z,QTooltip:K.Z,QField:tt.Z,QTable:et.Z})}}]);