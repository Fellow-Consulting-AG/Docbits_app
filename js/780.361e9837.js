"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[780],{40780:(e,t,a)=>{a.r(t),a.d(t,{default:()=>he});var l=a(83673);const s={class:"container p-b-0 q-pb-sm settings p-t-10"};function n(e,t,a,n,o,i){const d=(0,l.up)("SubHeader"),r=(0,l.up)("BackToSettings"),u=(0,l.up)("ListCustomColumn");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(d,{name:"doc_type_custom_columns",label:e.$t("custom_columns"),display_help_link:!1},null,8,["label"]),(0,l.Wm)(r,{back_to_rotue:"/settings/document"}),(0,l._)("div",s,[(0,l.Wm)(u)])],64)}var o=a(62323),i=a(98880);const d={class:"row q-mb-sm q-pa-sm warning-holder text-weight-bold text-red font-size-medium full-width"},r={style:{width:"100%"}},u={key:0,class:"row q-mb-sm q-pa-sm error-holder full-width"},m={style:{width:"100%"}},c={class:"row full-width q-mb-sm q-mt-md"},h={key:0,class:"row"},_={class:"active-toggle custom-col-toggle"},p=["onUpdate:modelValue"],w=(0,l._)("div",{class:"slider"},null,-1),g=(0,l._)("img",{class:"img-fluid",width:"24",height:"26",src:"Trash-Block.svg",alt:""},null,-1),b=(0,l._)("img",{class:"img-fluid",width:"24",height:"26",src:"trash-bin-default.svg",alt:""},null,-1);function y(e,t,a,s,n,y){const f=(0,l.up)("q-icon"),C=(0,l.up)("q-input"),v=(0,l.up)("q-space"),T=(0,l.up)("q-btn"),R=(0,l.up)("q-tooltip"),k=(0,l.up)("q-td"),D=(0,l.up)("q-popup-edit"),V=(0,l.up)("q-tr"),O=(0,l.up)("q-table"),q=(0,l.up)("CreateCustomColumn"),Z=(0,l.up)("q-dialog"),U=(0,l.up)("CreateTable");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[(0,l._)("span",r,(0,o.zw)(e.$t("custom_column_change_warning")),1)]),e.no_table_warning?((0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("span",m,(0,o.zw)(e.$t("no_table_exists")),1)])):(0,l.kq)("",!0),(0,l._)("div",c,[(0,l.Wm)(C,{style:{width:"300px"},dense:"",outlined:"",debounce:"300",color:"primary",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t)},{append:(0,l.w5)((()=>[(0,l.Wm)(f,{name:"search"})])),_:1},8,["modelValue"]),(0,l.Wm)(v),(0,l.Wm)(T,{class:"q-mr-sm",color:"primary",label:e.$t("create_new_table"),onClick:t[1]||(t[1]=t=>e.displayCreateTableDialog=!0)},null,8,["label"]),(0,l.Wm)(T,{color:"primary",label:e.$t("add_new_table_column"),onClick:t[2]||(t[2]=t=>e.addColumnDialog=!0)},null,8,["label"])]),(0,l.Wm)(O,{class:"sticky-header-table","no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),style:(0,o.j5)({height:e.table_height+"vh"}),rows:e.rows,columns:e.columns,"rows-per-page-options":[0],"row-key":"id","table-header-class":"highlighted-back",filter:e.filter,loading:e.loading},{top:(0,l.w5)((()=>[])),body:(0,l.w5)((t=>[(0,l.Wm)(V,{props:t,id:t.key},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.cols,(a=>((0,l.wg)(),(0,l.iD)(l.HY,{key:a.name},["action"===a.name?((0,l.wg)(),(0,l.j4)(k,{key:0,style:{width:"145px"}},{default:(0,l.w5)((()=>[""!==t.row.id?((0,l.wg)(),(0,l.iD)("span",h,[(0,l._)("label",_,[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":[e=>t.row.is_active=e,a=>{e.handleVisibility(a,t.row)}]},null,8,p),[[i.e8,t.row.is_active]]),w]),"DEFAULT"==t.row.org_id?((0,l.wg)(),(0,l.j4)(T,{key:0,"no-caps":"",flat:"",dense:"",style:{cursor:"default","margin-top":"4px",height:"35px"}},{default:(0,l.w5)((()=>[g,(0,l.Wm)(R,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("default_column_block_delete")),1)])),_:1})])),_:1})):((0,l.wg)(),(0,l.j4)(T,{key:1,disable:t.row.processing_delete,"no-caps":"",flat:"",dense:"",style:{cursor:"default","margin-top":"4px",height:"35px"},onClick:a=>e.handleDelete(t.row)},{default:(0,l.w5)((()=>[b])),_:2},1032,["disable","onClick"]))])):(0,l.kq)("",!0)])),_:2},1024)):"column_name"===a.name?((0,l.wg)(),(0,l.j4)(k,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{borderless:"",tabindex:"0","data-id":t.key,modelValue:t.row.column_name,"onUpdate:modelValue":e=>t.row.column_name=e,readonly:""!==t.row.id},null,8,["data-id","modelValue","onUpdate:modelValue","readonly"])])),_:2},1024)):"title"===a.name?((0,l.wg)(),(0,l.j4)(k,{key:2},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.row.title)+" ",1),(0,l.Wm)(D,{modelValue:t.row.title,"onUpdate:modelValue":e=>t.row.title=e,title:"Update title"},{default:(0,l.w5)((a=>[(0,l.Wm)(C,{modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,dense:"",autofocus:"",onKeyup:(0,i.D2)(a.set,["enter"]),onKeydown:(0,i.D2)((l=>e.updateColumnTitle(t.row.id,a.value)),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup","onKeydown"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)):"column_type"===a.name?((0,l.wg)(),(0,l.j4)(k,{key:3},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{borderless:"",tabindex:"0","data-id":t.key,modelValue:t.row.column_type,"onUpdate:modelValue":e=>t.row.column_type=e,readonly:""!==t.row.id},null,8,["data-id","modelValue","onUpdate:modelValue","readonly"])])),_:2},1024)):"table_name"===a.name?((0,l.wg)(),(0,l.j4)(k,{key:4},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{borderless:"",tabindex:"0","data-id":t.key,modelValue:t.row.table_name,"onUpdate:modelValue":e=>t.row.table_name=e,readonly:""!==t.row.id},null,8,["data-id","modelValue","onUpdate:modelValue","readonly"])])),_:2},1024)):(0,l.kq)("",!0)],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["no-data-label","style","rows","columns","filter","loading"]),(0,l.Wm)(Z,{modelValue:e.addColumnDialog,"onUpdate:modelValue":t[3]||(t[3]=t=>e.addColumnDialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[4]||(t[4]=(0,i.D2)((t=>e.addColumnDialog=!1),["esc"]))},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{is_table_training_doc:!1,table_name:"",tables_list:e.tables_list,tables:"[]",columns_list:e.columns_list,addColumnDialog:e.addColumnDialog,parent_view:"columns_list",table_list_loading:e.table_list_loading},null,8,["tables_list","columns_list","addColumnDialog","table_list_loading"])])),_:1},8,["modelValue"]),(0,l.Wm)(Z,{modelValue:e.displayCreateTableDialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.displayCreateTableDialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[6]||(t[6]=(0,i.D2)((t=>e.displayCreateTableDialog=!1),["esc"]))},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{doc_type:e.doc_type},null,8,["doc_type"])])),_:1},8,["modelValue"])],64)}var f=a(30052),C=a.n(f),v=a(77378),T=a(61959),R=a(45401),k=a(80579),D=a(54268),V=a(86068);const O={class:"text-weight-bold"},q={style:{"margin-bottom":"20px"},class:"row full-width mb-10 mt-8"},Z={class:"full-width"},U=(0,l._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function N(e,t,a,s,n,d){const r=(0,l.up)("q-toolbar-title"),u=(0,l.up)("q-btn"),m=(0,l.up)("q-toolbar"),c=(0,l.up)("q-input"),h=(0,l.up)("q-card-section"),_=(0,l.up)("q-card-actions"),p=(0,l.up)("q-inner-loading"),w=(0,l.up)("q-card"),g=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(w,{style:{width:"600px"}},{default:(0,l.w5)((()=>[(0,l._)("form",{onSubmit:t[1]||(t[1]=(0,i.iM)(((...t)=>e.submitNewColumFrom&&e.submitNewColumFrom(...t)),["prevent","stop"]))},[(0,l.Wm)(m,{class:"secondary-toolbar"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("span",O,(0,o.zw)(e.$t("create_new_table")),1)])),_:1}),(0,l.wy)((0,l.Wm)(u,{flat:"",round:"",dense:"",icon:"close"},null,512),[[g]])])),_:1}),(0,l.Wm)(h,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l._)("div",q,[(0,l._)("div",Z,[(0,l.Wm)(c,{outlined:"",tabindex:"0",class:(0,o.C_)("full-width "),modelValue:e.new_model["table_name"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.new_model["table_name"]=t),label:e.$t("table_name"),hint:e.message,"error-message":e.new_model["name_error_msg"],error:e.new_model["name_error"]},null,8,["modelValue","label","hint","error-message","error"])])])])),_:1}),(0,l.Wm)(_,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(u,{class:"highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[g]]),(0,l.Wm)(u,{type:"submit",color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,l.Wm)(p,{showing:e.loading},{default:(0,l.w5)((()=>[U])),_:1},8,["showing"])])),_:1})}var W=a(53371),E=a(29938),x=function(e,t,a,l){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function o(e){try{d(l.next(e))}catch(t){n(t)}}function i(e){try{d(l["throw"](e))}catch(t){n(t)}}function d(e){e.done?a(e.value):s(e.value).then(o,i)}d((l=l.apply(e,t||[])).next())}))};const $=(0,l.aZ)({el:"#app",mixins:[v.Z],props:{doc_type:{type:String,default:""}},components:{},data(){return{message:W.i18n.t("field_only_characters")}},setup(){let e={};return{new_model:(0,T.iH)(e),token:(0,T.iH)(""),loading:(0,T.iH)(!1)}},watch:{},mounted(){this.setNewModel()},methods:{setNewModel(){this.new_model["table_name"]="",this.new_model["name_error"]=!1,this.new_model["name_error_msg"]=""},submitNewColumFrom(){return x(this,void 0,void 0,(function*(){try{if(!this.validateRow(this.new_model))return;this.loading=!0,yield this.saveNewRow()}catch(e){return null!=e&&"object"==typeof e&&e.hasOwnProperty("message")?void this.showErrorToast(e.message):void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},saveNewRow(){return x(this,void 0,void 0,(function*(){let e;const t={table_name:this.new_model["table_name"],doc_type_name:this.doc_type,is_default:!1};if(e=yield k.Um.createTable(t),e.data&&e.data.hasOwnProperty("success")&&!1===e.data.success)throw{message:e.data.message};const a=new CustomEvent("new_table_created",{detail:{data:e.data}});document.dispatchEvent(a),this.showSuccessToast("Table Created successfully"),this.setNewModel()}))},validateRow(e){let t=!0;return this.new_model["name_error"]=!1,this.new_model["name_error_msg"]="",e["table_name"]&&0!=e["table_name"].length?(0,E.ij)(e["table_name"])?t:(this.new_model["name_error_msg"]="Field Name can only contain characters, numbers, hyphen and underscore",this.new_model["name_error"]=!0,!1):(this.new_model["name_error_msg"]="Table Name is required",this.new_model["name_error"]=!0,!1)}}});var L=a(74260),j=a(10151),H=a(39570),Q=a(13747),S=a(2165),I=a(25589),A=a(64689),F=a(99367),P=a(66941),z=a(60677),K=a(7518),B=a.n(K);const M=(0,L.Z)($,[["render",N]]),Y=M;B()($,"components",{QCard:j.Z,QToolbar:H.Z,QToolbarTitle:Q.Z,QBtn:S.Z,QCardSection:I.Z,QInput:A.Z,QCardActions:F.Z,QInnerLoading:P.Z}),B()($,"directives",{ClosePopup:z.Z});var G=function(e,t,a,l){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function o(e){try{d(l.next(e))}catch(t){n(t)}}function i(e){try{d(l["throw"](e))}catch(t){n(t)}}function d(e){e.done?a(e.value):s(e.value).then(o,i)}d((l=l.apply(e,t||[])).next())}))};const J=(0,l.aZ)({mixins:[R.Z,v.Z],components:{CreateCustomColumn:V.Z,CreateTable:Y},props:{table_height:{type:String,default:"55"}},data(){return{selectedTitle:(0,T.iH)("")}},mounted:function(){this.prepareColumns(),this.getTableName(),this.fetchColumns(),document.addEventListener("custom_column_create",this.customColumnCreated),document.addEventListener("new_table_created",this.newTableCreated)},unmounted:function(){document.removeEventListener("custom_column_create",this.customColumnCreated),document.removeEventListener("new_table_created",this.newTableCreated)},methods:{prepareColumns(){this.columns.push(Object.assign({},{name:"column_name",label:this.$t("column_name"),field:"column_name",align:"left"})),this.columns.push(Object.assign({},{name:"title",label:this.$t("title"),field:"title",align:"left"})),this.columns.push(Object.assign({},{name:"column_type",label:this.$t("column_type"),field:"column_type",align:"left"})),this.columns.push(Object.assign({},{name:"table_name",label:this.$t("table_name"),field:"table_name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},getTableName(){return this.doc_type=String(this.$route.params.type),String(this.doc_type)},fetchColumns(){return G(this,void 0,void 0,(function*(){try{this.loading=!0;const e=yield k.Um.getTableColumns(this.getTableName());if(e.data&&e.data.hasOwnProperty("success")&&!1===e.success)throw{message:e.data.message};let t=[];for(let[a,l]of Object.entries(e.data)){const e=l;for(let[l,s]of Object.entries(e)){const e=s;let l=Object.assign({},e);l["table_name"]=a,t.push(l)}}this.prepareRows(t)}catch(e){throw{message:this.$t("pages.messages.ERROR_INTERNAL_OCCUR")}}finally{this.hideLoading(),this.loading=!1}}))},prepareRows(e){this.rows=[],this.columns_list={};for(let[t,a]of Object.entries(e)){const e=a;this.addNewRow(e),e&&e.hasOwnProperty("column_name")&&this.addToColumnList(e.column_name)}this.prepareTableList()},addNewRow(e){let t=Object.assign({},e);return t["name"]=e.column_name,t["label"]=this.getLabelToDisplay(e),t["processing_visibility"]=!1,t["processing_delete"]=!1,t["is_hidden"]=!!t.is_hidden,t["is_active"]=!t["is_hidden"],this.rows.push(t),t},getLabelToDisplay(e){let t=e.title;return this.$t("pages.line_items_columns."+e.translation_key)!=="pages.line_items_columns."+e.translation_key&&(t=this.$t("pages.line_items_columns."+e.translation_key)),t},getRow(e){const t=this.rows.findIndex((t=>t.id==e));return t},updateColumnTitle(e,t){return G(this,void 0,void 0,(function*(){if(this.selectedTitle!==t){this.selectedTitle="";try{this.loading=!0;let a=new FormData;return a.append("title",t),yield this.updateRow(e,a),!0}catch(a){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}else this.selectedTitle=""}))},handleDelete(e){return G(this,void 0,void 0,(function*(){const t=this.getRow(e.id);try{this.rows[t].processing_delete=!0,this.loading=!0;let a=new FormData;a.append("is_deleted",!0===e.is_deleted?"false":"true"),yield this.updateRow(e.id,a),this.rows.splice(t,1)}catch(a){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.rows[t].processing_delete=!1,this.loading=!1}}))},handleVisibility(e,t){return G(this,void 0,void 0,(function*(){const a=this.getRow(t.id);try{const l=!e;this.rows[a].processing_visibility=!0,this.loading=!0;let s=new FormData;s.append("is_hidden",!1===l?"false":"true"),yield this.updateRow(t.id,s),this.rows[a].is_hidden=l}catch(l){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.rows[a].processing_visibility=!1,this.loading=!1}}))},updateRow(e,t){return G(this,void 0,void 0,(function*(){let a,l=yield(0,D.O_)();if(a=yield C().post(D.hi.update_document_table_column,t,{params:{id:e},headers:{Authorization:l}}),!a.data.success||!0!==a.data.success)throw a.data.message?a.data.message:{message:"Response dont have table_data index/success is set to false"}}))},addToColumnList(e){this.columns_list[e]=e},newTableCreated(){this.displayCreateTableDialog=!1,this.prepareTableList()},prepareTableList(){return G(this,void 0,void 0,(function*(){let e;this.tables_list=[],this.tables_list.push(Object.assign({},{value:"",label:this.$t("select_table")}));try{if(this.loading=!0,this.no_table_warning=!1,this.table_list_loading=!0,this.showLoading(),e=yield k.Um.getTable(this.doc_type),e.data&&e.data.hasOwnProperty("success")&&!1===e.success)throw{message:e.data.message};if(e.data&&0===e.data.length)return void(this.no_table_warning=!0);e.data.forEach((e=>{this.tables_list.push(Object.assign({},{value:e.table_name,label:e.table_name}))}))}catch(t){throw{message:this.$t("pages.messages.ERROR_INTERNAL_OCCUR")}}finally{this.hideLoading(),this.loading=!1,this.table_list_loading=!1}}))},customColumnCreated(e){e&&e.detail&&(this.addColumnDialog=!1,this.fetchColumns())}},setup(){const e=(0,T.iH)("");let t=[],a={};const l=(0,T.iH)(t);return{columns:l,filter:e,rows:(0,T.iH)(t),loading:(0,T.iH)(!1),addColumnDialog:(0,T.iH)(!1),columns_list:(0,T.iH)(a),tables_list:(0,T.iH)([]),doc_type:(0,T.iH)(""),displayCreateTableDialog:(0,T.iH)(!1),no_table_warning:(0,T.iH)(!1),table_list_loading:(0,T.iH)(!1)}}});var X=a(24554),ee=a(62025),te=a(17132),ae=a(18186),le=a(83884),se=a(5363),ne=a(61289),oe=a(46778);const ie=(0,L.Z)(J,[["render",y]]),de=ie;B()(J,"components",{QInput:A.Z,QIcon:X.Z,QSpace:ee.Z,QBtn:S.Z,QTable:te.Z,QTr:ae.Z,QTd:le.Z,QTooltip:se.Z,QPopupEdit:ne.Z,QDialog:oe.Z});var re=a(47845),ue=a(13873);const me=(0,l.aZ)({el:"#app",mixins:[],components:{ListCustomColumn:de,BackToSettings:re.Z,SubHeader:ue.Z},data(){return{}},setup(){return{}}}),ce=(0,L.Z)(me,[["render",n]]),he=ce}}]);