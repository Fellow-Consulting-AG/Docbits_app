"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[6181],{6181:(e,s,t)=>{t.r(s),t.d(s,{default:()=>De});var a=t(61758),r=t(29104),o=t(58790);const i=e=>((0,a.Qi)("data-v-2d056084"),e=e(),(0,a.jt)(),e),l={class:"h-m-24 dashboard-text-color"},n={class:"row justify-between",style:{"margin-top":"-18px"}},d={class:"dashboard-search-box mt-20 white-inputs"},m={class:"dashboard-list-area q-my-lg"},c={class:"table-header-text"},u=["data-index","draggable","dropzone","onDragstart","onDrop","onDragover"],h={key:0,class:"cursor-default"},p={key:1},g=["onClick"],_={key:0},w={key:1},b={key:2},f={key:3,class:"text-center"},y={class:"text-red-14"},k={key:0},v={key:0,class:"text-center",colspan:"4"},E={key:0},F={key:1},C={class:"col-sm-12 col-md-12 col-lg-12"},$={style:{width:"80%",left:"10%",position:"relative"}},L=i((()=>(0,a.Lk)("div",{class:"col-sm-12 col-md-12 col-lg-12 text-center"},[(0,a.Lk)("img",{src:"settings/user.svg",class:"black_to_white q-my-sm",style:{height:"80px"}})],-1))),A={class:"col-sm-12 col-md-12 col-lg-12",id:"fist_name",style:{"margin-bottom":"5%"}},D={class:"col-sm-12 col-md-12 col-lg-12",id:"last_name"},U={class:"col-sm-12 col-md-12 col-lg-12",id:"email"},V={class:"password-requirements"},S={class:"col-sm-12 col-md-12 col-lg-12",id:"confirm_password"},x={class:"col-sm-12 col-md-12 col-lg-12"},N={class:"float-right q-ml-auto q-mb-md q-mr-sm"},P={class:"q-ml-sm"};function T(e,s,t,i,T,q){const R=(0,a.g2)("SubHeader"),I=(0,a.g2)("BackToSettings"),Q=(0,a.g2)("q-input"),K=(0,a.g2)("f-btn"),X=(0,a.g2)("ColumnOrderBy"),z=(0,a.g2)("q-checkbox"),O=(0,a.g2)("q-item-section"),j=(0,a.g2)("q-item"),B=(0,a.g2)("q-separator"),M=(0,a.g2)("q-list"),H=(0,a.g2)("q-menu"),Z=(0,a.g2)("q-btn"),G=(0,a.g2)("q-markup-table"),J=(0,a.g2)("Loader"),W=(0,a.g2)("q-toolbar-title"),Y=(0,a.g2)("q-toolbar"),ee=(0,a.g2)("q-icon"),se=(0,a.g2)("q-form"),te=(0,a.g2)("q-card-section"),ae=(0,a.g2)("q-card"),re=(0,a.g2)("q-dialog"),oe=(0,a.g2)("q-avatar"),ie=(0,a.g2)("q-card-actions"),le=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(R,{name:"user_settings",label:e.$t("pages.user.settings"),onSearch:!1},null,8,["label"]),(0,a.bF)(I),(0,a.Lk)("div",l,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[(0,a.bF)(Q,{class:"width-500",dense:"",modelValue:e.filter.keyword,"onUpdate:modelValue":[s[0]||(s[0]=s=>e.filter.keyword=s),s[1]||(s[1]=s=>e.updateSearch(e.filter.keyword))],autofocus:"",debounce:1e3,placeholder:e.$t("search"),outlined:"",onKeyup:s[2]||(s[2]=(0,r.jR)((s=>e.updateSearch(e.filter.keyword)),["enter"]))},null,8,["modelValue","placeholder"])]),(0,a.bF)(K,{label:e.$t("pages.user.add_user"),class:"mt-20",onClick:s[3]||(s[3]=s=>e.openForm(null))},null,8,["label"])]),(0,a.Lk)("div",m,[(0,a.bF)(G,{flat:"",class:"dashboard-table-style scroll-height-100vh-130px back-white",id:"users_table"},{default:(0,a.k6)((()=>[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.columns,((t,i)=>((0,a.uX)(),(0,a.CE)("th",{key:t.name,"data-index":i,draggable:e.canDragDropColumn(t),dropzone:e.canDragDropColumn(t),direction:"horizontal",onDragstart:s=>e.onDragStart(s,e.columns,i),onDrop:(0,r.D$)((s=>e.handleDrop(s,i)),["prevent"]),onDragover:(0,r.D$)((s=>e.onDragOver(s,i)),["prevent"]),onDragenter:s[4]||(s[4]=(0,r.D$)(((...s)=>e.onDragEnter&&e.onDragEnter(...s)),["prevent"])),onDragleave:s[5]||(s[5]=(0,r.D$)(((...s)=>e.onDragLeave&&e.onDragLeave(...s)),["prevent"])),style:(0,o.Tr)({cursor:e.getIsDragging?"pointer":"move"}),class:(0,o.C4)(t.class||"")},["actions"==t.name?((0,a.uX)(),(0,a.CE)("span",h,(0,o.v_)(e.$t(t.label)),1)):((0,a.uX)(),(0,a.CE)("span",p,(0,o.v_)(e.$t(t.label)),1)),t.action?((0,a.uX)(),(0,a.Wv)(X,{key:2,returnSortingObj:!0,column_name:t.name},null,8,["column_name"])):(0,a.Q3)("",!0)],46,u)))),128))])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.usersList,((t,i)=>((0,a.uX)(),(0,a.CE)("tr",{key:i,onClick:s=>e.openForm(t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.columns,(i=>((0,a.uX)(),(0,a.CE)(a.FK,{key:i.name},["name"==i.name?((0,a.uX)(),(0,a.CE)("td",_,(0,o.v_)(t["first_name"])+" "+(0,o.v_)(t["last_name"]),1)):"email"==i.name?((0,a.uX)(),(0,a.CE)("td",w,(0,o.v_)(t["email"]),1)):"is_organisation_admin"==i.name?((0,a.uX)(),(0,a.CE)("td",b,[(0,a.bF)(z,{dense:"",modelValue:t["is_organisation_admin"],"onUpdate:modelValue":e=>t["is_organisation_admin"]=e,onClick:s=>e.isAdminToggle(t["id"],t["is_organisation_admin"])},null,8,["modelValue","onUpdate:modelValue","onClick"])])):((0,a.uX)(),(0,a.CE)("td",f,[(0,a.bF)(Z,{flat:"",dense:"",round:"",onClick:s[6]||(s[6]=(0,r.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,a.k6)((()=>[(0,a.bF)(H,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,a.k6)((()=>[(0,a.bF)(M,{dense:"",style:{"min-width":"100px"}},{default:(0,a.k6)((()=>[(0,a.bF)(j,{clickable:"",onClick:s=>e.openForm(t)},{default:(0,a.k6)((()=>[(0,a.bF)(O,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t("edit")),1)])),_:1})])),_:2},1032,["onClick"]),(0,a.bF)(B,{inset:""}),(0,a.bF)(j,{clickable:""},{default:(0,a.k6)((()=>[(0,a.bF)(O,{onClick:s=>{e.userId=t["id"],e.confirmDelete=!0}},{default:(0,a.k6)((()=>[(0,a.Lk)("span",y,(0,o.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)]))],64)))),128))],8,g)))),128)),e.usersList?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("tr",k,[e.spinner?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("td",v,(0,o.v_)(e.$t("pages.messages.no_record_found")),1))]))])])),_:1})])]),(0,a.bF)(J),(0,a.bF)(re,{modelValue:e.userDialog,"onUpdate:modelValue":s[15]||(s[15]=s=>e.userDialog=s)},{default:(0,a.k6)((()=>[(0,a.bF)(ae,{style:{width:"600px","max-width":"60vw"}},{default:(0,a.k6)((()=>[(0,a.bF)(Y,{class:"bg-primary"},{default:(0,a.k6)((()=>[(0,a.bF)(W,{class:"text-white"},{default:(0,a.k6)((()=>[this.userId&&""!=this.userId?((0,a.uX)(),(0,a.CE)("span",E,(0,o.v_)(e.$t("pages.user.edit_user")),1)):((0,a.uX)(),(0,a.CE)("span",F,(0,o.v_)(e.$t("pages.user.add_user")),1))])),_:1}),(0,a.bo)((0,a.bF)(K,{icon:"close"},null,512),[[le]])])),_:1}),(0,a.bF)(te,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",C,[(0,a.Lk)("div",$,[L,(0,a.bF)(se,{onSubmit:e.onSubmit,onReset:e.onReset},{default:(0,a.k6)((()=>[(0,a.Lk)("div",A,[(0,a.bF)(Q,{dense:"",outlined:"",modelValue:e.firstName,"onUpdate:modelValue":s[7]||(s[7]=s=>e.firstName=s),label:e.$t("pages.user.firstName"),style:{width:"450px"}},null,8,["modelValue","label"])]),(0,a.Lk)("div",D,[(0,a.bF)(Q,{dense:"",outlined:"",modelValue:e.lastName,"onUpdate:modelValue":s[8]||(s[8]=s=>e.lastName=s),label:e.lastNameError||e.$t("pages.user.lastName"),style:{width:"450px"},error:!!e.lastNameError},null,8,["modelValue","label","error"])]),(0,a.Lk)("div",U,[(0,a.bF)(Q,{dense:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":s[9]||(s[9]=s=>e.email=s),label:e.emailError||e.$t("pages.user.email"),style:{width:"450px"},error:!!e.emailError},null,8,["modelValue","label","error"])]),(0,a.bF)(Q,{dense:"",type:!1===e.show_password?"password":"text",outlined:"",modelValue:e.password,"onUpdate:modelValue":[s[11]||(s[11]=s=>e.password=s),e.validatePassword],label:e.passwordError||e.$t("pages.user.password"),id:"password",style:{width:"450px"},error:!!e.passwordError},{append:(0,a.k6)((()=>[(0,a.bF)(ee,{name:!1===e.show_password?"visibility":"visibility_off",onClick:s[10]||(s[10]=s=>e.show_password=!e.show_password)},null,8,["name"])])),_:1},8,["type","modelValue","label","error","onUpdate:modelValue"]),(0,a.Lk)("div",V,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.passwordRules,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"password-rule"},[(0,a.bF)(ee,{name:e.met?"check_circle":"cancel",color:e.met?"green":"red",style:{"margin-right":"5px"}},null,8,["name","color"]),(0,a.Lk)("span",{style:(0,o.Tr)([{color:e.met?"green":"grey"},{"font-size":"14px"}])},(0,o.v_)(e.message),5)])))),128))]),(0,a.Lk)("div",S,[(0,a.bF)(Q,{dense:"",type:!1===e.show_confirm_password?"password":"text",outlined:"",modelValue:e.confirmPassword,"onUpdate:modelValue":s[13]||(s[13]=s=>e.confirmPassword=s),label:e.confirmPasswordError||e.$t("pages.user.confirmPassword"),style:{width:"450px"},error:!!e.confirmPasswordError},{append:(0,a.k6)((()=>[(0,a.bF)(ee,{name:!1===e.show_confirm_password?"visibility":"visibility_off",onClick:s[12]||(s[12]=s=>e.show_confirm_password=!e.show_confirm_password)},null,8,["name"])])),_:1},8,["type","modelValue","label","error"])]),(0,a.Lk)("div",x,[(0,a.bF)(z,{modelValue:e.role,"onUpdate:modelValue":s[14]||(s[14]=s=>e.role=s),label:e.$t("pages.user.is_admin")},null,8,["modelValue","label"])]),(0,a.Lk)("div",N,[(0,a.bo)((0,a.bF)(K,{label:e.$t("pages.user.cancel"),appearance:"cancel"},null,8,["label"]),[[le]]),(0,a.bF)(K,{label:e.$t("pages.user.save"),class:"q-ml-sm",type:"submit"},null,8,["label"])])])),_:1},8,["onSubmit","onReset"])])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(re,{modelValue:e.confirmDelete,"onUpdate:modelValue":s[17]||(s[17]=s=>e.confirmDelete=s),persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(ae,null,{default:(0,a.k6)((()=>[(0,a.bF)(te,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,a.k6)((()=>[(0,a.bF)(oe,{icon:"warning",color:"primary"})])),_:1}),(0,a.bF)(te,{class:"row items-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("span",P,(0,o.v_)(e.$t("pages.messages.msg_delete")),1)])),_:1}),(0,a.bF)(ie,{align:"right"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(K,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[le]]),(0,a.bo)((0,a.bF)(K,{appearance:"negative",label:e.$t("delete"),onClick:s[16]||(s[16]=s=>e.deleteUser())},null,8,["label"]),[[le]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var q=t(82303),R=t(1659),I=t(23537),Q=t(24622),K=t(92162),X=t(38734),z=t(83319),O=t(96056),j=t(11470),B=t(89156),M=t(45022),H=t(18505),Z=t(64775),G=t(68450),J=t(10739),W=t(46162),Y=t(84364),ee=t(77362),se=t(25773),te=t(85487),ae=function(e,s,t,a){function r(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,o){function i(e){try{n(a.next(e))}catch(s){o(s)}}function l(e){try{n(a["throw"](e))}catch(s){o(s)}}function n(e){e.done?t(e.value):r(e.value).then(i,l)}n((a=a.apply(e,s||[])).next())}))};const re=(0,a.pM)({el:"#app",mixins:[H.A,Q.A,O.A,J.A],data(){return{emailError:"",passwordError:"",confirmPasswordError:"",lastNameError:"",userDialog:(0,X.KR)(!1),passwordRules:(0,X.KR)([])}},components:{ColumnOrderBy:Y.A,Loader:B.A,SubHeader:ee.A,BackToSettings:se.A},mounted(){this.init(),document.addEventListener("users_table-column-drop",this.onDropColumns),document.addEventListener("apply_filters",this.applyFilterEvent)},unmounted(){document.removeEventListener("apply_filters",this.applyFilterEvent),document.removeEventListener("users_table-column-drop",this.onDropColumns)},methods:{init(){this.getUsers(!0),this.prepareColumns(),this.initDragDropColumns("users_table","label",["actions"]),this.preparePasswordRules()},isAdminToggle(e,s){return ae(this,void 0,void 0,(function*(){let t=new FormData;t.append("is_organisation_admin",s?"1":"0"),t.append("org_id",(0,te.I)());try{this.showLoading();let s=yield(0,W.L3)(),a=yield q.A.put(W.FH.update_user+e,t,{headers:{Authorization:s}});if(a.data.message)return a.data.error_code?this.emailError=this.$t("pages.messages."+a.data.error_code):this.emailError=a.data.message,this.showErrorToast(this.emailError),yield this.getUsers(!1),void this.hideLoading();yield this.getUsers(!1),this.hideLoading(),this.showSuccessToast(this.$t("pages.messages.user_updated"))}catch(a){return this.showErrorToast(this.$t("pages.messages.error_internal_occur")),this.hideLoading(),void logError(a)}}))},getUsers(e){return ae(this,void 0,void 0,(function*(){e&&this.showLoading();try{let e="";for(let[s,t]of Object.entries(this.filter))t&&(e&&(e+="&"),e+=s+"="+t);this.allUsers=[],yield this.getAllUsers(e),this.usersList=this.allUsers,e&&(this.allUsers=[])}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(s)}finally{e&&this.hideLoading()}}))},isValidPassword(e){if(!e||0===e.trim().length)return!1;const s=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^a-zA-Z\d\s]).{8,20}$/;return s.test(e)},validatePassword(){this.passwordRules.forEach((e=>{e.met=e.test(this.password)}))},onSubmit(){this.lastNameError="",this.emailError="",this.passwordError="",this.confirmPasswordError="";let e=this.validateEmail(this.email);e||(this.emailError=this.$t("pages.messages.invalid_email")),this.lastName&&""!=this.lastName||(this.lastNameError=this.$t("pages.messages.user_name_mandatory")),this.isValid(this.userId),this.emailError||this.lastNameError||this.passwordError||this.confirmPasswordError||this.addEditUser()},isValid(e){e||(this.password&&""!=this.password||(this.passwordError=this.$t("pages.messages.password_mandatory")),this.confirmPassword&&""!=this.confirmPassword||(this.confirmPasswordError=this.$t("pages.messages.confirm_password_mandatory"))),this.password&&""!=this.password||this.isValidPassword(this.password)?this.confirmPassword&&!this.isValidPassword(this.confirmPassword)&&(this.confirmPasswordError=this.$t("pages.messages.confirm_password_is_invalid")):this.passwordError=this.$t("pages.messages.password_is_invalid"),this.password!==this.confirmPassword&&(this.confirmPasswordError=this.$t("pages.messages.password_not_match"))},addEditUser(){return ae(this,void 0,void 0,(function*(){const e={};e["first_name"]=this.firstName,e["last_name"]=this.lastName,e["email"]=this.email,e["password"]=this.password,e["org_id"]=(0,te.I)();let s=new FormData;for(let a in e)(0,G.z)(e[a])&&(e[a]=""),s.append(a,e[a]);this.showLoading();try{if(this.userId){s.append("is_organisation_admin",this.role.toString());const e=yield j.jD.editUser(this.userId,s);if(!1===e.success&&e.error_code)return void this.showErrorToast(e.message);this.showSuccessToast(this.$t("pages.messages.user_updated"))}else{s.append("is_admin",this.role.toString());const e=yield j.jD.addUser(s);if(!1===e.success&&e.error_code)return void this.showErrorToast(e.message);this.showSuccessToast(this.$t("pages.messages.user_successfully_created"))}yield this.getUsers(!1)}catch(t){const e=Z.t.getErrorMessage(t);this.showErrorToast(e),logError(t)}finally{this.userDialog=!1,this.hideLoading()}}))},openForm(e){e?(this.userId=e.id,this.email=e.email,this.lastName=e.last_name,this.firstName=e.first_name,this.role=e.is_organisation_admin):(this.role=!1,this.email="",this.userId="",this.lastName="",this.firstName=""),this.password="",this.confirmPassword="",this.emailError="",this.lastNameError="",this.passwordError="",this.confirmPasswordError="",this.userDialog=!0},onReset(){this.role=!1,this.email="",this.userId="",this.lastName="",this.password="",this.firstName="",this.emailError="",this.lastNameError="",this.passwordError="",this.confirmPasswordError="",this.removeClass((0,K.$)("#email").querySelector("label"),"error-border-left"),this.removeClass((0,K.$)("#last_name").querySelector("label"),"error-border-left"),this.removeClass((0,K.$)("#confirm_password").querySelector("label"),"error-border-left")},deleteUser(){return ae(this,void 0,void 0,(function*(){try{let e;this.showLoading();let s=yield(0,W.L3)();e=yield q.A.delete((0,te.MV)(W.FH.delete_user+this.userId),{headers:{Authorization:s}}),e.data&&!e.data.hasOwnProperty("success")&&e.data.hasOwnProperty("message")&&this.showErrorToast(e.data.message),e.data&&e.data.hasOwnProperty("success")&&!0===e.data.success&&(this.userId=null,yield this.getUsers(!1),this.showSuccessToast(this.$t("pages.messages.user_deleted")))}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.confirmDelete=!1,this.hideLoading()}}))},updateSearch(e){this.filter.keyword=e,this.getUsers(!0)},applyFilterEvent(e){this.filter={keyword:"",sort_by:e.detail.orderBy["field_name"],order:e.detail.orderBy["direction"]},this.getUsers(!0)},prepareColumns(){const e=M.A.getItem("USERS_SETTING_COLUMNS");e&&(this.columns=JSON.parse(e))},onDropColumns(){M.A.set("USERS_SETTING_COLUMNS",JSON.stringify(this.columns))},preparePasswordRules(){return ae(this,void 0,void 0,(function*(){yield this.$nextTick(),this.passwordRules=[{message:this.$t("pages.messages.password_length"),test:e=>e.length>=8,met:!1},{message:this.$t("pages.messages.password_lowercase"),test:e=>/[a-z]/.test(e),met:!1},{message:this.$t("pages.messages.password_uppercase"),test:e=>/[A-Z]/.test(e),met:!1},{message:this.$t("pages.messages.password_number"),test:e=>/\d/.test(e),met:!1},{message:this.$t("pages.messages.password_special_char"),test:e=>/[^a-zA-Z\d\s]/.test(e),met:!1}]}))}},setup(){const e=(0,z.kH)(),{getAllUsers:s}=e,{allUsers:t}=(0,R.bP)(e),{t:a}=(0,I.s9)(),r=[{name:"name",label:"name",action:!0},{name:"email",label:"pages.user.email",action:!0},{name:"is_organisation_admin",label:"pages.user.is_admin",action:!0},{name:"actions",label:"actions",action:!1,class:"text-center"}];return{icon:(0,X.KR)(!1),role:(0,X.KR)(!1),email:(0,X.KR)(),columns:r,show_confirm_password:(0,X.KR)(!1),show_password:(0,X.KR)(!1),userId:(0,X.KR)(),firstName:(0,X.KR)(),lastName:(0,X.KR)(),password:(0,X.KR)(),confirmPassword:(0,X.KR)(),confirmDelete:(0,X.KR)(!1),filter:(0,X.KR)({keyword:""}),getAllUsers:s,allUsers:t,usersList:(0,X.KR)([])}}});var oe=t(12807),ie=t(67837),le=t(857),ne=t(80460),de=t(56384),me=t(84436),ce=t(53999),ue=t(90124),he=t(25173),pe=t(10386),ge=t(82156),_e=t(23316),we=t(36914),be=t(39150),fe=t(44189),ye=t(49200),ke=t(50492),ve=t(3952),Ee=t(62669),Fe=t(42315),Ce=t(88672),$e=t(98582),Le=t.n($e);const Ae=(0,oe.A)(re,[["render",T],["__scopeId","data-v-2d056084"]]),De=Ae;Le()(re,"components",{QInput:ie.A,QMarkupTable:le.A,QCheckbox:ne.A,QBtn:de.A,QMenu:me.A,QList:ce.A,QItem:ue.A,QItemSection:he.A,QSeparator:pe.A,QDialog:ge.A,QCard:_e.A,QToolbar:we.A,QToolbarTitle:be.A,QCardSection:fe.A,QForm:ye.A,QIcon:ke.A,QAvatar:ve.A,QCardActions:Ee.A,QTable:Fe.A}),Le()(re,"directives",{ClosePopup:Ce.A})}}]);