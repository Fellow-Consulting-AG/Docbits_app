"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[6570],{16570:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ye});var l=a(59835);const s={class:"container p-b-0 q-pb-sm settings p-t-10"};function i(e,t,a,i,o,n){const d=(0,l.up)("SubHeader"),r=(0,l.up)("BackToSettings"),u=(0,l.up)("ListCustomColumn");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(d,{name:"doc_type_custom_columns",label:e.$t("custom_columns"),display_help_link:!1},null,8,["label"]),(0,l.Wm)(r,{back_to_rotue:"/settings/document"}),(0,l._)("div",s,[(0,l.Wm)(u)])],64)}var o=a(86970),n=a(61957);const d={class:"row q-mb-sm q-pa-sm warning-holder text-weight-bold text-red font-size-medium full-width"},r={style:{width:"100%"}},u={key:0,class:"row q-mb-sm q-pa-sm error-holder full-width"},m={style:{width:"100%"}},c={class:"row full-width q-mb-sm q-mt-md"},_={class:"text-red"},h={class:"text-red",style:{filter:"opacity(50%)",cursor:"not-allowed"}},p={class:"row"},w={class:"active-toggle custom-col-toggle"},g=["onUpdate:modelValue"],b=(0,l._)("div",{class:"slider"},null,-1),f=(0,l._)("img",{class:"img-fluid",width:"24",height:"26",src:"Trash-Block.svg",alt:""},null,-1),y=(0,l._)("img",{class:"img-fluid",width:"24",height:"26",src:"trash-bin-default.svg",alt:""},null,-1);function C(e,t,a,s,i,C){const v=(0,l.up)("q-icon"),k=(0,l.up)("q-input"),T=(0,l.up)("q-space"),R=(0,l.up)("f-btn"),q=(0,l.up)("q-item-section"),D=(0,l.up)("q-item"),V=(0,l.up)("q-separator"),Z=(0,l.up)("q-list"),U=(0,l.up)("q-menu"),W=(0,l.up)("q-btn"),O=(0,l.up)("q-tooltip"),x=(0,l.up)("q-td"),E=(0,l.up)("q-popup-edit"),$=(0,l.up)("q-tr"),j=(0,l.up)("q-table"),L=(0,l.up)("CreateCustomColumn"),N=(0,l.up)("q-dialog"),Q=(0,l.up)("CreateTable");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[(0,l._)("span",r,(0,o.zw)(e.$t("custom_column_change_warning")),1)]),e.no_table_warning?((0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("span",m,(0,o.zw)(e.$t("no_table_exists")),1)])):(0,l.kq)("",!0),(0,l._)("div",c,[(0,l.Wm)(k,{style:{width:"300px"},dense:"",outlined:"",debounce:"300",color:"primary",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t)},{append:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"search"})])),_:1},8,["modelValue"]),(0,l.Wm)(T),(0,l.Wm)(R,{class:"q-mr-sm",label:e.$t("create_new_table"),onClick:t[1]||(t[1]=t=>e.displayCreateTableDialog=!0)},null,8,["label"]),(0,l.Wm)(R,{label:e.$t("add_new_table_column"),onClick:t[2]||(t[2]=t=>e.addColumnDialog=!0)},null,8,["label"])]),(0,l.Wm)(j,{class:"dashboard-table-style back-white","no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),style:(0,o.j5)({height:e.table_height+"vh"}),rows:e.rows,columns:e.columns,"rows-per-page-options":[0],flat:"","row-key":"id","table-header-class":"table-header-text",filter:e.filter,loading:e.loading},{body:(0,l.w5)((a=>[(0,l.Wm)($,{props:a,id:a.key},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.cols,(s=>((0,l.wg)(),(0,l.iD)(l.HY,{key:s.name},["action"===s.name?((0,l.wg)(),(0,l.j4)(x,{key:0,style:{width:"145px"}},{default:(0,l.w5)((()=>[""!==a.row.id?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Wm)(W,{flat:"",dense:"",round:"",onClick:t[3]||(t[3]=(0,n.iM)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{persistent:"","auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{dense:"",style:{"min-width":"100px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{clickable:""},{default:(0,l.w5)((()=>[a.row.is_active?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(q,{key:0,onClick:t=>{e.handleVisibility(!0,a.row).then((()=>{a.row.is_active=!0}))}},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("activate")),1)])),_:2},1032,["onClick"])),a.row.is_active?((0,l.wg)(),(0,l.j4)(q,{key:1,onClick:t=>{e.handleVisibility(!1,a.row).then((()=>{a.row.is_active=!1}))}},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("deactivate")),1)])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:2},1024),(0,l.Wm)(V,{inset:""}),(0,l.Wm)(D,{clickable:"DEFAULT"!=a.row.org_id},{default:(0,l.w5)((()=>["DEFAULT"!=a.row.org_id?((0,l.wg)(),(0,l.j4)(q,{key:0,onClick:t=>e.handleDelete(a.row)},{default:(0,l.w5)((()=>[(0,l._)("span",_,(0,o.zw)(e.$t("delete")),1)])),_:2},1032,["onClick"])):(0,l.kq)("",!0),"DEFAULT"==a.row.org_id?((0,l.wg)(),(0,l.j4)(q,{key:1},{default:(0,l.w5)((()=>[(0,l._)("span",h,(0,o.zw)(e.$t("delete")),1)])),_:1})):(0,l.kq)("",!0)])),_:2},1032,["clickable"])])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,l._)("span",p,[(0,l._)("label",w,[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":[e=>a.row.is_active=e,t=>{e.handleVisibility(t,a.row)}]},null,8,g),[[n.e8,a.row.is_active]]),b]),"DEFAULT"==a.row.org_id?((0,l.wg)(),(0,l.j4)(W,{key:0,"no-caps":"",flat:"",dense:"",style:{cursor:"default","margin-top":"4px",height:"35px"}},{default:(0,l.w5)((()=>[f,(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("default_column_block_delete")),1)])),_:1})])),_:1})):((0,l.wg)(),(0,l.j4)(W,{key:1,disable:a.row.processing_delete,"no-caps":"",flat:"",dense:"",style:{cursor:"default","margin-top":"4px",height:"35px"},onClick:t=>e.handleDelete(a.row)},{default:(0,l.w5)((()=>[y])),_:2},1032,["disable","onClick"]))])],64)):(0,l.kq)("",!0)])),_:2},1024)):"column_name"===s.name?((0,l.wg)(),(0,l.j4)(x,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{borderless:"",tabindex:"0","data-id":a.key,modelValue:a.row.column_name,"onUpdate:modelValue":e=>a.row.column_name=e,readonly:""!==a.row.id},null,8,["data-id","modelValue","onUpdate:modelValue","readonly"])])),_:2},1024)):"title"===s.name?((0,l.wg)(),(0,l.j4)(x,{key:2},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.row.title)+" ",1),(0,l.Wm)(E,{modelValue:a.row.title,"onUpdate:modelValue":e=>a.row.title=e,title:"Update title"},{default:(0,l.w5)((t=>[(0,l.Wm)(k,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,dense:"",autofocus:"",onKeyup:(0,n.D2)(t.set,["enter"]),onKeydown:(0,n.D2)((l=>e.updateColumnTitle(a.row.id,t.value)),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup","onKeydown"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)):"column_type"===s.name?((0,l.wg)(),(0,l.j4)(x,{key:3},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{borderless:"",tabindex:"0","data-id":a.key,modelValue:a.row.column_type,"onUpdate:modelValue":e=>a.row.column_type=e,readonly:""!==a.row.id},null,8,["data-id","modelValue","onUpdate:modelValue","readonly"])])),_:2},1024)):"table_name"===s.name?((0,l.wg)(),(0,l.j4)(x,{key:4},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{borderless:"",tabindex:"0","data-id":a.key,modelValue:a.row.table_name,"onUpdate:modelValue":e=>a.row.table_name=e,readonly:""!==a.row.id},null,8,["data-id","modelValue","onUpdate:modelValue","readonly"])])),_:2},1024)):(0,l.kq)("",!0)],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["no-data-label","style","rows","columns","filter","loading"]),(0,l.Wm)(N,{modelValue:e.addColumnDialog,"onUpdate:modelValue":t[4]||(t[4]=t=>e.addColumnDialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[5]||(t[5]=(0,n.D2)((t=>e.addColumnDialog=!1),["esc"]))},{default:(0,l.w5)((()=>[(0,l.Wm)(L,{is_table_training_doc:!1,table_name:"",tables_list:e.tables_list,tables:"[]",columns_list:e.columns_list,addColumnDialog:e.addColumnDialog,parent_view:"columns_list",table_list_loading:e.table_list_loading},null,8,["tables_list","columns_list","addColumnDialog","table_list_loading"])])),_:1},8,["modelValue"]),(0,l.Wm)(N,{modelValue:e.displayCreateTableDialog,"onUpdate:modelValue":t[6]||(t[6]=t=>e.displayCreateTableDialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[7]||(t[7]=(0,n.D2)((t=>e.displayCreateTableDialog=!1),["esc"]))},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,{doc_type:e.doc_type},null,8,["doc_type"])])),_:1},8,["modelValue"])],64)}var v=a(39981),k=a.n(v),T=a(49990),R=a(60499),q=a(70501),D=a(49341),V=a(37744),Z=a(45223);const U={class:"text-weight-bold"},W={style:{"margin-bottom":"20px"},class:"row full-width mb-10 mt-8"},O={class:"full-width"},x=(0,l._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function E(e,t,a,s,i,d){const r=(0,l.up)("q-toolbar-title"),u=(0,l.up)("q-btn"),m=(0,l.up)("q-toolbar"),c=(0,l.up)("q-input"),_=(0,l.up)("q-card-section"),h=(0,l.up)("q-card-actions"),p=(0,l.up)("q-inner-loading"),w=(0,l.up)("q-card"),g=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(w,{style:{width:"600px"}},{default:(0,l.w5)((()=>[(0,l._)("form",{onSubmit:t[1]||(t[1]=(0,n.iM)(((...t)=>e.submitNewColumFrom&&e.submitNewColumFrom(...t)),["prevent","stop"]))},[(0,l.Wm)(m,{class:"secondary-toolbar"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("span",U,(0,o.zw)(e.$t("create_new_table")),1)])),_:1}),(0,l.wy)((0,l.Wm)(u,{flat:"",round:"",dense:"",icon:"close"},null,512),[[g]])])),_:1}),(0,l.Wm)(_,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l._)("div",W,[(0,l._)("div",O,[(0,l.Wm)(c,{outlined:"",tabindex:"0",class:(0,o.C_)("full-width "),modelValue:e.new_model["table_name"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.new_model["table_name"]=t),label:e.$t("table_name"),hint:e.message,"error-message":e.new_model["name_error_msg"],error:e.new_model["name_error"]},null,8,["modelValue","label","hint","error-message","error"])])])])),_:1}),(0,l.Wm)(h,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(u,{class:"highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[g]]),(0,l.Wm)(u,{type:"submit",color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,l.Wm)(p,{showing:e.loading},{default:(0,l.w5)((()=>[x])),_:1},8,["showing"])])),_:1})}var $=a(79860),j=a(96427),L=function(e,t,a,l){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,i){function o(e){try{d(l.next(e))}catch(t){i(t)}}function n(e){try{d(l["throw"](e))}catch(t){i(t)}}function d(e){e.done?a(e.value):s(e.value).then(o,n)}d((l=l.apply(e,t||[])).next())}))};const N=(0,l.aZ)({el:"#app",mixins:[T.Z],props:{doc_type:{type:String,default:""}},components:{},data(){return{message:$.i18n.t("field_only_characters")}},setup(){let e={};return{new_model:(0,R.iH)(e),token:(0,R.iH)(""),loading:(0,R.iH)(!1)}},watch:{},mounted(){this.setNewModel()},methods:{setNewModel(){this.new_model["table_name"]="",this.new_model["name_error"]=!1,this.new_model["name_error_msg"]=""},submitNewColumFrom(){return L(this,void 0,void 0,(function*(){try{if(!this.validateRow(this.new_model))return;this.loading=!0,yield this.saveNewRow()}catch(e){return null!=e&&"object"==typeof e&&e.hasOwnProperty("message")?void this.showErrorToast(e.message):void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},saveNewRow(){return L(this,void 0,void 0,(function*(){let e;const t={table_name:this.new_model["table_name"],doc_type_name:this.doc_type,is_default:!1};if(e=yield D.Um.createTable(t),e.data&&e.data.hasOwnProperty("success")&&!1===e.data.success)throw{message:e.data.message};const a=new CustomEvent("new_table_created",{detail:{data:e.data}});document.dispatchEvent(a),this.showSuccessToast("Table Created successfully"),this.setNewModel()}))},validateRow(e){let t=!0;return this.new_model["name_error"]=!1,this.new_model["name_error_msg"]="",e["table_name"]&&0!=e["table_name"].length?(0,j.ij)(e["table_name"])?t:(this.new_model["name_error_msg"]="Field Name can only contain characters, numbers, hyphen and underscore",this.new_model["name_error"]=!0,!1):(this.new_model["name_error_msg"]="Table Name is required",this.new_model["name_error"]=!0,!1)}}});var Q=a(7683),H=a(44458),S=a(51663),I=a(81973),z=a(68879),A=a(63190),F=a(13119),P=a(11821),K=a(60854),M=a(62146),B=a(69984),Y=a.n(B);const G=(0,Q.Z)(N,[["render",E]]),J=G;Y()(N,"components",{QCard:H.Z,QToolbar:S.Z,QToolbarTitle:I.Z,QBtn:z.Z,QCardSection:A.Z,QInput:F.Z,QCardActions:P.Z,QInnerLoading:K.Z}),Y()(N,"directives",{ClosePopup:M.Z});var X=function(e,t,a,l){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,i){function o(e){try{d(l.next(e))}catch(t){i(t)}}function n(e){try{d(l["throw"](e))}catch(t){i(t)}}function d(e){e.done?a(e.value):s(e.value).then(o,n)}d((l=l.apply(e,t||[])).next())}))};const ee=(0,l.aZ)({mixins:[q.Z,T.Z],components:{CreateCustomColumn:Z.Z,CreateTable:J},props:{table_height:{type:String,default:"55"}},data(){return{selectedTitle:(0,R.iH)("")}},mounted:function(){this.prepareColumns(),this.getTableName(),this.fetchColumns(),document.addEventListener("custom_column_create",this.customColumnCreated),document.addEventListener("new_table_created",this.newTableCreated)},unmounted:function(){document.removeEventListener("custom_column_create",this.customColumnCreated),document.removeEventListener("new_table_created",this.newTableCreated)},methods:{prepareColumns(){this.columns.push(Object.assign({},{name:"column_name",label:this.$t("column_name"),field:"column_name",align:"left"})),this.columns.push(Object.assign({},{name:"title",label:this.$t("title"),field:"title",align:"left"})),this.columns.push(Object.assign({},{name:"column_type",label:this.$t("column_type"),field:"column_type",align:"left"})),this.columns.push(Object.assign({},{name:"table_name",label:this.$t("table_name"),field:"table_name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},getTableName(){return this.doc_type=String(this.$route.params.type),String(this.doc_type)},fetchColumns(){return X(this,void 0,void 0,(function*(){try{this.loading=!0;const e=yield D.Um.getTableColumns(this.getTableName());if(e.data&&e.data.hasOwnProperty("success")&&!1===e.success)throw{message:e.data.message};let t=[];for(let[a,l]of Object.entries(e.data)){const e=l;for(let[l,s]of Object.entries(e)){const e=s;let l=Object.assign({},e);l["table_name"]=a,t.push(l)}}this.prepareRows(t)}catch(e){throw{message:this.$t("pages.messages.ERROR_INTERNAL_OCCUR")}}finally{this.hideLoading(),this.loading=!1}}))},prepareRows(e){this.rows=[],this.columns_list={};for(let[t,a]of Object.entries(e)){const e=a;this.addNewRow(e),e&&e.hasOwnProperty("column_name")&&this.addToColumnList(e.column_name)}this.prepareTableList()},addNewRow(e){let t=Object.assign({},e);return t["name"]=e.column_name,t["label"]=this.getLabelToDisplay(e),t["processing_visibility"]=!1,t["processing_delete"]=!1,t["is_hidden"]=!!t.is_hidden,t["is_active"]=!t["is_hidden"],this.rows.push(t),t},getLabelToDisplay(e){let t=e.title;return this.$t("pages.line_items_columns."+e.translation_key)!=="pages.line_items_columns."+e.translation_key&&(t=this.$t("pages.line_items_columns."+e.translation_key)),t},getRow(e){const t=this.rows.findIndex((t=>t.id==e));return t},updateColumnTitle(e,t){return X(this,void 0,void 0,(function*(){if(this.selectedTitle!==t){this.selectedTitle="";try{this.loading=!0;let a=new FormData;return a.append("title",t),yield this.updateRow(e,a),!0}catch(a){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}else this.selectedTitle=""}))},handleDelete(e){return X(this,void 0,void 0,(function*(){const t=this.getRow(e.id);try{this.rows[t].processing_delete=!0,this.loading=!0;let a=new FormData;a.append("is_deleted",!0===e.is_deleted?"false":"true"),yield this.updateRow(e.id,a),this.rows.splice(t,1)}catch(a){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.rows[t].processing_delete=!1,this.loading=!1}}))},handleVisibility(e,t){return X(this,void 0,void 0,(function*(){const a=this.getRow(t.id);try{const l=!e;this.rows[a].processing_visibility=!0,this.loading=!0;let s=new FormData;s.append("is_hidden",!1===l?"false":"true"),yield this.updateRow(t.id,s),this.rows[a].is_hidden=l}catch(l){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.rows[a].processing_visibility=!1,this.loading=!1}}))},updateRow(e,t){return X(this,void 0,void 0,(function*(){let a,l=yield(0,V.O_)();if(a=yield k().post(V.hi.update_document_table_column,t,{params:{id:e},headers:{Authorization:l}}),!a.data.success||!0!==a.data.success)throw a.data.message?a.data.message:{message:"Response dont have table_data index/success is set to false"}}))},addToColumnList(e){this.columns_list[e]=e},newTableCreated(){this.displayCreateTableDialog=!1,this.prepareTableList()},prepareTableList(){return X(this,void 0,void 0,(function*(){let e;this.tables_list=[],this.tables_list.push(Object.assign({},{value:"",label:this.$t("select_table")}));try{if(this.loading=!0,this.no_table_warning=!1,this.table_list_loading=!0,this.showLoading(),e=yield D.Um.getTable(this.doc_type),e.data&&e.data.hasOwnProperty("success")&&!1===e.success)throw{message:e.data.message};if(e.data&&0===e.data.length)return void(this.no_table_warning=!0);e.data.forEach((e=>{this.tables_list.push(Object.assign({},{value:e.table_name,label:e.table_name}))}))}catch(t){throw{message:this.$t("pages.messages.ERROR_INTERNAL_OCCUR")}}finally{this.hideLoading(),this.loading=!1,this.table_list_loading=!1}}))},customColumnCreated(e){e&&e.detail&&(this.addColumnDialog=!1,this.fetchColumns())}},setup(){const e=(0,R.iH)("");let t=[],a={};const l=(0,R.iH)(t);return{columns:l,filter:e,rows:(0,R.iH)(t),loading:(0,R.iH)(!1),addColumnDialog:(0,R.iH)(!1),columns_list:(0,R.iH)(a),tables_list:(0,R.iH)([]),doc_type:(0,R.iH)(""),displayCreateTableDialog:(0,R.iH)(!1),no_table_warning:(0,R.iH)(!1),table_list_loading:(0,R.iH)(!1)}}});var te=a(22857),ae=a(90136),le=a(61450),se=a(31233),ie=a(67220),oe=a(56362),ne=a(13246),de=a(490),re=a(76749),ue=a(50926),me=a(46858),ce=a(85863),_e=a(32074);const he=(0,Q.Z)(ee,[["render",C]]),pe=he;Y()(ee,"components",{QInput:F.Z,QIcon:te.Z,QSpace:ae.Z,QTable:le.Z,QTr:se.Z,QTd:ie.Z,QBtn:z.Z,QMenu:oe.Z,QList:ne.Z,QItem:de.Z,QItemSection:re.Z,QSeparator:ue.Z,QTooltip:me.Z,QPopupEdit:ce.Z,QDialog:_e.Z});var we=a(17256),ge=a(16308);const be=(0,l.aZ)({el:"#app",mixins:[],components:{ListCustomColumn:pe,BackToSettings:we.Z,SubHeader:ge.Z},data(){return{}},setup(){return{}}}),fe=(0,Q.Z)(be,[["render",i]]),ye=fe}}]);