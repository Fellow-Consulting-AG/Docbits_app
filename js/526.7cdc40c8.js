"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[526],{90526:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Le});var i=a(59835),s=a(86970),n=a(61957);const o=e=>((0,i.dD)("data-v-6224a646"),e=e(),(0,i.Cn)(),e),l={class:"col-6"},r={class:"container"},c={class:"full-width"},d=o((()=>(0,i._)("img",{src:"fields-default.svg",class:"black_to_white",width:"24"},null,-1))),_=(0,i.Uk)(" Standard "),u={class:"active-toggle height-40"},g=["onUpdate:modelValue"],m=o((()=>(0,i._)("div",{class:"slider"},null,-1))),p=["onUpdate:modelValue"],h=o((()=>(0,i._)("div",{class:"slider"},null,-1))),y=(0,i.Uk)(" Extraction Type "),f=o((()=>(0,i._)("img",{class:"img-fluid mb-14",width:"28",height:"28",src:"Trash-Block.svg",alt:""},null,-1))),w=o((()=>(0,i._)("img",{class:"img-fluid mb-14 black_to_white",width:"28",height:"28",src:"trash-bin-default.svg",alt:""},null,-1))),v={class:"row"},x=["onClick"],T=["onClick"],b=["onClick"],D=["onClick"],k=["onClick"],L=["disable","onClick"],C=["onClick"],E={class:"q-ml-sm"};function S(e,t,a,o,S,O){const R=(0,i.up)("ModelTrainingCounter"),q=(0,i.up)("SubHeader"),A=(0,i.up)("f-btn"),U=(0,i.up)("BackToSettings"),M=(0,i.up)("q-item-section"),W=(0,i.up)("q-badge"),H=(0,i.up)("q-tooltip"),I=(0,i.up)("q-btn"),Z=(0,i.up)("q-item"),N=(0,i.up)("q-separator"),V=(0,i.up)("LayoutBuilderBtn"),$=(0,i.up)("ManageRegexes"),F=(0,i.up)("q-list"),B=(0,i.up)("q-avatar"),z=(0,i.up)("q-card-section"),Q=(0,i.up)("q-card-actions"),Y=(0,i.up)("q-card"),P=(0,i.up)("q-dialog"),j=(0,i.up)("Loader"),G=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(q,{name:"settings_document_types",label:e.$t("pages.settings.document_types")},{default:(0,i.w5)((()=>[(0,i._)("span",l,[(0,i.Wm)(R)])])),_:1},8,["label"]),(0,i.Wm)(U,null,{default:(0,i.w5)((()=>[(0,i.Wm)(A,{class:"float-right",icon:"add",to:"/settings/document-create",label:e.$t("new")},null,8,["label"])])),_:1}),(0,i._)("div",r,[(0,i._)("div",c,[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.apiData,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:a,class:"q-mb-md q-pa-md p-b-0 grey-border doc-type-list"},[(0,i.Wm)(Z,{class:"v-p-0"},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{avatar:""},{default:(0,i.w5)((()=>[d])),_:1}),(0,i.Wm)(M,{class:"text-weight-bold"},{default:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Uk)((0,s.zw)(t.label)+" ",1),"DEFAULT"===t.org_id?((0,i.wg)(),(0,i.j4)(W,{key:0,transparent:"",align:"middle",color:"orange"},{default:(0,i.w5)((()=>[_])),_:1})):(0,i.kq)("",!0)])])),_:2},1024),(0,i.Wm)(M,{avatar:""},{default:(0,i.w5)((()=>[(0,i._)("label",u,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":[e=>t.is_active=e,a=>{e.handleVisibilty(a,t)}]},null,8,g),[[n.e8,t.is_active]]),m])])),_:2},1024),(0,i.Wm)(M,{avatar:""},{default:(0,i.w5)((()=>[(0,i._)("label",{class:(0,s.C_)(["active-toggle height-40",t.extraction_type_model?"extraction-type-flex":"extraction-type-fix"])},[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":[e=>t.extraction_type_model=e,a=>{e.handleExtractionType(a,t)}]},null,8,p),[[n.e8,t.extraction_type_model]]),h,(0,i.Wm)(H,null,{default:(0,i.w5)((()=>[y])),_:1})],2)])),_:2},1024),(0,i.Wm)(M,{class:"no-padding-left-right",style:{"min-width":"38px"},avatar:""},{default:(0,i.w5)((()=>["DEFAULT"===t.org_id?((0,i.wg)(),(0,i.j4)(I,{key:0,flat:"",color:"black",class:"no-padding-left-right",style:{cursor:"default"}},{default:(0,i.w5)((()=>[f,(0,i.Wm)(H,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e.$t("pages.fields_settings.not_trash")),1)])),_:1})])),_:1})):((0,i.wg)(),(0,i.j4)(I,{key:1,flat:"",color:"primary",class:"no-padding-left-right",onClick:a=>{e.deleteConfirm=!0,e.deleting_row=t}},{default:(0,i.w5)((()=>[w])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1024),(0,i.Wm)(Z,{class:"v-p-0"},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{avatar:""},{default:(0,i.w5)((()=>[(0,i._)("div",v,[e.MODELS_LABELS_MODULE?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("span",{class:"action-link no-border",onClick:a=>e.manageSettings("/settings/classify-extract?doc_type="+t.document_key)},(0,s.zw)(e.$t("Labels")),9,x),(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""})],64)):(0,i.kq)("",!0),e.LAYOUT_BUILDER_MODULE?((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Wm)(V,{doc_type_key:t.document_key,extraction_type:t.extraction_type},null,8,["doc_type_key","extraction_type"]),(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""})],64)):(0,i.kq)("",!0),(0,i._)("span",{class:"action-link no-border",onClick:a=>e.manageSettings("/settings/sub_doc_type/"+t.document_key)},(0,s.zw)(e.$t("sub_doc_type")),9,T),(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""}),(0,i._)("span",{class:"action-link no-border",onClick:a=>e.manageSettings("/settings/custom_columns/"+t.document_name)},(0,s.zw)(e.$t("custom_columns")),9,b),(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""}),(0,i._)("span",{class:"action-link no-border",onClick:a=>e.manageSettings("/settings/fields/"+t.document_name)},(0,s.zw)(e.$t("fields")),9,D),(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""}),(0,i._)("span",{class:"action-link no-border",onClick:a=>e.manageSettings("/settings/model_training/"+t.document_name+"/"+t.document_key)},(0,s.zw)(e.$t("model_training")),9,k),(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""}),e.hasRegexData(t.document_name)?((0,i.wg)(),(0,i.iD)(i.HY,{key:2},[(0,i._)("span",{class:"action-link no-border",disable:e.doc_type_regexes[t.document_name]["regexes"]["loading_data"],onClick:a=>e.showRegexesListView(t.document_name)},(0,s.zw)(e.$t("Regex")),9,L),(0,i.Wm)($,{doctype:t.document_name,display:e.doc_type_regexes[t.document_name]["regexes"]["display_list"],list_data:e.doc_type_regexes[t.document_name]["regexes"]["data"],language_origin_list:e.language_origin_list,loading_new_data:e.doc_type_regexes[t.document_name]["regexes"]["loading_data"]},null,8,["doctype","display","list_data","language_origin_list","loading_new_data"])],64)):(0,i.kq)("",!0),e.DOC_SCRIPT_MODULE?((0,i.wg)(),(0,i.iD)(i.HY,{key:3},[(0,i.Wm)(N,{class:"q-ml-sm q-mr-sm bg-primary",vertical:"",inset:""}),(0,i._)("span",{class:"action-link no-border",onClick:a=>e.manageSettings("/settings/doc_scripts/"+t.document_name)},(0,s.zw)(e.$t("scripts")),9,C)],64)):(0,i.kq)("",!0)])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])]),(0,i.Wm)(P,{modelValue:e.deleteConfirm,"onUpdate:modelValue":t[1]||(t[1]=t=>e.deleteConfirm=t),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(z,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,i.w5)((()=>[(0,i.Wm)(B,{icon:"warning",color:"primary"})])),_:1}),(0,i.Wm)(z,{class:"row items-center"},{default:(0,i.w5)((()=>[(0,i._)("span",E,(0,s.zw)(e.$t("sure")),1)])),_:1}),(0,i.Wm)(Q,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(I,{flat:"",label:e.$t("cancel"),"data-cy":"cancel",color:"primary"},null,8,["label"]),[[G]]),(0,i.wy)((0,i.Wm)(I,{flat:"",label:e.$t("delete"),"data-cy":"delete-popup",color:"primary",onClick:t[0]||(t[0]=t=>e.deleteDocumentType(this.deleting_row))},null,8,["label"]),[[G]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.Wm)(j)],64)}var O=a(39981),R=a.n(O),q=a(7363),A=a(3833),U=a(49990),M=a(60499),W=a(31921),H=a(96427),I=a(70501),Z=a(15877),N=a(37744),V=a(60937),$=a(97766),F=a(16308),B=a(17256),z=a(79824),Q=a(46624);const Y=e=>((0,i.dD)("data-v-12976e3f"),e=e(),(0,i.Cn)(),e),P={class:"row"},j=Y((()=>(0,i._)("div",{class:"col-6 text-white text-uppercase title q-ml-auto text-right"},"Next Model Training update:",-1))),G=Y((()=>(0,i._)("div",{class:"col-4 secondary-c-text next_model_training_time",style:{width:"150px"}},null,-1))),J=[j,G];function X(e,t,a,s,n,o){return(0,i.wg)(),(0,i.iD)("div",P,J)}function K(e,t){var a=document.createElement("span");a.className="flip-clock__piece",a.innerHTML='<b class="flip-clock__card card"><b class="card__top"></b><b class="card__bottom"></b><b class="card__back"><b class="card__bottom"></b></b></b>',a.innerHTML+='<span class="flip-clock__dot">:</span>',this.el=a;var i=a.querySelector(".card__top"),s=a.querySelector(".card__bottom"),n=a.querySelector(".card__back"),o=a.querySelector(".card__back .card__bottom");this.update=function(e){e=("0"+e).slice(-2),e!==this.currentValue&&(this.currentValue>=0&&(n.setAttribute("data-value",this.currentValue),s.setAttribute("data-value",this.currentValue)),this.currentValue=e,i.innerText=this.currentValue,o.setAttribute("data-value",this.currentValue),this.el.classList.remove("flip"),this.el.offsetWidth,this.el.classList.add("flip"))},this.update(t)}function ee(e){var t=Date.parse(e)-Date.parse(new Date);return{Total:t,Hours:Math.floor(t/36e5%24),Minutes:Math.floor(t/1e3/60%60),Seconds:Math.floor(t/1e3%60)}}function te(){var e=new Date;return{Total:e,Hours:e.getHours()%12,Minutes:e.getMinutes(),Seconds:e.getSeconds()}}function ae(e,t){e=!!e&&new Date(Date.parse(e)),t=t||function(){};var a=e?ee:te;this.el=document.createElement("div"),this.el.className="flip-clock";var i,s,n={},o=a(e);for(i in o)o[i]<0&&(o[i]=0),"Total"!==i&&(n[i]=new K(i,o[i]),this.el.appendChild(n[i].el));var l=0;function r(){if(s=requestAnimationFrame(r),!(l++%10)){var o=a(e);if(o.Total<0){for(i in cancelAnimationFrame(s),n)n[i].update(0);t()}else for(i in n)n[i].update(o[i])}}setTimeout(r,500)}var ie=function(e,t,a,i){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function o(e){try{r(i.next(e))}catch(t){n(t)}}function l(e){try{r(i["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):s(e.value).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const se=(0,i.aZ)({el:"#app",props:{},watch:{next_model_training_time:{handler:function(e,t){this.setCounter()}}},mounted(){this.initView()},methods:{initView(){return ie(this,void 0,void 0,(function*(){this.next_model_training_time=yield this.getNextModelTrainingTime(),this.setCounter()}))},makeCounter(){let e=document.querySelector(".next_model_training_time");e.innerHTML="";var t=new Date(this.counter_dateTime),a=new ae(t);e.appendChild(a.el)},getDistance(){const e=(new Date).getTime(),t=this.counter_time-e;return t},setCounter(){try{if(!this.next_model_training_time)return;this.counter_dateTime=new Date(this.next_model_training_time),this.counter_time=this.counter_dateTime.getTime();const e=this.getDistance();e<0&&this.expired_tries++,this.makeCounter()}catch(e){}}},setup(){const e=(0,Q.VF)(),{getNextModelTrainingTime:t}=e,{loading_next_model_training_time:a,next_model_training_time:i}=(0,q.Jk)(e);return{getNextModelTrainingTime:t,loading_next_model_training_time:a,next_model_training_time:i,counter_value:(0,M.iH)(""),counter_time:(0,M.iH)(0),counter_dateTime:(0,M.iH)({}),counter_interval:(0,M.iH)(0),expired_tries:(0,M.iH)(0)}}});var ne=a(7683);const oe=(0,ne.Z)(se,[["render",X],["__scopeId","data-v-12976e3f"]]),le=oe;var re=function(e,t,a,i){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function o(e){try{r(i.next(e))}catch(t){n(t)}}function l(e){try{r(i["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):s(e.value).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const ce=(0,i.aZ)({el:"#app",mixins:[I.Z,U.Z,V.Z],components:{Loader:W.Z,SubHeader:F.Z,ManageRegexes:$.Z,LayoutBuilderBtn:z.Z,ModelTrainingCounter:le,BackToSettings:B.Z},watch:{loading_settings:{handler:function(e,t){0==e&&1==t&&this.setAutoAccountingSettings()}}},mounted(){this.getDocumentTypes(!0),this.getTemplatesForDocuments(),this.LAYOUT_BUILDER_MODULE=(0,Z.$8)("LAYOUT_BUILDER_MODULE_SETTING"),this.MODELS_LABELS_MODULE=(0,Z.$8)("MODELS_LABELS_MODULE_SETTING"),this.DOC_SCRIPT_MODULE=(0,Z.$8)("DOC_SCRIPT_MODULE_SETTING"),document.addEventListener("regexes_saved",this.newChangesSavedForRegexes)},unmounted:function(){document.removeEventListener("regexes_saved",this.newChangesSavedForRegexes)},methods:{getDocumentTypes(e){return re(this,void 0,void 0,(function*(){let t;try{e&&this.showLoading();let a=yield(0,N.O_)();if(t=yield R().get(N.hi.get_document_types,{headers:{Authorization:a}}),!1===t.data.success)throw{message:t.data.message};t.data&&t.data.data&&(this.doc_type_list=[],t.data.data.forEach(((e,t)=>{let a=this.displayFieldLabel(e);e["document_key"]&&(e["auto_accounting"]=!!e["auto_accounting"],e["label"]=a,e["extraction_type_model"]=this.setExtractionTypeModel(e),this.apiData[e["document_key"]]=e,this.doc_type_auto_accounting_setting[e["document_key"]+"_auto_accounting"]=!1),this.doc_type_list.push(Object.assign({},{value:e.document_key,label:a}))})),A.Z.set("doc_types",this.doc_type_list)),this.resetDocTypeRegexData()}catch(a){return void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{e&&this.hideLoading()}}))},setAutoAccountingSettings(){this.user_settings[this.setting_name]=!1;for(const[e,t]of Object.entries(this.doc_type_auto_accounting_setting))this.user_settings.hasOwnProperty(e)&&(this.doc_type_auto_accounting_setting[e]=this.user_settings[e])},setExtractionTypeModel(e){return"FIX_COORDINATES"!==e.extraction_type},manageSettings(e){this.$router.push(e)},hasRegexData(e){return!(0,H.fg)(this.doc_type_regexes)&&!(0,H.fg)(this.doc_type_regexes[e])},showRegexesListView(e){return re(this,void 0,void 0,(function*(){if(!this.doc_type_regexes||!this.doc_type_regexes[e]||!this.doc_type_regexes[e]["regexes"]||this.doc_type_regexes[e]["regexes"]["loading_data"])return;let t=this.doc_type_regexes[e]["regexes"];try{0===this.language_origin_list.length&&(yield this.fetchLanguageOptions()),t["loading_data"]=!0,this.showLoading(),!1===t["api_data"]&&(yield this.getDocumentTypeRegexes(e)),t["display_list"]=!0,setTimeout((()=>{t["display_list"]=!1}),0)}catch(a){this.showErrorToast("Something went wrong while loading data. Please try again.")}finally{t["loading_data"]=!1,this.hideLoading()}}))},getDocumentTypeRegexes(e){return re(this,void 0,void 0,(function*(){if(!e||""===e)throw{message:"Document Type is missing"};let t,a=yield(0,N.O_)(),i=new FormData,s={regexType:e};i.append("data",JSON.stringify(s)),t=yield R().post(N.hi.post_data_fellowkv+N.hi.get_document_type_regexes,i,{headers:{Authorization:a}});let n=this.doc_type_regexes[e]["regexes"];if(n["api_data"]=!0,n["data"]=[],!t.data)throw{message:"No Data return from api"};if(t.data.hasOwnProperty("message"))throw t.data;t.data.forEach(((e,t)=>{n["data"].push(e)}))}))},newChangesSavedForRegexes(e){if(!e||!e.detail)return;let t=e.detail;this.doc_type_regexes[t]["regexes"]["api_data"]=!1,this.showRegexesListView(t)},resetDocTypeRegexData(){this.doc_type_regexes={};for(const e in this.apiData){const t=this.apiData[e],a=t.document_name;this.doc_type_regexes[a]={},this.doc_type_regexes[a]["regexes"]={data:[],display_list:!1,api_data:!1,loading_data:!1}}},fetchLanguageOptions(){return re(this,void 0,void 0,(function*(){let e,t=yield(0,N.O_)();if(e=yield R().get(N.hi.get_items_from_dictionary+"DOC_ORIGIN",{headers:{Authorization:t}}),!e.data||0===Object.keys(e.data).length)throw{message:"No language origin list found"};this.language_origin_list=[];for(const a in e.data){let t=e.data[a];this.language_origin_list.push(Object.assign({},{value:t.value,label:t.label}))}}))},deleteDocumentType(e){return re(this,void 0,void 0,(function*(){let t;try{if("DEFAULT"===e.org_id)return void this.showErrorToast("Standard document cannot be deleted");this.showLoading();let a=yield(0,N.O_)();if(t=yield R()["delete"](N.hi.delete_document_type+e.id,{headers:{Authorization:a}}),!1===t.data.success)return this.showErrorToast(t.data.message),void this.hideLoading();delete this.apiData[e.document_key],this.deleting_row={}}catch(a){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},handleVisibilty(e,t){return re(this,void 0,void 0,(function*(){let a;try{this.showLoading();let i=yield(0,N.O_)(),s=new FormData;s.append("id",t.id),s.append("activate",e.toString()),a=yield R().post(N.hi.activate_deactivate_document_type,s,{headers:{Authorization:i}}),!0===a.data.success?(yield this.getDocTypesSubTypes(),this.showSuccessToast(a.data.message)):this.showErrorToast(a.data.message),this.apiData[t.document_key]["is_active"]=e}catch(i){this.apiData[t.document_key]["is_active"]=!e,this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},handleExtractionType(e,t){return re(this,void 0,void 0,(function*(){let a;try{this.showLoading();let i=yield(0,N.O_)(),s=new FormData;s.append("id",t.id),s.append("extraction_type",e?"FLEX_COORDINATES":"FIX_COORDINATES"),a=yield R().post(N.hi.set_extraction_type,s,{headers:{Authorization:i}}),!0===a.data.success?this.showSuccessToast(a.data.message):this.showErrorToast(a.data.message)}catch(i){this.apiData[t.document_key]["extraction_type_model"]=!e,this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},handleAutoAccountingSetting(e,t){}},setup(){let e=[];const t=(0,Q.At)(),{getDocTypesSubTypes:a}=t,{doc_type_list:i}=(0,q.Jk)(t);let s={};const n=(0,Q.nc)(),{getTemplatesForDocuments:o}=n,l=(0,Q.VF)(),{getOrgSettings:r}=l,{user_settings:c,loading_settings:d}=(0,q.Jk)(l);return{user_settings:c,getOrgSettings:r,doc_type_list:i,getDocTypesSubTypes:a,getTemplatesForDocuments:o,apiData:(0,M.iH)(s),loading_doc_type_regex_data:(0,M.iH)(!0),doc_type_regexes:(0,M.iH)(s),language_origin_list:e,deleteConfirm:(0,M.iH)(!1),deleting_row:(0,M.iH)({}),doc_type_auto_accounting_setting:(0,M.iH)({}),currentDocType:(0,M.iH)(""),LAYOUT_BUILDER_MODULE:(0,M.iH)(!1),MODELS_LABELS_MODULE:(0,M.iH)(!1),DOC_SCRIPT_MODULE:(0,M.iH)(!1),options:[{label:"Yes",value:"true"},{label:"No",value:"false"}]}}});var de=a(13246),_e=a(490),ue=a(76749),ge=a(20990),me=a(46858),pe=a(68879),he=a(50926),ye=a(32074),fe=a(44458),we=a(63190),ve=a(61357),xe=a(11821),Te=a(62146),be=a(69984),De=a.n(be);const ke=(0,ne.Z)(ce,[["render",S],["__scopeId","data-v-6224a646"]]),Le=ke;De()(ce,"components",{QList:de.Z,QItem:_e.Z,QItemSection:ue.Z,QBadge:ge.Z,QTooltip:me.Z,QBtn:pe.Z,QSeparator:he.Z,QDialog:ye.Z,QCard:fe.Z,QCardSection:we.Z,QAvatar:ve.Z,QCardActions:xe.Z}),De()(ce,"directives",{ClosePopup:Te.Z})}}]);