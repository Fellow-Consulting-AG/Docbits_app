"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[4032],{84032:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ke});var a=s(61758),o=s(58790),r=s(29104);const l={class:"q-pa-lg page-height-limit"},i={class:"row"},n={class:"row q-my-sm menu-option-style"},d={class:"row q-my-sm menu-option-style"},c={class:"row q-my-sm menu-option-style"},u={class:"row q-my-sm menu-option-style"},_={class:"row q-my-sm menu-option-style"},h={class:"float-right q-ml-auto"},g={class:"q-pa-md col-4"},f={class:"row"},p={key:2},w={class:"text-subtitle2 row"},m={class:"q-pa-md full-width"},k={key:0},v={class:"card-category-text"},b={class:"full-width"},y={class:"card-category-text"},F={class:"card-category-text"},C={key:1},L={key:0,class:"small-heading"},D={class:"card-category-text"},S={key:1,class:"full-width"},q={class:"card-category-text"},x={class:"card-category-text"},X={class:"q-pa-md"},V={class:"small-heading"},W={key:0},K={key:1},A={key:0},E={class:"card-message q-my-sm"},R={key:1};function $(e,t,s,$,T,Q){const I=(0,a.g2)("SubHeader"),O=(0,a.g2)("q-btn"),Y=(0,a.g2)("q-space"),j=(0,a.g2)("q-select"),M=(0,a.g2)("q-date"),P=(0,a.g2)("q-popup-proxy"),U=(0,a.g2)("q-icon"),z=(0,a.g2)("q-input"),G=(0,a.g2)("f-btn"),B=(0,a.g2)("q-menu"),N=(0,a.g2)("q-card-section"),H=(0,a.g2)("q-tooltip"),J=(0,a.g2)("q-card"),Z=(0,a.g2)("q-separator"),ee=(0,a.g2)("q-pagination"),te=(0,a.g2)("q-th"),se=(0,a.g2)("q-tr"),ae=(0,a.g2)("q-td"),oe=(0,a.g2)("GenericCard"),re=(0,a.g2)("q-table"),le=(0,a.g2)("Loader"),ie=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(I,{name:"workflow_logs",label:e.$t("workflow_logs")},null,8,["label"]),(0,a.Lk)("div",l,[(0,a.Lk)("div",i,[(0,a.bF)(z,{modelValue:e.search,"onUpdate:modelValue":[t[9]||(t[9]=t=>e.search=t),t[10]||(t[10]=t=>{e.inputSearchValueChanges(t)})],label:e.$t("search"),rules:[e=>e.length>=0],"onClear:modelValue":e.clearSearchValue,debounce:"400",class:"row-8 wf-log-search white-inputs",outlined:"","hide-bottom-space":""},{append:(0,a.k6)((()=>[(0,a.bF)(O,{icon:"tune",flat:"",unelevated:"",id:"btn_tune_filters"}),(0,a.bF)(B,{class:"q-pa-md menu-border-style",style:{border:"1px solid grey"}},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,[(0,a.Lk)("span",null,(0,o.v_)(e.$t("sort_direction")),1),(0,a.bF)(Y),(0,a.bF)(j,{modelValue:e.sort_direction,"onUpdate:modelValue":t[0]||(t[0]=t=>e.sort_direction=t),options:e.sort_direction_options_translated,label:e.$t("sort_direction"),clearable:!1,dense:"",outlined:"",class:"q-mr-sm sort-dropdown"},null,8,["modelValue","options","label"])]),(0,a.Lk)("div",d,[(0,a.Lk)("span",null,(0,o.v_)(e.$t("sort_by")),1),(0,a.bF)(Y),(0,a.bF)(j,{modelValue:e.sort_by,"onUpdate:modelValue":t[1]||(t[1]=t=>e.sort_by=t),options:e.sort_by_options_translated,label:e.$t("sort_by"),clearable:!1,dense:"",outlined:"",class:"q-mr-sm sort-dropdown"},null,8,["modelValue","options","label"])]),(0,a.Lk)("div",c,[(0,a.Lk)("span",null,(0,o.v_)(e.$t("status")),1),(0,a.bF)(Y),(0,a.bF)(j,{modelValue:e.sort_status,"onUpdate:modelValue":t[2]||(t[2]=t=>e.sort_status=t),options:e.sort_status_options_translated,label:e.$t("status"),clearable:!0,onClear:e.clearStatus,dense:"",outlined:"",class:"q-mr-sm sort-dropdown"},null,8,["modelValue","options","label","onClear"])]),(0,a.Lk)("div",u,[(0,a.eW)((0,o.v_)(e.$t("start_date"))+" ",1),(0,a.bF)(Y),(0,a.bF)(z,{outlined:"",dense:"",modelValue:e.startDate,"onUpdate:modelValue":t[4]||(t[4]=t=>e.startDate=t),placeholder:"YYYY-MM-DD",mask:"####-##-##","data-cy":"start_date",clearable:!0,class:"q-mr-sm sort-dropdown",onClear:t[5]||(t[5]=t=>e.clearDate("startDate"))},{append:(0,a.k6)((()=>[(0,a.bF)(U,{name:"event",class:"cursor-pointer",id:"btn_start_date"},{default:(0,a.k6)((()=>[(0,a.bF)(P,null,{default:(0,a.k6)((()=>[(0,a.bF)(M,{modelValue:e.startDate,"onUpdate:modelValue":t[3]||(t[3]=t=>e.startDate=t),mask:"YYYY-MM-DD",color:"primary"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(O,{label:e.$t("close"),color:"primary",flat:""},null,8,["label"]),[[ie]])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,a.Lk)("div",_,[(0,a.eW)((0,o.v_)(e.$t("end_date"))+" ",1),(0,a.bF)(Y),(0,a.bF)(z,{outlined:"",dense:"",modelValue:e.endDate,"onUpdate:modelValue":t[7]||(t[7]=t=>e.endDate=t),placeholder:"YYYY-MM-DD",mask:"####-##-##","data-cy":"end_date",clearable:!0,class:"q-mr-sm sort-dropdown",onClear:t[8]||(t[8]=t=>e.clearDate("endDate"))},{append:(0,a.k6)((()=>[(0,a.bF)(U,{name:"event",class:"cursor-pointer",id:"btn_end_date"},{default:(0,a.k6)((()=>[(0,a.bF)(P,null,{default:(0,a.k6)((()=>[(0,a.bF)(M,{modelValue:e.endDate,"onUpdate:modelValue":t[6]||(t[6]=t=>e.endDate=t),mask:"YYYY-MM-DD",color:"primary"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(O,{label:e.$t("close"),color:"primary",flat:""},null,8,["label"]),[[ie]])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,a.Lk)("div",h,[(0,a.bF)(G,{appearance:"secondary",class:"q-mr-sm mt-20 q-mb-md",label:e.$t("apply"),onClick:e.applyFilter},null,8,["label","onClick"]),(0,a.bF)(G,{appearance:"secondary",class:"q-mr-sm mt-20 q-mb-md",label:e.$t("clear_filters"),onClick:e.clearFilter},null,8,["label","onClick"])])])),_:1})])),_:1},8,["modelValue","label","rules","onClear:modelValue"]),(0,a.Lk)("div",g,[(0,a.Lk)("div",f,[(0,a.bF)(J,{flat:"",bordered:"",class:"status-count-card status-count-card-primary"},{default:(0,a.k6)((()=>[(0,a.bF)(N,{class:"status-count-number"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(this.total_records),1)])),_:1}),(0,a.bF)(H,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t("total")),1)])),_:1})])),_:1}),(0,a.bF)(Z,{vertical:!0,class:"seperator"}),(0,a.bF)(J,{flat:"",bordered:"",class:"status-count-card status-count-card-red"},{default:(0,a.k6)((()=>[(0,a.bF)(N,{class:"status-count-number"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(this.in_error),1)])),_:1}),(0,a.bF)(H,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t("sort_status_error")),1)])),_:1})])),_:1}),(0,a.bF)(J,{flat:"",bordered:"",class:"status-count-card status-count-card-yellow"},{default:(0,a.k6)((()=>[(0,a.bF)(N,{class:"status-count-number"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(this.in_failed_condition),1)])),_:1}),(0,a.bF)(H,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t("sort_status_failed_condition")),1)])),_:1})])),_:1}),(0,a.bF)(J,{flat:"",bordered:"",class:"status-count-card status-count-card-green"},{default:(0,a.k6)((()=>[(0,a.bF)(N,{class:"status-count-number"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(this.in_success),1)])),_:1}),(0,a.bF)(H,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t("sort_status_success")),1)])),_:1})])),_:1})])])]),(0,a.bF)(re,{class:"dashboard-table-style",flat:"",bordered:"",rows:this.rows,columns:e.columns,"rows-per-page-options":[e.page_size],separator:"cell","wrap-cells":""},{pagination:(0,a.k6)((()=>[(0,a.bF)(ee,{modelValue:e.current_page,"onUpdate:modelValue":[t[11]||(t[11]=t=>e.current_page=t),t[12]||(t[12]=t=>e.nextPageClicked())],color:"primary",max:e.total_pages,class:"q-py-xs q-mx-md","max-pages":6,input:"","boundary-links":""},null,8,["modelValue","max"])])),header:(0,a.k6)((t=>[(0,a.bF)(se,{props:t},{default:(0,a.k6)((()=>[(0,a.bF)(te,{"auto-width":""}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.cols,(s=>((0,a.uX)(),(0,a.Wv)(te,{key:s.name,props:t},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t(s.label)),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,a.k6)((t=>[(0,a.bF)(se,{props:t,onClick:e=>t.expand=!t.expand,class:"cursor-pointer"},{default:(0,a.k6)((()=>[(0,a.bF)(ae,{"auto-width":""},{default:(0,a.k6)((()=>[(0,a.bF)(U,{size:"sm",name:t.expand?"keyboard_arrow_up":"keyboard_arrow_down",color:"primary"},null,8,["name"])])),_:2},1024),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.cols,(s=>((0,a.uX)(),(0,a.Wv)(ae,{key:s.name,props:t},{default:(0,a.k6)((()=>["created_on"===s.name?((0,a.uX)(),(0,a.Wv)(ae,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.formatDateAccordingToPreference(s.value)),1)])),_:2},1024)):"result"===s.name?((0,a.uX)(),(0,a.Wv)(ae,{key:1,class:"result-column"},{default:(0,a.k6)((()=>["success"===t.row[s.name]?((0,a.uX)(),(0,a.Wv)(U,{key:0,name:"check_circle",color:"green",size:"sm"})):null===t.row[s.name]||"failed_condition"===t.row[s.name]?((0,a.uX)(),(0,a.Wv)(U,{key:1,name:"do_not_disturb_on",color:"orange",size:"sm"})):((0,a.uX)(),(0,a.Wv)(U,{key:2,name:"cancel",color:"red",size:"sm"}))])),_:2},1024)):((0,a.uX)(),(0,a.CE)("div",p,(0,o.v_)(s.value),1))])),_:2},1032,["props"])))),128))])),_:2},1032,["props","onClick"]),(0,a.bo)((0,a.bF)(se,{props:t},{default:(0,a.k6)((()=>[(0,a.bF)(ae,{colspan:"1"}),(0,a.bF)(ae,{colspan:"1",class:"no-padding"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",w,[(0,a.Lk)("div",m,[[void 0,null].includes(t.row.workflow_data)||void 0==t.row.workflow_data.data||void 0==t.row.workflow_data.data.when_condition.card_logs?((0,a.uX)(),(0,a.CE)("div",C,[this.workflowChanged(t.row.id)?((0,a.uX)(),(0,a.CE)("div",L,(0,o.v_)(e.$t("workflow_changed")),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[(0,a.Lk)("div",D,(0,o.v_)(e.$t("wf_when")),1)]),Object.keys(this.workflows).includes(t.row.workflow_id)?((0,a.uX)(),(0,a.CE)("div",S,[(0,a.Lk)("div",null,[(0,a.bF)(oe,{card_result:e.checkCardSuccess(t.row.id,0,"when"),item:this.workflows[t.row.workflow_id].data.when_condition,version:this.workflows[t.row.workflow_id].data.when_condition.version,onClick:e=>this.getCardLogs(this.workflows[t.row.workflow_id].data.when_condition.id,t.row.id,0,"when")},null,8,["card_result","item","version","onClick"])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[(0,a.Lk)("div",q,(0,o.v_)(e.$t("wf_and")),1)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.workflows[t.row.workflow_id].data.and_conditions,((s,o)=>((0,a.uX)(),(0,a.CE)("div",{class:"full-width",key:s.id+"_"+s.card_version+"_"+o},[(0,a.Lk)("div",null,[(0,a.bF)(oe,{card_result:e.checkCardSuccess(t.row.id,o,"and"),item:s,version:s.version,onClick:e=>this.getCardLogs(s.id,t.row.id,o,"and")},null,8,["card_result","item","version","onClick"])])])))),128)),(0,a.Lk)("div",null,[(0,a.Lk)("div",x,(0,o.v_)(e.$t("wf_then")),1)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.workflows[t.row.workflow_id].data.then_conditions,((s,o)=>((0,a.uX)(),(0,a.CE)("div",{class:"full-width",key:s.id+"_"+s.card_version+"_"+o},[(0,a.Lk)("div",null,[(0,a.bF)(oe,{card_result:e.checkCardSuccess(t.row.id,o,"then"),item:s,version:s.version,onClick:e=>this.getCardLogs(s.id,t.row.id,o,"then")},null,8,["card_result","item","version","onClick"])])])))),128))])):((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("span",v,(0,o.v_)(e.$t("wf_when")),1),(0,a.Lk)("div",b,[(0,a.Lk)("div",null,[(0,a.bF)(oe,{card_result:e.checkCardSuccess(t.row.id,0,"when"),item:t.row.workflow_data.data.when_condition,version:t.row.workflow_data.data.when_condition.version,onClick:e=>this.getCardLogs(t.row.workflow_data.data.when_condition.id,t.row.id,0,"when")},null,8,["card_result","item","version","onClick"])])]),(0,a.Lk)("div",y,(0,o.v_)(e.$t("wf_and")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.row.workflow_data.data.and_conditions,((s,o)=>((0,a.uX)(),(0,a.CE)("div",{class:"full-width",key:s.id+"_"+s.card_version+"_"+o},[(0,a.Lk)("div",null,[(0,a.bF)(oe,{card_result:e.checkCardSuccess(t.row.id,o,"and"),item:s,version:s.version,onClick:e=>this.getCardLogs(s.id,t.row.id,o,"and")},null,8,["card_result","item","version","onClick"])])])))),128)),(0,a.Lk)("div",F,(0,o.v_)(e.$t("wf_then")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.row.workflow_data.data.then_conditions,((s,o)=>((0,a.uX)(),(0,a.CE)("div",{class:"full-width",key:s.id+"_"+s.card_version+"_"+o},[(0,a.Lk)("div",null,[(0,a.bF)(oe,{card_result:e.checkCardSuccess(t.row.id,o,"then"),item:s,version:s.version,onClick:e=>this.getCardLogs(s.id,t.row.id,o,"then")},null,8,["card_result","item","version","onClick"])])])))),128))]))])])])),_:2},1024),(0,a.bF)(ae,{colspan:"3",class:"no-padding log-message-column"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",X,[(0,a.Lk)("div",V,[([void 0,null].includes(t.row.workflow_data)||void 0==t.row.workflow_data.data||[void 0,null].includes(t.row.workflow_data.data.when_condition.card_logs))&&this.workflowChanged(t.row.id)?((0,a.uX)(),(0,a.CE)("div",K,(0,o.v_)(e.$t("workflow_logs")),1)):((0,a.uX)(),(0,a.CE)("div",W,(0,o.v_)(e.$t("card_logs")),1))]),Object.keys(this.displayed_messages).includes(t.row.id)?((0,a.uX)(),(0,a.CE)("div",A,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.displayed_messages[t.row.id],(e=>((0,a.uX)(),(0,a.CE)("div",{key:e},[(0,a.Lk)("span",E,(0,o.v_)(e.message),1)])))),128))])):((0,a.uX)(),(0,a.CE)("div",R,(0,o.v_)(e.$t("card_logs_message")),1))])])),_:2},1024)])),_:2},1032,["props"]),[[r.aG,t.expand]])])),_:1},8,["rows","columns","rows-per-page-options"])]),(0,a.bF)(le)],64)}var T=s(24622),Q=s(38734);const I={class:"col-sm-12 col-md-12 col-lg-12"},O={class:"float-right q-ml-auto q-pa-xs"},Y={class:"float-right"},j={class:"completion-time-margin"},M=["innerHTML"],P={class:"color-93939A paddingMargin0 font-size-0-75"},U={class:"paddingMargin0 font-size-15 card-text"};function z(e,t,s,r,l,i){const n=(0,a.g2)("q-icon"),d=(0,a.g2)("q-card-section"),c=(0,a.g2)("q-card");return(0,a.uX)(),(0,a.CE)("div",I,[(0,a.bF)(c,{class:(0,o.C4)(["card-margin-bottom",e.card_result?"cursor-pointer":"cursor-not-allowed opacity-half"]),bordered:"",flat:""},{default:(0,a.k6)((()=>[(0,a.Lk)("div",O,[(0,a.Lk)("div",Y,[e.card_result?((0,a.uX)(),(0,a.Wv)(n,{key:0,name:"check_circle",size:"22px",color:"green"})):((0,a.uX)(),(0,a.Wv)(n,{key:1,name:"cancel",size:"22px",color:"red"}))]),(0,a.Lk)("div",j,(0,o.v_)(e.item.completion_time),1)]),(0,a.bF)(d,{class:"row no-padding"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",{class:"col-1 card-svg-margin",round:"",flat:"",size:"xs",style:(0,o.Tr)("background-color:"+e.color)},[(0,a.Lk)("i",{innerHTML:e.item.svg,class:"svg-icon center-inner"},null,8,M)],4),(0,a.bF)(d,{class:"col-11"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",P,(0,o.v_)(e.$t(e.item.category)),1),(0,a.Lk)("p",U,[!e.dataArray||e.dataArray.length<1?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,o.v_)(e.$t(e.item.text)),1)],64)):((0,a.uX)(!0),(0,a.CE)(a.FK,{key:1},(0,a.pI)(e.dataArray,((t,s)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:s},[e.renderBadge(t)?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,o.v_)(e.$t(e.getVariableData(t))),1)],64)):e.renderTextTranslation(t)?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,o.v_)(e.$t(t)),1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.eW)((0,o.v_)(t+" "),1)],64))],64)))),128))])])),_:1})])),_:1})])),_:1},8,["class"])])}var G=s(96056),B=s(18505),N=s(76956),H=s(16332),J=s(1659),Z=s(11470),ee=function(e,t,s,a){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function l(e){try{n(a.next(e))}catch(t){r(t)}}function i(e){try{n(a["throw"](e))}catch(t){r(t)}}function n(e){e.done?s(e.value):o(e.value).then(l,i)}n((a=a.apply(e,t||[])).next())}))};const te=(0,J.nY)("workflow_logs_variables_store",{state:()=>({users:[],groups:[],workflows:[]}),getters:{getStoredUsers:e=>e.users},actions:{getUsers(){return ee(this,void 0,void 0,(function*(){if(0==this.users.length){const e=yield Z.jD.getUsers();e.forEach((e=>{this.users.push(e)}))}}))},getGroups(){return ee(this,void 0,void 0,(function*(){if(0==this.groups.length){const e=yield Z.jD.getGroups();e.forEach((e=>{this.groups.push(e)}))}}))},getWorkflows(){return ee(this,void 0,void 0,(function*(){if(0==this.users.length){const e=yield Z.Bj.getWorkflowsForOrg();e.forEach((e=>{this.workflows.push(e)}))}}))}}}),se=(0,a.pM)({name:"generic-card",emits:[],mixins:[T.A,G.A,B.A],components:{},props:{isDialog:{type:Boolean,default:!1},itemIndex:{type:Number,default:null},cardType:{type:String,default:""},parentSvg:{type:String,default:""},color:{type:String,default:""},card_result:{type:Boolean,default:!1},item:{type:Object,default:{category:"",id:"",text:"",toolTip:"",card_version:""}}},data(){return{showItemPanel:(0,Q.KR)(!1),dataArray:(0,Q.KR)([])}},mounted(){this.prepareDataForVariableReplacement(),this.prepareData()},methods:{renderBadge(e){return e.startsWith(N.XF)},renderTextTranslation(e){return e.startsWith(N.Q9)},getVariableData(e){if(this.item)for(let t of this.item.variables)if(t.id.split(N.XF).join("")==e.split(N.XF).join("")){if(["user","users","operator","math_operator","sub_org_id","groups","workflow","export_configuration","decision_table"].includes(t.display_name))switch(t.display_name){case"user":case"users":case"groups":case"operator":case"sub_org_id":return this.getVariableDataForID(t.display_name,"id",t.data).replace(/,/g,", ");case"operator":case"math_operator":return H.i18n.t(t.data);case"workflow":return this.getVariableDataForID(t.display_name,"entries.id",t.data).replace(/,/g,", ")}return t.data.replace(/,/g,", ")}return""},getVariableDataForID(e,t,s){const a=Object.keys(this.data);if(a.includes(e)){let a=[];for(let o of s.split(","))for(let s of this.data[e])if(s[t]==o)switch(e){case"user":case"users":const e=s.first_name+" "+s.last_name;-1==a.indexOf(e)&&a.push(e);break;case"groups":case"workflows":a.push(s.name);break}return a.length>0?a.toString():s}return s},prepareDataForVariableReplacement(){this.data.users=this.users,this.data.user=this.users,this.data.groups=this.groups,this.data.workflows=this.workflows},prepareData(){try{if(this.item&&this.$t(this.item.text).includes(N.XF)){let e=this.$t(this.item.text).split(/(__%)/);for(let t=0;t<e.length;t++){let s="";e[t]&&(e[t]==N.XF?(s=e[t]+e[t+1]+e[t+2],t+=2):s=e[t],this.dataArray.push(s))}}}catch(e){}}},setup(){const e=te(),{users:t,groups:s,workflows:a}=(0,J.bP)(e);return{users:t,groups:s,workflows:a,data:{}}}});var ae=s(12807),oe=s(23316),re=s(50492),le=s(44189),ie=s(98582),ne=s.n(ie);const de=(0,ae.A)(se,[["render",z],["__scopeId","data-v-03e18317"]]),ce=de;ne()(se,"components",{QCard:oe.A,QIcon:re.A,QCardSection:le.A});var ue=s(89156),_e=s(36246),he=s(68180),ge=s(46736),fe=function(e,t,s,a){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,r){function l(e){try{n(a.next(e))}catch(t){r(t)}}function i(e){try{n(a["throw"](e))}catch(t){r(t)}}function n(e){e.done?s(e.value):o(e.value).then(l,i)}n((a=a.apply(e,t||[])).next())}))};const pe=(0,a.pM)({name:"workflowLogs",mixins:[T.A,G.A,B.A,ge.A],components:{Loader:ue.A,GenericCard:ce,SubHeader:he.A},data(){return{}},mounted(){return fe(this,void 0,void 0,(function*(){this.showLoading(),yield this.getLogsForDocument(),this.getUsers(),this.getGroups(),this.getWorkflows,this.prepareTableRows(),this.hideLoading(),this.translateSortOptions(),window.vpo=this}))},unmounted(){this.clearFilter(!1),this.clearSearchValue(!1)},methods:{formatDate(e,t){return _e.Ay.formatDate(e,t)},prepareTableRows(){this.rows=this.logs;for(let e=0;e<this.rows.length;e++)this.rows[e].name=this.rows[e].workflow_name,this.rows[e].created_on=this.rows[e].created_on,this.rows[e].run_time_seconds=(this.rows[e].run_time_mili_seconds/1e3).toFixed(2)},nextPageClicked(){return fe(this,void 0,void 0,(function*(){try{this.showLoading(),this.calculateOffset(),yield this.getLogsForDocument()}catch(e){this.showErrorToast(e),logError(e)}finally{this.hideLoading()}}))},resetPagination(){this.total_pages=0,this.current_page=1,this.total_records=0,this.offset=0},setTotalPages(){this.total_pages=Math.ceil(this.total_records/this.page_size)},calculateOffset(){this.offset=this.page_size*(this.current_page-1)},inputSearchValueChanges(e){try{this.showLoading(),e.length>3?(this.search_value=e,this.getLogsForDocument()):this.search_value.length>e.length?this.clearSearchValue():this.search_value=e}catch(t){logError(t)}finally{this.hideLoading()}},clearSearchValue(e=!0){this.search_value="",e&&this.getLogsForDocument()},clearFilter(e=!0){this.sort_direction={value:"sort_asc",label:H.i18n.t("sort_asc")},this.sort_by={value:"created_on",label:H.i18n.t("log_created_on")},this.sort_status={value:"",label:H.i18n.t("")},this.startDate="",this.endDate="",e&&this.getLogsForDocument()},clearStatus(){this.sort_status={value:"",label:H.i18n.t("")}},clearDate(e){"startDate"===e?this.startDate="":("endDate"===e||(this.startDate=""),this.endDate="")},applyFilter(){this.resetPagination(),this.getLogsForDocument()},getLogsForDocument(){return fe(this,void 0,void 0,(function*(){try{this.showLoading();let e={with_name:!0,include_workflows:!0};e["per_site"]=this.page_size,e["offset"]=this.offset,e["ignore_pagination"]=!1,e["sort_direction"]=this.sort_direction.value.replace("sort_",""),e["sort_by"]=this.sort_by.value,this.sort_status.value.length>1&&(e["status"]=this.sort_status.value.replace("sort_status_","")),this.search_value.length>1&&(e["keyword"]=this.search_value),this.startDate.length>1&&(e["start_date"]=this.startDate),this.endDate.length>1&&(e["end_date"]=this.endDate);let t=yield Z.Bj.getWorkflowLogsForDoc(this.$route.params.id.toString(),e);this.logs=t.logs,this.complete_logs=t,this.total_records=t.total,this.in_error=t.in_status.in_error,this.in_failed_condition=t.in_status.in_failed_condition,this.in_success=t.in_status.in_success,this.setTotalPages();for(let s of t.logs)this.loadWorkflow(s.workflow_id),this.expanded[s.id]=!1;this.prepareTableRows()}catch(e){logError(e)}finally{this.hideLoading()}}))},loadWorkflow(e){if(!Object.keys(this.workflows).includes(e)&&Object.keys(this.complete_logs.workflows).includes(e)){let t=this.complete_logs.workflows[e];this.workflows[e]=t;let s="";s=null!=t.last_modified_on?t.last_modified_on:t.created_on,this.workflows[e].last_modified_on=s}},getCardLogs(e,t,s,a){Object.keys(this.card_messages).includes(e.toString()+t.toString()+s+"_"+a)||this.prepareCardLogs(e,t,s,a),this.displayed_messages[t.toString()]=this.card_messages[e.toString()+t.toString()+s+"_"+a]},prepareCardLogs(e,t,s,a){const o=this.getWorkflowRunLog(t),r=this.getFullWorkflowLog(t);if(void 0!=r.workflow_data.data.when_condition.card_logs){if("when"==a)return void(this.card_messages[e.toString()+t.toString()+s+"_"+a]=r.workflow_data.data.when_condition.card_logs);if("and"==a)return void(this.card_messages[e.toString()+t.toString()+s+"_"+a]=r.workflow_data.data.and_conditions[s].card_logs);if("then"==a)return void(this.card_messages[e.toString()+t.toString()+s+"_"+a]=r.workflow_data.data.then_conditions[s].card_logs)}if("when"==a)this.card_messages[e.toString()+t.toString()+s+"_"+a]=o[0];else if("and"==a){for(let l=1;l<o.length;l++)if(l==s+1){this.card_messages[e.toString()+t.toString()+s+"_"+a]=o[l];break}}else if("then"==a)for(let l=0;l<o.length;l++)if(o[l][0].run_category==a){this.card_messages[e.toString()+t.toString()+s+"_"+a]=o[l+s];break}},prepareCompleteLogs(e){const t=this.getWorkflowRunLog(e);let s=[];for(let a of t)for(let e of a)s.push(e);this.displayed_messages[e.toString()]=s},checkCardSuccess(e,t,s){try{const a=this.getWorkflowRunLog(e),o=this.getFullWorkflowLog(e);if(![null,void 0].includes(o.workflow_data)&&void 0!=o.workflow_data.data.when_condition.card_logs){if("when"==s)return["success","default"].includes(o.workflow_data.data.when_condition.card_logs[0].card_result);if("and"==s)return["success","default"].includes(o.workflow_data.data.and_conditions[t].card_logs[0].card_result);if("then"==s)return["success","default"].includes(o.workflow_data.data.then_conditions[t].card_logs[0].card_result)}if("when"==s)return["success","default"].includes(a[0][0].card_result);if("and"==s)return t+=1,"and"==a[t][0].run_category&&["success","default"].includes(a[t][0].card_result);if("then"==s)for(let e=1;e<a.length;e++)if(a[e][0].run_category==s)return["success","default"].includes(a[e+t][0].card_result)}catch(a){logError(a)}},getWorkflowRunLog(e){let t="";for(let s of this.logs)if(s.id==e)return t=s.logs,t;return t},getFullWorkflowLog(e){let t="";for(let s of this.logs)s.id==e&&(t=s);return t},workflowChanged(e){let t=!1;for(let s of this.logs){if(s.id==e&&Object.keys(this.workflows).includes(s.workflow_id))return t=new Date(JSON.parse(JSON.stringify(s.created_on))).getTime()<new Date(JSON.parse(JSON.stringify(this.workflows[s.workflow_id].last_modified_on))).getTime(),t&&this.prepareCompleteLogs(e),t;if(s.id==e)return!1}return t},translateSortOptions(){for(let e of this.sort_by_options)"created_on"===e?this.sort_by_options_translated.push({value:e,label:H.i18n.t("log_"+e)}):this.sort_by_options_translated.push({value:e,label:H.i18n.t(e)});this.sort_by={value:"created_on",label:H.i18n.t("log_created_on")};for(let e of this.sort_direction_options)this.sort_direction_options_translated.push({value:e,label:H.i18n.t(e)});this.sort_direction={value:"sort_asc",label:H.i18n.t("sort_asc")};for(let e of this.sort_status_options)this.sort_status_options_translated.push({value:e,label:H.i18n.t(e)});this.clearStatus()}},setup(){const e=[{name:"wf_name",required:!0,label:"wf_name",align:"left",field:"workflow_name",headerClasses:"table-header-wf-logs",style:"width: 40%;",headerStyle:" width: 40%;"},{name:"created_on",required:!1,label:"log_created_on",align:"left",field:"created_on",headerClasses:"table-header-wf-logs"},{name:"run_time_seconds",required:!1,label:"run_time_seconds",align:"right",field:"run_time_seconds",headerClasses:"table-header-wf-logs",headerStyle:"align-items: left; justify-content: left;"},{name:"result",required:!1,label:"result",align:"left",field:"result",style:" align-items: center; justify-content: center; width: 10%;",headerStyle:" width: 10%;",headerClasses:"table-header-wf-logs"}],t=te(),{getUsers:s,getGroups:a,getWorkflows:o}=t;return{logs:(0,Q.KR)([]),expanded:(0,Q.KR)({}),workflows:(0,Q.KR)({}),complete_logs:(0,Q.KR)({}),card_messages:(0,Q.KR)({}),displayed_messages:(0,Q.KR)({}),wf_logs:(0,Q.KR)({}),columns:e,rows:(0,Q.KR)([]),getUsers:s,getGroups:a,getWorkflows:o,current_page:(0,Q.KR)(1),total_pages:(0,Q.KR)(0),offset:(0,Q.KR)(0),page_size:(0,Q.KR)(10),total_records:(0,Q.KR)(0),search_value:(0,Q.KR)(""),startDate:(0,Q.KR)(""),endDate:(0,Q.KR)(""),sort_direction:(0,Q.KR)({value:"sort_asc",label:"sort_asc"}),sort_direction_options:["sort_asc","sort_desc"],sort_direction_options_translated:(0,Q.KR)([]),sort_by:(0,Q.KR)({value:"created_on",label:"log_created_on"}),sort_by_options:["created_on","wf_name"],sort_by_options_translated:(0,Q.KR)([]),sort_status:(0,Q.KR)({value:"",label:""}),sort_status_options:["sort_status_success","sort_status_failed_condition","sort_status_error"],sort_status_options_translated:(0,Q.KR)([]),in_error:(0,Q.KR)(null),in_success:(0,Q.KR)(null),in_failed_condition:(0,Q.KR)(null)}}});var we=s(67837),me=s(56384),ke=s(84436),ve=s(93676),be=s(94940),ye=s(48975),Fe=s(93692),Ce=s(97410),Le=s(10386),De=s(42315),Se=s(54700),qe=s(44488),xe=s(57722),Xe=s(45262),Ve=s(88672);const We=(0,ae.A)(pe,[["render",$],["__scopeId","data-v-63c14e00"]]),Ke=We;ne()(pe,"components",{QInput:we.A,QIcon:re.A,QBtn:me.A,QMenu:ke.A,QSpace:ve.A,QSelect:be.A,QPopupProxy:ye.A,QDate:Fe.A,QCard:oe.A,QCardSection:le.A,QTooltip:Ce.A,QSeparator:Le.A,QTable:De.A,QPagination:Se.A,QTr:qe.A,QTh:xe.A,QTd:Xe.A}),ne()(pe,"directives",{ClosePopup:Ve.A})}}]);