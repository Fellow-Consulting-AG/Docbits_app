"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[661],{10661:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Se});var r=a(61758),l=a(58790),i=a(29104);const s=e=>((0,r.Qi)("data-v-577343a6"),e=e(),(0,r.jt)(),e),o={class:"row __bg_wrapper q-px-lg q-pb-lg"},n={class:"col-12 border-bottom-bdbdbd q-pb-sm"},d={class:"row"},u={class:"col-6 items-center"},c={class:"text-h6 text-bold text-primary flex items-center"},_=s((()=>(0,r.Lk)("img",{src:"images/purchase-order-icon-20240409-130351.svg",style:{width:"70px"}},null,-1))),p={key:0,class:"col-12 mt-4 q-pa-lg text-blue-grey-5"},h={class:"row mb-4"},g={class:"col-3 text-bold"},m={class:"col-3 text-uppercase"},b={class:"col-3 text-bold"},v={class:"col-3"},k={class:"row mb-4"},f={class:"col-3 text-bold"},y={class:"col-3"},L={class:"col-3 text-bold"},w={class:"col-3"},x={class:"row mb-4"},q={class:"col-3 text-bold"},A={class:"col-3"},P={class:"col-3 text-bold"},F={class:"col-3"},C={class:"row mb-4"},$={class:"col-3 text-bold"},Q={class:"col-3"},D={class:"col-3 text-bold"},E={class:"col-3"},I={class:"q-pa-md col-12"},S={id:"customers",class:"shadow-1"},T={align:"right"},K={align:"right"},X={align:"right"},O={align:"right"},B={align:"right"},M={class:"sub-table-row"},R={colspan:"100%",class:"sub-table-main-td"},V={class:"text-uppercase sticky-header transparent-header table_height table-striped resizable shadow-1 sub-table"},W={align:"right"},z={align:"right"},j={key:1},N={colspan:"9",class:"text-center"},U={class:"col-12 iframe-padding"},H={class:"mx-12 q-card mt-10"},Z=["src"],G={class:"text-weight-bold"},Y=s((()=>(0,r.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1)));function J(e,t,a,s,J,ee){const te=(0,r.g2)("SubHeader"),ae=(0,r.g2)("BackToSettings"),re=(0,r.g2)("q-badge"),le=(0,r.g2)("q-img"),ie=(0,r.g2)("q-icon"),se=(0,r.g2)("q-skeleton"),oe=(0,r.g2)("q-card-actions"),ne=(0,r.g2)("q-card"),de=(0,r.g2)("q-toolbar-title"),ue=(0,r.g2)("q-btn"),ce=(0,r.g2)("q-toolbar"),_e=(0,r.g2)("SupplierItemNumberMap"),pe=(0,r.g2)("q-card-section"),he=(0,r.g2)("q-dialog"),ge=(0,r.g2)("q-inner-loading"),me=(0,r.gN)("close-popup");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(te,{name:"purchase_order_detail",label:e.$t("purchase_order"),show_expiry_alert:!0,display_back_button:!1,back_to_link:"/purchase-order"},null,8,["label"]),(0,r.bF)(ae,{back_to_rotue:"/purchase-order",label:e.$t("po_dashboard.back")},null,8,["label"]),(0,r.Lk)("div",o,[(0,r.bF)(ne,{class:"col-12 q-mt-sm q-pa-md"},{default:(0,r.k6)((()=>[(0,r.bF)(oe,{class:"row"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",n,[(0,r.Lk)("div",d,[(0,r.Lk)("div",u,[(0,r.Lk)("div",c,[_,(0,r.Lk)("span",null,(0,l.v_)(e.$t("Purchase_Order"))+" #"+(0,l.v_)(e.po_detail.purchase_order.purchase_order_number),1)])])])]),e.po_detail.purchase_order?((0,r.uX)(),(0,r.CE)("div",p,[(0,r.Lk)("div",h,[(0,r.Lk)("div",g,(0,l.v_)(e.$t("order_status"))+" :",1),(0,r.Lk)("div",m,[e.po_detail.purchase_order.status?((0,r.uX)(),(0,r.Wv)(re,{key:0,transparent:"",align:"middle",color:e.statusColor(e.po_detail.purchase_order.status)},{default:(0,r.k6)((()=>[(0,r.eW)((0,l.v_)(e.po_detail.purchase_order.status),1)])),_:1},8,["color"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",b,(0,l.v_)(e.$t("purchase_order_number"))+" :",1),(0,r.Lk)("div",v,(0,l.v_)(e.po_detail.purchase_order.purchase_order_number),1)]),(0,r.Lk)("div",k,[(0,r.Lk)("div",f,(0,l.v_)(e.$t("order_date"))+" :",1),(0,r.Lk)("div",y,(0,l.v_)(e.formatDateTimeZone(e.po_detail.purchase_order.order_date,!0)),1),(0,r.Lk)("div",L,(0,l.v_)(e.$t("po_dashboard.requested_delivery_date"))+":",1),(0,r.Lk)("div",w,(0,l.v_)(e.formatDateTimeZone(e.po_detail.purchase_order.requested_shipment_date,!0)),1)]),(0,r.Lk)("div",x,[(0,r.Lk)("div",q,(0,l.v_)(e.$t("total_amount"))+" :",1),(0,r.Lk)("div",A,(0,l.v_)(e.po_detail.purchase_order.total_amount),1),(0,r.Lk)("div",P,(0,l.v_)(e.$t("ship_to_party_name"))+" :",1),(0,r.Lk)("div",F,(0,l.v_)(e.po_detail.purchase_order.ship_to_party_name),1)]),(0,r.Lk)("div",C,[(0,r.Lk)("div",$,(0,l.v_)(e.$t("warehouse"))+" :",1),(0,r.Lk)("div",Q,(0,l.v_)(e.po_detail.purchase_order.location_id),1),(0,r.Lk)("div",D,(0,l.v_)(e.$t("geo_code"))+" :",1),(0,r.Lk)("div",E,(0,l.v_)(e.po_detail.purchase_order.geo_code),1)])])):(0,r.Q3)("",!0),(0,r.Lk)("div",I,[(0,r.Lk)("table",S,[(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.columns,(t=>((0,r.uX)(),(0,r.CE)("th",{key:t.field,class:(0,l.C4)(e.getTextRightAligement(t.field))},(0,l.v_)(t.label),3)))),128))])]),(0,r.Lk)("tbody",null,[e.po_detail.purchase_order_line&&e.po_detail.purchase_order_line.length?((0,r.uX)(!0),(0,r.CE)(r.FK,{key:0},(0,r.pI)(e.po_detail.purchase_order_line,((t,a)=>{var s;return(0,r.uX)(),(0,r.CE)(r.FK,{key:a},[(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(null===(s=t.charges)||void 0===s?void 0:s.length)>0?((0,r.uX)(),(0,r.Wv)(le,{key:0,src:"images/charges/charges.svg",height:"21px",width:"19px",class:"charge-icon icon-grey-svg",onClick:e=>t.show_charges=!t.show_charges},null,8,["onClick"])):(0,r.Q3)("",!0)]),(0,r.Lk)("td",null,[(0,r.bF)(re,{transparent:"",align:"middle",color:e.statusColor(t.status)},{default:(0,r.k6)((()=>[(0,r.eW)((0,l.v_)(t.status),1)])),_:2},1032,["color"])]),(0,r.Lk)("td",T,(0,l.v_)(t.line_number),1),(0,r.Lk)("td",null,(0,l.v_)(t.item_id),1),(0,r.Lk)("td",null,(0,l.v_)(t.supplier_item_id),1),(0,r.Lk)("td",null,(0,l.v_)(t.description),1),(0,r.Lk)("td",K,(0,l.v_)(t.quantity),1),(0,r.Lk)("td",X,[(0,r.eW)((0,l.v_)(t.received_quantity)+" ",1),t.quantity==t.received_quantity?((0,r.uX)(),(0,r.Wv)(ie,{key:0,name:"check",color:"green",size:"xs"})):(0,r.Q3)("",!0)]),(0,r.Lk)("td",O,(0,l.v_)(t.unit_price),1),(0,r.Lk)("td",B,(0,l.v_)(t.total_amount),1)]),(0,r.bo)((0,r.Lk)("tr",M,[(0,r.Lk)("td",R,[(0,r.Lk)("table",V,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,(0,l.v_)(e.$t("charge_id")),1),(0,r.Lk)("th",null,(0,l.v_)(e.$t("amount")),1),(0,r.Lk)("th",null,(0,l.v_)(e.$t("charge_type")),1),(0,r.Lk)("th",null,(0,l.v_)(e.$t("purchase_order_number")),1)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.charges,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:t},[(0,r.Lk)("td",null,(0,l.v_)(e.charge_id),1),(0,r.Lk)("td",W,(0,l.v_)(e.formattedAmount),1),(0,r.Lk)("td",null,(0,l.v_)(e.charge_type),1),(0,r.Lk)("td",z,(0,l.v_)(e.purchase_order_number),1)])))),128))])])],512),[[i.aG,t.show_charges]])],64)})),128)):(0,r.Q3)("",!0),0==e.po_detail.purchase_order_line.length?((0,r.uX)(),(0,r.CE)("tr",j,[(0,r.Lk)("td",N,(0,l.v_)(e.$t("no_data_found")),1)])):(0,r.Q3)("",!0)])])]),(0,r.Lk)("div",U,[(0,r.Lk)("div",H,[e.skeletonLoad?((0,r.uX)(),(0,r.Wv)(se,{key:1,style:{width:"100%"},animated:!1,width:"100%",height:"900px",class:"custom-skeleton"})):((0,r.uX)(),(0,r.CE)("iframe",{key:0,id:"preview_frame",src:e.iframe_path,title:"file preview",width:"100%",height:"900px"},null,8,Z))])])])),_:1})])),_:1})]),(0,r.bF)(he,{modelValue:e.showSupplierMapDlg,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showSupplierMapDlg=t),persistent:""},{default:(0,r.k6)((()=>[(0,r.bF)(ne,{style:{width:"700px"}},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{class:"text-white secondary-toolbar"},{default:(0,r.k6)((()=>[(0,r.bF)(de,null,{default:(0,r.k6)((()=>[(0,r.Lk)("span",G,(0,l.v_)(e.$t("supplier_item_number_map")),1)])),_:1}),(0,r.bo)((0,r.bF)(ue,{flat:"",round:"",dense:"",icon:"close"},null,512),[[me]])])),_:1}),(0,r.bF)(pe,null,{default:(0,r.k6)((()=>[(0,r.bF)(_e,{width:100,supplierId:e.po_detail.purchase_order.supplier_id},null,8,["supplierId"])])),_:1}),(0,r.bF)(oe,{align:"right",class:"bg-white text-teal"},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.bF)(ue,{flat:"",label:e.$t("close"),color:"primary"},null,8,["label"]),[[me]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,r.bF)(ge,{showing:e.loading,style:{"z-index":"1000000000"}},{default:(0,r.k6)((()=>[Y])),_:1},8,["showing"])],64)}var ee=a(23537),te=a(1659),ae=a(60455),re=a(38734),le=a(76651),ie=a(1595),se=a(68180),oe=a(62488),ne=a(39264),de=a(25773),ue=a(11470),ce=a(82303),_e=a(68450),pe=a(64775),he=a(46162),ge=a(46736),me=function(e,t,a,r){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,i){function s(e){try{n(r.next(e))}catch(t){i(t)}}function o(e){try{n(r["throw"](e))}catch(t){i(t)}}function n(e){e.done?a(e.value):l(e.value).then(s,o)}n((r=r.apply(e,t||[])).next())}))};const be=(0,r.pM)({mixins:[ge.A],props:{},data(){return{showSupplierMapDlg:(0,re.KR)(!1),formattedAmount:(0,re.KR)(""),skeletonLoad:(0,re.KR)(!1),iframe_path:(0,re.KR)("")}},components:{SubHeader:se.A,BackToSettings:de.A,SupplierItemNumberMap:ne.A},mounted(){this.init()},methods:{init(){this.getDataServer()},getDataServer(){return me(this,void 0,void 0,(function*(){try{this.preview_path="",this.loading=!0,this.skeletonLoad=!0;const e=[];yield this.getPurchaseOrderDetail(this.id);const t=yield ue.nb.getPoCharges({purchase_order_numbers:this.po_detail.purchase_order.purchase_order_number});if(t.success){const a=t.data;this.po_detail.purchase_order_line.map((t=>{t.charges=a.filter((e=>e.line_number===t.line_number));for(const a of t.charges)e.push(a.amount);return t.show_charges=!1,t})),this.columns.unshift()}const a=yield this.formatAmount(e),r=t.data;this.po_detail.purchase_order_line.map((e=>{e.charges=r.filter((t=>t.line_number===e.line_number&&t.sub_line_number===e.sub_line_number));for(const t of e.charges)t.formattedAmount=this.searchValueByKey(t.amount,a);return e.show_charges=!1,e})),yield this.getPreviewPathDetails()}catch(e){logError(e)}finally{this.loading=!1,this.skeletonLoad=!1}}))},getPreviewPathDetails(){return me(this,void 0,void 0,(function*(){try{if(!(0,_e.z)(this.preview_path)&&!(0,_e.jw)(this.preview_path))return void this.getPdfFileDetails();try{this.skeletonLoad=!0,yield this.getPreviewPath(this.id),yield this.getPdfFileDetails()}catch(e){logInfo(e)}finally{this.skeletonLoad=!1}}catch(e){const t=pe.t.getErrorMessage(e),a=document.getElementById("preview_frame"),r=a.contentDocument;r&&(r.write("<h1>Error</h1><p>Oops!  "+t+".</p>"),r.close()),logError(e)}}))},getPdfFileDetails(){return me(this,void 0,void 0,(function*(){try{if((0,_e.z)(this.preview_path)||(0,_e.jw)(this.preview_path))return;const t=(0,ie._6)();yield t.getTokenQueryParam();const{tokenQueryParam:a}=t;try{this.skeletonLoad=!0;const e=yield ce.A.get(`${he.VA}/resource/get_file/${this.po_number_path}?path=${this.preview_path}&download=false&${a}`,{responseType:"blob"});if("application/json"==e.headers["content-type"])return setTimeout((()=>{this.getPdfFileDetails()}),5e3);const t=e.config.url;this.iframe_path=t}catch(e){logError(e)}finally{this.skeletonLoad=!1}}catch(t){logInfo(t)}}))},statusColor(e){return(0,oe.qY)(e.toLowerCase())||"primary"},getTextRightAligement(e){return"total_amount"===e||"unit_price"===e||"quantity"===e||"line_number"===e||"received_quantity"===e||"geo_code"===e?"text-right":"text-left"},searchValueByKey(e,t){return(0,ie.gP)().searchValueByKey(e,t)},formatAmount(e){return me(this,void 0,void 0,(function*(){let t=[];Array.isArray(e)?t=e.map((e=>({key:e,value:e}))):e?t.push({key:e,value:e}):t.push({key:0,value:0});const{user_settings:a}=(0,ie.Bu)(),r=yield(0,ie.gP)().formatMultiValues(t,"en_US",a.AMOUNTS_LOCALE);return r}))}},setup(){const{t:e}=(0,ee.s9)(),t=(0,le.av)(),a=(0,ae.lq)(),r=(0,re.KR)(a.params.purchase_number),l=(0,re.KR)([{field:"",label:""},{field:"status",label:e("status")},{field:"line_number",label:e("line_number")},{field:"item_id",label:e("item_id")},{field:"supplier_item_id",label:e("supplier_item_id")},{field:"description",label:e("description")},{field:"quantity",label:e("quantity")},{field:"received_quantity",label:e("received_quantity")},{field:"unit_price",label:e("po_unit_price")},{field:"total_amount",label:e("total_amount")}]),{datePattern:i,statusInterface:s,dateFormatOnly:o}=(0,ie.Bu)(),{display_data:n,loading:d,table_columns:u,po_detail:c,preview_path:_,po_number_path:p}=(0,te.bP)(t),{getPurchaseOrderData:h,getPurchaseOrderDetail:g,getPreviewPath:m}=t;return{getPurchaseOrderData:h,getPurchaseOrderDetail:g,dashboard_purchase_order_store:t,id:r,loading:d,display_data:n,po_detail:c,table_columns:u,columns:l,datePattern:i,statusInterface:s,dateFormatOnly:o,purchaseOrderService:ue.nb,preview_path:_,getPreviewPath:m,po_number_path:p}}});var ve=a(12807),ke=a(23316),fe=a(62669),ye=a(56384),Le=a(23954),we=a(15046),xe=a(50492),qe=a(43820),Ae=a(82156),Pe=a(36914),Fe=a(39150),Ce=a(44189),$e=a(39035),Qe=a(88672),De=a(98582),Ee=a.n(De);const Ie=(0,ve.A)(be,[["render",J],["__scopeId","data-v-577343a6"]]),Se=Ie;Ee()(be,"components",{QCard:ke.A,QCardActions:fe.A,QBtn:ye.A,QBadge:Le.A,QImg:we.A,QIcon:xe.A,QSkeleton:qe.Ay,QDialog:Ae.A,QToolbar:Pe.A,QToolbarTitle:Fe.A,QCardSection:Ce.A,QInnerLoading:$e.A}),Ee()(be,"directives",{ClosePopup:Qe.A})}}]);