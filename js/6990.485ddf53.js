"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[6990],{66990:(e,s,t)=>{t.r(s),t.d(s,{default:()=>He});var o=t(83673),a=t(62323),l=t(98880);const r={class:"container no-padding back highlighted-back"},i={class:"secondary-c-text text-h6 q-pt-md q-pb-md"},n=(0,o._)("img",{width:"24",src:"back_new.svg"},null,-1),d={style:{"vertical-align":"middle","margin-left":"10px","font-size":"20px",cursor:"pointer"}},u={class:"container"},p={style:{"margin-top":"3px"}},c={class:"row mt-8 mb-25"},m={class:"",style:{width:"100%",margin:"auto"}},h={key:0,class:"row"},g=["onClick"],_={class:"q-ml-sm"},w={class:"text-weight-bold"},f={class:"table-container col-sm-12 col-md-12 col-lg-12 min-height-300"},b=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function y(e,s,t,y,v,C){const k=(0,o.up)("SubHeader"),W=(0,o.up)("q-icon"),q=(0,o.up)("q-btn"),U=(0,o.up)("q-space"),I=(0,o.up)("q-separator"),Z=(0,o.up)("q-toggle"),x=(0,o.up)("q-td"),T=(0,o.up)("q-tooltip"),R=(0,o.up)("q-table"),O=(0,o.up)("q-card-section"),S=(0,o.up)("q-card"),Q=(0,o.up)("q-expansion-item"),N=(0,o.up)("q-list"),D=(0,o.up)("q-avatar"),E=(0,o.up)("q-card-actions"),$=(0,o.up)("q-dialog"),P=(0,o.up)("Permissions"),V=(0,o.up)("CreateGroup"),H=(0,o.up)("q-toolbar-title"),G=(0,o.up)("q-toolbar"),L=(0,o.up)("ManageUser"),A=(0,o.up)("q-inner-loading"),z=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(k,{name:"settings_group_and_roles",label:e.$t("roles_groups"),display_help_link:!1},null,8,["label"]),(0,o._)("div",r,[(0,o._)("div",i,[(0,o.Wm)(q,{flat:"",rounded:"",color:"primary",to:"/settings"},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{class:"text-red-13",size:"sm"},{default:(0,o.w5)((()=>[n])),_:1}),(0,o._)("label",d,(0,a.zw)(e.$t("layout.settings")),1)])),_:1})])]),(0,o._)("div",u,[(0,o.Wm)(N,{bordered:"",class:"rounded-borders"},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,o.w5)((()=>[(0,o.Wm)(W,{size:"25px",class:"q-mr-lg black_to_white",name:"img:settings/groups.svg"}),(0,o._)("span",p,(0,a.zw)(e.$t("groups_mains_setting_header")),1),(0,o.Wm)(U)])),default:(0,o.w5)((()=>[(0,o.Wm)(I),(0,o.Wm)(S,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o._)("div",m,[(0,o.Uk)((0,a.zw)(e.$t("group_main_setting"))+" ",1),(0,o.Wm)(Z,{modelValue:e.settings_model["GROUP_PERMISSION_ACTIVATED"],"onUpdate:modelValue":[s[0]||(s[0]=s=>e.settings_model["GROUP_PERMISSION_ACTIVATED"]=s),s[1]||(s[1]=s=>{e.saveSetting("GROUP_PERMISSION_ACTIVATED",s)})]},null,8,["modelValue"])])]),this.settings_model["GROUP_PERMISSION_ACTIVATED"]?((0,o.wg)(),(0,o.iD)("div",h,[(0,o.Wm)(R,{style:{width:"100%"},rows:e.rows,columns:e.columns,"no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),"row-key":"name",flat:"",bordered:"","table-header-class":"text-uppercase","rows-per-page-options":[0]},{top:(0,o.w5)((()=>[(0,o.Wm)(q,{color:"primary",class:"q-ml-auto",icon:"add",label:e.$t("new"),onClick:s[2]||(s[2]=s=>e.display_create_group_dialog=!0)},null,8,["label"])])),"body-cell-name":(0,o.w5)((e=>[(0,o.Wm)(x,{props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.row.name),1)])),_:2},1032,["props"])])),"body-cell-action":(0,o.w5)((s=>[(0,o.Wm)(x,{props:s},{default:(0,o.w5)((()=>[(0,o.Wm)(q,{class:"mr-18",outline:"",onClick:t=>e.manageUsers(s.row),color:"primary",label:e.$t("pages.settings.manage_users")},null,8,["onClick","label"]),(0,o.Wm)(q,{outline:"",onClick:t=>e.viewPermissions(s.row),color:"primary",label:e.$t("view_permissions")},null,8,["onClick","label"]),(0,o.Wm)(q,{flat:"",color:"primary",class:""},{default:(0,o.w5)((()=>[(0,o._)("img",{class:"img-fluid mb-14 black_to_white",width:"26",height:"26",src:"trash-bin-default.svg",alt:"",onClick:t=>{e.delete_id=s.row.group_id,e.deleteConfirm=!0}},null,8,g),(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("pages.fields_settings.trashcan")),1)])),_:1})])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,o.w5)((()=>[])),_:1},8,["rows","columns","no-data-label"])])):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1})]),(0,o.Wm)($,{modelValue:e.deleteConfirm,"onUpdate:modelValue":s[4]||(s[4]=s=>e.deleteConfirm=s),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(S,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{icon:"warning",color:"primary"})])),_:1}),(0,o.Wm)(O,{class:"row items-center"},{default:(0,o.w5)((()=>[(0,o._)("span",_,(0,a.zw)(e.$t("pages.messages.MSG_DELETE")),1)])),_:1}),(0,o.Wm)(E,{align:"right"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(q,{flat:"",label:e.$t("pages.user.cancel"),color:"primary"},null,8,["label"]),[[z]]),(0,o.wy)((0,o.Wm)(q,{flat:"",label:e.$t("pages.user.done"),color:"primary",onClick:s[3]||(s[3]=s=>e.deleteGroup())},null,8,["label"]),[[z]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)($,{modelValue:e.display_permissions_dialog,"onUpdate:modelValue":s[5]||(s[5]=s=>e.display_permissions_dialog=s),persistent:"",onKeydown:s[6]||(s[6]=(0,l.D2)((s=>e.display_permissions_dialog=!1),["esc"]))},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{groupId:e.selectedGroupId},null,8,["groupId"])])),_:1},8,["modelValue"]),(0,o.Wm)($,{modelValue:e.display_create_group_dialog,"onUpdate:modelValue":s[7]||(s[7]=s=>e.display_create_group_dialog=s),persistent:"",onKeydown:s[8]||(s[8]=(0,l.D2)((s=>e.display_create_group_dialog=!1),["esc"]))},{default:(0,o.w5)((()=>[(0,o.Wm)(V)])),_:1},8,["modelValue"]),(0,o.Wm)($,{modelValue:e.display_users_dialog,"onUpdate:modelValue":s[9]||(s[9]=s=>e.display_users_dialog=s),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:s[10]||(s[10]=(0,l.D2)((s=>e.display_users_dialog=!1),["esc"]))},{default:(0,o.w5)((()=>[(0,o.Wm)(S,{style:{width:"700px","max-width":"1060px",height:"600px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(G,{class:"secondary-toolbar"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,null,{default:(0,o.w5)((()=>[(0,o._)("span",w,(0,a.zw)(e.selectedGroupName)+" "+(0,a.zw)(e.$t("users")),1)])),_:1}),(0,o.wy)((0,o.Wm)(q,{flat:"",round:"",dense:"",icon:"close"},null,512),[[z]])])),_:1}),(0,o.Wm)(O,{class:"row items-center q-pb-none"}),(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o._)("div",f,[(0,o.Wm)(L,{groupId:e.selectedGroupId},null,8,["groupId"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(A,{showing:e.processing},{default:(0,o.w5)((()=>[b])),_:1},8,["showing"])],64)}var v=t(10321),C=t(77378);const k=(0,o._)("img",{class:"img-fluid mb-14 black_to_white",width:"24",height:"24",src:"trash-bin-default.svg",alt:""},null,-1),W={class:"text-weight-bold"},q={class:"table-container col-sm-12 col-md-12 col-lg-12"},U={class:"table-container col-sm-12 col-md-12 col-lg-12"};function I(e,s,t,r,i,n){const d=(0,o.up)("q-icon"),u=(0,o.up)("q-input"),p=(0,o.up)("q-space"),c=(0,o.up)("q-btn"),m=(0,o.up)("q-td"),h=(0,o.up)("q-tr"),g=(0,o.up)("q-table"),_=(0,o.up)("q-toolbar-title"),w=(0,o.up)("q-toolbar"),f=(0,o.up)("q-card-section"),b=(0,o.up)("q-item-section"),y=(0,o.up)("q-item"),v=(0,o.up)("q-select"),C=(0,o.up)("q-card-actions"),I=(0,o.up)("q-card"),Z=(0,o.up)("q-dialog"),x=(0,o.up)("Loader"),T=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(g,{class:"sticky-header-table",rows:e.rows,columns:e.columns,"rows-per-page-options":[0],"row-key":"id",filter:e.filter,"no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),"table-header-class":"back-white",loading:e.loading},{top:(0,o.w5)((()=>[(0,o.Wm)(u,{outlined:"",debounce:"300",color:"primary",dense:"",modelValue:e.filter,"onUpdate:modelValue":s[0]||(s[0]=s=>e.filter=s)},{append:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"search"})])),_:1},8,["modelValue"]),(0,o.Wm)(p),(0,o.Wm)(c,{color:"primary",label:e.$t("pages.user.add_user"),onClick:s[1]||(s[1]=s=>e.openUserDlg()),style:{height:"40px"}},null,8,["label"])])),body:(0,o.w5)((s=>[(0,o.Wm)(h,{props:s,id:s.key},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.cols,(t=>((0,o.wg)(),(0,o.iD)(o.HY,{key:t.name},["action"===t.name?((0,o.wg)(),(0,o.j4)(m,{key:0,style:{width:"30%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{size:"18px",class:"float-right","no-caps":"",flat:"",dense:"",onClick:t=>e.unassignUser(s.row.id)},{default:(0,o.w5)((()=>[k])),_:2},1032,["onClick"])])),_:2},1024)):(0,o.kq)("",!0),"user_name"===t.name?((0,o.wg)(),(0,o.j4)(m,{key:1,style:{width:"70%"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(s.row.user_name),1)])),_:2},1024)):(0,o.kq)("",!0)],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","filter","no-data-label","loading"]),(0,o.Wm)(Z,{modelValue:e.add_users_dialog,"onUpdate:modelValue":s[5]||(s[5]=s=>e.add_users_dialog=s),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:s[6]||(s[6]=(0,l.D2)((s=>e.add_users_dialog=!1),["esc"]))},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{style:{width:"700px","max-width":"1060px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{class:"text-white secondary-toolbar"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o._)("span",W,(0,a.zw)(e.$t("pages.user.add_user")),1)])),_:1}),(0,o.wy)((0,o.Wm)(c,{flat:"",round:"",dense:"",icon:"close"},null,512),[[T]])])),_:1}),(0,o.Wm)(f,{class:"row items-center q-pb-none"}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o._)("div",q,[(0,o.Wm)(v,{outlined:"",modelValue:e.selectedUserId,"onUpdate:modelValue":s[2]||(s[2]=s=>e.selectedUserId=s),options:this.usersDropdownList,"use-input":"","emit-value":"","map-options":"",onFilter:e.filterUserByName,label:e.$t("select_user")},{"no-option":(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","label"])])])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o._)("div",U,[(0,o.Wm)(v,{outlined:"",modelValue:e.removeFromOtherGroups,"onUpdate:modelValue":s[3]||(s[3]=s=>e.removeFromOtherGroups=s),options:[{value:!1,label:e.$t("form_builder.no")},{value:!0,label:e.$t("form_builder.yes")}],"emit-value":"","map-options":"",label:e.$t("remove_from_other_groups")},null,8,["modelValue","options","label"])])])),_:1}),(0,o.Wm)(C,{align:"right"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(c,{label:e.$t("cancel")},null,8,["label"]),[[T]]),(0,o.Wm)(c,{onClick:s[4]||(s[4]=s=>e.assigneeGroupToUser()),color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(x)],64)}var Z=t(98303),x=t(72113),T=t(60727),R=t(45401),O=t(61959),S=t(80579),Q=t(91949),N=function(e,s,t,o){function a(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,l){function r(e){try{n(o.next(e))}catch(s){l(s)}}function i(e){try{n(o["throw"](e))}catch(s){l(s)}}function n(e){e.done?t(e.value):a(e.value).then(r,i)}n((o=o.apply(e,s||[])).next())}))};const D=(0,o.aZ)({mixins:[R.Z,C.Z,x.Z],components:{},props:{groupId:{type:String,default:""}},data(){return{current_user_id:""}},mounted:function(){this.current_user_id=(0,Q.Y4)("id"),this.prepareTableData(),this.dropdownStore.prepareUsersDropdown(),this.dropdownStore.prepareBooleanList()},methods:{prepareTableData(){return N(this,void 0,void 0,(function*(){yield this.getGroupUsers(),this.prepareTableColumns(),this.prepareTableRows()}))},getGroupUsers(){return N(this,void 0,void 0,(function*(){let e=null;this.showLoading();try{if(e=yield S.kP.getGroupUsers(this.groupId),!e)throw e;this.groupUsers=e}catch(s){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},prepareTableColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"user_name",label:this.$t("name"),field:"user_name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareTableRows(){this.rows=[];for(let e of this.groupUsers)e["user_name"]=e.first_name+" "+e.last_name;this.rows=this.groupUsers},unassignUser(e){return N(this,void 0,void 0,(function*(){this.showLoading();try{yield S.kP.removeUserFromGroup(this.groupId,e.toString());this.removeUser(e),yield this.updateUserPermissions(e),this.showSuccessToast(this.$t("user_removed_from_group"))}catch(s){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},removeUser(e){const s=this.rows.findIndex((s=>s.id===e));-1!==s&&this.rows.splice(s,1)},assigneeGroupToUser(){return N(this,void 0,void 0,(function*(){if(this.selectedUserId){this.showLoading();try{yield S.kP.addUserToGroup(this.groupId,this.selectedUserId.toString(),this.removeFromOtherGroups);this.add_users_dialog=!1,this.addNewUser(),yield this.updateUserPermissions(this.selectedUserId),this.showSuccessToast(this.$t("user_added_to_group"))}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}else this.showErrorToast(this.$t("select_user"))}))},addNewUser(){const e=JSON.parse(JSON.stringify(this.dropdownStore.usersMap.get(this.selectedUserId)));e["user_name"]=e.first_name+" "+e.last_name,this.rows.push(e)},openUserDlg(){this.add_users_dialog=!0,this.selectedUserId=null,this.prepareDropdownData()},prepareDropdownData(){this.usersList=[];let e=new Map(JSON.parse(JSON.stringify(Array.from(this.dropdownStore.usersMap))));for(const s of this.rows)e.delete(s.id);e.forEach(((e,s)=>{this.usersList.push({value:s,label:e.first_name+" "+e.last_name})})),this.usersDropdownList=this.usersList},updateUserPermissions(e){return N(this,void 0,void 0,(function*(){this.current_user_id===String(e)&&(yield Z.W1.fetch())}))},filterUserByName(e,s){s(""!==e?()=>{const s=e.toLowerCase();this.usersDropdownList=this.usersList.filter((e=>e.label.toLowerCase().indexOf(s)>-1))}:()=>{this.usersDropdownList=this.usersList})}},setup(){const e=(0,O.iH)("");let s=[];const t=(0,O.iH)(s),o=(0,T.At)();let a=(0,O.iH)([]);return{filter:e,columns:t,usersList:a,dropdownStore:o,rows:(0,O.iH)(s),loading:(0,O.iH)(!1),selectedUserId:(0,O.iH)(),groupUsers:(0,O.iH)([]),add_users_dialog:(0,O.iH)(!1),removeFromOtherGroups:(0,O.iH)(!1),usersDropdownList:(0,O.XI)([])}}});var E=t(74260),$=t(17132),P=t(64689),V=t(24554),H=t(62025),G=t(2165),L=t(18186),A=t(83884),z=t(46778),j=t(10151),M=t(39570),F=t(13747),B=t(25589),J=t(72448),Y=t(83414),K=t(52035),X=t(99367),ee=t(60677),se=t(7518),te=t.n(se);const oe=(0,E.Z)(D,[["render",I]]),ae=oe;te()(D,"components",{QTable:$.Z,QInput:P.Z,QIcon:V.Z,QSpace:H.Z,QBtn:G.Z,QTr:L.Z,QTd:A.Z,QDialog:z.Z,QCard:j.Z,QToolbar:M.Z,QToolbarTitle:F.Z,QCardSection:B.Z,QSelect:J.Z,QItem:Y.Z,QItemSection:K.Z,QCardActions:X.Z}),te()(D,"directives",{ClosePopup:ee.Z});const le={class:"text-h6"},re={class:"row q-pt-lg p-t-0"},ie={class:"col-sm-12 q-pr-sm"},ne={key:0},de={key:1};function ue(e,s,t,l,r,i){const n=(0,o.up)("q-space"),d=(0,o.up)("q-btn"),u=(0,o.up)("q-card-section"),p=(0,o.up)("q-checkbox"),c=(0,o.up)("q-th"),m=(0,o.up)("q-tr"),h=(0,o.up)("q-td"),g=(0,o.up)("q-table"),_=(0,o.up)("q-card"),w=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(_,{style:{width:"1060px","max-width":"1060px","max-height":"700px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"row items-center q-pb-md bg-primary"},{default:(0,o.w5)((()=>[(0,o._)("div",le,[(0,o._)("b",null,(0,a.zw)(e.group_name),1)]),(0,o.Wm)(n),(0,o.wy)((0,o.Wm)(d,{label:e.$t("save"),class:"float-right q-mr-md q-pa-sm q-pl-md q-pr-md",color:"primary",dense:"",onClick:e.savePermissions},null,8,["label","onClick"]),[[w]]),(0,o.wy)((0,o.Wm)(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[w]])])),_:1}),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o._)("div",re,[(0,o._)("div",ie,[(0,o.Wm)(g,{class:"sticky-header-table",rows:e.rows,columns:e.columns,"no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),"row-key":"name",flat:"",bordered:"","rows-per-page-options":[0]},{header:(0,o.w5)((s=>[(0,o.Wm)(m,{props:s,class:"back-white"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.cols,(t=>((0,o.wg)(),(0,o.j4)(c,{key:t.name,props:s,class:"back-white"},{default:(0,o.w5)((()=>["document_name"===t.name?((0,o.wg)(),(0,o.iD)("span",ne,(0,a.zw)(t.label),1)):((0,o.wg)(),(0,o.iD)("span",de,[(0,o.Wm)(p,{modelValue:this.headerCheckboxs[t.name],"onUpdate:modelValue":[e=>this.headerCheckboxs[t.name]=e,s=>e.columnSelectAll(t.name)]},null,8,["modelValue","onUpdate:modelValue"]),(0,o.Uk)(" "+(0,a.zw)(e.$t(t.label)),1)]))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((t=>[(0,o.Wm)(m,{props:t,id:t.key},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.cols,(l=>((0,o.wg)(),(0,o.iD)(o.HY,{key:l.name},["document_name"===l.name?((0,o.wg)(),(0,o.j4)(h,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.row.document_name),1)])),_:2},1024)):((0,o.wg)(),(0,o.j4)(h,{key:1},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:t.row.acls[l.name],"onUpdate:modelValue":[e=>t.row.acls[l.name]=e,s[0]||(s[0]=s=>e.onRowCheckboxChange())]},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","no-data-label"])])])])),_:1})])),_:1})}var pe=t(53371);const ce=(0,o.aZ)({el:"#app",mixins:[C.Z],components:{},props:{groupId:{type:String,default:""}},data(){return{}},mounted(){this.group_data=JSON.parse(JSON.stringify(this.getPermissionsByGroupId(this.groupId))),this.setGroupName(),this.prepareColumns(),this.preparePermissionList(),this.prepareHeaderCheckboxs()},methods:{columnSelectAll(e){Array.from(this.rows).forEach((s=>{s.acls[e]=this.headerCheckboxs[e]}))},prepareHeaderCheckboxs(){Array.from(this.rows).forEach((e=>{for(let[s,t]of Object.entries(e.acls))!0===this.headerCheckboxs[s]&&!1===t&&(this.headerCheckboxs[s]=!1)}))},onRowCheckboxChange(){this.resetHeaderCheckbox(),this.prepareHeaderCheckboxs()},resetHeaderCheckbox(){for(let[e,s]of Object.entries(this.headerCheckboxs))this.headerCheckboxs[e]=!0},setGroupName(){this.group_data&&(this.group_name=this.group_data.group_name)},prepareColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"document_name",label:pe.i18n.t("document_type"),field:"document_name",align:"left"})),this.hasPermissins()&&this.prepareHeaderCheckbox()},prepareHeaderCheckbox(){const e=this.group_data.doc_type_permissions[0].acls;for(let[s,t]of Object.entries(e))this.columns.push(Object.assign({},{name:s,label:s,field:s,align:"left"})),this.headerCheckboxs[s]=!0},hasPermissins(){return!(!this.group_data||!Array.isArray(this.group_data.doc_type_permissions)||this.group_data.doc_type_permissions.length<1)},preparePermissionList(){this.hasPermissins()&&(this.rows=[],this.rows=JSON.parse(JSON.stringify(this.group_data.doc_type_permissions)))},savePermissions(){this.saveDocPermissions(this.rows,this.groupId),this.showSuccessToast(this.$t("roles_permission_saved"))}},setup(){const e=(0,T.zI)(),{getPermissionsByGroupId:s}=(0,v.Jk)(e),{saveDocPermissions:t}=e;return{saveDocPermissions:t,getPermissionsByGroupId:s,group_data:(0,O.iH)([]),columns:(0,O.iH)([]),rows:(0,O.iH)([]),group_name:(0,O.iH)(""),headerCheckboxs:(0,O.iH)({})}}});var me=t(92414),he=t(65735);const ge=(0,E.Z)(ce,[["render",ue]]),_e=ge;te()(ce,"components",{QCard:j.Z,QCardSection:B.Z,QSpace:H.Z,QBtn:G.Z,QTable:$.Z,QTr:L.Z,QTh:me.Z,QCheckbox:he.Z,QTd:A.Z}),te()(ce,"directives",{ClosePopup:ee.Z});const we=(0,o._)("span",{class:"text-weight-bold"},null,-1),fe={style:{"margin-bottom":"20px"},class:"row full-width mb-10 mt-8"},be={class:"full-width"},ye={class:"row full-width mb-10 mt-8",style:{"margin-bottom":"20px"}},ve={class:"full-width"},Ce=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function ke(e,s,t,r,i,n){const d=(0,o.up)("q-toolbar-title"),u=(0,o.up)("q-btn"),p=(0,o.up)("q-toolbar"),c=(0,o.up)("q-tooltip"),m=(0,o.up)("q-icon"),h=(0,o.up)("q-input"),g=(0,o.up)("q-card-section"),_=(0,o.up)("q-card-actions"),w=(0,o.up)("q-inner-loading"),f=(0,o.up)("q-card"),b=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(f,{style:{width:"600px"}},{default:(0,o.w5)((()=>[(0,o._)("form",{onSubmit:s[2]||(s[2]=(0,l.iM)(((...s)=>e.submitNewColumFrom&&e.submitNewColumFrom(...s)),["prevent","stop"]))},[(0,o.Wm)(p,{class:"secondary-toolbar"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("create_group")),1),we])),_:1}),(0,o.wy)((0,o.Wm)(u,{flat:"",round:"",dense:"",icon:"close"},null,512),[[b]])])),_:1}),(0,o.Wm)(g,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o._)("div",fe,[(0,o._)("div",be,[(0,o.Wm)(h,{outlined:"",tabindex:"0",class:(0,a.C_)("full-width "+(!e.new_model["validate"]||e.new_model["required_error"]?"column-error-border":"")),modelValue:e.new_model["name"],"onUpdate:modelValue":s[0]||(s[0]=s=>e.new_model["name"]=s),placeholder:e.$t("group_name"),hint:e.message},{append:(0,o.w5)((()=>[!e.new_model["validate"]||e.new_model["required_error"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[e.new_model["validate"]?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)((0,a.zw)(e.message),1)],64)),e.new_model["required_error"]?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Uk)((0,a.zw)(e.$t("field_required")),1)],64)):(0,o.kq)("",!0)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["class","modelValue","placeholder","hint"])])]),(0,o._)("div",ye,[(0,o._)("div",ve,[(0,o.Wm)(h,{modelValue:e.new_model["description"],"onUpdate:modelValue":s[1]||(s[1]=s=>e.new_model["description"]=s),outlined:"",type:"textarea",autogrow:"",placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])])])),_:1}),(0,o.Wm)(_,{align:"right"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(u,{label:e.$t("cancel"),class:"highlighted-back"},null,8,["label"]),[[b]]),(0,o.Wm)(u,{type:"submit",color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,o.Wm)(w,{showing:e.loading},{default:(0,o.w5)((()=>[Ce])),_:1},8,["showing"])])),_:1})}var We=t(29938),qe=function(e,s,t,o){function a(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,l){function r(e){try{n(o.next(e))}catch(s){l(s)}}function i(e){try{n(o["throw"](e))}catch(s){l(s)}}function n(e){e.done?t(e.value):a(e.value).then(r,i)}n((o=o.apply(e,s||[])).next())}))};const Ue=(0,o.aZ)({el:"#app",mixins:[C.Z],props:{},components:{},data(){return{message:this.$t("only_characters")}},setup(){let e={};const s=(0,T.zI)(),{createGroup:t}=s;return{createGroup:t,new_model:(0,O.iH)(e),loading:(0,O.iH)(!1)}},watch:{},mounted(){this.setNewModel()},methods:{setNewModel(){this.new_model["name"]="",this.new_model["description"]="",this.new_model["validate"]=!0,this.new_model["required_error"]=!1},submitNewColumFrom(){return qe(this,void 0,void 0,(function*(){try{if(!this.validateRow(this.new_model))return;this.loading=!0,yield this.saveNewRow()}catch(e){if(e&&e.response&&e.response.data&&e.response.data.message)return void this.showErrorToast(e.response.data.message);if(null!=e&&"object"==typeof e&&e.hasOwnProperty("message"))return void this.showErrorToast(e.message);this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},saveNewRow(){return qe(this,void 0,void 0,(function*(){const e={name:this.new_model["name"],description:this.new_model["description"]};yield this.createGroup(e),this.setNewModel();const s=new CustomEvent("group_added",{});document.dispatchEvent(s),this.showSuccessToast("Group Created successfully")}))},validateRow(e){let s=!0;return e["name"]&&0!=e["name"].length?(0,We.x7)(e["name"])?s:(e.validate=!1,!1):(e.required_error=!0,!1)}}});var Ie=t(5363),Ze=t(66941);const xe=(0,E.Z)(Ue,[["render",ke]]),Te=xe;te()(Ue,"components",{QCard:j.Z,QToolbar:M.Z,QToolbarTitle:F.Z,QBtn:G.Z,QCardSection:B.Z,QInput:P.Z,QIcon:V.Z,QTooltip:Ie.Z,QCardActions:X.Z,QInnerLoading:Ze.Z}),te()(Ue,"directives",{ClosePopup:ee.Z});var Re=t(13873),Oe=t(28239),Se=function(e,s,t,o){function a(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,l){function r(e){try{n(o.next(e))}catch(s){l(s)}}function i(e){try{n(o["throw"](e))}catch(s){l(s)}}function n(e){e.done?t(e.value):a(e.value).then(r,i)}n((o=o.apply(e,s||[])).next())}))};const Qe=(0,o.aZ)({el:"#app",mixins:[C.Z],components:{SubHeader:Re.Z,ManageUser:ae,Permissions:_e,CreateGroup:Te},data(){return{dialog:!1}},mounted(){try{this.getPermissionsData(),this.setSettings();const e=(0,T.zI)();e.$subscribe(((e,s)=>{this.prepareColumns(),this.prepareRows()}))}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}document.addEventListener("group_added",this.groupAdded)},methods:{saveSetting(e,s){return Se(this,void 0,void 0,(function*(){try{this.processing=!0,yield(0,Oe.AF)(e,s),this.setSettings(),yield Z.W1.fetch()}catch(t){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}}))},setSettings(){const e=(0,Oe.$8)("GROUP_PERMISSION_ACTIVATED"),s=["true",!0];this.settings_model["GROUP_PERMISSION_ACTIVATED"]=!!s.includes(e)},groupAdded(){this.display_create_group_dialog=!1},deleteGroup(){try{if(!this.delete_id)return;this.deleteGroupById(this.delete_id)}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.processing=!1}},viewPermissions(e){this.selectedGroupId=e.group_id,this.display_permissions_dialog=!0},manageUsers(e){this.selectedGroupId=e.group_id,this.selectedGroupName=e.group_name,this.display_users_dialog=!0},prepareColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"group_name",label:this.$t("group_name"),field:"group_name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareRows(){if(this.groups){this.rows=[];for(let[e,s]of Object.entries(this.groups)){const e=s;this.addNewRow(e)}}},addNewRow(e){let s=Object.assign({},e);return this.rows.push(s),this.rows.length.toString()}},setup(){const e=(0,T.zI)(),{getPermissionsData:s,deleteGroupById:t}=e,{groups:o,processing:a}=(0,v.Jk)(e);return{settings_model:(0,O.iH)({GROUP_PERMISSION_ACTIVATED:!1}),groups:o,processing:a,deleteGroupById:t,getPermissionsData:s,display_users_dialog:(0,O.iH)(!1),display_permissions_dialog:(0,O.iH)(!1),display_create_group_dialog:(0,O.iH)(!1),columns:(0,O.iH)([]),rows:(0,O.iH)([]),selectedGroupId:(0,O.iH)(""),selectedGroupName:(0,O.iH)(""),deleteConfirm:(0,O.iH)(!1),delete_id:(0,O.iH)("")}}});var Ne=t(27011),De=t(60429),Ee=t(65869),$e=t(28886),Pe=t(75096);const Ve=(0,E.Z)(Qe,[["render",y]]),He=Ve;te()(Qe,"components",{QBtn:G.Z,QIcon:V.Z,QList:Ne.Z,QExpansionItem:De.Z,QSpace:H.Z,QSeparator:Ee.Z,QCard:j.Z,QCardSection:B.Z,QToggle:$e.Z,QTable:$.Z,QTd:A.Z,QTooltip:Ie.Z,QDialog:z.Z,QAvatar:Pe.Z,QCardActions:X.Z,QToolbar:M.Z,QToolbarTitle:F.Z,QInnerLoading:Ze.Z}),te()(Qe,"directives",{ClosePopup:ee.Z})}}]);