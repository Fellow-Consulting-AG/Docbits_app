"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[7717],{57717:(e,t,s)=>{s.r(t),s.d(t,{default:()=>kt});var o=s(83673),a=s(62323);const i=e=>((0,o.dD)("data-v-de4633ec"),e=e(),(0,o.Cn)(),e),l={key:0,class:"row highlighted-back q-pl-md q-pr-md q-pb-md"},r={key:1,class:"row highlighted-back q-pr-md q-pb-md q-mt-lg"},d={class:"col-sm-3 col-lg-3 q-pl-sm",id:"left_section",ref:"left_section"},n={class:"full-width q-ma-sm scroll-area-height"},c={class:"image_control_panel"},u={class:"row"},m={class:"q-mr-auto"},h={class:"cursor-pointer"},p={key:0,class:"back-white q-pa-md"},_={class:"row"},g={class:"q-mr-auto"},w={class:"text-h6 text-weight-bold"},v={class:"panel-right"},f={class:"text-h6 text-weight-bold"},y={class:"row"},k={class:"q-mr-auto ml-30"},b=i((()=>(0,o._)("div",{class:"panel-right"},null,-1))),C={class:"row float-right"},q={class:"q-pl-md q-pr-md full-width"},x={class:"col-sm-6 col-lg-6 q-pl-sm"},R={class:"full-width q-ma-sm scroll-area-height"},L={class:"image_control_panel"},W={class:"row"},z={class:"q-mr-auto"},D={class:"page-numbers"},I={class:"panel-middle"},$={class:"panel-right"},E={class:"doc-name"},A={class:"q-my-sm"},V={class:"row"},U={class:"q-mr-sm"},S={key:0,class:"row q-ml-sm",style:{"margin-top":"5px"}},T={key:1,style:{"margin-top":"3px"},class:"row"},H={class:"row q-ml-sm back-white custom-border",style:{width:"138px"}},M=["src"],F=["src"],O={class:"full-width back-white",id:"image_container",style:{height:"92.4%"}},Z={class:"full-width full-height q-pa-sm scrolle-y",id:"image_scrolle",style:{position:"relative"}},N={class:"col-sm-3 col-lg-3 q-pl-sm"},Q={class:"full-width q-ma-sm scroll-area-height"},P=i((()=>(0,o._)("div",{class:"image_control_panel",style:{"margin-bottom":"-3px"}},null,-1))),j={class:"full-width back-white",style:{height:"96%","margin-top":"3px"}},B={class:"full-width full-height q-pa-sm scrolle-y",style:{position:"relative"}},Y={class:"row q-pt-sm"},G={class:"secondary-c-text text-h6 text-weight-bold"},J={class:"row full-width"},K={class:"row full-width"},X={class:"col-md-12"},ee={class:"row full-width"},te={class:"col-md-12"},se={class:"row full-width"},oe={class:"col-md-6"},ae={class:"col-md-6 pl-20"},ie={class:"row full-width"},le={class:"col-md-4"},re={class:"col-md-4 pl-20"},de={class:"col-md-4 pl-20"},ne=i((()=>(0,o._)("div",{class:"border-top-bdbdbd q-mt-md q-mb-md"},null,-1))),ce={class:"row full-width"},ue={class:"row full-width"},me={class:"col-md-12"},he={class:"row full-width"},pe={class:"col-md-12"},_e={class:"row full-width"},ge={class:"col-md-12"},we=i((()=>(0,o._)("div",{class:"border-top-bdbdbd q-mt-md q-mb-md"},null,-1))),ve={class:"row full-width"},fe={class:"row full-width"},ye={class:"col-md-12"},ke={class:"row q-pt-sm"},be={class:"secondary-c-text text-h6 text-weight-bold"},Ce=i((()=>(0,o._)("div",{class:"border-top-bdbdbd q-mt-md q-mb-md"},null,-1))),qe={class:"row full-width"};function xe(e,t,s,i,xe,Re){const Le=(0,o.up)("ErrorDocumentView"),We=(0,o.up)("q-icon"),ze=(0,o.up)("q-btn"),De=(0,o.up)("DocumentLogs"),Ie=(0,o.up)("q-tooltip"),$e=(0,o.up)("q-separator"),Ee=(0,o.up)("q-item-section"),Ae=(0,o.up)("q-item"),Ve=(0,o.up)("q-list"),Ue=(0,o.up)("q-menu"),Se=(0,o.up)("AnnotationView"),Te=(0,o.up)("q-input"),He=(0,o.up)("q-select"),Me=(0,o.up)("Loader"),Fe=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[e.error?((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(Le)])):((0,o.wg)(),(0,o.iD)("div",r,[(0,o._)("div",d,[(0,o._)("div",n,[(0,o._)("div",c,[(0,o._)("div",u,[(0,o._)("div",m,[(0,o._)("span",{class:"cursor-pointer doc-name text-uppercase",onClick:t[0]||(t[0]=(...t)=>e.routeToListPendingApproval&&e.routeToListPendingApproval(...t))},[(0,o.Wm)(We,{class:"cursor-pointer",onClick:e.nextImage,color:"primary",name:"chevron_left",size:"sm"},null,8,["onClick"]),(0,o.Uk)(" "+(0,a.zw)(e.$t("pending_approval_list")),1)]),(0,o._)("span",h," - "+(0,a.zw)(e.pending_approval_doc_count)+" "+(0,a.zw)(e.$t("invoices_for_release")),1)])])]),e.isModelReady()?((0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("div",_,[(0,o._)("div",g,[(0,o._)("span",w,[e.prev_record?((0,o.wg)(),(0,o.j4)(We,{key:0,class:"cursor-pointer",name:"navigate_before",size:"sm",onClick:t[1]||(t[1]=t=>e.routeTo("prev"))})):(0,o.kq)("",!0),e.readonlyModel["total_amount"]?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Uk)((0,a.zw)(e.readonlyModel["total_amount"].formatted_value),1)],64)):(0,o.kq)("",!0)])]),(0,o._)("div",v,[(0,o._)("span",f,[e.readonlyModel["invoice_date"]?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)((0,a.zw)(e.readonlyModel["invoice_date"].formatted_value),1)],64)):(0,o.kq)("",!0),e.next_record?((0,o.wg)(),(0,o.j4)(We,{key:1,class:"cursor-pointer",name:"navigate_next",size:"sm",onClick:t[2]||(t[2]=t=>e.routeTo("next"))})):(0,o.kq)("",!0)])])]),(0,o._)("div",y,[(0,o._)("div",k,[e.readonlyModel["payment_terms"]?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)((0,a.zw)(e.readonlyModel["payment_terms"].formatted_value),1)],64)):(0,o.kq)("",!0)]),b])])):(0,o.kq)("",!0),(0,o._)("div",C,[(0,o.Wm)(ze,{round:"",icon:"chevron_left",style:{"margin-right":"-12px"},size:"xs",class:"highlighted-back",onClick:t[3]||(t[3]=t=>e.toggleMenu())})]),(0,o._)("div",q,[(0,o.Wm)(De,{docId:e.docId,list_data:e.doc_logs},null,8,["docId","list_data"])])])],512),(0,o._)("div",x,[(0,o._)("div",R,[(0,o._)("div",L,[(0,o._)("div",W,[(0,o._)("div",z,[(0,o.Wm)(We,{class:"up-arrow cursor-pointer",onClick:e.prevImage,name:"expand_less",size:"sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(Ie,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("previous")),1)])),_:1})])),_:1},8,["onClick"]),(0,o.Wm)(We,{class:"down-arrow cursor-pointer",onClick:e.nextImage,name:"expand_more",size:"sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(Ie,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("next")),1)])),_:1})])),_:1},8,["onClick"]),(0,o._)("span",D,(0,a.zw)(e.currentPage())+"/"+(0,a.zw)(e.images.length)+" "+(0,a.zw)(e.$t("page_number_text")),1)]),(0,o._)("div",I,[(0,o._)("span",null,[e.second_approval?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)((0,a.zw)(e.$t("second_approval")),1)],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Uk)((0,a.zw)(e.$t("first_approval")),1)],64))])]),(0,o._)("div",$,[(0,o._)("span",{class:"cursor-pointer q-mr-md text-uppercase",onClick:t[4]||(t[4]=(...t)=>e.downloadFile&&e.downloadFile(...t))},(0,a.zw)(e.$t("download")),1),(0,o._)("span",E,(0,a.zw)(e.record.filename),1)])])]),(0,o._)("div",A,[(0,o._)("div",V,[(0,o._)("div",U,[(0,o.Wm)(ze,{dense:"",class:"q-mr-sm q-pa-sm custom-border back-white",flat:"",onClick:t[5]||(t[5]=t=>{e.showStampMenu=!0,e.showFontMenu=!1,e.screenmode="stamp"})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{name:"img:annotation/stamp_icon.svg",class:"icon-grey-svg"}),(0,o.Wm)(Ie,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("annotation.stamp_annotation")),1)])),_:1})])),_:1}),(0,o.Wm)(ze,{dense:"",flat:"",class:"q-pa-sm custom-border back-white",onClick:t[6]||(t[6]=t=>{e.showFontMenu=!0,e.showStampMenu=!1,e.screenmode="annotate"})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{name:"text_format",class:"icon-grey"}),(0,o.Wm)(Ie,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.$t("annotation.text_annotation")),1)])),_:1})])),_:1})]),(0,o.Wm)($e,{vertical:""}),(0,o._)("div",null,[e.showFontMenu?((0,o.wg)(),(0,o.iD)("div",S,[(0,o._)("div",null,[(0,o.Wm)(ze,{flat:"",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[7]||(t[7]=t=>{e.selectColor="#000000",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{size:"22px",color:"black",name:"title"})])),_:1}),(0,o.Wm)(ze,{flat:"",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[8]||(t[8]=t=>{e.selectColor="#f44336",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{size:"22px",color:"red",name:"title"})])),_:1}),(0,o.Wm)(ze,{flat:"",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[9]||(t[9]=t=>{e.selectColor="#4caf50",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{size:"22px",color:"green",name:"title"})])),_:1}),(0,o.Wm)(ze,{flat:"",class:"back-white custom-border q-mr-sm",dense:"",onClick:t[10]||(t[10]=t=>{e.selectColor="#2196f3",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{size:"22px",color:"blue",name:"title"})])),_:1}),(0,o.Wm)(ze,{flat:"",class:"back-white custom-border",dense:"",onClick:t[11]||(t[11]=t=>{e.selectColor="#ffeb3b",this.$refs.child_comp.createAnnotationFromColorShortcut(e.selectColor)})},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{size:"22px",color:"yellow",name:"title"})])),_:1})])])):(0,o.kq)("",!0),e.showStampMenu?((0,o.wg)(),(0,o.iD)("div",T,[(0,o._)("div",H,[(0,o._)("img",{class:"q-px-sm",src:e.stampToShow,style:{width:"100px"}},null,8,M),(0,o.Wm)(ze,{dense:"",flat:"",style:{"margin-left":"3px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(We,{name:"expand_more",class:"icon-grey"}),(0,o.Wm)(Ue,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Ve,{style:{"min-width":"80px"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.stamps,(t=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(Ae,{key:t,clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(Ee,{onClick:s=>e.stampToShow=t},{default:(0,o.w5)((()=>[(0,o._)("img",{width:"80",src:t},null,8,F)])),_:2},1032,["onClick"])])),_:2},1024)),[[Fe]]))),128))])),_:1})])),_:1})])),_:1})]),(0,o.Wm)(ze,{label:e.$t("doc2light.pages.add"),class:"q-ml-sm",color:"primary",unelevated:"",onClick:t[12]||(t[12]=t=>this.$refs.child_comp.addTemplateAnnotation(e.stampToShow))},null,8,["label"])])):(0,o.kq)("",!0)])])]),(0,o._)("div",O,[(0,o._)("div",Z,[(0,o.Wm)(Se,{ref:"child_comp",enableEditing:e.enable_editing,cropUrl:e.image,width:e.imageWidth,screenmode:e.screenmode,selectFont:e.selectFont,selectFontSize:e.selectFontSize,selectColor:e.selectColor,onLoad:e.getImageDetails},null,8,["enableEditing","cropUrl","width","screenmode","selectFont","selectFontSize","selectColor","onLoad"])])])])]),(0,o._)("div",N,[(0,o._)("div",Q,[P,(0,o._)("div",j,[(0,o._)("div",B,[(0,o._)("div",Y,[(0,o._)("span",G,(0,a.zw)(e.$t("auto_detect")),1)]),e.isModelReady()?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",J,[(0,o._)("div",K,[(0,o._)("div",X,[(0,o._)("div",null,(0,a.zw)(e.$t("belegtyp")),1),(0,o._)("div",null,[e.record.doc_type?((0,o.wg)(),(0,o.j4)(Te,{key:0,outlined:"","data-name":e.doc_type,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.record.doc_type,"onUpdate:modelValue":t[13]||(t[13]=t=>e.record.doc_type=t)},null,8,["data-name","modelValue"])):(0,o.kq)("",!0)])])]),(0,o._)("div",ee,[(0,o._)("div",te,[(0,o._)("div",null,(0,a.zw)(e.$t("payment_terms")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.payment_terms,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.readonlyModel["payment_terms"].formatted_value,"onUpdate:modelValue":t[14]||(t[14]=t=>e.readonlyModel["payment_terms"].formatted_value=t)},null,8,["data-name","modelValue"])])])]),(0,o._)("div",se,[(0,o._)("div",oe,[(0,o._)("div",null,(0,a.zw)(e.$t("invoice_date")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.invoice_date,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.readonlyModel["invoice_date"].formatted_value,"onUpdate:modelValue":t[15]||(t[15]=t=>e.readonlyModel["invoice_date"].formatted_value=t)},null,8,["data-name","modelValue"])])]),(0,o._)("div",ae,[(0,o._)("div",null,(0,a.zw)(e.$t("order_date")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.order_date,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.readonlyModel["order_date"].formatted_value,"onUpdate:modelValue":t[16]||(t[16]=t=>e.readonlyModel["order_date"].formatted_value=t)},null,8,["data-name","modelValue"])])])]),(0,o._)("div",ie,[(0,o._)("div",le,[(0,o._)("div",null,(0,a.zw)(e.$t("total_amount")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.total_amount,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.readonlyModel["total_amount"].formatted_value,"onUpdate:modelValue":t[17]||(t[17]=t=>e.readonlyModel["total_amount"].formatted_value=t)},null,8,["data-name","modelValue"])])]),(0,o._)("div",re,[(0,o._)("div",null,(0,a.zw)(e.$t("currency")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.currency,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.readonlyModel["currency"].formatted_value,"onUpdate:modelValue":t[18]||(t[18]=t=>e.readonlyModel["currency"].formatted_value=t)},null,8,["data-name","modelValue"])])]),(0,o._)("div",de,[(0,o._)("div",null,(0,a.zw)(e.$t("tax_amount")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.tax_amount,disable:!0,class:(0,a.C_)("input-field full-width"),modelValue:e.readonlyModel["tax_amount"].formatted_value,"onUpdate:modelValue":t[19]||(t[19]=t=>e.readonlyModel["tax_amount"].formatted_value=t)},null,8,["data-name","modelValue"])])])])]),ne,(0,o._)("div",ce,[(0,o._)("div",ue,[(0,o._)("div",me,[(0,o._)("div",null,(0,a.zw)(e.$t("notes")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.notes,class:(0,a.C_)("full-width"),modelValue:e.model["notes"],"onUpdate:modelValue":[t[20]||(t[20]=t=>e.model["notes"]=t),t[21]||(t[21]=t=>{e.inputValueChanges("notes",t)})],type:"textarea",autogrow:""},null,8,["data-name","modelValue"])])])]),(0,o._)("div",he,[(0,o._)("div",pe,[(0,o._)("div",null,(0,a.zw)(e.$t("kostenstelle")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.kostenstelle,class:(0,a.C_)("input-field full-width"),modelValue:e.model["kostenstelle"],"onUpdate:modelValue":[t[22]||(t[22]=t=>e.model["kostenstelle"]=t),t[23]||(t[23]=t=>{e.inputValueChanges("kostenstelle",t)})]},null,8,["data-name","modelValue"])])])]),(0,o._)("div",_e,[(0,o._)("div",ge,[(0,o._)("div",null,(0,a.zw)(e.$t("kostentrager")),1),(0,o._)("div",null,[(0,o.Wm)(Te,{outlined:"","data-name":e.kostentrager,class:(0,a.C_)("input-field full-width"),modelValue:e.model["kostentrager"],"onUpdate:modelValue":[t[24]||(t[24]=t=>e.model["kostentrager"]=t),t[25]||(t[25]=t=>{e.inputValueChanges("kostentrager",t)})]},null,8,["data-name","modelValue"])])])])]),we,(0,o._)("div",ve,[(0,o._)("div",fe,[(0,o._)("div",ye,[(0,o._)("div",null,(0,a.zw)(e.$t("releases_person")),1),(0,o._)("div",null,[(0,o.Wm)(He,{"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",onFilter:e.filterUserList,tabindex:"0",class:(0,a.C_)("input-field full-width"),modelValue:e.model["assigned_to"],"onUpdate:modelValue":[t[26]||(t[26]=t=>e.model["assigned_to"]=t),t[27]||(t[27]=t=>{e.inputValueChanges("assigned_to",t)})],"error-message":"Field is required",error:e.assign_user_error,options:e.usersList,"emit-value":"","map-options":""},null,8,["onFilter","modelValue","error","options"])])])])]),(0,o._)("div",ke,[(0,o._)("span",be,(0,a.zw)(e.$t("release")),1)]),Ce,(0,o._)("div",qe,[(0,o.Wm)(ze,{color:"primary",label:e.$t("save"),class:"full-width q-mb-sm",onClick:e.saveData},null,8,["label","onClick"]),(0,o.Wm)(ze,{color:"primary",label:e.$t("request_release"),class:"full-width q-mb-sm",onClick:e.acceptRequest},null,8,["label","onClick"]),(0,o.Wm)(ze,{flat:"",style:{color:"red"},label:e.$t("reject"),class:"full-width",onClick:e.rejectRequest},null,8,["label","onClick"])])],64)):(0,o.kq)("",!0)])])])])])),(0,o.Wm)(Me)],64)}var Re=s(30052),Le=s.n(Re),We=s(77378),ze=s(61959),De=s(29938),Ie=s(72113),$e=s(48825),Ee=s(60727),Ae=s(45401),Ve=s(54268);const Ue=e=>((0,o.dD)("data-v-ed8e6c98"),e=e(),(0,o.Cn)(),e),Se={class:"activity-logs left-scroll-area-height scrolle-y"},Te=(0,o.Uk)(" Commnet required "),He=Ue((()=>(0,o._)("img",{width:"36",src:"send_msg.svg"},null,-1))),Me=Ue((()=>(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1)));function Fe(e,t,s,i,l,r){const d=(0,o.up)("q-avatar"),n=(0,o.up)("q-item-section"),c=(0,o.up)("timeago"),u=(0,o.up)("q-item-label"),m=(0,o.up)("q-item"),h=(0,o.up)("q-tooltip"),p=(0,o.up)("q-icon"),_=(0,o.up)("q-input"),g=(0,o.up)("q-list"),w=(0,o.up)("q-inner-loading");return(0,o.wg)(),(0,o.iD)("div",Se,[(0,o.Wm)(g,{class:"full-width"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.logs,(t=>((0,o.wg)(),(0,o.j4)(m,{key:t.id,class:"q-my-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{color:"primary","text-color":"white"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.avatar_letters),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,{caption:"",lines:"1"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{datetime:t.created_on},null,8,["datetime"]),(0,o.Uk)(" "+(0,a.zw)(e.$t("by"))+" "+(0,a.zw)(t.created_by_name),1)])),_:2},1024),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.action_description),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,{outlined:"","data-name":e.new_message,class:(0,a.C_)("full-width cursor-pointer post_messgae"),modelValue:e.new_message["text"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.new_message["text"]=t),type:"textarea",autogrow:"",placeholder:e.$t("write_comment")},{append:(0,o.w5)((()=>[e.new_message["error"]?((0,o.wg)(),(0,o.j4)(p,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[Te])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(p,{flat:"",dense:"",size:"36px",color:"primary",onClick:e.postComment},{default:(0,o.w5)((()=>[He])),_:1},8,["onClick"])])),_:1},8,["data-name","modelValue","placeholder"])])),_:1})])),_:1})])),_:1}),(0,o.Wm)(w,{showing:e.loading},{default:(0,o.w5)((()=>[Me])),_:1},8,["showing"])])}var Oe=function(e,t,s,o){function a(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function l(e){try{d(o.next(e))}catch(t){i(t)}}function r(e){try{d(o["throw"](e))}catch(t){i(t)}}function d(e){e.done?s(e.value):a(e.value).then(l,r)}d((o=o.apply(e,t||[])).next())}))};const Ze=(0,o.aZ)({el:"#app",mixins:[We.Z,Ae.Z],props:{docId:{type:String,default:""},list_data:{}},components:{},data(){return{}},setup(){return{loading:(0,ze.iH)(!1),logs:(0,ze.iH)([]),new_message:(0,ze.iH)({error:!1,text:""})}},watch:{list_data:{deep:!0,handler:function(e,t){setTimeout((()=>{this.prepareRows(e)}),0)}}},mounted:function(){this.prepareRows(this.list_data)},methods:{prepareRows(e){this.logs=[];for(let[t,s]of Object.entries(e)){let e=s;e.avatar_letters=this.getAvatarLetters(e.created_by_name),this.logs.push(e)}setTimeout((()=>{this.scrollToBottom()}),0),this.logs.reverse()},getAvatarLetters(e){let t="";if(!e)return"-";let s=e.split(" ");if(0===s.length)return"-";void 0!==s[0]&&(t+=s[0].charAt(0));let o=s.length-1;return s.length>=2&&void 0!==s[o]&&(t+=s[o].charAt(0)),t},postComment(){return Oe(this,void 0,void 0,(function*(){try{if(!this.validateData())return;this.loading=!0,this.showLoading();let e,t=new FormData;t.append("action_type","message"),t.append("action_description",this.new_message["text"]);let s=yield(0,Ve.O_)();e=yield Le().post(Ve.hi.update_document_log+this.docId,t,{headers:{Authorization:s}}),!1===e.data.success&&(this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR")),this.showErrorToast(e.data.message)),this.new_message={error:!1,text:""};let o=e.data.data;const a=new CustomEvent("new_log",{detail:o});document.dispatchEvent(a)}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},validateData(){let e=!0;return this.new_message["text"]&&0!=this.new_message["text"].length||(e=!1,this.new_message["error"]=!0),e},scrollToBottom(){let e=document.querySelector(".activity-logs");e&&(e.scrollTop=e.scrollHeight)}}});var Ne=s(74260),Qe=s(27011),Pe=s(83414),je=s(52035),Be=s(75096),Ye=s(2350),Ge=s(64689),Je=s(24554),Ke=s(5363),Xe=s(66941),et=s(17132),tt=s(86115),st=s(7518),ot=s.n(st);const at=(0,Ne.Z)(Ze,[["render",Fe],["__scopeId","data-v-ed8e6c98"]]),it=at;ot()(Ze,"components",{QList:Qe.Z,QItem:Pe.Z,QItemSection:je.Z,QAvatar:Be.Z,QItemLabel:Ye.Z,QInput:Ge.Z,QIcon:Je.Z,QTooltip:Ke.Z,QInnerLoading:Xe.Z,QTable:et.Z,QField:tt.Z});var lt=s(41891),rt=s(49566),dt=s(10321),nt=s(65864),ct=s(12413),ut=function(e,t,s,o){function a(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function l(e){try{d(o.next(e))}catch(t){i(t)}}function r(e){try{d(o["throw"](e))}catch(t){i(t)}}function d(e){e.done?s(e.value):a(e.value).then(l,r)}d((o=o.apply(e,t||[])).next())}))};const mt=document.querySelector.bind(document);let ht;const pt=(0,o.aZ)({el:"#app",mixins:[Ae.Z,We.Z],components:{Loader:Ie.Z,DocumentLogs:it,AnnotationView:ct.Z,ErrorDocumentView:nt.Z},watch:{doc_status:{deep:!0,handler:function(){this.checkValidStatus()}}},data(){return{page:1,docId:"",imageHeight:0,imageWidth:0,showArticlePage:!1,loading:!1,enableExportButton:!1,allowedDoctypes:lt.rf,filter_status:"validated_pending_approval",readonly_model_required_fields:["currency","tax_amount","invoice_date","payment_terms","invoice_date","order_date","total_amount"],model_required_fields:["kostenstelle","kostentrager","notes","assigned_to"]}},beforeRouteLeave:function(e,t,s){this.record={},s()},mounted:function(){let e=this.$route.params.id;this.getDocAnnotations(e),window.addEventListener("resize",this.windowResize),document.body.addEventListener("click",this.mouseClicked,!0),window.rda=this,this.init(),document.addEventListener("new_log",this.addNewLog);for(let t=1;t<=80;t++)this.fontSizes.push(t.toString()+"pt")},unmounted:function(){window.removeEventListener("resize",this.windowResize),document.removeEventListener("new_log",this.addNewLog)},methods:{init(){return ut(this,void 0,void 0,(function*(){this.isSecondApproval();const e=(!0).toString();"true"===e.toLowerCase()&&(this.$route.params.id||this.$router.push("/dashboard"),this.doc2AppMode=!0),this.second_approval&&(this.filter_status="approved_pending_second_approval"),this.docId=this.$route.params.id,this.initRequiredFields(),yield this.getInvoiceDataByDocId(this.docId),this.renderDocumentLog(),this.renderPendingRecordsCountView(),this.renderNextPrevLinkBtns(),yield this.makeReadOnlyModel(),yield this.makeEditableModel(),this.getAssignToUsers(),lt.at.includes(this.record.status)&&(this.isReadOnly=!0),this.handleImageBaseURL(),this.image=this.baseUrl+"/"+(0,rt.Rl)(this.record.images[0].path),this.images=(0,rt.PN)(this.record.images);let t=mt("#image_container");this.imageWidth=t.offsetWidth,this.imageHeight=t.offsetHeight,this.getImageDetails()}))},isSecondApproval(){this.$route.params.second_approval&&"true"===this.$route.params.second_approval&&(this.second_approval=!0)},getInvoiceDataByDocId(e){return ut(this,void 0,void 0,(function*(){try{if(yield this.getDocumentById(e),!this.record.doc_id)return void this.showErrorToast(this.$t("pages.messages.INVALID_DOCUMENT"))}catch(t){return void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}}))},initRequiredFields(){this.readonly_model_required_fields.forEach(((e,t)=>{let s=this.createEmptyField(e,"text");this.readonlyModel[e]=s})),this.model_required_fields.forEach(((e,t)=>{this.model[e]=""}))},makeReadOnlyModel(){return new Promise(((e,t)=>{let s={};if(void 0!==this.record){this.record.fields.forEach(((e,t)=>{s[e.name]=e}));let e=[];e=this.record.layout.groups,e.forEach(((e,t)=>{e.rows.forEach(((e,t)=>{e.forEach(((e,t)=>{let o=e.field_name,a=s[o];a||(a=this.createEmptyField(o,e.input_type)),this.readonlyModel[o]=a,this.readOnlyfieldsDef[o]=e}))}))}))}e("done")}))},makeEditableModel(){return new Promise(((e,t)=>{if(void 0!==this.record){for(const[e,t]of Object.entries(this.record))this.model[e]=t;this.setPrevAssignee()}e("done")}))},setPrevAssignee(){this.prev_assignee=this.record.assigned_to},createEmptyField(e,t){let s="checkbox"!=t&&"";return{confidence:0,name:e,value:s,formatted_value:s,content:s}},getAssignToUsers(){return ut(this,void 0,void 0,(function*(){yield this.dropdownStore.prepareUsersDropdown(),this.usersList=this.dropdownStore.usersList}))},filterUserList(e,t,s){try{if(""===e)return void t((()=>{this.usersList=this.dropdownStore.usersList}));t((()=>{const t=e.toLowerCase();this.usersList=this.dropdownStore.usersList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}))}catch(o){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR")),s()}},getUserFullName(e){let t=this.dropdownStore.usersList.filter((t=>t.value==e));return t.first_name+" "+t.last_name},isModelReady(){return 0!==(0,De.v7)(this.model)},goHelp(){window.open("https://docs.cloudintegration.eu/")},inputValueChanges(e,t){try{this.record[e]=t}catch(s){}},setApiData(e){this.record=e,this.$forceUpdate()},windowResize(){let e=mt("#image_container");this.imageWidth=e.offsetWidth,this.imageHeight=e.offsetHeight,this.$forceUpdate(),setTimeout((()=>{this.getImageDetails()}),20)},getImageDetails(){ht=mt("#screenshot"),ht&&(this.imageWidth=ht.offsetWidth,this.imageHeight=ht.offsetHeight)},currentPage(){return this.page},prevImage(){let e=this.page-1,t=this.getImagePath(e);this.updateImage(e,t)},nextImage(){let e=this.page+1,t=this.getImagePath(e);this.updateImage(e,t)},getImagePath(e){let t="";for(const[s,o]of Object.entries(this.images)){let s=o;s.pageNumber===e&&(t=s.path)}return t},updateImage(e,t){t&&""!==t&&(this.image=this.baseUrl+"/"+(0,rt.Rl)(t),this.page=e)},handleImageBaseURL(){this.record.images[0]&&this.record.images[0].path.match(/doc2/g)&&(this.baseUrl="https://fellowkv2.cloudintegration.eu")},updateApiData(e){e.detail&&(this.record=e.detail)},saveData(){return ut(this,void 0,void 0,(function*(){try{if(this.isReadOnly)return;if(!this.validateData())return;let e=this.record;this.showLoading();let t,s=new FormData;s.append("data",JSON.stringify(e));let o=yield(0,Ve.O_)();t=yield Le().post(Ve.hi.save_document+this.docId,s,{headers:{Authorization:o}}),!1===t.data.success?(this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR")),this.showErrorToast(t.data.message)):(this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),this.setPrevAssignee()),this.assign_user_error=!1}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},validateData(){let e=!0;return this.record.assigned_to&&0!=this.record.assigned_to.length||(this.assign_user_error=!0,e=!1),e},acceptRequest(){this.updateRequest("approve")},rejectRequest(){this.updateRequest("reject")},updateRequest(e){return ut(this,void 0,void 0,(function*(){try{if(this.isReadOnly)return;this.verifyAssignee()||(yield this.saveData()),this.showLoading();let t,s=new FormData;s.append("request_type",e);let o=yield(0,Ve.O_)();t=yield Le().post(Ve.hi.approve_or_reject_document+this.docId,s,{headers:{Authorization:o}}),!1===t.data.success?(this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR")),this.showErrorToast(t.data.message)):this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(t){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading(),this.$router.push("/dashboard")}}))},verifyAssignee(){let e=!0;return this.prev_assignee!==this.record.assigned_to&&(e=!1),e},addNewLog(e){e&&e.detail&&this.renderDocumentLog()},renderDocumentLog(){return ut(this,void 0,void 0,(function*(){try{yield this.getDocumentLogs()}catch(e){}finally{this.hideLoading()}}))},getDocumentLogs(){return ut(this,void 0,void 0,(function*(){let e;this.doc_logs={};let t=new FormData;t.append("action_type","message");let s=yield(0,Ve.O_)();if(e=yield Le().post(Ve.hi.get_document_log+this.docId,t,{headers:{Authorization:s}}),!e.data)throw{message:"no logs from server"};e.data.forEach((e=>{this.doc_logs[e.id.toString()+"_ID"]=e}))}))},downloadFile(){let e="https://api.docbits.com/resource/document/"+this.docId+"/"+this.docId+".pdf";if(e){var t=document.createElement("a");t.download=this.record.filename,t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},routeToListPendingApproval(){this.removeDashboardFilters(),this.$router.push("/dashboard")},renderPendingRecordsCountView(){return ut(this,void 0,void 0,(function*(){try{let e,t="?filter=current-year&skip=0&limit=100&status="+this.filter_status,s=yield(0,Ve.O_)();if(e=yield Le().get(Ve.hi.get_dashboard_data+t,{headers:{Authorization:s}}),!e.data.documents)throw{message:"no pending documents from server"};this.pending_approval_doc_count=e.data.documents.length,this.pending_approval_doc_count<0&&(this.pending_approval_doc_count=0)}catch(e){}finally{this.hideLoading()}}))},renderNextPrevLinkBtns(){return ut(this,void 0,void 0,(function*(){try{let e,t=yield(0,Ve.O_)();if(e=yield Le().get(Ve.hi.get_next_document+this.docId+"?doc_type="+this.record.doc_type+"&status="+this.filter_status+"&sort_attr=created_on",{headers:{Authorization:t}}),!1===e.data.success)throw{message:"cannot get response related to next or prev record"};e.data.has_next&&e.data.next_id&&(this.next_record=e.data.next_id),e.data.has_previous&&e.data.previous_id&&(this.prev_record=e.data.previous_id)}catch(e){}finally{this.hideLoading()}}))},checkValidStatus(){this.doc_status!==this.filter_status&&(this.error=!0,this.error_message="invalid_status")},routeTo(e){let t="ready-for-approval";this.second_approval&&(t="ready-for-second-approval"),"prev"===e&&this.prev_record&&this.$router.push({path:"/"+t+"/"+this.prev_record,replace:!0}),"next"===e&&this.next_record&&this.$router.push("/"+t+"/"+this.next_record)},updateValue(e,t){"font"==e?this.selectFont=t:"color"==e?this.selectColor=t:"size"==e&&(this.selectFontSize=t)}},setup(){const e=(0,$e.Z)();let t={},s=[];const o=(0,Ee.At)(),a=(0,Ee.H_)(),{getDocumentById:i,getDocAnnotations:l}=a,{record:r,doc_status:d,error:n,error_message:c}=(0,dt.Jk)(a),u=(0,Ee.Ln)(),{removeSavedFilters:m,saveFilters:h}=u;return{removeDashboardFilters:m,savedDashboardFilters:h,doc_status:d,error:n,error_message:c,getDocumentById:i,record:r,dropdownStore:o,fields:t,image:"",images:s,baseUrl:"https://api.docbits.com",isReadOnly:!1,doc2AppMode:(0,ze.iH)(!1),model:(0,ze.iH)({}),fieldsDef:(0,ze.iH)({}),readOnlyfieldsDef:(0,ze.iH)({}),readonlyModel:(0,ze.iH)({}),usersList:(0,ze.iH)([]),prev_assignee:(0,ze.iH)(null),assign_user_error:(0,ze.iH)(!1),doc_logs:(0,ze.iH)({}),pending_approval_doc_count:(0,ze.iH)(0),next_record:(0,ze.iH)(""),prev_record:(0,ze.iH)(""),second_approval:(0,ze.iH)(!1),showNotification(t){e.notify({message:t,color:"primary",position:"top"})},getDocAnnotations:l,showFontMenu:(0,ze.iH)(!0),showStampMenu:(0,ze.iH)(!1),selectColor:(0,ze.iH)("#000000"),selectFont:(0,ze.iH)("Helvetica"),fontlist:["Helvetica","Times New Roman","Arimo","Caladea","Carlito","Cousine","Liberation Serif","Arial"],selectFontSize:(0,ze.iH)(20),fontSizes:[],showDoc:(0,ze.iH)(!1),stampToShow:(0,ze.iH)("annotation/annotation_stamps/approved_stamp_de.svg"),stampSelection:(0,ze.iH)(!1),stamps:["annotation/annotation_stamps/approved_stamp_de.svg","annotation/annotation_stamps/rejected_stamp_de.svg","annotation/annotation_stamps/approved_stamp_en.svg","annotation/annotation_stamps/rejected_stamp_en.svg"],screenmode:(0,ze.iH)("annotate")}}});var _t=s(2165),gt=s(65869),wt=s(20811),vt=s(72448),ft=s(60677);const yt=(0,Ne.Z)(pt,[["render",xe],["__scopeId","data-v-de4633ec"]]),kt=yt;ot()(pt,"components",{QIcon:Je.Z,QBtn:_t.Z,QTooltip:Ke.Z,QSeparator:gt.Z,QMenu:wt.Z,QList:Qe.Z,QItem:Pe.Z,QItemSection:je.Z,QInput:Ge.Z,QSelect:vt.Z,QField:tt.Z,QTable:et.Z}),ot()(pt,"directives",{ClosePopup:ft.Z})}}]);