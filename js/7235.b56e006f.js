"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[7235],{17235:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Je});var o=t(61758),a=t(58790),r=t(29104);const l=e=>((0,o.Qi)("data-v-45f34d20"),e=e(),(0,o.jt)(),e),i={class:"container"},n={class:"row mt-8 mb-25"},d={class:"col-sm-6 col-md-6 col-lg-6",style:{margin:"auto"}},u={class:"col-sm-6 col-md-6 col-lg-6"},c={key:0,class:"row"},p={class:"sorting-container"},m={key:0,class:"sorting-buttons"},g=["data-name","onClick"],h=["data-name","onClick"],_={style:{"text-transform":"capitalize"}},b={style:{"text-transform":"capitalize"}},f={style:{"text-transform":"capitalize"}},w={style:{"text-transform":"capitalize"}},k={class:"text-red-14"},y={class:"q-ml-sm"},v={class:"text-weight-bold"},C={class:"table-container col-sm-12 col-md-12 col-lg-12 min-height-300"},A=l((()=>(0,o.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1)));function F(e,s,t,l,F,q){const I=(0,o.g2)("SubHeader"),T=(0,o.g2)("q-toggle"),x=(0,o.g2)("f-btn"),S=(0,o.g2)("q-th"),L=(0,o.g2)("q-td"),Q=(0,o.g2)("q-item-section"),R=(0,o.g2)("q-item"),U=(0,o.g2)("q-separator"),$=(0,o.g2)("q-list"),E=(0,o.g2)("q-menu"),P=(0,o.g2)("q-btn"),G=(0,o.g2)("q-table"),V=(0,o.g2)("CreateGroup"),K=(0,o.g2)("q-dialog"),O=(0,o.g2)("q-avatar"),N=(0,o.g2)("q-card-section"),D=(0,o.g2)("q-card-actions"),X=(0,o.g2)("q-card"),j=(0,o.g2)("Permissions"),W=(0,o.g2)("q-toolbar-title"),M=(0,o.g2)("q-toolbar"),B=(0,o.g2)("ManageUser"),H=(0,o.g2)("q-inner-loading"),J=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(I,{name:"settings_group_and_roles",label:e.$t("roles_groups"),display_help_link:!0,onSearch:!1},null,8,["label"]),(0,o.Lk)("div",i,[(0,o.Lk)("div",n,[(0,o.Lk)("div",d,[(0,o.eW)((0,a.v_)(e.$t("group_main_setting"))+" ",1),(0,o.bF)(T,{modelValue:e.user_settings["GROUP_PERMISSION_ACTIVATED"],"onUpdate:modelValue":[s[0]||(s[0]=s=>e.user_settings["GROUP_PERMISSION_ACTIVATED"]=s),s[1]||(s[1]=s=>{e.saveSetting("GROUP_PERMISSION_ACTIVATED",s)})]},null,8,["modelValue"])]),(0,o.Lk)("div",u,[(0,o.bF)(x,{class:"float-right",icon:"add",label:e.$t("new"),onClick:s[2]||(s[2]=s=>e.display_create_group_dialog=!0)},null,8,["label"])])]),e.user_settings["GROUP_PERMISSION_ACTIVATED"]?((0,o.uX)(),(0,o.CE)("div",c,[(0,o.bF)(G,{style:{width:"100%"},class:"page-height-100-135 back-white groups-table",rows:e.rows,columns:e.columns,"no-data-label":e.$t("pages.messages.no_record_found"),"row-key":"name","hide-bottom":"",flat:"","table-header-class":"table-header-text","rows-per-page-options":[0]},{"header-cell":(0,o.k6)((s=>[(0,o.bF)(S,{props:s},{default:(0,o.k6)((()=>[(0,o.Lk)("div",p,[(0,o.Lk)("span",{class:(0,a.C4)("action"==s.col.name?"action-cell":"")},(0,a.v_)(s.col.label),3),"group_name"==s.col.name?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("span",{class:(0,a.C4)(["up-arrow absolute",e.sort_by==s.col.field&&"asc"==e.sort_order?"selected":""]),"data-name":s.col.field,"data-direction":"asc",onClick:t=>e.sortTable(s.col.field,"asc")},null,10,g),(0,o.Lk)("span",{class:(0,a.C4)(["down-arrow absolute",e.sort_by==s.col.field&&"desc"==e.sort_order?"selected":""]),"data-name":s.col.field,"data-direction":"desc",onClick:t=>e.sortTable(s.col.field,"desc")},null,10,h)])):(0,o.Q3)("",!0)])])),_:2},1032,["props"])])),"body-cell-name":(0,o.k6)((e=>[(0,o.bF)(L,{props:e},{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.row.name),1)])),_:2},1032,["props"])])),"body-cell-action":(0,o.k6)((t=>[(0,o.bF)(L,{props:t},{default:(0,o.k6)((()=>[(0,o.bF)(P,{flat:"",dense:"",round:"",onClick:s[3]||(s[3]=(0,r.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,o.k6)((()=>[(0,o.bF)(E,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,o.k6)((()=>[(0,o.bF)($,{dense:"",style:{"max-width":"155px"}},{default:(0,o.k6)((()=>[(0,o.bF)(R,{clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{onClick:s=>e.manageUsers(t.row)},{default:(0,o.k6)((()=>[(0,o.Lk)("span",_,(0,a.v_)(e.$t("pages.settings.manage_users")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.bF)(R,{clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{onClick:s=>e.viewPermissions(t.row)},{default:(0,o.k6)((()=>[(0,o.Lk)("span",b,(0,a.v_)(e.$t("view_permissions")),1)])),_:2},1032,["onClick"])])),_:2},1024),e.user_settings["ACCESS_CONTROL_SETTING"]?((0,o.uX)(),(0,o.Wv)(R,{key:0,clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{onClick:s=>e.viewAccessControl(t.row)},{default:(0,o.k6)((()=>[(0,o.Lk)("span",f,(0,a.v_)(e.$t("view_access_control")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,o.Q3)("",!0),(0,o.bF)(R,{clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{onClick:s=>e.openForm(t.row)},{default:(0,o.k6)((()=>[(0,o.Lk)("span",w,(0,a.v_)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.bF)(U,{inset:""}),(0,o.bF)(R,{clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{onClick:s=>{e.delete_id=t.row.group_id,e.deleteConfirm=!0}},{default:(0,o.k6)((()=>[(0,o.Lk)("span",k,(0,a.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["rows","columns","no-data-label"])])):(0,o.Q3)("",!0)]),(0,o.bF)(K,{modelValue:e.permission_form,"onUpdate:modelValue":s[4]||(s[4]=s=>e.permission_form=s),persistent:"",onKeydown:s[5]||(s[5]=(0,r.jR)((s=>e.permission_form=!1),["esc"]))},{default:(0,o.k6)((()=>[(0,o.bF)(V,{is_edit:!0,name:e.group_edit_name,id:e.group_edit_id},null,8,["name","id"])])),_:1},8,["modelValue"]),(0,o.bF)(K,{modelValue:e.deleteConfirm,"onUpdate:modelValue":s[7]||(s[7]=s=>e.deleteConfirm=s),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(X,null,{default:(0,o.k6)((()=>[(0,o.bF)(N,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,o.k6)((()=>[(0,o.bF)(O,{icon:"warning",color:"primary"})])),_:1}),(0,o.bF)(N,{class:"row items-center"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",y,(0,a.v_)(e.$t("pages.messages.msg_delete")),1)])),_:1}),(0,o.bF)(D,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(x,{appearance:"cancel",label:e.$t("pages.user.cancel")},null,8,["label"]),[[J]]),(0,o.bo)((0,o.bF)(x,{appearance:"negative",label:e.$t("pages.user.done"),onClick:s[6]||(s[6]=s=>e.deleteGroup())},null,8,["label"]),[[J]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(K,{modelValue:e.display_permissions_dialog,"onUpdate:modelValue":s[8]||(s[8]=s=>e.display_permissions_dialog=s),persistent:"",onKeydown:s[9]||(s[9]=(0,r.jR)((s=>e.display_permissions_dialog=!1),["esc"]))},{default:(0,o.k6)((()=>[(0,o.bF)(j,{groupId:e.selectedGroupId},null,8,["groupId"])])),_:1},8,["modelValue"]),(0,o.bF)(K,{modelValue:e.display_create_group_dialog,"onUpdate:modelValue":s[10]||(s[10]=s=>e.display_create_group_dialog=s),persistent:"",onKeydown:s[11]||(s[11]=(0,r.jR)((s=>e.display_create_group_dialog=!1),["esc"]))},{default:(0,o.k6)((()=>[(0,o.bF)(V)])),_:1},8,["modelValue"]),(0,o.bF)(K,{modelValue:e.display_users_dialog,"onUpdate:modelValue":s[12]||(s[12]=s=>e.display_users_dialog=s),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:s[13]||(s[13]=(0,r.jR)((s=>e.display_users_dialog=!1),["esc"]))},{default:(0,o.k6)((()=>[(0,o.bF)(X,{style:{width:"700px","max-width":"1060px",height:"600px"}},{default:(0,o.k6)((()=>[(0,o.bF)(M,{class:"secondary-toolbar text-white"},{default:(0,o.k6)((()=>[(0,o.bF)(W,null,{default:(0,o.k6)((()=>[(0,o.Lk)("span",v,(0,a.v_)(e.selectedGroupName)+" "+(0,a.v_)(e.$t("users")),1)])),_:1}),(0,o.bo)((0,o.bF)(x,{flat:"",round:"",dense:"",icon:"close"},null,512),[[J]])])),_:1}),(0,o.bF)(N,{class:"row items-center q-pb-none"}),(0,o.bF)(N,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",C,[(0,o.bF)(B,{groupId:e.selectedGroupId},null,8,["groupId"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(H,{showing:e.processing},{default:(0,o.k6)((()=>[A])),_:1},8,["showing"])],64)}var q=t(1659),I=t(24622);const T=(0,o.Lk)("img",{class:"img-fluid mb-14 black_to_white",width:"24",height:"24",src:"images/trash-bin-default.svg",alt:""},null,-1),x={class:"text-weight-bold"},S={class:"table-container col-sm-12 col-md-12 col-lg-12"},L={class:"table-container col-sm-12 col-md-12 col-lg-12"};function Q(e,s,t,l,i,n){const d=(0,o.g2)("q-icon"),u=(0,o.g2)("q-input"),c=(0,o.g2)("q-space"),p=(0,o.g2)("f-btn"),m=(0,o.g2)("q-btn"),g=(0,o.g2)("q-td"),h=(0,o.g2)("q-tr"),_=(0,o.g2)("q-table"),b=(0,o.g2)("q-toolbar-title"),f=(0,o.g2)("q-toolbar"),w=(0,o.g2)("q-card-section"),k=(0,o.g2)("q-item-section"),y=(0,o.g2)("q-item"),v=(0,o.g2)("q-select"),C=(0,o.g2)("q-card-actions"),A=(0,o.g2)("q-card"),F=(0,o.g2)("q-dialog"),q=(0,o.g2)("Loader"),I=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(_,{class:"sticky-header-table",rows:e.rows,columns:e.columns,"rows-per-page-options":[0],"row-key":"id",filter:e.filter,"no-data-label":e.$t("pages.messages.no_record_found"),"table-header-class":"back-white",loading:e.loading},{top:(0,o.k6)((()=>[(0,o.bF)(u,{outlined:"",debounce:"300",color:"primary",dense:"",modelValue:e.filter,"onUpdate:modelValue":s[0]||(s[0]=s=>e.filter=s)},{append:(0,o.k6)((()=>[(0,o.bF)(d,{name:"search"})])),_:1},8,["modelValue"]),(0,o.bF)(c),(0,o.bF)(p,{label:e.$t("pages.user.add_user"),onClick:s[1]||(s[1]=s=>e.openUserDlg())},null,8,["label"])])),body:(0,o.k6)((s=>[(0,o.bF)(h,{props:s,id:s.key},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.cols,(t=>((0,o.uX)(),(0,o.CE)(o.FK,{key:t.name},["action"===t.name?((0,o.uX)(),(0,o.Wv)(g,{key:0,style:{width:"30%"}},{default:(0,o.k6)((()=>[(0,o.bF)(m,{size:"18px",class:"float-right","no-caps":"",flat:"",dense:"",onClick:t=>e.unassignUser(s.row.id)},{default:(0,o.k6)((()=>[T])),_:2},1032,["onClick"])])),_:2},1024)):(0,o.Q3)("",!0),"user_name"===t.name?((0,o.uX)(),(0,o.Wv)(g,{key:1,style:{width:"70%"}},{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(s.row.user_name),1)])),_:2},1024)):(0,o.Q3)("",!0)],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","filter","no-data-label","loading"]),(0,o.bF)(F,{modelValue:e.add_users_dialog,"onUpdate:modelValue":s[5]||(s[5]=s=>e.add_users_dialog=s),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:s[6]||(s[6]=(0,r.jR)((s=>e.add_users_dialog=!1),["esc"]))},{default:(0,o.k6)((()=>[(0,o.bF)(A,{style:{width:"700px","max-width":"1060px"}},{default:(0,o.k6)((()=>[(0,o.bF)(f,{class:"text-white secondary-toolbar"},{default:(0,o.k6)((()=>[(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.Lk)("span",x,(0,a.v_)(e.$t("pages.user.add_user")),1)])),_:1}),(0,o.bo)((0,o.bF)(m,{flat:"",round:"",dense:"",icon:"close"},null,512),[[I]])])),_:1}),(0,o.bF)(w,{class:"row items-center q-pb-none"}),(0,o.bF)(w,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",S,[(0,o.bF)(v,{outlined:"",modelValue:e.selectedUserId,"onUpdate:modelValue":s[2]||(s[2]=s=>e.selectedUserId=s),options:this.usersDropdownList,"use-input":"","emit-value":"","map-options":"",onFilter:e.filterUserByName,label:e.$t("select_user")},{"no-option":(0,o.k6)((()=>[(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","label"])])])),_:1}),(0,o.bF)(w,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",L,[(0,o.bF)(v,{outlined:"",modelValue:e.removeFromOtherGroups,"onUpdate:modelValue":s[3]||(s[3]=s=>e.removeFromOtherGroups=s),options:[{value:!1,label:e.$t("form_builder.no")},{value:!0,label:e.$t("form_builder.yes")}],"emit-value":"","map-options":"",label:e.$t("remove_from_other_groups")},null,8,["modelValue","options","label"])])])),_:1}),(0,o.bF)(C,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(m,{label:e.$t("cancel")},null,8,["label"]),[[I]]),(0,o.bF)(m,{onClick:s[4]||(s[4]=s=>e.assigneeGroupToUser()),color:"primary",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(q)],64)}var R=t(45938),U=t(89156),$=t(83319),E=t(18505),P=t(38734),G=t(11470),V=t(73937),K=function(e,s,t,o){function a(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,r){function l(e){try{n(o.next(e))}catch(s){r(s)}}function i(e){try{n(o["throw"](e))}catch(s){r(s)}}function n(e){e.done?t(e.value):a(e.value).then(l,i)}n((o=o.apply(e,s||[])).next())}))};const O=(0,o.pM)({mixins:[E.A,I.A],components:{Loader:U.A},props:{groupId:{type:String,default:""}},data(){return{current_user_id:""}},mounted:function(){this.current_user_id=(0,V.Ky)("id"),this.prepareTableData(),this.dropdownStore.prepareUsersDropdown(),this.dropdownStore.prepareBooleanList()},methods:{prepareTableData(){return K(this,void 0,void 0,(function*(){yield this.getGroupUsers(),this.prepareTableColumns(),this.prepareTableRows()}))},getGroupUsers(){return K(this,void 0,void 0,(function*(){let e=null;this.showLoading();try{if(e=yield G.lr.getGroupUsers(this.groupId),!e)throw e;this.groupUsers=e}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},prepareTableColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"user_name",label:this.$t("name"),field:"user_name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareTableRows(){this.rows=[];for(let e of this.groupUsers)e["user_name"]=e.first_name+" "+e.last_name;this.rows=this.groupUsers},unassignUser(e){return K(this,void 0,void 0,(function*(){this.showLoading();try{yield G.lr.removeUserFromGroup(this.groupId,e.toString());this.removeUser(e),yield this.updateUserPermissions(e),this.showSuccessToast(this.$t("user_removed_from_group"))}catch(s){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}))},removeUser(e){const s=this.rows.findIndex((s=>s.id===e));-1!==s&&this.rows.splice(s,1)},assigneeGroupToUser(){return K(this,void 0,void 0,(function*(){if(this.selectedUserId){this.showLoading();try{yield G.lr.addUserToGroup(this.groupId,this.selectedUserId.toString(),this.removeFromOtherGroups);this.add_users_dialog=!1,this.addNewUser(),yield this.updateUserPermissions(this.selectedUserId),this.showSuccessToast(this.$t("user_added_to_group"))}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}else this.showErrorToast(this.$t("select_user"))}))},addNewUser(){const e=JSON.parse(JSON.stringify(this.dropdownStore.usersMap.get(this.selectedUserId)));e["user_name"]=e.first_name+" "+e.last_name,this.rows.push(e)},openUserDlg(){this.add_users_dialog=!0,this.selectedUserId=null,this.prepareDropdownData()},prepareDropdownData(){this.usersList=[];let e=new Map(JSON.parse(JSON.stringify(Array.from(this.dropdownStore.usersMap))));for(const s of this.rows)e.delete(s.id);e.forEach(((e,s)=>{this.usersList.push({value:s,label:e.first_name+" "+e.last_name})})),this.usersDropdownList=this.usersList},updateUserPermissions(e){return K(this,void 0,void 0,(function*(){this.current_user_id===String(e)&&(yield R.tH.fetch())}))},filterUserByName(e,s){s(""!==e?()=>{const s=e.toLowerCase();this.usersDropdownList=this.usersList.filter((e=>e.label.toLowerCase().indexOf(s)>-1))}:()=>{this.usersDropdownList=this.usersList})}},setup(){const e=(0,P.KR)("");let s=[];const t=(0,P.KR)(s),o=(0,$.cY)();let a=(0,P.KR)([]);return{filter:e,columns:t,usersList:a,dropdownStore:o,rows:(0,P.KR)(s),loading:(0,P.KR)(!1),selectedUserId:(0,P.KR)(),groupUsers:(0,P.KR)([]),add_users_dialog:(0,P.KR)(!1),removeFromOtherGroups:(0,P.KR)(!1),usersDropdownList:(0,P.IJ)([])}}});var N=t(12807),D=t(42315),X=t(67837),j=t(50492),W=t(93676),M=t(44488),B=t(45262),H=t(56384),J=t(82156),z=t(23316),Y=t(36914),Z=t(39150),ee=t(44189),se=t(94940),te=t(90124),oe=t(25173),ae=t(62669),re=t(88672),le=t(98582),ie=t.n(le);const ne=(0,N.A)(O,[["render",Q]]),de=ne;ie()(O,"components",{QTable:D.A,QInput:X.A,QIcon:j.A,QSpace:W.A,QTr:M.A,QTd:B.A,QBtn:H.A,QDialog:J.A,QCard:z.A,QToolbar:Y.A,QToolbarTitle:Z.A,QCardSection:ee.A,QSelect:se.A,QItem:te.A,QItemSection:oe.A,QCardActions:ae.A}),ie()(O,"directives",{ClosePopup:re.A});const ue={class:"text-weight-bold"},ce={class:"row q-pt-lg p-t-0"},pe={class:"col-sm-12 q-pr-sm"},me={key:0},ge={key:1},he={class:"left-actions row items-center"},_e={class:"q-mr-md"},be={class:"right-actions row items-center"};function fe(e,s,t,r,l,i){const n=(0,o.g2)("q-toolbar-title"),d=(0,o.g2)("q-space"),u=(0,o.g2)("q-btn"),c=(0,o.g2)("q-toolbar"),p=(0,o.g2)("q-checkbox"),m=(0,o.g2)("q-th"),g=(0,o.g2)("q-tr"),h=(0,o.g2)("q-td"),_=(0,o.g2)("q-table"),b=(0,o.g2)("q-card-section"),f=(0,o.g2)("q-toggle"),w=(0,o.g2)("f-btn"),k=(0,o.g2)("q-card-actions"),y=(0,o.g2)("q-card"),v=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.Wv)(y,{style:{width:"1060px","max-width":"1060px","max-height":"670px"}},{default:(0,o.k6)((()=>[(0,o.bF)(c,{class:"secondary-toolbar text-white"},{default:(0,o.k6)((()=>[(0,o.bF)(n,null,{default:(0,o.k6)((()=>[(0,o.Lk)("span",ue,(0,a.v_)(e.group_name),1)])),_:1}),(0,o.bF)(d),(0,o.bo)((0,o.bF)(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[v]])])),_:1}),(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",ce,[(0,o.Lk)("div",pe,[(0,o.bF)(_,{class:"roles-sticky-header-table",rows:e.rows,columns:e.columns,"no-data-label":e.$t("pages.messages.no_record_found"),"row-key":"name",flat:"",bordered:"","rows-per-page-options":[0]},{header:(0,o.k6)((s=>[(0,o.bF)(g,{props:s,class:"back-white"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.cols,(t=>((0,o.uX)(),(0,o.Wv)(m,{key:t.name,props:s,class:"back-white"},{default:(0,o.k6)((()=>["document_name"===t.name?((0,o.uX)(),(0,o.CE)("span",me,(0,a.v_)(t.label),1)):((0,o.uX)(),(0,o.CE)("span",ge,[(0,o.bF)(p,{modelValue:e.headerCheckboxs[t.name],"onUpdate:modelValue":[s=>e.headerCheckboxs[t.name]=s,s=>e.columnSelectAll(t.name)]},null,8,["modelValue","onUpdate:modelValue"]),(0,o.eW)(" "+(0,a.v_)(e.$t(t.label)),1)]))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.k6)((t=>[(0,o.bF)(g,{props:t,id:t.key},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.cols,(r=>((0,o.uX)(),(0,o.CE)(o.FK,{key:r.name},["document_name"===r.name?((0,o.uX)(),(0,o.Wv)(h,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(t.row.document_name.replaceAll("_"," ")),1)])),_:2},1024)):((0,o.uX)(),(0,o.Wv)(h,{key:1},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:t.row.acls[r.name],"onUpdate:modelValue":[e=>t.row.acls[r.name]=e,s[0]||(s[0]=s=>e.onRowCheckboxChange())]},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","no-data-label"])])])])),_:1}),(0,o.bF)(k,{class:"actions-container q-pa-md"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",he,[(0,o.bF)(f,{dense:"",class:"q-mr-sm",modelValue:e.onlyAssignedDocs,"onUpdate:modelValue":s[1]||(s[1]=s=>e.onlyAssignedDocs=s)},null,8,["modelValue"]),(0,o.Lk)("span",_e,(0,a.v_)(e.$t("only_assigned_documents")),1)]),(0,o.Lk)("div",be,[(0,o.bo)((0,o.bF)(w,{class:"q-mr-sm",label:e.$t("cancel"),appearance:"cancel"},null,8,["label"]),[[v]]),(0,o.bo)((0,o.bF)(w,{class:"q-mr-md",label:e.$t("save"),onClick:e.savePermissions},null,8,["label","onClick"]),[[v]])])])),_:1})])),_:1})}var we=t(16332),ke=t(85487);const ye=(0,o.pM)({el:"#app",mixins:[I.A],components:{},props:{groupId:{type:String,default:""}},data(){return{}},mounted(){this.group_data=JSON.parse(JSON.stringify(this.getPermissionsByGroupId(this.groupId))),this.setGroupName(),this.prepareColumns(),this.preparePermissionList(),this.prepareHeaderCheckboxs(),this.prepareToggleOnlyAssignedDocs()},methods:{columnSelectAll(e){Array.from(this.rows).forEach((s=>{s.acls[e]=this.headerCheckboxs[e]}))},prepareHeaderCheckboxs(){Array.from(this.rows).forEach((e=>{for(let[s,t]of Object.entries(e.acls))!0===this.headerCheckboxs[s]&&!1===t&&(this.headerCheckboxs[s]=!1)}))},onRowCheckboxChange(){this.resetHeaderCheckbox(),this.prepareHeaderCheckboxs()},resetHeaderCheckbox(){for(let[e,s]of Object.entries(this.headerCheckboxs))this.headerCheckboxs[e]=!0},setGroupName(){this.group_data&&(this.group_name=this.group_data.group_name)},prepareColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"document_name",label:we.i18n.t("document_type"),field:"document_name",align:"left"})),this.hasPermissins()&&this.prepareHeaderCheckbox()},prepareHeaderCheckbox(){const e=this.group_data.doc_type_permissions[0].acls;for(let[s,t]of Object.entries(e))this.columns.push(Object.assign({},{name:s,label:s,field:s,align:"left"})),this.headerCheckboxs[s]=!0},hasPermissins(){return!(!this.group_data||!Array.isArray(this.group_data.doc_type_permissions)||this.group_data.doc_type_permissions.length<1)},preparePermissionList(){this.hasPermissins()&&(this.rows=[],this.rows=JSON.parse(JSON.stringify(this.group_data.doc_type_permissions)))},savePermissions(){this.editGroup(this.groupId,{only_assigned_documents:this.onlyAssignedDocs,org_id:(0,ke.I)()}),this.saveDocPermissions(this.rows,this.groupId),this.showSuccessToast(this.$t("roles_permission_saved"))},prepareToggleOnlyAssignedDocs(){this.onlyAssignedDocs=this.group_data.only_assigned_documents||!1}},setup(){const e=(0,$.H4)(),{getPermissionsByGroupId:s}=(0,q.bP)(e),{saveDocPermissions:t,editGroup:o}=e;return{saveDocPermissions:t,getPermissionsByGroupId:s,group_data:(0,P.KR)([]),columns:(0,P.KR)([]),rows:(0,P.KR)([]),group_name:(0,P.KR)(""),headerCheckboxs:(0,P.KR)({}),onlyAssignedDocs:(0,P.KR)(!1),editGroup:o}}});var ve=t(57722),Ce=t(80460),Ae=t(66908);const Fe=(0,N.A)(ye,[["render",fe],["__scopeId","data-v-2db7acaa"]]),qe=Fe;ie()(ye,"components",{QCard:z.A,QToolbar:Y.A,QToolbarTitle:Z.A,QSpace:W.A,QBtn:H.A,QCardSection:ee.A,QTable:D.A,QTr:M.A,QTh:ve.A,QCheckbox:Ce.A,QTd:B.A,QCardActions:ae.A,QToggle:Ae.A}),ie()(ye,"directives",{ClosePopup:re.A});const Ie=(0,o.Lk)("span",{class:"text-weight-bold"},null,-1),Te=(0,o.Lk)("span",{class:"text-weight-bold"},null,-1),xe={style:{"margin-bottom":"20px"},class:"row full-width mb-10 mt-8"},Se={class:"full-width"},Le={key:0,class:"row full-width mb-10 mt-8",style:{"margin-bottom":"20px"}},Qe={class:"full-width"},Re=(0,o.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function Ue(e,s,t,l,i,n){const d=(0,o.g2)("q-toolbar-title"),u=(0,o.g2)("q-btn"),c=(0,o.g2)("q-toolbar"),p=(0,o.g2)("q-tooltip"),m=(0,o.g2)("q-icon"),g=(0,o.g2)("q-input"),h=(0,o.g2)("q-card-section"),_=(0,o.g2)("f-btn"),b=(0,o.g2)("q-card-actions"),f=(0,o.g2)("q-inner-loading"),w=(0,o.g2)("q-card"),k=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.Wv)(w,{style:{width:"600px"}},{default:(0,o.k6)((()=>[(0,o.Lk)("form",{onSubmit:s[2]||(s[2]=(0,r.D$)(((...s)=>e.submitNewColumFrom&&e.submitNewColumFrom(...s)),["prevent","stop"]))},[(0,o.bF)(c,{class:"secondary-toolbar"},{default:(0,o.k6)((()=>[e.is_edit?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("pages.user.edit_group")),1),Ie])),_:1})):((0,o.uX)(),(0,o.Wv)(d,{key:1},{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(e.$t("create_group")),1),Te])),_:1})),(0,o.bo)((0,o.bF)(u,{flat:"",round:"",dense:"",icon:"close"},null,512),[[k]])])),_:1}),(0,o.bF)(h,{class:"q-pt-none"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",xe,[(0,o.Lk)("div",Se,[(0,o.bF)(g,{outlined:"",tabindex:"0",class:(0,a.C4)("full-width "+(!e.new_model["validate"]||e.new_model["required_error"]?"column-error-border":"")),modelValue:e.new_model["name"],"onUpdate:modelValue":s[0]||(s[0]=s=>e.new_model["name"]=s),placeholder:e.$t("group_name"),hint:e.message,counter:"",maxlength:"80"},{append:(0,o.k6)((()=>[!e.new_model["validate"]||e.new_model["required_error"]?((0,o.uX)(),(0,o.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{class:"bg-red line-error-tooltip"},{default:(0,o.k6)((()=>[e.new_model["validate"]?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,a.v_)(e.message),1)],64)),e.new_model["required_error"]?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)((0,a.v_)(e.$t("field_required")),1)],64)):(0,o.Q3)("",!0)])),_:1})])),_:1})):(0,o.Q3)("",!0)])),_:1},8,["class","modelValue","placeholder","hint"])])]),e.is_edit?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Le,[(0,o.Lk)("div",Qe,[(0,o.bF)(g,{modelValue:e.new_model["description"],"onUpdate:modelValue":s[1]||(s[1]=s=>e.new_model["description"]=s),outlined:"",type:"textarea",autogrow:"",placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])]))])),_:1}),(0,o.bF)(b,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(_,{label:e.$t("cancel"),appearance:"cancel"},null,8,["label"]),[[k]]),(0,o.bF)(_,{type:"submit",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,o.bF)(f,{showing:e.loading},{default:(0,o.k6)((()=>[Re])),_:1},8,["showing"])])),_:1})}var $e=t(68450),Ee=function(e,s,t,o){function a(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,r){function l(e){try{n(o.next(e))}catch(s){r(s)}}function i(e){try{n(o["throw"](e))}catch(s){r(s)}}function n(e){e.done?t(e.value):a(e.value).then(l,i)}n((o=o.apply(e,s||[])).next())}))};const Pe=(0,o.pM)({el:"#app",mixins:[I.A],props:{is_edit:{type:Boolean,default:!1},name:{type:String||null,default:null},id:{type:String||null,default:null}},components:{},data(){return{message:this.$t("pages.messages.NO_SPACES_SPECIAL_CHARS")}},setup(){let e={};const s=(0,$.H4)(),{createGroup:t,editGroup:o}=s,{getPermissionsByGroupId:a}=(0,q.bP)(s);return{getPermissionsByGroupId:a,createGroup:t,editGroup:o,new_model:(0,P.KR)(e),loading:(0,P.KR)(!1),group_data:(0,P.KR)([])}},watch:{},mounted(){this.setNewModel(),this.is_edit?this.new_model["name"]=this.name:this.new_model["name"]="",this.group_data=JSON.parse(JSON.stringify(this.getPermissionsByGroupId(this.id)))},methods:{setNewModel(){this.new_model["name"]="",this.new_model["description"]="",this.new_model["validate"]=!0,this.new_model["required_error"]=!1},submitNewColumFrom(){return Ee(this,void 0,void 0,(function*(){try{if(!this.validateRow(this.new_model))return;this.loading=!0,this.is_edit?yield this.editExistingRow():yield this.saveNewRow()}catch(e){if(e&&e.response&&e.response.data&&e.response.data.message)return void this.showErrorToast(e.response.data.message);if(null!=e&&"object"==typeof e&&e.hasOwnProperty("message"))return void this.showErrorToast(e.message);this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}finally{this.loading=!1}}))},editExistingRow(){return Ee(this,void 0,void 0,(function*(){const e={name:this.new_model["name"],org_id:(0,ke.I)(),only_assigned_documents:this.group_data.only_assigned_documents};yield this.editGroup(this.id,e),this.setNewModel();const s=new CustomEvent("group_edited",{});document.dispatchEvent(s),this.showSuccessToast(this.$t("pages.messages.GROUP_UPDATED"))}))},saveNewRow(){return Ee(this,void 0,void 0,(function*(){const e={name:this.new_model["name"],description:this.new_model["description"]};yield this.createGroup(e),this.setNewModel();const s=new CustomEvent("group_added",{});document.dispatchEvent(s),this.showSuccessToast("Group Created successfully")}))},validateRow(e){let s=!0;return e["name"]&&0!=e["name"].length?(0,$e.mK)(e["name"])?s:(e.validate=!1,!1):(e.required_error=!0,!1)}}});var Ge=t(97410),Ve=t(39035);const Ke=(0,N.A)(Pe,[["render",Ue]]),Oe=Ke;ie()(Pe,"components",{QCard:z.A,QToolbar:Y.A,QToolbarTitle:Z.A,QBtn:H.A,QCardSection:ee.A,QInput:X.A,QIcon:j.A,QTooltip:Ge.A,QCardActions:ae.A,QInnerLoading:Ve.A}),ie()(Pe,"directives",{ClosePopup:re.A});var Ne=t(77362),De=function(e,s,t,o){function a(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,r){function l(e){try{n(o.next(e))}catch(s){r(s)}}function i(e){try{n(o["throw"](e))}catch(s){r(s)}}function n(e){e.done?t(e.value):a(e.value).then(l,i)}n((o=o.apply(e,s||[])).next())}))};const Xe=(0,o.pM)({el:"#app",mixins:[I.A],components:{SubHeader:Ne.A,ManageUser:de,Permissions:qe,CreateGroup:Oe},data(){return{dialog:!1,permission_form:(0,P.KR)(!1),group_edit_name:(0,P.KR)(""),group_edit_id:(0,P.KR)("")}},mounted(){try{this.getPermissionsData(),this.setSettings();const e=(0,$.H4)();e.$subscribe(((e,s)=>{this.prepareColumns(),this.prepareRows(),this.sortTable("group_name","asc")}))}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}document.addEventListener("group_added",this.groupAdded),document.addEventListener("group_edited",this.groupEdited)},methods:{openForm(e){e&&(this.group_edit_name=e.group_name,this.group_edit_id=e.group_id),this.permission_form=!0},saveSetting(e,s){return De(this,void 0,void 0,(function*(){try{this.processing=!0,yield this.updateSetting(e,s),this.setSettings(),yield R.tH.fetch()}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},setSettings(){this.user_settings["GROUP_PERMISSION_ACTIVATED"]||(this.user_settings["GROUP_PERMISSION_ACTIVATED"]=!1)},groupAdded(){this.display_create_group_dialog=!1},groupEdited(){this.getPermissionsData(),this.permission_form=!1},deleteGroup(){try{if(!this.delete_id)return;this.deleteGroupById(this.delete_id)}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}finally{this.processing=!1}},viewPermissions(e){this.selectedGroupId=e.group_id,this.display_permissions_dialog=!0},viewAccessControl(e){const s=e.group_name,t=e.group_id;this.$router.push(`/settings/access_control/${s}/${t}`)},manageUsers(e){this.selectedGroupId=e.group_id,this.selectedGroupName=e.group_name,this.display_users_dialog=!0},prepareColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"group_name",label:this.$t("group_name"),field:"group_name",align:"left"})),this.columns.push(Object.assign({},{name:"group_description",label:this.$t("group_description"),field:"group_description",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareRows(){if(this.groups){this.rows=[];for(let[e,s]of Object.entries(this.groups)){const e=s;this.addNewRow(e)}}},addNewRow(e){let s=Object.assign({},e);return this.rows.push(s),this.rows.length.toString()},sortTable(e,s){this.sort_by=e,this.sort_order=s,this.rows.sort(((t,o)=>{const a=t[e]?t[e].toLowerCase():"",r=o[e]?o[e].toLowerCase():"";return"asc"===s?a.localeCompare(r):r.localeCompare(a)}))}},setup(){const e=(0,$.H4)(),{getPermissionsData:s,deleteGroupById:t,editGroup:o}=e,{groups:a,processing:r}=(0,q.bP)(e),l=(0,$.Bu)(),{user_settings:i}=(0,q.bP)(l),{updateSetting:n}=l;return{groups:a,processing:r,editGroup:o,updateSetting:n,deleteGroupById:t,getPermissionsData:s,display_users_dialog:(0,P.KR)(!1),display_permissions_dialog:(0,P.KR)(!1),display_create_group_dialog:(0,P.KR)(!1),columns:(0,P.KR)([]),rows:(0,P.KR)([]),selectedGroupId:(0,P.KR)(""),selectedGroupName:(0,P.KR)(""),deleteConfirm:(0,P.KR)(!1),delete_id:(0,P.KR)(""),user_settings:i,sort_by:(0,P.KR)(""),sort_order:(0,P.KR)("")}}});var je=t(84436),We=t(53999),Me=t(10386),Be=t(3952);const He=(0,N.A)(Xe,[["render",F],["__scopeId","data-v-45f34d20"]]),Je=He;ie()(Xe,"components",{QIcon:j.A,QToggle:Ae.A,QTable:D.A,QTh:ve.A,QTd:B.A,QBtn:H.A,QMenu:je.A,QList:We.A,QItem:te.A,QItemSection:oe.A,QSeparator:Me.A,QDialog:J.A,QCard:z.A,QCardSection:ee.A,QAvatar:Be.A,QCardActions:ae.A,QToolbar:Y.A,QToolbarTitle:Z.A,QInnerLoading:Ve.A}),ie()(Xe,"directives",{ClosePopup:re.A})}}]);