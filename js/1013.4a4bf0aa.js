"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[1013],{11013:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var o=a(61758),s=a(58790);const i=e=>((0,o.Qi)("data-v-e97de4b0"),e=e(),(0,o.jt)(),e),n={key:0,class:"container container-wrapper"},l={class:"row full-width"},c={class:"flex-end full-width"},u={class:"col-12 q-mt-sm"},r={class:"table-header-text"},d=["data-index"],p={key:0,class:"action-align cursor-default"},m={key:1,class:""},h={key:0},g=["onClick"],_={key:1},k={key:2},y=i((()=>(0,o.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1)));function b(e,t,a,i,b,v){const f=(0,o.g2)("SubHeader"),D=(0,o.g2)("BackToSettings"),I=(0,o.g2)("f-btn"),T=(0,o.g2)("q-icon"),L=(0,o.g2)("q-item-label"),w=(0,o.g2)("q-item-section"),C=(0,o.g2)("q-item"),A=(0,o.g2)("q-select"),E=(0,o.g2)("q-markup-table"),F=(0,o.g2)("q-inner-loading");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(f,{name:"access_controll",label:e.$t("access_control"),display_help_link:!1,onSearch:!1},null,8,["label"]),(0,o.bF)(D,{back_to_rotue:"/settings/roles",label:e.groupName},null,8,["label"]),e.renderDataList?((0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",l,[(0,o.Lk)("div",c,[(0,o.bF)(I,{class:"float-right",label:e.$t("save"),onClick:e.save},null,8,["label","onClick"])]),(0,o.Lk)("div",u,[(0,o.bF)(E,{flat:"",class:"dashboard-table-style back-white",id:"access_control_table"},{default:(0,o.k6)((()=>[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.table_columns,((t,a)=>((0,o.uX)(),(0,o.CE)("th",{key:t.name,"data-index":a},["actions"==t.name?((0,o.uX)(),(0,o.CE)("span",p,(0,s.v_)(e.$t(t.label)),1)):((0,o.uX)(),(0,o.CE)("span",m,(0,s.v_)(e.$t(t.label)),1))],8,d)))),128))])]),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.documentList,(t=>((0,o.uX)(),(0,o.CE)("tr",{key:t.id},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.table_columns,(a=>((0,o.uX)(),(0,o.CE)(o.FK,{key:a.name},["all"===a.name?((0,o.uX)(),(0,o.CE)("td",h,[(0,o.Lk)("div",{class:"cursor-pointer color-primary",onClick:a=>e.goToAccessControlDetail(t)},(0,s.v_)(t.title),9,g)])):"access"===a.name?((0,o.uX)(),(0,o.CE)("td",_,[(0,o.bF)(A,{modelValue:e.apiData[e.groupId][t.document_key][a.name],"onUpdate:modelValue":o=>e.apiData[e.groupId][t.document_key][a.name]=o,borderless:"",options:e.accessOptionList,dense:"","emit-value":"","map-options":"","hide-dropdown-icon":""},{option:(0,o.k6)((i=>[(0,o.bF)(C,(0,o.v6)({ref_for:!0},i.itemProps),{default:(0,o.k6)((()=>[(0,o.bF)(w,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[i.opt.value===e.apiData[e.groupId][t.document_key][a.name]?((0,o.uX)(),(0,o.Wv)(T,{key:0,name:"check",class:"q-ml-xs",color:"primary"})):(0,o.Q3)("",!0),(0,o.eW)(" "+(0,s.v_)(i.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:2},1032,["modelValue","onUpdate:modelValue","options"])])):((0,o.uX)(),(0,o.CE)("td",k,[(0,o.bF)(A,{modelValue:e.apiData[e.groupId][t.document_key][a.name],"onUpdate:modelValue":o=>e.apiData[e.groupId][t.document_key][a.name]=o,borderless:"",options:e.listOption,dense:"","emit-value":"","map-options":"","hide-dropdown-icon":""},{option:(0,o.k6)((i=>[(0,o.bF)(C,(0,o.v6)({ref_for:!0},i.itemProps),{default:(0,o.k6)((()=>[(0,o.bF)(w,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[i.opt.value===e.apiData[e.groupId][t.document_key][a.name]?((0,o.uX)(),(0,o.Wv)(T,{key:0,name:"check",class:"q-ml-xs",color:"primary"})):(0,o.Q3)("",!0),(0,o.eW)(" "+(0,s.v_)(i.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:2},1032,["modelValue","onUpdate:modelValue","options"])]))],64)))),128))])))),128))])])),_:1})])])])):(0,o.Q3)("",!0),(0,o.bF)(F,{showing:e.processing},{default:(0,o.k6)((()=>[y])),_:1},8,["showing"])],64)}var v=a(38734),f=a(66693),D=a(25773),I=a(1595),T=a(1659),L=a(11470),w=a(24622),C=a(76956),A=function(e,t,a,o){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,i){function n(e){try{c(o.next(e))}catch(t){i(t)}}function l(e){try{c(o["throw"](e))}catch(t){i(t)}}function c(e){e.done?a(e.value):s(e.value).then(n,l)}c((o=o.apply(e,t||[])).next())}))};const E=(0,o.pM)({el:"#app",mixins:[w.A],components:{SubHeader:f.A,BackToSettings:D.A},mounted(){return A(this,void 0,void 0,(function*(){yield this.init()}))},data(){return{table_columns:[{label:"all",name:"all"},{label:"access",name:"access"},{label:"list",name:"list"},{label:"view",name:"view"},{label:"edit",name:"edit"},{label:"delete",name:"delete"},{label:"mass_update",name:"mass_update"},{label:"first_approval",name:"first_approval"},{label:"second_approval",name:"second_approval"},{label:"unlock_document",name:"unlock_document"}],renderDataList:(0,v.KR)(!1),documentList:[],groupId:this.$route.params.id,groupName:this.$route.params.group_name}},methods:{init(){return A(this,void 0,void 0,(function*(){try{this.processing=!0,yield this.getDocTypes(),yield this.fetchAllDocTypeSettings()}catch(e){logInfo(e)}finally{this.renderDataList=!0,this.processing=!1}}))},getDocTypes(){return A(this,void 0,void 0,(function*(){try{const e=yield L.p5.fetchDocTypes();if(!e.success)throw null===e||void 0===e?void 0:e.message;this.documentList=e.data.filter((e=>!C.gh.includes(e.document_key)&&!0===e.is_active))}catch(e){logError(e)}}))},fetchAllDocTypeSettings(){return A(this,void 0,void 0,(function*(){try{yield this.getAllDocTypeSettings(this.groupId),this.mappedPermissionToDocument(this.documentList)}catch(e){logError(e)}}))},save(){return A(this,void 0,void 0,(function*(){const e={[this.groupId]:{}};this.documentList.forEach((t=>{e[this.groupId][t.document_key]={access:this.apiData[this.groupId][t.document_key]["access"],list:this.apiData[this.groupId][t.document_key]["list"],view:this.apiData[this.groupId][t.document_key]["view"],edit:this.apiData[this.groupId][t.document_key]["edit"],delete:this.apiData[this.groupId][t.document_key]["delete"],mass_update:this.apiData[this.groupId][t.document_key]["mass_update"],first_approval:this.apiData[this.groupId][t.document_key]["first_approval"],second_approval:this.apiData[this.groupId][t.document_key]["second_approval"],unlock_document:this.apiData[this.groupId][t.document_key]["unlock_document"]}}));try{this.processing=!0;const t=JSON.stringify(e);yield this.updateDocTypeSetting(t),yield this.fetchAllDocTypeSettings(),this.showSuccessToast(this.$t("save_successfully"))}catch(t){logError(t),this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},goToAccessControlDetail(e){const t=e.document_key;this.$router.push(`/settings/access_control/detail/${this.groupName}/${t}/${this.groupId}`)}},setup(){const e=(0,I.H4)(),{accessOptionList:t,listOption:a,processing:o,apiData:s}=(0,T.bP)(e),{getAllDocTypeSettings:i,mappedPermissionToDocument:n,updateDocTypeSetting:l}=e;return{accessOptionList:t,listOption:a,processing:o,getAllDocTypeSettings:i,mappedPermissionToDocument:n,updateDocTypeSetting:l,apiData:s}}});var F=a(12807),S=a(857),X=a(94940),$=a(90124),Q=a(25173),q=a(13796),x=a(50492),V=a(39035),O=a(98582),P=a.n(O);const K=(0,F.A)(E,[["render",b],["__scopeId","data-v-e97de4b0"]]),N=K;P()(E,"components",{QMarkupTable:S.A,QSelect:X.A,QItem:$.A,QItemSection:Q.A,QItemLabel:q.A,QIcon:x.A,QInnerLoading:V.A})}}]);