"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[5496],{65496:(e,t,a)=>{a.r(t),a.d(t,{default:()=>rt});var s=a(59835),i=a(86970);const o={class:"container"},l={class:"full-width"},n={style:{"margin-top":"3px","text-transform":"capitalize"}},r=(0,s._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function d(e,t,a,d,c,u){const p=(0,s.up)("SubHeader"),_=(0,s.up)("BackToSettings"),h=(0,s.up)("q-separator"),m=(0,s.up)("q-icon"),y=(0,s.up)("q-space"),g=(0,s.up)("MasterDataTypeList"),w=(0,s.up)("q-card-section"),f=(0,s.up)("q-card"),b=(0,s.up)("q-expansion-item"),v=(0,s.up)("q-list"),k=(0,s.up)("q-inner-loading");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(p,{name:"master_data_settings",label:e.$t("pages.settings.supplier_validation")},null,8,["label"]),(0,s.Wm)(_),(0,s._)("div",o,[(0,s._)("div",l,[e.data_types_loaded?((0,s.wg)(),(0,s.j4)(v,{key:0,bordered:"",class:"rounded-borders"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.data_types,((t,a)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:a},[(0,s.Wm)(h),(0,s.Wm)(b,{"expand-separator":"","header-class":"highlighted-back","default-opened":0==a},{header:(0,s.w5)((()=>[(0,s.Wm)(m,{size:"25px",class:"q-mr-lg black_to_white",name:"img:vendors-default.svg"}),(0,s._)("span",n,(0,i.zw)(e.$t(e.aliases[t]||t)),1),(0,s.Wm)(y)])),default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,{style:"height: auto; min-height: 15vh;"},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{type_name:t},null,8,["type_name"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["default-opened"]),(0,s.Wm)(h)],64)))),128))])),_:1})):(0,s.kq)("",!0)])]),(0,s.Wm)(k,{showing:e.loading},{default:(0,s.w5)((()=>[r])),_:1},8,["showing"])],64)}var c=a(7363),u=a(49990),p=a(60499),_=a(70501),h=a(37446),m=a(46624),y=a(16308),g=a(17256),w=a(61957);const f={class:"q-mb-md"},b={class:"row full-width"},v={key:0},k={class:"q-mr-sm"},C={class:"row no-wrap justify-around"},q={class:"drop-target rounded-borders"},S={class:"box row justify-center items-center"},Z={class:"visible-columns-parent scrolle-y master-data-border",style:{height:"30vh"}},W={class:"full-width q-mt-md"},x={class:"ellipsis"},T={class:"text-item",style:{"text-transform":"capitalize"}},Q={class:"row float-right"},E={class:"text-red"},B={class:"text-center"},D={class:"q-mt-md row full-width"},H=(0,s._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function O(e,t,a,o,l,n){const r=(0,s.up)("q-icon"),d=(0,s.up)("q-input"),c=(0,s.up)("q-space"),u=(0,s.up)("f-btn"),p=(0,s.up)("q-item-label"),_=(0,s.up)("q-item-section"),h=(0,s.up)("q-item"),m=(0,s.up)("draggable"),y=(0,s.up)("q-list"),g=(0,s.up)("q-card-section"),O=(0,s.up)("q-card"),U=(0,s.up)("q-btn-dropdown"),V=(0,s.up)("q-select"),$=(0,s.up)("savedSortByBadges"),L=(0,s.up)("ColumnOrderBy"),M=(0,s.up)("q-th"),A=(0,s.up)("q-tr"),P=(0,s.up)("q-separator"),z=(0,s.up)("q-menu"),R=(0,s.up)("q-btn"),I=(0,s.up)("q-td"),j=(0,s.up)("q-table"),J=(0,s.up)("q-markup-table"),F=(0,s.up)("q-pagination"),N=(0,s.up)("EditCreate"),Y=(0,s.up)("q-dialog"),K=(0,s.up)("TableAlias"),G=(0,s.up)("q-inner-loading"),X=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[e.data[e.type_name]&&e.data[e.type_name].data?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",f,[(0,s._)("div",b,[(0,s.Wm)(d,{class:"width-500",outlined:"",dense:"",debounce:"300",color:"primary",modelValue:e.filter_value,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filter_value=t),label:e.$t("search_by_column"),onKeyup:e.onKeyup},{append:(0,s.w5)((()=>[(0,s.Wm)(r,{name:"search",onClick:t[0]||(t[0]=t=>e.searchByAll())})])),_:1},8,["modelValue","label","onKeyup"]),(0,s.Wm)(c),e.data[e.type_name].readonly?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",v,[(0,s.Wm)(u,{class:"mr-6",label:e.$t("pages.settings.master_data_lookup.add_row"),onClick:e.createRow},null,8,["label","onClick"])])),(0,s._)("div",null,[(0,s.Wm)(u,{class:"mr-6",label:e.$t("update_alias"),onClick:t[2]||(t[2]=t=>e.display_table_alias_popup=!0)},null,8,["label"])]),(0,s._)("div",null,[(0,s.Wm)(u,{class:"mr-6",label:e.$t("downlaod_as_csv"),onClick:e.downloadAsCSV},null,8,["label","onClick"])]),(0,s._)("div",k,[(0,s.Wm)(U,{color:"primary",style:{"border-radius":"7px"},unelevated:"",label:e.$t("sort_columns"),onClick:t[4]||(t[4]=t=>e.restColumnsList())},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s._)("div",C,[(0,s._)("div",q,[(0,s._)("div",S,(0,i.zw)(e.$t("drag_columns_to_sort")),1),(0,s._)("div",Z,[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{sort:!0,"item-key":"name",class:"dragArea",list:e.columnsCopy,onChange:e.itemDraggedComplete,group:{name:"masterData",pull:!1,put:!0}},{item:(0,s.w5)((({element:e})=>[(0,s.Wm)(h,{clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:1},8,["list","onChange"])])),_:1})])])]),(0,s._)("div",W,[(0,s.wy)((0,s.Wm)(u,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[X]]),(0,s.wy)((0,s.Wm)(u,{label:e.$t("done"),class:"q-ml-sm float-right",onClick:t[3]||(t[3]=t=>e.saveColumnOrder())},null,8,["label"]),[[X]])])])),_:1})])),_:1})])),_:1},8,["label"])]),(0,s.Wm)(V,{outlined:"",class:"select-box",modelValue:e.search_operator,"onUpdate:modelValue":[t[5]||(t[5]=t=>e.search_operator=t),t[6]||(t[6]=t=>{e.operatorUpdated(t)})],options:e.search_operators_list,label:e.$t("default_search_operator"),style:{width:"200px"},"emit-value":"","map-options":""},{"selected-item":(0,s.w5)((e=>[(0,s._)("div",x,(0,i.zw)(e.opt.label),1)])),_:1},8,["modelValue","options","label"])]),(0,s.Wm)($,{type_name:e.type_name},null,8,["type_name"])]),e.data[e.type_name].data?((0,s.wg)(),(0,s.j4)(j,{key:0,class:(0,i.C_)("main-table dashboard-table-style back-white"),"rows-per-page-options":[0],rows:e.data[e.type_name].data,columns:e.columns,"row-key":"id",flat:"","hide-bottom":"","table-header-class":"table-header-text","no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),"no-results-label":"The filter didn't uncover any results"},{header:(0,s.w5)((t=>[(0,s.Wm)(A,{props:t},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.cols,((a,o)=>((0,s.wg)(),(0,s.j4)(M,{key:a.name,props:t,dropzone:"true","data-index":o},{default:(0,s.w5)((()=>[(0,s._)("span",T,(0,i.zw)(a.label),1),"action"!==a.name?((0,s.wg)(),(0,s.j4)(L,{key:0,type_name:e.type_name,column_name:a.field},null,8,["type_name","column_name"])):(0,s.kq)("",!0)])),_:2},1032,["props","data-index"])))),128))])),_:2},1032,["props"])])),body:(0,s.w5)((a=>[(0,s.Wm)(A,{props:a,id:a.key,class:(0,i.C_)((e.data[e.type_name].readonly,""))},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.cols,(o=>((0,s.wg)(),(0,s.iD)(s.HY,{key:o.name},["action"===o.name?((0,s.wg)(),(0,s.j4)(I,{key:0},{default:(0,s.w5)((()=>[(0,s._)("div",Q,[(0,s.Wm)(R,{flat:"",dense:"",round:"",onClick:t[7]||(t[7]=(0,w.iM)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,s.w5)((()=>[(0,s.Wm)(z,{persistent:"","auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{dense:"",style:{"min-width":"100px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{onClick:t=>e.editRow(a.rowIndex)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.Wm)(P,{inset:""}),(0,s.Wm)(h,{clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{onClick:t=>e.deleteClicked(a.rowIndex,a.row.id)},{default:(0,s.w5)((()=>[(0,s._)("span",E,(0,i.zw)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):((0,s.wg)(),(0,s.j4)(I,{key:1},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(a.row[o.name]),1)])),_:2},1024))],64)))),128))])),_:2},1032,["props","id","class"])])),_:1},8,["rows","columns","no-data-label"])):(0,s.kq)("",!0),0==e.data[e.type_name].data.length?((0,s.wg)(),(0,s.j4)(J,{key:1,class:"full-width"},{default:(0,s.w5)((()=>[(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("td",B,(0,i.zw)(e.$t("no_data_found")),1)])])])),_:1})):(0,s.kq)("",!0)],64)):(0,s.kq)("",!0),(0,s._)("div",D,[e.total_pages>1?((0,s.wg)(),(0,s.j4)(F,{key:0,modelValue:e.current_page,"onUpdate:modelValue":t[8]||(t[8]=t=>e.current_page=t),max:e.total_pages,"max-pages":6,"direction-links":"",unelevated:"",color:"black","active-color":"black",class:"doc2-pagination q-mb-md q-ml-auto q-mr-auto",onClick:t[9]||(t[9]=t=>e.paginationItemClicked())},null,8,["modelValue","max"])):(0,s.kq)("",!0)]),(0,s.Wm)(Y,{modelValue:e.show_edit_create,"onUpdate:modelValue":t[10]||(t[10]=t=>e.show_edit_create=t),persistent:"",onKeydown:t[11]||(t[11]=(0,w.D2)((t=>e.show_edit_create=!1),["esc"])),onHide:t[12]||(t[12]=t=>e.show_edit_create=!1)},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{type_name:e.type_name,create_row:e.create_row,model:e.selected_row,selected_row_index:e.selected_row_index},null,8,["type_name","create_row","model","selected_row_index"])])),_:1},8,["modelValue"]),(0,s.Wm)(Y,{modelValue:e.display_table_alias_popup,"onUpdate:modelValue":t[13]||(t[13]=t=>e.display_table_alias_popup=t),onKeydown:t[14]||(t[14]=(0,w.D2)((t=>e.display_table_alias_popup=!1),["esc"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(K,{alias_key_temp:e.type_name},null,8,["alias_key_temp"])])),_:1},8,["modelValue"]),(0,s.Wm)(G,{showing:e.loading},{default:(0,s.w5)((()=>[H])),_:1},8,["showing"])],64)}var U=a(79860),V=a(73130),$=a.n(V),L=a(49341);const M={key:0,class:"text-weight-bold"},A={key:1,class:"text-weight-bold"},P={class:"row full-width"},z={class:"full-width"},R={key:0},I=(0,s._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function j(e,t,a,o,l,n){const r=(0,s.up)("q-toolbar-title"),d=(0,s.up)("q-btn"),c=(0,s.up)("q-toolbar"),u=(0,s.up)("q-input"),p=(0,s.up)("q-card-section"),_=(0,s.up)("f-btn"),h=(0,s.up)("q-card-actions"),m=(0,s.up)("q-inner-loading"),y=(0,s.up)("q-card"),g=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(y,{class:"create-edit-card"},{default:(0,s.w5)((()=>[(0,s._)("form",{onSubmit:t[0]||(t[0]=(0,w.iM)(((...t)=>e.submitFrom&&e.submitFrom(...t)),["prevent","stop"]))},[(0,s.Wm)(c,{class:"text-white secondary-toolbar"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[e.create_row?((0,s.wg)(),(0,s.iD)("span",A,(0,i.zw)(e.$t("pages.settings.master_data_lookup.create_row")),1)):((0,s.wg)(),(0,s.iD)("span",M,(0,i.zw)(e.$t("pages.settings.master_data_lookup.edit_row")),1))])),_:1}),(0,s.wy)((0,s.Wm)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[g]])])),_:1}),(0,s.Wm)(p,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s._)("div",P,[(0,s._)("div",z,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.data[e.type_name].fields,(t=>((0,s.wg)(),(0,s.iD)(s.HY,{key:t.id},[e.exclue_fields.includes(t)?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",R,[(0,s.Wm)(u,{outlined:"",dense:"",modelValue:e.edit_model[t],"onUpdate:modelValue":a=>e.edit_model[t]=a,label:t.toUpperCase(),class:"q-my-md"},null,8,["modelValue","onUpdate:modelValue","label"])]))],64)))),128))])])])),_:1}),(0,s.Wm)(h,{align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(_,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[g]]),(0,s.Wm)(_,{type:"submit",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,s.Wm)(m,{showing:e.loading},{default:(0,s.w5)((()=>[I])),_:1},8,["showing"])])),_:1})}var J=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function l(e){try{r(s.next(e))}catch(t){o(t)}}function n(e){try{r(s["throw"](e))}catch(t){o(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,n)}r((s=s.apply(e,t||[])).next())}))};const F=(0,s.aZ)({el:"#app",mixins:[_.Z,u.Z],props:{type_name:{type:String,reqired:!0,default:""},create_row:{type:Boolean,required:!0},model:{},selected_row_index:{type:Number,default:0}},components:{},data(){return{}},setup(){const e=(0,m.UU)(),{updateRow:t}=e,{data:a,exclue_fields:s}=(0,c.Jk)(e);return{exclue_fields:s,data:a,loading:(0,p.iH)(!1),edit_model:(0,p.iH)({}),row_id:(0,p.iH)(""),updateRow:t}},mounted:function(){this.initView()},methods:{initView(){this.edit_model=this.model,this.row_id=this.model.id},submitFrom(){return J(this,void 0,void 0,(function*(){try{if(this.loading=!0,!this.validateNewRow())return;const e=yield this.updateRow(this.type_name,this.edit_model,this.create_row,this.selected_row_index);if(!e||!0!==e.success)throw e;this.create_row?this.showSuccessToast("Created Record"):this.showSuccessToast("Updated Record");const t=new CustomEvent("record_saved",{detail:{}});document.dispatchEvent(t)}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},validateNewRow(){try{if(!this.edit_model.hasOwnProperty("id")||""==this.edit_model.id.replace(/\s+/g,""))throw this.$t("pages.settings.master_data_lookup.required_id");if(this.row_id!=this.edit_model.id&&this.data[this.type_name].ids.includes(this.edit_model.id))throw this.$t("pages.settings.master_data_lookup.not_unique_id");return!0}catch(e){if("string"==typeof e)return this.showErrorToast(e),!1;throw e}}}});var N=a(7683),Y=a(44458),K=a(51663),G=a(81973),X=a(68879),ee=a(63190),te=a(13119),ae=a(11821),se=a(60854),ie=a(62146),oe=a(69984),le=a.n(oe);const ne=(0,N.Z)(F,[["render",j]]),re=ne;le()(F,"components",{QCard:Y.Z,QToolbar:K.Z,QToolbarTitle:G.Z,QBtn:X.Z,QCardSection:ee.Z,QInput:te.Z,QCardActions:ae.Z,QInnerLoading:se.Z}),le()(F,"directives",{ClosePopup:ie.Z});const de={class:"text-weight-bold"},ce={class:"row"},ue={class:"col-12"},pe={class:"row q-mt-md"},_e={class:"col-12"},he=(0,s._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function me(e,t,a,o,l,n){const r=(0,s.up)("q-toolbar-title"),d=(0,s.up)("q-btn"),c=(0,s.up)("q-toolbar"),u=(0,s.up)("q-input"),p=(0,s.up)("q-card-section"),_=(0,s.up)("q-card-actions"),h=(0,s.up)("q-card"),m=(0,s.up)("q-inner-loading"),y=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(h,{style:{width:"700px","max-width":"1060px","min-height":"260px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"text-white secondary-toolbar"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s._)("span",de,(0,i.zw)(e.$t("update_alias")),1)])),_:1}),(0,s.wy)((0,s.Wm)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[y]])])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",ce,[(0,s._)("div",ue,[(0,s.Wm)(u,{readonly:"",outlined:"",modelValue:e.table_alias_key,"onUpdate:modelValue":t[0]||(t[0]=t=>e.table_alias_key=t),filled:"",label:e.$t("pages.settings.master_data_lookup.manage.select_table")},null,8,["modelValue","label"])])]),(0,s._)("div",pe,[(0,s._)("div",_e,[(0,s.Wm)(u,{outlined:"",modelValue:e.table_alias_value,"onUpdate:modelValue":t[1]||(t[1]=t=>e.table_alias_value=t),filled:"",label:e.$t("pages.settings.master_data_lookup.manage.alias"),maxlength:"100",style:{height:"60px"}},null,8,["modelValue","label"])])])])),_:1}),(0,s.Wm)(_,{align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(d,{class:"q-mr-sm highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[y]]),(0,s.Wm)(d,{class:"q-mr-sm",type:"submit",color:"primary",label:e.$t("save"),onClick:e.set_alias},null,8,["label","onClick"])])),_:1})])),_:1}),(0,s.Wm)(m,{showing:e.loading},{default:(0,s.w5)((()=>[he])),_:1},8,["showing"])],64)}var ye=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function l(e){try{r(s.next(e))}catch(t){o(t)}}function n(e){try{r(s["throw"](e))}catch(t){o(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,n)}r((s=s.apply(e,t||[])).next())}))};const ge=(0,s.aZ)({el:"#app",mixins:[_.Z,u.Z],components:{},data(){return{}},setup(){const e=(0,m.UU)(),{setAlias:t}=e,{aliases:a}=(0,c.Jk)(e);return{aliases:a,setAlias:t,loading:(0,p.iH)(!1),table_alias_value:(0,p.iH)(""),table_alias_key:(0,p.iH)("")}},props:{alias_key_temp:{type:String,default:""}},mounted:function(){this.table_alias_key=this.alias_key_temp,this.populateAlias()},methods:{set_alias(){return ye(this,void 0,void 0,(function*(){try{if(!this.validate())return;this.loading=!0,0==this.table_alias_value.length&&(this.table_alias_value=this.table_alias_key),yield this.setAlias(this.table_alias_key,this.table_alias_value),this.showSuccessToast("alias is Updated.");const e=new CustomEvent("alias_updated",{});document.dispatchEvent(e)}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},validate(){return null===this.table_alias_key?(this.showErrorToast("Please select a Table to create an alias for"),!1):null!==this.table_alias_value||(this.showErrorToast("Please set an alias to create for the table"),!1)},populateAlias(){if(null===this.table_alias_key)return;const e=this.aliases[this.table_alias_key];null!==e&&(this.table_alias_value=e)}}}),we=(0,N.Z)(ge,[["render",me]]),fe=we;le()(ge,"components",{QCard:Y.Z,QToolbar:K.Z,QToolbarTitle:G.Z,QBtn:X.Z,QCardSection:ee.Z,QInput:te.Z,QCardActions:ae.Z,QInnerLoading:se.Z}),le()(ge,"directives",{ClosePopup:ie.Z});const be={class:"orderByParentSpan arrow-color"},ve=["data-name"],ke=["data-name"];function Ce(e,t,a,o,l,n){return(0,s.wg)(),(0,s.iD)("span",be,[(0,s._)("span",{class:(0,i.C_)(["up-arrow orderBy absolute cursor-pointer",e.is_order_by_selected("asc")?"selected":""]),"data-name":e.column_name,"data-direction":"asc",onClick:t[0]||(t[0]=t=>e.OrderBy("asc"))},null,10,ve),(0,s._)("span",{class:(0,i.C_)(["down-arrow orderBy absolute cursor-pointer",e.is_order_by_selected("desc")?"selected":""]),"data-name":e.column_name,"data-direction":"desc",onClick:t[1]||(t[1]=t=>e.OrderBy("desc"))},null,10,ke)])}var qe=a(22354);const Se=(0,s.aZ)({mixins:[],props:{column_name:{type:String,required:!0},type_name:{type:String,required:!0}},components:{},methods:{is_order_by_selected(e){return Boolean(this.sortby_data_types[this.type_name]["orderByMap"].has(this.column_name)&&this.sortby_data_types[this.type_name]["orderByMap"].get(this.column_name)==e)},OrderBy(e){this.sortby_data_types[this.type_name]["orderByMap"].has(this.column_name)&&this.sortby_data_types[this.type_name]["orderByMap"].get(this.column_name)==e?this.sortby_data_types[this.type_name]["orderByMap"].delete(this.column_name):this.sortby_data_types[this.type_name]["orderByMap"].set(this.column_name,e),(0,qe.$i)(this.type_name,this.sortby_data_types[this.type_name]["orderByMap"]),this.triggerApplyFilters()},triggerApplyFilters(){const e=new CustomEvent("ms_search",{detail:{data_type:this.type_name}});document.dispatchEvent(e)}},setup(){const e=(0,m.UU)(),{sortby_data_types:t}=(0,c.Jk)(e);return{sortby_data_types:t}}}),Ze=(0,N.Z)(Se,[["render",Ce],["__scopeId","data-v-1e8e08c6"]]),We=Ze;var xe=a(15877);const Te={class:"row"},Qe={key:0};function Ee(e,t,a,o,l,n){const r=(0,s.up)("q-icon"),d=(0,s.up)("q-badge");return(0,s.wg)(),(0,s.iD)("div",Te,[e.sortby_data_types[e.type_name]["orderByMap"].size>0?((0,s.wg)(),(0,s.iD)("span",Qe,(0,i.zw)(e.$t("sort_by")),1)):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.sortby_data_types[e.type_name]["orderByMap"],(([t,a])=>((0,s.wg)(),(0,s.j4)(d,{key:t,rounded:"",color:"primary",class:"q-ml-md capitalize"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(t)+" : "+(0,i.zw)(a)+" ",1),(0,s.Wm)(r,{name:"close",color:"white",class:"q-ml-xs cursor-pointer",onClick:a=>e.removeFilter(t)},null,8,["onClick"])])),_:2},1024)))),128))])}const Be=(0,s.aZ)({props:{type_name:{type:String,required:!0}},methods:{removeFilter(e){this.sortby_data_types[this.type_name]["orderByMap"].delete(e),this.triggerApplyFilters()},triggerApplyFilters(){const e=new CustomEvent("ms_search",{detail:{data_type:this.type_name}});document.dispatchEvent(e)}},setup(){const e=(0,m.UU)(),{sortby_data_types:t}=(0,c.Jk)(e);return{sortby_data_types:t}}});var De=a(20990),He=a(22857);const Oe=(0,N.Z)(Be,[["render",Ee]]),Ue=Oe;le()(Be,"components",{QBadge:De.Z,QIcon:He.Z});var Ve=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function l(e){try{r(s.next(e))}catch(t){o(t)}}function n(e){try{r(s["throw"](e))}catch(t){o(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,n)}r((s=s.apply(e,t||[])).next())}))};const $e=(0,s.aZ)({el:"#app",mixins:[_.Z,u.Z],props:{type_name:{type:String,reqired:!0,default:""}},components:{draggable:$(),EditCreate:re,TableAlias:fe,ColumnOrderBy:We,savedSortByBadges:Ue},data(){return{selectedIndex:(0,p.iH)(0),columnListPreferenc:[],enableSaveColumnOrderBtn:(0,p.iH)(!1)}},setup(){const e=(0,m.UU)(),{deleteRow:t,getDataByType:a,getDataTypeFields:s,sortColumns:i,getColumnPreference:o}=e,{data:l,sortby_data_types:n}=(0,c.Jk)(e),r=(0,m.fI)(),{search_operators:d,search_op_key_postfix:u,default_operator:_}=(0,c.Jk)(r);let h=[];const y=(0,m.VF)(),{updateSetting:g}=y;return{updateSetting:g,sortby_data_types:n,search_op_key_postfix:u,search_operators_list:d,getColumnPreference:o,getDataTypeFields:s,getDataByType:a,sortColumns:i,data:l,loading:(0,p.iH)(!1),columns:(0,p.iH)(h),columnsCopy:(0,p.iH)(h),filter_value:(0,p.iH)(""),edit_model:(0,p.iH)({}),create_row:(0,p.iH)(!1),show_edit_create:(0,p.iH)(!1),selected_row:(0,p.iH)({}),selected_row_index:(0,p.iH)(0),request_params:(0,p.iH)({}),current_page:(0,p.iH)(1),total_pages:(0,p.iH)(0),offset:(0,p.iH)(0),page_size:(0,p.iH)(7),total_records:(0,p.iH)(0),filter_data_json_str:(0,p.iH)(""),display_table_alias_popup:(0,p.iH)(!1),search_operator:(0,p.iH)(""),default_operator:_,search_operator_pref_key:(0,p.iH)(""),deleteRow:t}},mounted:function(){window.ms=this,this.initView(),document.addEventListener("record_saved",this.recordSaved),document.addEventListener("alias_updated",this.aliasUpdated),document.addEventListener("ms_search",this.searchEvent)},unmounted:function(){document.removeEventListener("record_saved",this.recordSaved),document.removeEventListener("alias_updated",this.aliasUpdated),document.removeEventListener("ms_search",this.searchEvent)},methods:{initView(){return Ve(this,void 0,void 0,(function*(){try{this.loading=!0,yield this.getDataTypeFields(this.type_name),this.getOrderByColumns(),yield this.getDataServer(),this.prepareColumns(),this.setSearchOperator()}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},searchEvent(e){e.detail.data_type==this.type_name&&this.searchByAll()},setSearchOperator(){return Ve(this,void 0,void 0,(function*(){this.search_operator_pref_key=String(this.type_name+this.search_op_key_postfix).toUpperCase(),this.search_operator=yield(0,xe.$8)(this.search_operator_pref_key),this.search_operator||(this.search_operator=this.default_operator)}))},getDataServer(){return Ve(this,void 0,void 0,(function*(){try{this.loading=!0,this.request_params={},this.request_params["skip"]=this.offset,this.request_params["limit"]=this.page_size,this.request_params["data_type"]=this.type_name,this.request_params["match_all"]=!1,this.makeOrderByForCall(),yield this.getDataByType(this.request_params,this.filter_data_json_str),this.data[this.type_name].data.length>0&&(this.total_records=this.data[this.type_name].total_records,this.setTotalPages())}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},makeOrderByForCall(){const e=(0,qe.Lm)(this.sortby_data_types[this.type_name]["orderByMap"]);e&&0!=e.length&&(this.request_params["sort_order_json"]=JSON.stringify(e))},onKeyup(e){"Enter"==e.key&&this.searchByAll()},searchByAll(){return Ve(this,void 0,void 0,(function*(){try{this.loading=!0;const e=this.data[this.type_name]["fields"];this.data[this.type_name]={},this.data[this.type_name]["fields"]=e,this.resetPagination(),this.filter_data_json_str=this.getSearchJson(),yield this.getDataServer()}catch(e){}finally{this.loading=!1}}))},getSearchJson(){let e="";if(!this.filter_value||""==this.filter_value)return e;const t=["action"];let a={},s=[];return Array.from(this.columns).forEach((e=>{t.includes(e.field)||s.push({field:e.field,operator:this.search_operator,value:this.filter_value})})),s.length>0&&(a["filters"]=s,a["match_all"]=!1,e=JSON.stringify(a)),e},paginationItemClicked(){return Ve(this,void 0,void 0,(function*(){try{this.calculateOffset(),yield this.getDataServer()}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}}))},prepareColumns(){try{if("function"!==typeof this.$t)return;const e=this.data[this.type_name].readonly;e||this.columns.push({name:"id",label:"id",field:"id",align:"left"});for(const[t,a]of Object.entries(this.data[this.type_name].fields)){const e=String(a);if("id"==a)continue;let t=e;t="last_modified_on"==e?this.$t(e):(0,qe.TY)(t),this.columns.push({name:e,label:t,field:e,align:"left"})}this.getColumnSortPreference(),this.applyColumnSort(),e||this.columns.push({name:"action",label:U.i18n.t("action"),field:"action",align:"right"}),this.restColumnsList()}catch(e){}},restColumnsList(){this.columnsCopy=JSON.parse(JSON.stringify(this.columns))},editRow(e){this.create_row=!1;const t=JSON.parse(JSON.stringify(this.data[this.type_name].data[e]));this.selected_row=t,this.selected_row_index=e,this.show_edit_create=!0},createRow(){this.create_row=!0,this.columns.length<=2?this.showErrorToast("No Columns found Please upload a csv before adding a new row"):(this.selected_row={},this.selected_row_index=0,this.show_edit_create=!0)},deleteClicked(e,t){return Ve(this,void 0,void 0,(function*(){try{this.loading=!0;const a=yield this.deleteRow(this.type_name,t,e);if(!a||!0!==a.success)throw a;this.showSuccessToast("Record Deleted"),this.handleCurrentPage()}catch(a){const e=h.w.getErrorMessage(a);this.showErrorToast(e)}finally{this.loading=!1}}))},handleCurrentPage(){0==this.data[this.type_name].data.length&&this.paginationItemClicked()},recordSaved(){this.show_edit_create=!1},resetPagination(){this.offset=0,this.total_pages=0,this.current_page=1,this.total_records=0},setTotalPages(){this.total_pages=Math.ceil(this.total_records/this.page_size)},setCurrentPage(){return this.current_page>this.total_pages&&(this.current_page--,this.setCurrentPage()),this.current_page},calculateOffset(){this.offset=this.page_size*(this.current_page-1)},saveColumnOrder(){return Ve(this,void 0,void 0,(function*(){this.loading=!0;let e=[];this.columns=JSON.parse(JSON.stringify(this.columnsCopy));for(let a of this.columns)e.push(a.name);try{let t="master_data"+this.type_name;yield this.updateSetting(t,JSON.stringify(e)),this.showSuccessToast("Order of Columns has bean sucessfully updated")}catch(t){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.enableSaveColumnOrderBtn=!1,this.loading=!1}}))},itemDraggedComplete(e){e.moved&&(this.enableSaveColumnOrderBtn=!0)},getColumnSortPreference(){this.columnListPreferenc=JSON.parse(this.getColumnPreference(this.type_name))},applyColumnSort(){this.columns=this.sortColumns(this.columnListPreferenc,this.columns)},downloadAsCSV(){return Ve(this,void 0,void 0,(function*(){try{this.loading=!0;const e=yield L.MG.downloadAsCSV(this.type_name);if(e.error)throw e.error;const t=window.URL.createObjectURL(new Blob([e])),a=document.createElement("a");a.href=t,a.setAttribute("download",this.type_name+".csv"),document.body.appendChild(a),a.click(),a.remove()}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},aliasUpdated(){this.display_table_alias_popup=!1},operatorUpdated(e){return Ve(this,void 0,void 0,(function*(){try{if(!e)return;this.showLoading(),yield(0,xe.AF)(this.search_operator_pref_key,e),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(t){const e=h.w.getErrorMessage(t);this.showErrorToast(e)}finally{this.hideLoading()}}))},getOrderByColumns(){this.sortby_data_types[this.type_name]={},this.sortby_data_types[this.type_name]["orderByMap"]=(0,qe.Gl)(this.type_name)}}});var Le=a(90136),Me=a(32045),Ae=a(13246),Pe=a(490),ze=a(76749),Re=a(33115),Ie=a(32259),je=a(61450),Je=a(31233),Fe=a(21682),Ne=a(67220),Ye=a(56362),Ke=a(50926),Ge=a(46858),Xe=a(66933),et=a(80996),tt=a(32074);const at=(0,N.Z)($e,[["render",O]]),st=at;le()($e,"components",{QInput:te.Z,QIcon:He.Z,QSpace:Le.Z,QBtnDropdown:Me.Z,QCard:Y.Z,QCardSection:ee.Z,QList:Ae.Z,QItem:Pe.Z,QItemSection:ze.Z,QItemLabel:Re.Z,QSelect:Ie.Z,QTable:je.Z,QTr:Je.Z,QTh:Fe.Z,QTd:Ne.Z,QBtn:X.Z,QMenu:Ye.Z,QSeparator:Ke.Z,QTooltip:Ge.Z,QMarkupTable:Xe.Z,QPagination:et.Z,QDialog:tt.Z,QInnerLoading:se.Z}),le()($e,"directives",{ClosePopup:ie.Z});var it=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function l(e){try{r(s.next(e))}catch(t){o(t)}}function n(e){try{r(s["throw"](e))}catch(t){o(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,n)}r((s=s.apply(e,t||[])).next())}))};const ot=(0,s.aZ)({el:"#app",mixins:[_.Z,u.Z],props:{},components:{SubHeader:y.Z,BackToSettings:g.Z,MasterDataTypeList:st},data(){return{tab:(0,p.iH)("tables")}},beforeRouteLeave:function(e,t,a){const s=(0,m.UU)();s.$reset(),a()},setup(){const e=(0,m.UU)(),{getDataSetTypes:t,getDataSetAliases:a}=e,{aliases:s,data_types:i,data_types_loaded:o}=(0,c.Jk)(e),l=(0,m.VF)(),{getOrgSettings:n}=l;return{data_types_loaded:o,getOrgSettings:n,getDataSetTypes:t,getDataSetAliases:a,aliases:s,data_types:i,loading:(0,p.iH)(!1)}},mounted:function(){this.initView()},methods:{initView(){return it(this,void 0,void 0,(function*(){try{this.loading=!0,yield this.getDataSetTypes(),yield this.getDataSetAliases(),yield this.getOrgSettings()}catch(e){const t=h.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))}}});var lt=a(50651);const nt=(0,N.Z)(ot,[["render",d]]),rt=nt;le()(ot,"components",{QList:Ae.Z,QSeparator:Ke.Z,QExpansionItem:lt.Z,QIcon:He.Z,QSpace:Le.Z,QCard:Y.Z,QCardSection:ee.Z,QInnerLoading:se.Z})}}]);