"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[7893],{27893:(e,l,o)=>{o.r(l),o.d(l,{default:()=>Tl});var t=o(61758),i=o(58790);const s=e=>((0,t.Qi)("data-v-371864e6"),e=e(),(0,t.jt)(),e),a={class:"row back-white"},d={class:"col-sm-12 col-md-12 col-lg-12 q-pl-md q-pb-lg"},c={class:"secondary-c-text text-h6"},n=s((()=>(0,t.Lk)("img",{width:"24",src:"images/back-primary.svg"},null,-1))),r={class:"primary-back"},u={class:"col-sm-12 col-md-12 col-lg-12 q-pa-sm"},m={class:"row workflow-builder-box"},p={class:"col-sm-7 col-md-7 col-lg-7 q-pt-lg wf-b-section border-right-D8D8D8-1px"},w={class:"row"},k={class:"col-sm-12 col-md-12 col-lg-12"},v={class:"row"},g={class:"col-sm-2 col-md-2 col-lg-2 text-align-center"},f={class:"center flow-oval-shape text-primary back-white"},b={class:"row"},h={class:"col-sm-2 col-md-2 col-lg-2 text-align-center q-pt-sm q-pb-sm"},_={class:"row"},x={class:"col-sm-2 col-md-2 col-lg-2 text-align-center q-pt-sm q-pb-sm"},F=["onClick"],L={class:"criteria-content"},C={class:"col-sm-1 col-md-1 col-lg-1 align-center flow-text"},q={class:"col-sm-2 col-md-2 col-lg-2 align-center"},y={class:"col-sm-12 col-md-12 col-lg-12 back-white"},I={class:"col-sm-3 col-md-3 col-lg-3 align-center flow-text"},A={class:"center flow-oval-shape text-primary back-white"},R={class:"row"},B={class:"col-sm-2 col-md-2 col-lg-2 text-align-center flow-text q-pt-sm"},V=s((()=>(0,t.Lk)("div",{class:"col-sm-10 col-md-10 col-lg-10 text-align-center"},null,-1))),$={class:"col-sm-2 col-md-2 col-lg-2 text-align-center q-pb-sm"},M=s((()=>(0,t.Lk)("div",{class:"col-sm-10 col-md-10 col-lg-10 text-align-center"},null,-1))),D={class:"row q-mb-md"},E={class:"col-sm-2 col-md-2 col-lg-2 text-align-center"},S={class:"center flow-oval-shape text-primary back-white"},Q={class:"col-sm-5 col-md-5 col-lg-5 wf-b-section"},T={class:"row q-pa-md"},U={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},W={class:"text-h6"},O={class:"row back-white"},K={class:"col-sm-12 col-md-12 col-lg-12"},X={class:"row"},z={class:"col-sm-12 col-md-12 col-lg-12"},N={class:"row center-inner"};function P(e,l,o,s,P,j){const H=(0,t.g2)("SubHeader"),G=(0,t.g2)("q-icon"),J=(0,t.g2)("q-btn"),Y=(0,t.g2)("Criteria"),Z=(0,t.g2)("Action"),ee=(0,t.g2)("q-space"),le=(0,t.g2)("q-card-section"),oe=(0,t.g2)("q-separator"),te=(0,t.g2)("q-option-group"),ie=(0,t.g2)("q-card-actions"),se=(0,t.g2)("q-card"),ae=(0,t.g2)("q-dialog"),de=(0,t.g2)("Loader"),ce=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(H,{name:"workflow_builder",label:e.$t("workflow_builder")+" - WORKFLOW 1",show_expiry_alert:!0,display_help_link:!1},null,8,["label"]),(0,t.Lk)("div",a,[(0,t.Lk)("div",d,[(0,t.Lk)("div",c,[(0,t.bF)(J,{flat:"",rounded:"","data-cy":"workflow_builder",color:"primary",to:"/workflows"},{default:(0,t.k6)((()=>[(0,t.bF)(G,{class:"text-red-13",size:"sm"},{default:(0,t.k6)((()=>[n])),_:1}),(0,t.Lk)("label",r,(0,i.v_)(e.$t("processes")),1)])),_:1})])]),(0,t.Lk)("div",u,[(0,t.Lk)("div",m,[(0,t.Lk)("div",p,[(0,t.Lk)("div",w,[(0,t.Lk)("div",k,[(0,t.bF)(J,{outline:"",icon:"add",color:"primary",label:e.$t("add_criteria"),class:"float-right q-mr-md",onClick:l[0]||(l[0]=l=>e.openAddCriteriadlg())},null,8,["label"])])]),(0,t.Lk)("div",v,[(0,t.Lk)("div",g,[(0,t.Lk)("label",f,(0,i.v_)(e.$t("start")),1)])]),(0,t.Lk)("div",b,[(0,t.Lk)("div",h,[(0,t.bF)(G,{name:"las la-long-arrow-alt-down color-B1B1B1",size:"lg"})])]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.workflowBuilderModel,((l,o)=>((0,t.uX)(),(0,t.CE)(t.FK,{key:o},[(0,t.Lk)("div",_,[(0,t.Lk)("div",x,[(0,t.Lk)("div",{class:(0,i.C4)(["criteria-box back-white align-center cursor-pointer",o==e.selectedRowIndex&&e.isConditionContent?"active-criteria-box back-white":""]),onClick:l=>e.setSelectionType(!0,o)},[(0,t.Lk)("div",L,(0,i.v_)(e.$t("criteria")),1)],10,F)]),(0,t.Lk)("div",C,[(0,t.Lk)("div",null,[(0,t.eW)((0,i.v_)(e.$t("true"))+" ",1),(0,t.bF)(G,{name:"las la-long-arrow-alt-right color-B1B1B1",size:"lg"})])]),(0,t.Lk)("div",q,[(0,t.Lk)("div",{class:(0,i.C4)(["row action-box cursor-pointer",o!=e.selectedRowIndex||e.isConditionContent?"":"active-border"])},[(0,t.Lk)("div",{class:(0,i.C4)(["col-sm-12 col-md-12 col-lg-12 flow-text action-header",o!=e.selectedRowIndex||e.isConditionContent?"":"active-border-bottom"])},(0,i.v_)(e.$t("immediate_action")),3),(0,t.Lk)("div",y,[(0,t.bF)(J,{flat:"",color:"primary",icon:"add",label:e.$t("add_action"),size:"sm",onClick:l=>e.setSelectionType(!1,o)},null,8,["label","onClick"])])],2)]),(0,t.Lk)("div",I,[(0,t.Lk)("div",null,[(0,t.bF)(G,{name:"las la-long-arrow-alt-right color-B1B1B1",size:"lg"}),(0,t.Lk)("label",A,(0,i.v_)(e.$t("form_builder.done")),1)])])]),(0,t.Lk)("div",R,[(0,t.Lk)("div",B,(0,i.v_)(e.$t("false")),1),V,(0,t.Lk)("div",$,[(0,t.bF)(G,{name:"las la-long-arrow-alt-down color-B1B1B1",size:"lg"})]),M])],64)))),128)),(0,t.Lk)("div",D,[(0,t.Lk)("div",E,[(0,t.Lk)("label",S,(0,i.v_)(e.$t("form_builder.done")),1)])])]),(0,t.Lk)("div",Q,[e.isConditionContent&&e.workflowBuilderModel[e.selectedRowIndex]&&e.workflowBuilderModel[e.selectedRowIndex].criteria?((0,t.uX)(),(0,t.Wv)(Y,{key:0})):(0,t.Q3)("",!0),!e.isConditionContent&&e.workflowBuilderModel[e.selectedRowIndex]&&e.workflowBuilderModel[e.selectedRowIndex].action?((0,t.uX)(),(0,t.Wv)(Z,{key:1})):(0,t.Q3)("",!0),(0,t.Lk)("div",T,[(0,t.Lk)("div",U,[(0,t.bF)(J,{flat:"",color:"primary",label:e.$t("delete_selected_criteria"),class:"float-left",onClick:l[1]||(l[1]=l=>e.deleteSelectedCriteria())},null,8,["label"]),(0,t.bF)(J,{color:"primary",label:e.$t("save"),class:"float-right",onClick:l[2]||(l[2]=l=>e.saveWorkFlow())},null,8,["label"]),(0,t.bF)(J,{color:"white","text-color":"black",label:e.$t("cancel"),class:"float-right q-ml-sm q-mr-sm"},null,8,["label"])])])])])])]),(0,t.bF)(ae,{modelValue:e.showAddCriteriaBox,"onUpdate:modelValue":l[5]||(l[5]=l=>e.showAddCriteriaBox=l),persistent:""},{default:(0,t.k6)((()=>[(0,t.bF)(se,{style:{width:"500px"}},{default:(0,t.k6)((()=>[(0,t.bF)(le,{class:"row items-center q-pb-none secondary-c-text"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",W,(0,i.v_)(e.$t("add_criteria")),1),(0,t.bF)(ee)])),_:1}),(0,t.bF)(oe),(0,t.bF)(le,null,{default:(0,t.k6)((()=>[(0,t.Lk)("div",O,[(0,t.Lk)("div",K,[(0,t.Lk)("div",X,[(0,t.Lk)("div",z,[(0,t.bF)(te,{modelValue:e.criteriaValue,"onUpdate:modelValue":l[3]||(l[3]=l=>e.criteriaValue=l),options:e.criteriaOptions,color:"primary"},null,8,["modelValue","options"])]),(0,t.bF)(oe)])])])])),_:1}),(0,t.bF)(oe),(0,t.bF)(ie,{class:"back-white text-teal"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",N,[(0,t.bo)((0,t.bF)(J,{label:e.$t("cancel"),color:"primary",outline:""},null,8,["label"]),[[ce]]),(0,t.bo)((0,t.bF)(J,{label:e.$t("create"),color:"primary",onClick:l[4]||(l[4]=l=>e.createCriteria()),class:"q-ml-md"},null,8,["label"]),[[ce]])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(de)],64)}var j=o(1659),H=o(16332),G=o(24622),J=o(38734),Y=o(96056),Z=o(89156),ee=o(18505),le=o(11470),oe=o(1595);const te={class:"row q-pa-sm back-white"},ie={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},se={class:"secondary-c-text"},ae={class:"row q-pa-md"},de={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ce={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ne={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},re={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ue={key:0,class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},me={class:"row"},pe={key:0,class:"col-sm-12 col-md-12 col-lg-12"},we={class:"row q-pa-xs q-mt-md"},ke={class:"row q-pa-md workflow-border"},ve=(0,t.Lk)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),ge={class:"col-sm-5 col-md-4 col-lg-5 q-pr-sm"},fe={class:"col-sm-5 col-md-4 col-lg-5 q-pl-sm"},be=(0,t.Lk)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),he={key:1,class:"row full-width"},_e={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs q-mt-md"},xe={class:"col-sm-12 col-md-12 col-lg-12"};function Fe(e,l,o,s,a,d){const c=(0,t.g2)("q-icon"),n=(0,t.g2)("q-input"),r=(0,t.g2)("q-item-section"),u=(0,t.g2)("q-item"),m=(0,t.g2)("q-select"),p=(0,t.g2)("ActionFieldsView");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",te,[(0,t.Lk)("div",ie,[(0,t.Lk)("span",se,(0,i.v_)(e.$t("define_action_for_this_group")),1),(0,t.bF)(c,{name:"help",class:"float-right",size:"sm"})])]),(0,t.Lk)("div",ae,[(0,t.Lk)("div",de,[(0,t.eW)((0,i.v_)(e.$t("action_name"))+"* ",1),(0,t.bF)(c,{name:"info",size:"xs"})]),(0,t.Lk)("div",ce,[(0,t.bF)(n,{outlined:"",dense:"",modelValue:e.workflowBuilderModel[e.selectedRowIndex].action.name,"onUpdate:modelValue":l[0]||(l[0]=l=>e.workflowBuilderModel[e.selectedRowIndex].action.name=l),placeholder:e.$t("name"),class:"back-white"},null,8,["modelValue","placeholder"])]),(0,t.Lk)("div",ne,[(0,t.eW)((0,i.v_)(e.$t("action_type"))+"* ",1),(0,t.bF)(c,{name:"info",size:"xs"})]),(0,t.Lk)("div",re,[(0,t.bF)(m,{dense:"",outlined:"","emit-value":"","map-options":"",clearable:"","use-input":"","hide-selected":"","fill-input":"","hide-dropdown-icon":"",class:"back-white",options:e.actionTypes,modelValue:e.workflowBuilderModel[e.selectedRowIndex].action.type,"onUpdate:modelValue":[l[1]||(l[1]=l=>e.workflowBuilderModel[e.selectedRowIndex].action.type=l),l[2]||(l[2]=l=>e.setActionNode())],"input-debounce":"0",label:e.$t("action_type")},{"no-option":(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)(r,{class:"text-grey"},{default:(0,t.k6)((()=>[(0,t.eW)(" $t"+(0,i.v_)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:1},8,["options","modelValue","label"])]),e.workflowBuilderModel[e.selectedRowIndex].action.type?((0,t.uX)(),(0,t.CE)("div",ue,[(0,t.Lk)("div",me,[e.workflowBuilderModel[e.selectedRowIndex].action.type==e.fieldUpdate?((0,t.uX)(),(0,t.CE)("div",pe,[(0,t.Lk)("div",we,(0,i.v_)(e.$t("add_actions")),1),(0,t.Lk)("div",ke,[ve,(0,t.Lk)("div",ge,(0,i.v_)(e.$t("pages.settings.fields"))+"* ",1),(0,t.Lk)("div",fe,(0,i.v_)(e.$t("value"))+"* ",1),be,(0,t.bF)(p)])])):((0,t.uX)(),(0,t.CE)("div",he,[(0,t.Lk)("div",_e,(0,i.v_)(e.$t("status")),1),(0,t.Lk)("div",xe,[(0,t.bF)(m,{outlined:"",dense:"",modelValue:e.workflowBuilderModel[e.selectedRowIndex].action.action_elements[0].status,"onUpdate:modelValue":l[3]||(l[3]=l=>e.workflowBuilderModel[e.selectedRowIndex].action.action_elements[0].status=l),options:e.document_statuses_list,"emit-value":"","map-options":"",class:"back-white",label:e.$t("status")},null,8,["modelValue","options","label"])])]))])])):(0,t.Q3)("",!0)])],64)}var Le=o(76956);const Ce={class:"col-sm-1 col-md-1 col-lg-1"},qe={class:"workflow-count-box q-mr-md"},ye={class:"col-sm-5 col-md-5 col-lg-5 q-pr-sm"},Ie={class:"col-sm-5 col-md-5 col-lg-5 q-pl-sm"},Ae={class:"col-sm-1 col-md-1 col-lg-1"},Re={class:"col-sm-12 col-md-12 col-lg-12"};function Be(e,l,o,s,a,d){const c=(0,t.g2)("q-item-section"),n=(0,t.g2)("q-item"),r=(0,t.g2)("q-select"),u=(0,t.g2)("q-input"),m=(0,t.g2)("q-btn");return(0,t.uX)(),(0,t.CE)(t.FK,null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.workflowBuilderModel[e.selectedRowIndex].action.action_elements,((l,o)=>((0,t.uX)(),(0,t.CE)("div",{key:o+"_"+o,class:"row q-pb-xs full-width"},[(0,t.Lk)("div",Ce,[(0,t.Lk)("span",qe,(0,i.v_)(o+1),1)]),(0,t.Lk)("div",ye,[(0,t.bF)(r,{dense:"",outlined:"","emit-value":"","map-options":"",clearable:"","use-input":"","hide-selected":"","fill-input":"","hide-dropdown-icon":"",class:"back-white",modelValue:l.field,"onUpdate:modelValue":e=>l.field=e,"input-debounce":"0",label:e.$t("select_a_field"),options:e.filteredDocFields,onFilter:e.filterlistEvent},{"no-option":(0,t.k6)((()=>[(0,t.bF)(n,null,{default:(0,t.k6)((()=>[(0,t.bF)(c,{class:"text-grey"},{default:(0,t.k6)((()=>[(0,t.eW)(" $t"+(0,i.v_)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","label","options","onFilter"])]),(0,t.Lk)("div",Ie,[(0,t.bF)(u,{outlined:"",dense:"",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,class:"back-white"},null,8,["modelValue","onUpdate:modelValue"])]),(0,t.Lk)("div",Ae,[(0,t.bF)(m,{flat:"",color:"primary",icon:"close",onClick:l=>e.removeAction(o)},null,8,["onClick"])])])))),128)),(0,t.Lk)("div",Re,[(0,t.bF)(m,{flat:"",color:"primary",icon:"add",label:e.$t("pages.settings.master_data_lookup.add_row"),onClick:l[0]||(l[0]=l=>e.addRowToActions(e.selectedRowIndex))},null,8,["label"])])],64)}const Ve=(0,t.pM)({el:"#app",mixins:[],components:{},data(){return{criteriaName:(0,J.KR)("")}},mounted(){this.loadDocumentDefaultFields("INVOICE")},methods:{filterlistEvent(e,l,o){l(e?()=>{const l=e.toLowerCase();this.filteredDocFields=this.docFields.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{this.filteredDocFields=this.docFields})},removeAction(e){this.workflowBuilderModel[this.selectedRowIndex].action.action_elements.splice(e,1)}},setup(){const e=(0,oe.r9)(),{loadDocumentDefaultFields:l,addRowToActions:o}=e,{docFields:t,workflowBuilderModel:i,selectedRowIndex:s}=(0,j.bP)(e);return{docFields:t,filteredDocFields:(0,J.KR)([]),selectedRowIndex:s,workflowBuilderModel:i,addRowToActions:o,loadDocumentDefaultFields:l}}});var $e=o(12807),Me=o(94940),De=o(90124),Ee=o(25173),Se=o(67837),Qe=o(56384),Te=o(98582),Ue=o.n(Te);const We=(0,$e.A)(Ve,[["render",Be]]),Oe=We;Ue()(Ve,"components",{QSelect:Me.A,QItem:De.A,QItemSection:Ee.A,QInput:Se.A,QBtn:Qe.A});const Ke=(0,t.pM)({name:"ActionFieldView",mixins:[],components:{ActionFieldsView:Oe},data(){return{fieldUpdate:Le.aH.field_update}},mounted:function(){this.getDocumentStatuses()},methods:{setActionNode(){this.workflowBuilderModel[this.selectedRowIndex].action.action_elements=[],this.workflowBuilderModel[this.selectedRowIndex].action.type==this.fieldUpdate?this.addRowToActions(this.selectedRowIndex):this.addRowToActionsForStatusChange(this.selectedRowIndex)}},setup(){const e=(0,oe.r9)(),{addRowToActions:l,addRowToActionsForStatusChange:o}=e,{workflowBuilderModel:t,selectedRowIndex:i}=(0,j.bP)(e),s=(0,oe.cY)(),{document_statuses_list:a}=(0,j.bP)(s),{getDocumentStatuses:d}=s;return{selectedRowIndex:i,workflowBuilderModel:t,actionTypes:[{label:"Update Field",value:Le.aH.field_update},{label:"Change Status",value:Le.aH.status_change}],document_statuses_list:a,getDocumentStatuses:d,addRowToActions:l,addRowToActionsForStatusChange:o}}});var Xe=o(50492);const ze=(0,$e.A)(Ke,[["render",Fe]]),Ne=ze;Ue()(Ke,"components",{QIcon:Xe.A,QInput:Se.A,QSelect:Me.A,QItem:De.A,QItemSection:Ee.A});const Pe={class:"row q-pa-sm back-white"},je={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},He={class:"secondary-c-text"},Ge={class:"row q-pa-md"},Je={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},Ye={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},Ze={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs q-mt-md"},el={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ll={class:"row q-pa-md workflow-border"},ol=(0,t.Lk)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),tl={class:"col-sm-4 col-md-4 col-lg-4"},il={class:"col-sm-2 col-md-2 col-lg-2"},sl={class:"col-sm-3 col-md-3 col-lg-3"},al={class:"col-sm-5 col-md-5 col-lg-5"},dl={class:"col-sm-4 col-md-4 col-lg-4 q-pl-md"},cl=(0,t.Lk)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),nl={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"};function rl(e,l,o,s,a,d){const c=(0,t.g2)("q-icon"),n=(0,t.g2)("q-input"),r=(0,t.g2)("CriteriaFieldView"),u=(0,t.g2)("q-option-group");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",Pe,[(0,t.Lk)("div",je,[(0,t.Lk)("span",He,(0,i.v_)(e.$t("define_criteria_for_action_group")),1),(0,t.bF)(c,{name:"help",class:"float-right",size:"sm"})])]),(0,t.Lk)("div",Ge,[(0,t.Lk)("div",Je,[(0,t.eW)((0,i.v_)(e.$t("criteria_name")+"*")+" ",1),(0,t.bF)(c,{name:"info",size:"xs"})]),(0,t.Lk)("div",Ye,[(0,t.bF)(n,{outlined:"",dense:"",modelValue:e.workflowBuilderModel[e.selectedRowIndex].criteria.name,"onUpdate:modelValue":l[0]||(l[0]=l=>e.workflowBuilderModel[e.selectedRowIndex].criteria.name=l),placeholder:e.$t("name"),class:"back-white"},null,8,["modelValue","placeholder"])]),(0,t.Lk)("div",Ze,(0,i.v_)(e.$t("set_conditions")),1),(0,t.Lk)("div",el,[(0,t.Lk)("div",ll,[ol,(0,t.Lk)("div",tl,(0,i.v_)(e.$t("pages.settings.fields"))+"* ",1),(0,t.Lk)("div",il,(0,i.v_)(e.$t("operator"))+"* ",1),(0,t.Lk)("div",sl,(0,i.v_)(e.$t("priority"))+"* ",1),(0,t.Lk)("div",al,(0,i.v_)(e.$t("math_operator"))+"* ",1),(0,t.Lk)("div",dl,(0,i.v_)(e.$t("doc2light.popups.value"))+"* ",1),cl,(0,t.bF)(r)])]),(0,t.Lk)("div",nl,[(0,t.bF)(u,{modelValue:e.workflowBuilderModel[e.selectedRowIndex].criteria.type,"onUpdate:modelValue":l[1]||(l[1]=l=>e.workflowBuilderModel[e.selectedRowIndex].criteria.type=l),options:e.operatorOptions,color:"primary"},null,8,["modelValue","options"])])])],64)}const ul={class:"col-sm-1 col-md-1 col-lg-1"},ml={class:"workflow-count-box q-mr-md"},pl={class:"col-sm-4 col-md-4 col-lg-4 q-pr-md"},wl={class:"col-sm-2 col-md-2 col-lg-2"},kl={class:"col-sm-3 col-md-3 col-lg-3"},vl={class:"col-sm-5 col-md-5 col-lg-5"},gl={class:"col-sm-4 col-md-4 col-lg-4 q-pl-md"},fl={class:"col-sm-1 col-md-1 col-lg-1"},bl={class:"col-sm-12 col-md-12 col-lg-12"};function hl(e,l,o,s,a,d){const c=(0,t.g2)("q-item-section"),n=(0,t.g2)("q-item"),r=(0,t.g2)("q-select"),u=(0,t.g2)("q-input"),m=(0,t.g2)("q-btn");return(0,t.uX)(),(0,t.CE)(t.FK,null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.workflowBuilderModel[e.selectedRowIndex].criteria.condition_elements,((l,o)=>((0,t.uX)(),(0,t.CE)("div",{key:o,class:"row q-pb-xs full-width"},[(0,t.Lk)("div",ul,[(0,t.Lk)("span",ml,(0,i.v_)(o+1),1)]),(0,t.Lk)("div",pl,[(0,t.bF)(r,{dense:"",outlined:"","emit-value":"","map-options":"",clearable:"","use-input":"","hide-selected":"","fill-input":"","hide-dropdown-icon":"",class:"back-white",modelValue:l.key,"onUpdate:modelValue":e=>l.key=e,"input-debounce":"0",label:e.$t("select_a_field"),options:e.filteredDocFields,onFilter:e.filterlistEvent},{"no-option":(0,t.k6)((()=>[(0,t.bF)(n,null,{default:(0,t.k6)((()=>[(0,t.bF)(c,{class:"text-grey"},{default:(0,t.k6)((()=>[(0,t.eW)(" $t"+(0,i.v_)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","label","options","onFilter"])]),(0,t.Lk)("div",wl,[(0,t.bF)(r,{dense:"",outlined:"",modelValue:l.match_type,"onUpdate:modelValue":e=>l.match_type=e,class:"back-white",label:e.$t("please_select"),"emit-value":"","map-options":"",options:e.operators},null,8,["modelValue","onUpdate:modelValue","label","options"])]),(0,t.Lk)("div",kl,[(0,t.bF)(r,{dense:"",outlined:"",modelValue:l.match_type,"onUpdate:modelValue":e=>l.match_type=e,class:"back-white",label:e.$t("please_select"),"emit-value":"","map-options":"",options:e.priority},null,8,["modelValue","onUpdate:modelValue","label","options"])]),(0,t.Lk)("div",vl,[(0,t.bF)(r,{dense:"",outlined:"",modelValue:l.match_type,"onUpdate:modelValue":e=>l.match_type=e,class:"back-white",label:e.$t("please_select"),"emit-value":"","map-options":"",options:e.math_operators},null,8,["modelValue","onUpdate:modelValue","label","options"])]),(0,t.Lk)("div",gl,[(0,t.bF)(u,{outlined:"",dense:"",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,class:"back-white"},null,8,["modelValue","onUpdate:modelValue"])]),(0,t.Lk)("div",fl,[(0,t.bF)(m,{flat:"",color:"primary",icon:"close",onClick:l=>e.removeCondition(o)},null,8,["onClick"])])])))),128)),(0,t.Lk)("div",bl,[(0,t.bF)(m,{flat:"",color:"primary",icon:"add",label:e.$t("pages.settings.master_data_lookup.add_row"),onClick:l[0]||(l[0]=l=>e.addRowToCondition(e.selectedRowIndex))},null,8,["label"])])],64)}const _l=(0,t.pM)({name:"criteriaField",mixins:[],components:{},data(){return{criteriaName:(0,J.KR)("")}},mounted(){const e=this.$route.params.doc_type;this.loadDocumentDefaultFields(e)},methods:{filterlistEvent(e,l,o){l(e?()=>{const l=e.toLowerCase();this.filteredDocFields=this.docFields.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{this.filteredDocFields=this.docFields})},removeCondition(e){this.workflowBuilderModel[this.selectedRowIndex].criteria.condition_elements.splice(e,1)}},setup(){const e=(0,oe.r9)(),{loadDocumentDefaultFields:l,addRowToCondition:o}=e,{docFields:t,workflowBuilderModel:i,selectedRowIndex:s}=(0,j.bP)(e);return{docFields:t,filteredDocFields:(0,J.KR)([]),selectedRowIndex:s,workflowBuilderModel:i,addRowToCondition:o,loadDocumentDefaultFields:l,operators:[{value:"eq",label:H.i18n.t("equal")},{value:"ne",label:H.i18n.t("not_equal")},{value:"gt",label:H.i18n.t("greater_than")},{value:"lt",label:H.i18n.t("less_than")}],priority:[{value:"high",label:H.i18n.t("high")},{value:"medium",label:H.i18n.t("medium")},{value:"low",label:H.i18n.t("low")}],math_operators:[{value:"+",label:H.i18n.t("plus")},{value:"-",label:H.i18n.t("minus")},{value:"/",label:H.i18n.t("divided")},{value:"*",label:H.i18n.t("multiplied")}]}}}),xl=(0,$e.A)(_l,[["render",hl]]),Fl=xl;Ue()(_l,"components",{QSelect:Me.A,QItem:De.A,QItemSection:Ee.A,QInput:Se.A,QBtn:Qe.A});const Ll=(0,t.pM)({name:"criteriaField",mixins:[],components:{CriteriaFieldView:Fl},data(){return{}},methods:{},setup(){const e=(0,oe.r9)(),{workflowBuilderModel:l,selectedRowIndex:o}=(0,j.bP)(e);return{selectedRowIndex:o,workflowBuilderModel:l,operatorOptions:[{label:H.i18n.t("all_conditions_met_and"),value:"and"},{label:H.i18n.t("all_conditions_met_or"),value:"or"}],criteriaOptions:[{label:H.i18n.t("update_records_that_meet_all_conditions"),value:"all_conditions"},{label:H.i18n.t("no_criteria_update_all_records"),value:"no_conditions"}]}}});var Cl=o(61003);const ql=(0,$e.A)(Ll,[["render",rl]]),yl=ql;Ue()(Ll,"components",{QIcon:Xe.A,QInput:Se.A,QOptionGroup:Cl.A});var Il=o(68180),Al=function(e,l,o,t){function i(e){return e instanceof o?e:new o((function(l){l(e)}))}return new(o||(o=Promise))((function(o,s){function a(e){try{c(t.next(e))}catch(l){s(l)}}function d(e){try{c(t["throw"](e))}catch(l){s(l)}}function c(e){e.done?o(e.value):i(e.value).then(a,d)}c((t=t.apply(e,l||[])).next())}))};const Rl=(0,t.pM)({name:"workflowDesigner",mixins:[G.A,Y.A,ee.A],components:{Loader:Z.A,SubHeader:Il.A,Criteria:yl,Action:Ne},data(){return{workFlowId:(0,J.KR)(""),criteriaValue:(0,J.KR)("after"),showAddCriteriaBox:(0,J.KR)(!1),isConditionContent:(0,J.KR)(!0)}},mounted(){this.workflowBuilderModel=[],this.workFlowId=this.$route.params.id,this.workFlowId&&(this.loadWorkFlowBuilderById(),this.prepareCriteriaOptions())},unmounted:function(){logInfo("unmounted")},methods:{openAddCriteriadlg(){this.showAddCriteriaBox=!0,this.criteriaValue="after"},createCriteria(){let e=this.selectedRowIndex;"after"==this.criteriaValue&&(e+=1),this.addCriteria(e)},deleteSelectedCriteria(){let e=this.deleteCriteria(this.selectedRowIndex);e?this.showSuccessToast(this.$t("pages.messages.CRITERIA_DELETED")):this.showSuccessToast(this.$t("pages.messages.CRITERIA_VALUE_CLEARED"))},setSelectionType(e,l){this.isConditionContent=e,this.selectedRowIndex=l},loadWorkFlowBuilderById(){return Al(this,void 0,void 0,(function*(){let e;try{this.showLoading(),e=yield le.Bj.getWorkflowJson(this.workFlowId),e&&e.conditions&&e.actions&&e.logic?this.prepareWorkflowBuilderModel(e):this.loadDefaultWorkFlowJson()}catch(l){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(l)}finally{this.hideLoading()}}))},prepareWorkflowBuilderModel(e){let l=new Map,o=new Map,t=new Map;for(const d of e.conditions)t.set(d.id,d);for(const d of e.actions)o.set(d.id,d);for(const d of e.logic.nodes)d.hasOwnProperty("next_step")||l.set(d.id,d);let i=e.logic.start,s={criteria:t.get(i.id),action:o.get(i.true)},a=i.false;this.workflowBuilderModel.push(s);while(l.size>0)i=l.get(a),s={criteria:t.get(i.id),action:o.get(i.true)},this.workflowBuilderModel.push(s),a=i.false,l.delete(i.id)},validateConditionsNode(e,l){let o=!1;e.name||(o=!0);for(const t of e.condition_elements)if(!t.key||!t.match_type||!t.value){this.setSelectionType(!0,l),o=!0;break}return o},validateActionNode(e,l){let o=!1;e.name||(o=!0);for(const t of e.action_elements)if(t.hasOwnProperty("field")&&!t.field||t.hasOwnProperty("value")&&!t.value||t.hasOwnProperty("status")&&!t.status){this.setSelectionType(!1,l),o=!0;break}return o},saveWorkFlow(){0==this.workflowBuilderModel.length&&this.showErrorToast("No Data found to save");let e=[],l=[],o=[],t={},i=null,s=null;for(const[d,c]of Object.entries(this.workflowBuilderModel)){let t=c;if(this.validateConditionsNode(t.criteria,+d)||this.validateActionNode(t.action,+d))return void this.showErrorToast(this.$t("pages.messages.MISSING_FIELD"));e.push(t.criteria),l.push(t.action),i=this.workflowBuilderModel[+d+1],s=null,i&&(s=i.criteria.id),o.push(Object.assign({},{false:s,id:t.criteria.id,true:t.action.id})),o.push(Object.assign({},{id:t.action.id,next_step:null}))}t=o[0],o.splice(0,1);const a={actions:l,conditions:e,logic:{nodes:o,start:t}};logInfo(a),this.proceedWorkflowSaving(a)},proceedWorkflowSaving(e){let l;try{this.showLoading(),logInfo(l),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(o){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(o)}finally{this.hideLoading()}},prepareCriteriaOptions(){this.criteriaOptions=[{label:H.i18n.t("add_criteria_after_current_criteria"),value:"after"},{label:H.i18n.t("add_criteria_before_current_criteria"),value:"before"}]}},setup(){const e=(0,oe.r9)(),{addCriteria:l,deleteCriteria:o,loadDefaultWorkFlowJson:t}=e,{workflowBuilderModel:i,selectedRowIndex:s}=(0,j.bP)(e);return e.$reset(),{selectedRowIndex:s,workflowBuilderModel:i,addCriteria:l,deleteCriteria:o,loadDefaultWorkFlowJson:t,criteriaOptions:(0,J.KR)([])}}});var Bl=o(82156),Vl=o(23316),$l=o(44189),Ml=o(93676),Dl=o(10386),El=o(62669),Sl=o(88672);const Ql=(0,$e.A)(Rl,[["render",P],["__scopeId","data-v-371864e6"]]),Tl=Ql;Ue()(Rl,"components",{QBtn:Qe.A,QIcon:Xe.A,QDialog:Bl.A,QCard:Vl.A,QCardSection:$l.A,QSpace:Ml.A,QSeparator:Dl.A,QOptionGroup:Cl.A,QCardActions:El.A}),Ue()(Rl,"directives",{ClosePopup:Sl.A})}}]);