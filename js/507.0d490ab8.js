"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[507],{507:(e,t,s)=>{s.r(t),s.d(t,{default:()=>uo});var o=s(59835),i=s(86970);const l={class:"container"},a={style:{width:"100%"}},r={style:{"margin-top":"3px"}},n={style:{"margin-top":"3px"}},d={style:{"margin-top":"3px"}};function c(e,t,s,c,u,m){const p=(0,o.up)("SubHeader"),_=(0,o.up)("BackToSettings"),h=(0,o.up)("q-separator"),g=(0,o.up)("q-icon"),w=(0,o.up)("q-space"),f=(0,o.up)("PageRestriction"),y=(0,o.up)("q-card-section"),b=(0,o.up)("q-card"),v=(0,o.up)("q-expansion-item"),k=(0,o.up)("FtpImportList"),E=(0,o.up)("EmailImportList"),q=(0,o.up)("q-list");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(p,{name:"import_settings",label:e.$t("Import")},null,8,["label"]),(0,o.Wm)(_),(0,o._)("div",l,[(0,o._)("div",a,[(0,o._)("div",null,[(0,o.Wm)(q,{bordered:"",class:"rounded-borders"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,o.w5)((()=>[(0,o.Wm)(g,{size:"25px",class:"q-mr-lg black_to_white",name:"img:settings/doc.svg"}),(0,o._)("span",r,(0,i.zw)(e.$t("pages.import.email_import")),1),(0,o.Wm)(w)])),default:(0,o.w5)((()=>[(0,o.Wm)(h),(0,o.Wm)(b,{class:"page-background"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(v,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,o.w5)((()=>[(0,o.Wm)(g,{size:"25px",class:"q-mr-lg black_to_white",name:"img:settings/email-import.svg"}),(0,o._)("span",n,(0,i.zw)(e.$t("ftp_import")),1),(0,o.Wm)(w)])),default:(0,o.w5)((()=>[(0,o.Wm)(h),(0,o.Wm)(b,{class:"page-background"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(k)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(v,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,o.w5)((()=>[(0,o.Wm)(g,{size:"25px",class:"q-mr-lg black_to_white",name:"img:settings/email-import.svg"}),(0,o._)("span",d,(0,i.zw)(e.$t("pages.settings.email_import")),1),(0,o.Wm)(w)])),default:(0,o.w5)((()=>[(0,o.Wm)(h),(0,o.Wm)(b,{class:"page-background"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(E)])),_:1})])),_:1})])),_:1})])),_:1})])])])],64)}var u=s(16308),m=s(17256);const p={class:"import-container q-pa-xl"},_={class:"row"},h={style:{width:"30%",margin:"auto","padding-right":"5%"}},g={style:{width:"30%"}},w=(0,o.Uk)(" Ony process given number of pages every further page will be ignored. "),f=(0,o._)("div",{style:{width:"40%",margin:"auto","padding-left":"5%"}},null,-1),y={class:"row q-py-sm"},b={style:{width:"30%",margin:"auto","padding-right":"5%"}},v={style:{width:"30%"}},k=(0,o._)("div",{style:{width:"40%"}},null,-1),E={class:"row"},q={style:{width:"30%",margin:"auto","padding-right":"5%"}},C={style:{width:"30%"}},W=(0,o._)("div",{style:{width:"40%"}},null,-1);function O(e,t,s,l,a,r){const n=(0,o.up)("q-tooltip"),d=(0,o.up)("q-input"),c=(0,o.up)("q-select");return(0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("div",_,[(0,o._)("div",h,(0,i.zw)(e.$t("restrict_to_pages")),1),(0,o._)("div",g,[(0,o.Wm)(d,{outlined:"",dense:"",tabindex:"0",type:"number",class:(0,i.C_)("full-width back-white"),modelValue:e.settings_model["RESTRICT_TO_PAGES"],"onUpdate:modelValue":[t[0]||(t[0]=t=>e.settings_model["RESTRICT_TO_PAGES"]=t),t[1]||(t[1]=t=>{e.saveSettings("RESTRICT_TO_PAGES",t)})]},{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[w])),_:1})])),_:1},8,["modelValue"])]),f]),(0,o._)("div",y,[(0,o._)("div",b,(0,i.zw)(e.$t("payment_terms_days")),1),(0,o._)("div",v,[(0,o.Wm)(d,{outlined:"",dense:"",tabindex:"0",type:"number",class:(0,i.C_)("full-width back-white"),modelValue:e.settings_model["PAYMENT_TERMS_DAYS"],"onUpdate:modelValue":[t[2]||(t[2]=t=>e.settings_model["PAYMENT_TERMS_DAYS"]=t),t[3]||(t[3]=t=>{e.saveSettings("PAYMENT_TERMS_DAYS",t)})]},null,8,["modelValue"])]),k]),(0,o._)("div",E,[(0,o._)("div",q,(0,i.zw)(e.$t("date_pattern")),1),(0,o._)("div",C,[(0,o.Wm)(c,{outlined:"",dense:"",class:"back-white",modelValue:e.settings_model["DATE_PATTERN"],"onUpdate:modelValue":[t[4]||(t[4]=t=>e.settings_model["DATE_PATTERN"]=t),t[5]||(t[5]=t=>{e.saveSettings("DATE_PATTERN",t)})],options:[{label:e.$t("select"),value:""},{label:"%d/%m/%Y",value:"%d/%m/%Y"},{label:"%d.%m.%Y",value:"%d.%m.%Y"},{label:"%m %d, %Y",value:"%m %d, %Y"},{label:"%Y %m, %d",value:"%Y %m, %d"}],"emit-value":"","map-options":"",label:e.$t("date_pattern")},null,8,["modelValue","options","label"])]),W])])}var S=s(60499),T=s(70501),L=s(49990),$=s(39981),V=s.n($),x=s(37744),U=s(15877),I=s(19302),Z=function(e,t,s,o){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{n(o.next(e))}catch(t){l(t)}}function r(e){try{n(o["throw"](e))}catch(t){l(t)}}function n(e){e.done?s(e.value):i(e.value).then(a,r)}n((o=o.apply(e,t||[])).next())}))};const R=(0,o.aZ)({mixins:[T.Z,L.Z],mounted:function(){this.getSettings()},methods:{getSettings(){return Z(this,void 0,void 0,(function*(){let e;this.showLoading();try{let t=yield(0,x.O_)();e=yield V().get(x.hi.get_preferences,{headers:{"Content-Type":"multipart/form-data",Authorization:t}})}catch(t){return this.hideLoading(),void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}if(this.hideLoading(),e.data)for(let[s,o]of Object.entries(e.data))this.settings_model[s]="true"==o||"false"!=o&&o}))},saveSettings(e,t){return Z(this,void 0,void 0,(function*(){if(!e)return;this.showLoading();let s=new FormData;s.append("key",e),s.append("value",t);try{let e=yield(0,x.O_)();yield V().put(x.hi.set_preference,s,{headers:{"Content-Type":"multipart/form-data",Authorization:e}})}catch(o){return this.hideLoading(),void this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}this.hideLoading(),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),(0,U.vq)(e,t)}))}},setup(){const e=(0,I.Z)(),t={};let s=[];return{settings_model:(0,S.iH)(t),display_data:[],icon:(0,S.iH)(!1),columns:s,processing:(0,S.iH)(!1),showNotification(t){e.notify({message:t,color:"primary",position:"top"})}}},data(){return{userDialog:(0,S.iH)(!1),api_key:""}}});var D=s(7683),H=s(13119),z=s(46858),Q=s(32259),A=s(69984),M=s.n(A);const P=(0,D.Z)(R,[["render",O]]),F=P;M()(R,"components",{QInput:H.Z,QTooltip:z.Z,QSelect:Q.Z});var j=s(61957);const N={class:"container q-pa-xl"},Y={class:"row",style:{"margin-bottom":"15px"}},K={style:{width:"20%",margin:"auto"}},J={style:{width:"80%"}},X={class:"row"},B={class:"row float-right"},G={class:"text-red-14"},ee=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function te(e,t,s,l,a,r){const n=(0,o.up)("f-btn"),d=(0,o.up)("ImportLogs"),c=(0,o.up)("q-th"),u=(0,o.up)("q-tr"),m=(0,o.up)("q-item-section"),p=(0,o.up)("q-item"),_=(0,o.up)("q-separator"),h=(0,o.up)("q-list"),g=(0,o.up)("q-menu"),w=(0,o.up)("q-btn"),f=(0,o.up)("q-td"),y=(0,o.up)("q-table"),b=(0,o.up)("q-inner-loading"),v=(0,o.up)("EditCreate"),k=(0,o.up)("q-dialog"),E=(0,o.up)("ConnectionLogs");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",N,[(0,o._)("div",Y,[(0,o._)("div",K,(0,i.zw)(e.$t("pages.import.email")),1),(0,o._)("div",J,[(0,o.Uk)((0,i.zw)(e.$t("pages.import.email_info"))+" ",1),(0,o._)("a",{onClick:t[0]||(t[0]=(...t)=>e.webSiteLink&&e.webSiteLink(...t)),class:"cursor-pointer",target:"_blank",style:{color:"#2388AE"}},(0,i.zw)(e.$t("pages.import.email_link")),1)]),(0,o.Wm)(n,{class:"q-ml-auto",icon:"add",label:e.$t("new"),onClick:e.createNewRecord},null,8,["label","onClick"]),(0,o.Wm)(d,{setheight:"36px"})]),(0,o._)("div",X,[(0,o.Wm)(y,{"no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),style:{width:"100%",height:"100%"},class:"dashboard-table-style back-white",rows:e.rows,columns:e.columns,"row-key":"name",flat:"","rows-per-page-options":[0]},{header:(0,o.w5)((e=>[(0,o.Wm)(u,{props:e},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,((t,s)=>((0,o.wg)(),(0,o.j4)(c,{key:t.name,props:e,dropzone:"true","data-index":s},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(t.label),1)])),_:2},1032,["props","data-index"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((s=>[(0,o.Wm)(u,{props:s,id:s.key},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.cols,(l=>((0,o.wg)(),(0,o.iD)(o.HY,{key:l.name},["action"===l.name?((0,o.wg)(),(0,o.j4)(f,{key:0,style:{width:"350px"}},{default:(0,o.w5)((()=>[(0,o._)("div",B,[(0,o.Wm)(w,{flat:"",dense:"",round:"",onClick:t[1]||(t[1]=(0,j.iM)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{persistent:"","auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{dense:"",style:{"min-width":"100px"}},{default:(0,o.w5)((()=>["IMAP"===s.row.protocol||"POP3"===s.row.protocol?((0,o.wg)(),(0,o.j4)(p,{key:0,clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{onClick:t=>e.checkLogin(s.row)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("test_connection")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,o.kq)("",!0),(0,o.Wm)(p,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{onClick:t=>e.showMailConnectionLogs(s.row.id)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.import.connection_logs")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(_,{inset:""}),(0,o.Wm)(p,{clickable:""},{default:(0,o.w5)((()=>[s.row.is_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(m,{key:0,onClick:t=>{s.row.is_active=!0,e.de_activateEmail(s.row)}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("activate")),1)])),_:2},1032,["onClick"])),s.row.is_active?((0,o.wg)(),(0,o.j4)(m,{key:1,onClick:t=>{s.row.is_active=!1,e.de_activateEmail(s.row)}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("deactivate")),1)])),_:2},1032,["onClick"])):(0,o.kq)("",!0)])),_:2},1024),(0,o.Wm)(p,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{onClick:t=>e.editRow(s.rowIndex,s.row)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(_,{inset:""}),(0,o.Wm)(p,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{onClick:t=>e.deleteClicked(s.rowIndex,s.row.id)},{default:(0,o.w5)((()=>[(0,o._)("span",G,(0,i.zw)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):"sub_org_id"===l.name?((0,o.wg)(),(0,o.j4)(f,{key:1,class:(0,i.C_)(s.row.is_active?"":"email-import-deactive-column")},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.sub_orgs_flattened[s.row[l.name]]),1)])),_:2},1032,["class"])):((0,o.wg)(),(0,o.j4)(f,{key:2,class:(0,i.C_)(1==s.row.is_active?"":"email-import-deactive-column")},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)("null"===s.row[l.name]?"":s.row[l.name]),1)])),_:2},1032,["class"]))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["no-data-label","rows","columns"])])]),(0,o.Wm)(b,{showing:e.loading,class:"z-index-1"},{default:(0,o.w5)((()=>[ee])),_:1},8,["showing"]),(0,o.Wm)(k,{modelValue:e.show_edit_create,"onUpdate:modelValue":t[2]||(t[2]=t=>e.show_edit_create=t),persistent:"",onKeydown:t[3]||(t[3]=(0,j.D2)((t=>e.show_edit_create=!1),["esc"]))},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{selected_model:e.selected_row,api_key:e.api_key},null,8,["selected_model","api_key"])])),_:1},8,["modelValue"]),(0,o.Wm)(k,{modelValue:e.show_connection_logs,"onUpdate:modelValue":t[4]||(t[4]=t=>e.show_connection_logs=t)},{default:(0,o.w5)((()=>[(0,o.Wm)(E,{connection_id:e.connection_id,connection_type:e.connection_type},null,8,["connection_id","connection_type"])])),_:1},8,["modelValue"])],64)}var se=s(49341),oe=s(37446);const ie={key:0,class:"text-weight-bold"},le={key:1,class:"text-weight-bold"},ae={class:"row q-mt-md"},re={class:"col-2"},ne={class:"col-7"},de={class:"col-3"},ce={class:"row q-mt-md"},ue={class:"col-2"},me={class:"col-7"},pe={class:"col-3"},_e={class:"row q-mt-md"},he=(0,o._)("div",{class:"col-2"},null,-1),ge={class:"col-7"},we={class:"col-3"},fe={style:{"margin-top":"8px"}},ye={class:"row q-mt-md"},be=(0,o._)("div",{class:"col-2"},null,-1),ve={class:"col-7"},ke=(0,o._)("div",{class:"col-3"},null,-1),Ee={class:"row q-mt-md"},qe=(0,o._)("div",{class:"col-2"},null,-1),Ce={class:"col-7"},We=(0,o._)("div",{class:"col-3"},null,-1),Oe={class:"row q-mt-md"},Se=(0,o._)("div",{class:"col-2"},null,-1),Te={class:"col-7"},Le=(0,o._)("div",{class:"col-3"},null,-1),$e={class:"row q-mt-md"},Ve={class:"col-2"},xe={class:"col-7"},Ue={class:"col-3"},Ie={class:"row q-mt-md"},Ze=(0,o._)("div",{class:"col-2"},null,-1),Re={class:"col-6"},De={class:"col-1"},He=(0,o._)("div",{class:"col-3"},null,-1),ze={key:0,class:"row q-mt-md"},Qe=(0,o._)("div",{class:"col-2"},null,-1),Ae={class:"col-7"},Me={class:"row"},Pe={class:"col-4"},Fe={style:{"margin-top":"8px"}},je={class:"col"},Ne=(0,o._)("div",{class:"col-3"},null,-1),Ye={key:1,class:"row q-mt-md"},Ke=(0,o._)("div",{class:"col-2"},null,-1),Je={class:"col-7"},Xe={class:"row"},Be={class:"col-4"},Ge={style:{"margin-top":"8px"}},et={class:"col"},tt=(0,o._)("div",{class:"col-3"},null,-1),st={key:2,class:"row q-mt-md"},ot=(0,o._)("div",{class:"col-2"},null,-1),it={class:"col-7"},lt={class:"row"},at={class:"col-6"},rt={style:{"margin-top":"8px"}},nt=(0,o._)("div",{class:"col"},null,-1),dt=(0,o._)("div",{class:"col-3"},null,-1),ct={class:"row q-mt-md"},ut=(0,o._)("div",{class:"col-2"},null,-1),mt={class:"col-7"},pt=(0,o._)("div",{class:"col-3"},null,-1),_t=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function ht(e,t,s,l,a,r){const n=(0,o.up)("q-toolbar-title"),d=(0,o.up)("q-btn"),c=(0,o.up)("q-toolbar"),u=(0,o.up)("q-tooltip"),m=(0,o.up)("q-icon"),p=(0,o.up)("q-select"),_=(0,o.up)("q-input"),h=(0,o.up)("q-toggle"),g=(0,o.up)("q-card-section"),w=(0,o.up)("f-btn"),f=(0,o.up)("q-inner-loading"),y=(0,o.up)("q-card"),b=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(y,{style:{width:"1200px","max-width":"1200px",height:"600px"}},{default:(0,o.w5)((()=>[(0,o._)("form",{onSubmit:t[23]||(t[23]=(0,j.iM)(((...t)=>e.submitFrom&&e.submitFrom(...t)),["prevent","stop"]))},[(0,o.Wm)(c,{class:"text-white secondary-toolbar"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[e.row_id?((0,o.wg)(),(0,o.iD)("span",ie,(0,i.zw)(e.$t("pages.settings.master_data_lookup.edit_row")),1)):((0,o.wg)(),(0,o.iD)("span",le,(0,i.zw)(e.$t("pages.settings.master_data_lookup.create_row")),1))])),_:1}),(0,o.wy)((0,o.Wm)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[b]])])),_:1}),e.Office365_selected?((0,o.wg)(),(0,o.j4)(g,{key:1},{default:(0,o.w5)((()=>[(0,o._)("div",$e,[(0,o._)("div",Ve,[(0,o.Wm)(p,{modelValue:e.model["protocol"],"onUpdate:modelValue":[t[11]||(t[11]=t=>e.model["protocol"]=t),e.protocolUpdated],outlined:"",options:e.protocols,label:e.$t("pages.import.protocol")},{append:(0,o.w5)((()=>[e.errors["protocol"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","options","label","onUpdate:modelValue"])]),(0,o._)("div",xe,[(0,o.Wm)(p,{class:"full q-ml-sm",outlined:"",clearable:"",modelValue:e.model["sub_org_id"],"onUpdate:modelValue":t[12]||(t[12]=t=>e.model["sub_org_id"]=t),"use-input":"",options:e.filterSubOrgsList,onFilter:e.filterSubOrgslistEvent,label:e.$t("sub_organizations"),loading:e.sub_org_list_loading,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","label","loading"])]),(0,o._)("div",Ue,[0==e.ms_authenticate&&0==e.ms_is_authenticated?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"q-ml-sm",appearance:"secondary",label:e.$t("pages.import.authenticate"),onClick:t[13]||(t[13]=t=>e.submitFrom()),style:{height:"56px"}},null,8,["label"])):1==e.ms_authenticate&&0==e.ms_is_authenticated?((0,o.wg)(),(0,o.j4)(w,{key:1,class:"q-ml-sm",style:{height:"56px"},label:e.$t("pages.import.finish_authentication"),onClick:t[14]||(t[14]=t=>e.msfinish())},null,8,["label"])):(0,o.kq)("",!0)])]),(0,o._)("div",Ie,[Ze,(0,o._)("div",Re,[1==e.ms_authenticate&&0==e.ms_is_authenticated?((0,o.wg)(),(0,o.j4)(_,{key:0,modelValue:e.ms_code,"onUpdate:modelValue":t[15]||(t[15]=t=>e.ms_code=t),label:e.$t("pages.import.microsoft_code"),outlined:"",readonly:"",onClick:e.copyText,id:"mscode",style:{"margin-left":"10px",width:"90%"}},null,8,["modelValue","label","onClick"])):(0,o.kq)("",!0)]),(0,o._)("div",De,[1==e.ms_authenticate&&0==e.ms_is_authenticated?((0,o.wg)(),(0,o.j4)(w,{key:0,style:{"margin-left":"4px","margin-top":"8px"},icon:"fas fa-copy",onClick:e.copyText},null,8,["onClick"])):(0,o.kq)("",!0)]),He]),e.loading||1!=e.ms_is_authenticated?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",ze,[Qe,(0,o._)("div",Ae,[(0,o._)("div",Me,[(0,o._)("div",Pe,[(0,o.Wm)(h,{modelValue:e.use_folder,"onUpdate:modelValue":t[16]||(t[16]=t=>e.use_folder=t)},null,8,["modelValue"]),(0,o._)("span",Fe,(0,i.zw)(e.$t("Use Folder")),1)]),(0,o._)("div",je,[1==e.use_folder&&""!=e.row_id?((0,o.wg)(),(0,o.j4)(p,{key:0,modelValue:e.model["folder"],"onUpdate:modelValue":t[17]||(t[17]=t=>e.model["folder"]=t),label:e.$t("pages.import.folder"),options:e.folder_list,outlined:"","data-cy":"folder",style:{"margin-left":"10px"}},null,8,["modelValue","label","options"])):(0,o.kq)("",!0)])])]),Ne])),e.loading||1!=e.ms_is_authenticated?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",Ye,[Ke,(0,o._)("div",Je,[(0,o._)("div",Xe,[(0,o._)("div",Be,[(0,o.Wm)(h,{modelValue:e.use_email,"onUpdate:modelValue":t[18]||(t[18]=t=>e.use_email=t)},null,8,["modelValue"]),(0,o._)("span",Ge,(0,i.zw)(e.$t("Use shared Mailbox")),1),(0,o.Wm)(m,{name:"help",style:{"margin-top":"-8px","margin-left":"2px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("Seperate, shared Email-Adress you want to import from.")),1)])),_:1})])),_:1})]),(0,o._)("div",et,[1==e.use_email?((0,o.wg)(),(0,o.j4)(_,{key:0,modelValue:e.model["shared_email"],"onUpdate:modelValue":t[19]||(t[19]=t=>e.model["shared_email"]=t),label:e.$t("pages.import.shared_email"),outlined:"","data-cy":"shared_email",style:{"margin-left":"10px"}},null,8,["modelValue","label"])):(0,o.kq)("",!0)])])]),tt])),e.loading||1!=e.ms_is_authenticated?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",st,[ot,(0,o._)("div",it,[(0,o._)("div",lt,[(0,o._)("div",at,[(0,o.Wm)(h,{modelValue:e.delete_after_import,"onUpdate:modelValue":t[20]||(t[20]=t=>e.delete_after_import=t)},null,8,["modelValue"]),(0,o._)("span",rt,(0,i.zw)(e.$t("Move imported Emails into the trash-folder")),1)]),nt])]),dt]))])),_:1})):((0,o.wg)(),(0,o.j4)(g,{key:0},{default:(0,o.w5)((()=>[(0,o._)("div",ae,[(0,o._)("div",re,[(0,o.Wm)(p,{modelValue:e.model["protocol"],"onUpdate:modelValue":[t[0]||(t[0]=t=>e.model["protocol"]=t),e.protocolUpdated],outlined:"",options:e.protocols,label:e.$t("pages.import.protocol")},{append:(0,o.w5)((()=>[e.errors["protocol"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","options","label","onUpdate:modelValue"])]),(0,o._)("div",ne,[(0,o.Wm)(_,{modelValue:e.model["server"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.model["server"]=t),label:e.$t("pages.import.server"),outlined:"",class:(0,i.C_)("full q-ml-sm")},{append:(0,o.w5)((()=>[e.errors["server"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),(0,o._)("div",de,[(0,o.Wm)(_,{modelValue:e.model["port"],"onUpdate:modelValue":t[2]||(t[2]=t=>e.model["port"]=t),label:e.$t("pages.import.port"),outlined:"","data-cy":"port",class:(0,i.C_)("full q-ml-sm")},{append:(0,o.w5)((()=>[e.errors["port"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])])]),(0,o._)("div",ce,[(0,o._)("div",ue,[(0,o.Wm)(p,{modelValue:e.model["encryption"],"onUpdate:modelValue":t[3]||(t[3]=t=>e.model["encryption"]=t),outlined:"","data-cy":"encryption",options:e.encryptions,class:(0,i.C_)("full-width "),label:e.$t("pages.import.encryption")},{append:(0,o.w5)((()=>[e.errors["encryption"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","options","label"])]),(0,o._)("div",me,[(0,o.Wm)(_,{modelValue:e.model["username"],"onUpdate:modelValue":t[4]||(t[4]=t=>e.model["username"]=t),class:(0,i.C_)(["full q-ml-sm","full q-ml-sm"]),label:e.$t("pages.import.username"),outlined:"","data-cy":"username"},{append:(0,o.w5)((()=>[e.errors["username"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),(0,o._)("div",pe,["IMAP"==e.model["protocol"]&&""!=e.row_id?((0,o.wg)(),(0,o.j4)(p,{key:0,modelValue:e.model["folder"],"onUpdate:modelValue":t[5]||(t[5]=t=>e.model["folder"]=t),label:e.$t("pages.import.folder"),options:e.folder_list,outlined:"","data-cy":"folder",class:"full q-ml-sm"},null,8,["modelValue","label","options"])):(0,o.kq)("",!0)])]),(0,o._)("div",_e,[he,(0,o._)("div",ge,[(0,o.Wm)(_,{modelValue:e.model["email"],"onUpdate:modelValue":t[6]||(t[6]=t=>e.model["email"]=t),label:e.$t("pages.import.email"),outlined:"","data-cy":"email",class:(0,i.C_)("full q-ml-sm")},{append:(0,o.w5)((()=>[e.errors["email"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),(0,o._)("div",we,[(0,o.Wm)(h,{modelValue:e.delete_after_import,"onUpdate:modelValue":t[7]||(t[7]=t=>e.delete_after_import=t)},null,8,["modelValue"]),(0,o._)("span",fe,(0,i.zw)(e.$t("Move imported Emails into the trash")),1)])]),(0,o._)("div",ye,[be,(0,o._)("div",ve,[(0,o.Wm)(_,{modelValue:e.model["password"],"onUpdate:modelValue":t[8]||(t[8]=t=>e.model["password"]=t),type:"password",label:e.$t("pages.import.password"),outlined:"","data-cy":"password",class:(0,i.C_)("full q-ml-sm")},{append:(0,o.w5)((()=>[e.errors["password"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),ke]),(0,o._)("div",Ee,[qe,(0,o._)("div",Ce,[(0,o.Wm)(p,{class:"full q-ml-sm",outlined:"",clearable:"",modelValue:e.model["sub_org_id"],"onUpdate:modelValue":t[9]||(t[9]=t=>e.model["sub_org_id"]=t),"use-input":"",options:e.filterSubOrgsList,onFilter:e.filterSubOrgslistEvent,label:e.$t("sub_organizations"),loading:e.sub_org_list_loading,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","label","loading"])]),We]),(0,o._)("div",Oe,[Se,(0,o._)("div",Te,[(0,o.Wm)(_,{class:(0,i.C_)(["full q-ml-sm","bg-disable"]),id:"apiKey",outlined:"",modelValue:e.api_key_ref,"onUpdate:modelValue":t[10]||(t[10]=t=>e.api_key_ref=t),readonly:"",label:e.$t("pages.import.token")},null,8,["modelValue","label"])]),Le])])),_:1})),e.Office365_selected&&1!=e.ms_is_authenticated?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(g,{key:2,class:"p-t-0"},{default:(0,o.w5)((()=>[(0,o._)("div",ct,[ut,(0,o._)("div",mt,[e.Office365_selected?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(w,{key:0,type:"submit",class:"q-ml-sm float-right",label:e.$t("save")},null,8,["label"])),1==e.ms_is_authenticated?((0,o.wg)(),(0,o.j4)(w,{key:1,class:"q-ml-sm float-right",label:e.$t("pages.import.save"),onClick:t[21]||(t[21]=t=>e.saveFolder())},null,8,["label"])):(0,o.kq)("",!0),e.row_id?((0,o.wg)(),(0,o.j4)(w,{key:2,appearance:"secondary",class:"q-ml-sm float-right",label:e.$t("pages.import.import"),onClick:t[22]||(t[22]=t=>e.manual_import())},null,8,["label"])):(0,o.kq)("",!0),(0,o.wy)((0,o.Wm)(w,{class:"float-right",appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[b]])]),pt])])),_:1}))],32),(0,o.Wm)(f,{showing:e.loading,class:"z-index-1"},{default:(0,o.w5)((()=>[_t])),_:1},8,["showing"])])),_:1})}var gt=s(7363),wt=s(46624),ft=s(65054),yt=s(38733),bt=function(e,t,s,o){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{n(o.next(e))}catch(t){l(t)}}function r(e){try{n(o["throw"](e))}catch(t){l(t)}}function n(e){e.done?s(e.value):i(e.value).then(a,r)}n((o=o.apply(e,t||[])).next())}))};const vt=(0,o.aZ)({el:"#app",mixins:[T.Z,L.Z],props:{selected_model:{},api_key:{type:String,default:""}},components:{},data(){return{}},setup(){const e=(0,wt.At)(),{encryptions:t,protocols:s,subOrgList:o,sub_org_list_loading:i}=(0,gt.Jk)(e),l=(0,S.iH)(e.subOrgList);return{EMAIL_ENCRYPTION_KEY:(0,S.iH)(""),subOrgList:o,sub_org_list_loading:i,filterSubOrgsList:l,protocols:s,encryptions:t,loading:(0,S.iH)(!1),model:(0,S.iH)({}),row_id:(0,S.iH)(""),errors:(0,S.iH)({}),Office365_selected:(0,S.iH)(!1),use_folder:(0,S.iH)(!1),use_email:(0,S.iH)(!1),delete_after_import:(0,S.iH)(!1),ms_url:(0,S.iH)("https://microsoft.com/devicelogin"),ms_code:(0,S.iH)(""),ms_authenticate:(0,S.iH)(!1),ms_is_authenticated:(0,S.iH)(!1),ms_message:(0,S.iH)("Microsoft o365 is authenticated already."),api_key_ref:(0,S.iH)(""),folder_list:(0,S.iH)([])}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";if(void 0==e)throw"Missing EMAIL_ENCRYPTION_KEY env - unable to load";this.EMAIL_ENCRYPTION_KEY=e,this.initView()},methods:{initView(){return bt(this,void 0,void 0,(function*(){this.api_key_ref=this.api_key,this.row_id=this.selected_model.hasOwnProperty("id")?this.selected_model.id:"",""!=this.row_id&&(yield this.getFolders()),this.folder_list,this.model=JSON.parse(JSON.stringify(this.selected_model));for(let[e,t]of Object.entries(this.model))t||(this.model[e]="");"OAuth Office365"==this.model["protocol"]&&(this.ms_is_authenticated=!0,this.protocolUpdated(),"null"!=this.model.folder&&""!=this.model.folder?this.use_folder=!0:(this.model.folder="",this.use_folder=!1),"null"!=this.model.shared_email&&null!=this.model.shared_email?this.use_email=!0:(this.model.shared_email="",this.use_email=!1)),this.model.delete_after_import&&(this.delete_after_import=!0),this.model.hasOwnProperty("service_type")||(this.model.service_type="Other"),null!=this.model["password"]&&""!=this.model["password"]&&(this.model["password"]=this.decryptPassword(this.model["password"]).toString(yt.cE.Utf8)),this.row_id||this.resetForm()}))},resetForm(){this.model={active:!1,email:"",shared_email:"",username:"",password:"",server:"",port:"",folder:"",encryption:"",protocol:"",service_type:"Other",whole_email:!1,skip:!1,sub_org_id:"",delete_after_import:!1}},submitFrom(){return bt(this,void 0,void 0,(function*(){try{this.loading=!0,"OAuth Office365"==this.model.protocol&&this.updateModel();const e=yield se.mX.AddUpdateEmail(this.prepareApiData());if(!e.success)throw e.message;if(this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),"OAuth Office365"!==this.model.protocol)return this.resetForm(),void this.updateEmailImportEvent();"OAuth Office365"==this.model.protocol&&e.hasOwnProperty("code")&&(this.model=e.data,this.row_id=this.model.id,this.ms_code=e.code,this.openMsPage(),this.ms_authenticate=!0);const t=new CustomEvent("record_saved",{detail:{}});document.dispatchEvent(t)}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},prepareApiData(){let e=this.encryptPassword();return{email:this.model.email,shared_email:this.model.shared_email,password:e,username:this.model.username,server:this.model.server,port:this.model.port,encryption:this.model.encryption,protocol:this.model.protocol,whole_email:""!==this.model.whole_email&&this.model.whole_email,skip:""!==this.model.skip&&this.model.skip,api_key:this.api_key,sub_org_id:this.model.sub_org_id,id:this.row_id,folder:"SSL"!=this.model.encryption||"IMAP"!=this.model.protocol?"":this.model.folder,delete_after_import:this.delete_after_import}},encryptPassword(){var e=yt.cE.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),t=yt.es.encrypt(this.model.password,e,{mode:yt.xJ.ECB,padding:yt.vk.PKCS7});return t},decryptPassword(e){var t=yt.cE.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),s=yt.es.decrypt(e,t,{mode:yt.xJ.ECB});return s},updateModel(){this.model.password="",this.model.username="",this.model.server="",this.model.port="",this.model.encryption="",this.model.folder=""},copyText(){(0,ft.Z)(this.ms_code).then((()=>{this.showSuccessToast("Copied!")}))},updateEmailImportEvent(){const e=new CustomEvent("email_import_updated",{});document.dispatchEvent(e)},openMsPage(){window.open(this.ms_url,"_blank")},protocolUpdated(){"OAuth Office365"==this.model.protocol?this.Office365_selected=!0:this.Office365_selected=!1},msfinish(){return bt(this,void 0,void 0,(function*(){try{this.loading=!0;const e=yield se.mX.finishMsAuth(this.row_id);1==e.success&&(this.ms_is_authenticated=!0,this.showSuccessToast(this.$t("Authentication completed")))}catch(e){this.showErrorToast(this.$t("Something failed on the transmission. Please try again."))}finally{this.loading=!1}}))},manual_import(){return bt(this,void 0,void 0,(function*(){this.loading=!0,yield se.mX.performManuelImportMail(this.row_id),this.loading=!1,this.showSuccessToast(this.$t("pages.messages.import_try")),this.$router.push("/dashboard")}))},validateLoginTest(){let e=!0;this.resetErrors();const t=["folder","whole_email","skip","active"];if("OAuth Office365"===this.model.protocol)return e=!1,this.showErrorToast(this.$t("service_type_not_supported")),e;for(const[s,o]of Object.entries(this.model))t.includes(s)||o&&0!=String(o).length||(e=!1,this.errors[s]=!0);return e},resetErrors(){for(const[e,t]of Object.entries(this.model))this.errors[e]=!1},saveFolder(){return bt(this,void 0,void 0,(function*(){try{this.loading=!0;const e={id:this.row_id,folder:1==this.use_folder?this.model.folder:"null",shared_email:1==this.use_email?this.model.shared_email:"null",sub_org_id:this.model.sub_org_id,delete_after_import:this.delete_after_import};let t=yield se.mX.saveFolder(e);if(!t.success)throw t;this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),this.resetForm(),this.updateEmailImportEvent()}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},getFolders(){return bt(this,void 0,void 0,(function*(){try{this.loading=!0;let e=yield se.mX.getFolders(this.row_id);if(!e.success)throw e;this.folder_list=e.data}catch(e){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.loading=!1}}))},filterSubOrgslistEvent(e,t,s){t(e?()=>{const t=e.toLowerCase();this.filterSubOrgsList=this.subOrgList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}:()=>{this.filterSubOrgsList=this.subOrgList})}}});var kt=s(44458),Et=s(51663),qt=s(81973),Ct=s(68879),Wt=s(63190),Ot=s(22857),St=s(23175),Tt=s(60854),Lt=s(62146);const $t=(0,D.Z)(vt,[["render",ht]]),Vt=$t;M()(vt,"components",{QCard:kt.Z,QToolbar:Et.Z,QToolbarTitle:qt.Z,QBtn:Ct.Z,QCardSection:Wt.Z,QSelect:Q.Z,QIcon:Ot.Z,QTooltip:z.Z,QInput:H.Z,QToggle:St.Z,QInnerLoading:Tt.Z}),M()(vt,"directives",{ClosePopup:Lt.Z});const xt={class:"text-weight-bold primary-bg-text"},Ut={class:"q-pl-md q-pr-md q-pt-md"},It={class:"text-item"},Zt=(0,o._)("div",{class:"row float-right"},null,-1),Rt={key:0,style:{"text-wrap":"wrap"}},Dt={key:1},Ht={class:"q-mt-md row full-width"},zt=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function Qt(e,t,s,l,a,r){const n=(0,o.up)("q-toolbar-title"),d=(0,o.up)("q-btn"),c=(0,o.up)("q-toolbar"),u=(0,o.up)("q-th"),m=(0,o.up)("q-tr"),p=(0,o.up)("q-td"),_=(0,o.up)("q-icon"),h=(0,o.up)("q-table"),g=(0,o.up)("q-pagination"),w=(0,o.up)("q-card-section"),f=(0,o.up)("q-card"),y=(0,o.up)("q-inner-loading"),b=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(f,{style:{width:"1060px","max-width":"1060px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"secondary-toolbar"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o._)("span",xt,(0,i.zw)(e.$t("pages.import.connection_logs")),1)])),_:1}),(0,o.wy)((0,o.Wm)(d,{flat:"",round:"",dense:"",class:"primary-bg-text",icon:"close",onClick:e.cleanupOnhide},null,8,["onClick"]),[[b]])])),_:1}),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o._)("div",Ut,[(0,o.Wm)(h,{class:"dashboard-table-style dashboard-table-height back-white","rows-per-page-options":[0],rows:e.rows,columns:e.columns,"row-key":"id","hide-bottom":"",flat:"","table-header-class":"table-header-text","no-data-label":e.$t("no_data_found"),"no-results-label":"The filter didn't uncover any results",style:{overflow:"auto",height:"550px"}},{header:(0,o.w5)((t=>[(0,o.Wm)(m,{props:t},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.cols,((e,s)=>((0,o.wg)(),(0,o.j4)(u,{key:e.name,props:t,"data-index":s},{default:(0,o.w5)((()=>[(0,o._)("span",It,(0,i.zw)(e.label),1)])),_:2},1032,["props","data-index"])))),128))])),_:2},1032,["props"]),0==e.rows.length?((0,o.wg)(),(0,o.j4)(m,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{colspan:"20",class:"text-center"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("no_data_found")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),body:(0,o.w5)((e=>[(0,o.Wm)(m,{props:e,id:e.key},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(t=>((0,o.wg)(),(0,o.iD)(o.HY,{key:t.name},["action"===t.name?((0,o.wg)(),(0,o.j4)(p,{key:0},{default:(0,o.w5)((()=>[Zt])),_:1})):(0,o.kq)("",!0),"success"===t.name?((0,o.wg)(),(0,o.j4)(p,{key:1},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{name:!0===e.row[t.name]?"check_circle":"cancel",color:!0===e.row[t.name]?"green":"red",size:"20px"},null,8,["name","color"])])),_:2},1024)):((0,o.wg)(),(0,o.j4)(p,{key:2},{default:(0,o.w5)((()=>["message"===t.name?((0,o.wg)(),(0,o.iD)("span",Rt,(0,i.zw)(e.row[t.name]),1)):((0,o.wg)(),(0,o.iD)("span",Dt,(0,i.zw)(e.row[t.name]),1))])),_:2},1024))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","no-data-label"]),(0,o._)("div",Ht,[e.total_pages>1?((0,o.wg)(),(0,o.j4)(g,{key:0,modelValue:e.current_page,"onUpdate:modelValue":t[0]||(t[0]=t=>e.current_page=t),max:e.total_pages,"max-pages":6,"direction-links":"",unelevated:"",color:"black","active-color":"black",class:"doc2-pagination q-mb-md q-ml-auto q-mr-auto",onClick:t[1]||(t[1]=t=>e.nexPageClicked())},null,8,["modelValue","max"])):(0,o.kq)("",!0)])])])),_:1})])),_:1}),(0,o.Wm)(y,{showing:e.loading},{default:(0,o.w5)((()=>[zt])),_:1},8,["showing"])],64)}var At=s(54170),Mt=function(e,t,s,o){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{n(o.next(e))}catch(t){l(t)}}function r(e){try{n(o["throw"](e))}catch(t){l(t)}}function n(e){e.done?s(e.value):i(e.value).then(a,r)}n((o=o.apply(e,t||[])).next())}))};const Pt=(0,o.aZ)({mixins:[L.Z,T.Z],props:{connection_id:{type:String,required:!0},connection_type:{type:String,required:!0}},components:{},watch:{},computed:{},mounted:function(){this.init(),this.checkConnectionLogs()},unmounted:function(){this.cleanupOnhide()},methods:{init(){this.prepareColumns()},checkConnectionLogs(){try{this.resetPagination(),this.getDataFromServer()}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}},getDataFromServer(){return Mt(this,void 0,void 0,(function*(){try{this.loading=!0,this.request_params={},this.request_params["offset"]=this.offset,this.request_params["limit"]=30,this.request_params["connection_type"]=this.connection_type,this.request_params["connection_id"]=this.connection_id,this.request_params["order_by_direction"]="desc";const e=yield se.mX.fetchConnectionLogs(this.request_params);if(!1===e.success)throw{message:e.message};this.total_records=e.total_records_count,this.setTotalPages(),this.prepareRows(e.elements)}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},prepareRows(e){this.rows=[],Array.from(e).forEach((e=>{const t=e;this.addNewRow(t)}))},addNewRow(e){let t=Object.assign({},e);return t["created_on"]=this.formateDate(e["created_on"],"DD-MM-YYYY HH:mm:ss"),this.rows.push(t),this.rows.length.toString()},formateDate(e,t){return At.ZP.formatDate(e,t)},resetPagination(){this.offset=0,this.total_pages=0,this.current_page=1,this.total_records=0},setTotalPages(){this.total_pages=Math.ceil(this.total_records/this.page_size)},nexPageClicked(){return Mt(this,void 0,void 0,(function*(){try{this.calculateOffset(),yield this.getDataFromServer()}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}}))},calculateOffset(){this.offset=this.page_size*(this.current_page-1)},prepareColumns(){this.columns=[],this.columns.push({name:"success",label:this.$t("status"),field:"status",align:"left"}),this.columns.push({name:"created_on",label:this.$t("created_on"),field:"created_on",align:"left"}),this.columns.push({name:"message",label:this.$t("pages.support.message"),field:"message",align:"left"})},cleanupOnhide(){this.resetPagination()}},setup(){return{loading:(0,S.iH)(!1),request_params:(0,S.iH)({}),current_page:(0,S.iH)(1),total_pages:(0,S.iH)(0),offset:(0,S.iH)(0),page_size:(0,S.iH)(8),total_records:(0,S.iH)(0),columns:(0,S.iH)([]),rows:(0,S.iH)([])}}});var Ft=s(61450),jt=s(31233),Nt=s(21682),Yt=s(67220),Kt=s(80996);const Jt=(0,D.Z)(Pt,[["render",Qt]]),Xt=Jt;M()(Pt,"components",{QCard:kt.Z,QToolbar:Et.Z,QToolbarTitle:qt.Z,QBtn:Ct.Z,QCardSection:Wt.Z,QTable:Ft.Z,QTr:jt.Z,QTh:Nt.Z,QTd:Yt.Z,QIcon:Ot.Z,QPagination:Kt.Z,QInnerLoading:Tt.Z}),M()(Pt,"directives",{ClosePopup:Lt.Z});var Bt=s(9848),Gt=s(32475);const es="sub_app",ts={methods:{async getSubscriptionFromServer(){try{const e=await se.FT.getSubscription();if(!e||!e||!Array.isArray(e)||0==e.length)return;(0,Gt.w4)(es,this.getDoc2AppSubscription(e))}catch(e){}},getDoc2AppSubscription(e){let t=!1,s={};for(let o of e){const e=o.apps;for(let i of e)if("FELLOW_DOC2"===i.app_key){t=!0,s=o;break}if(!0===t)break}return s},getRemainingDays(){let e=-1,t=this.getSubscription();if(!t)return null;let s=this.getDateFromServerDate(t.end_date);const o=(new Date).setHours(0,0,0,0);return e=this.datediff(o,s),e},datediff(e,t){return Math.round((t-e)/864e5)},getDateFromServerDate(e){var t=e.split(" ");return new Date(t[0]).setHours(0,0,0,0)},async getsubscriptionRemainingDays(){let e=0;try{e=this.getRemainingDays(),null==e&&(await this.getSubscriptionFromServer(),e=this.getRemainingDays())}catch(t){}return e},subscriptionAlertShowDays(){return 30},getSubscription(){let e=(0,Gt.jE)(es);return e&&e.hasOwnProperty("start_date")&&e.hasOwnProperty("end_date")?e:null}}};var ss=s(77997),os=function(e,t,s,o){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{n(o.next(e))}catch(t){l(t)}}function r(e){try{n(o["throw"](e))}catch(t){l(t)}}function n(e){e.done?s(e.value):i(e.value).then(a,r)}n((o=o.apply(e,t||[])).next())}))};const is=(0,o.aZ)({mixins:[T.Z,L.Z,ts],components:{EditCreate:Vt,ConnectionLogs:Xt,ImportLogs:Bt.Z},watch:{sub_org_list_loading(e,t){!1===e&&this.initView()}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";void 0!=e?(this.EMAIL_ENCRYPTION_KEY=e,document.addEventListener("email_import_updated",this.emailImportUpdated),this.handleSubOrgs()):this.showErrorToast("Missing an important value - unable to load email import")},unmounted:function(){document.removeEventListener("email_import_updated",this.emailImportUpdated)},methods:{showMailConnectionLogs(e){this.connection_type="email_import",this.connection_id=e,this.show_connection_logs=!0},initView(){return os(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns(),yield this.getAppKey(),this.flattenSubOrgs(),this.getList()}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},handleSubOrgs(){this.subOrgList.length>1&&this.initView(),this.sub_org_list_loading&&(this.loading=!0)},getList(){return os(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns();const e=yield se.mX.getList();if(0==e.data.length)return;this.prepareRows(e.data)}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},prepareRows(e){this.rows=[],Array.from(e).forEach((e=>{const t=e;this.addNewRow(t)}))},addNewRow(e){let t=Object.assign({},e);return this.rows.push(t),this.rows.length.toString()},createNewRecord(){this.selected_row={},this.show_edit_create=!0},emailImportUpdated(){this.show_edit_create=!1,this.getList()},editRow(e,t){this.selected_row=JSON.parse(JSON.stringify(t)),this.show_edit_create=!0},deleteClicked(e,t){return os(this,void 0,void 0,(function*(){try{this.loading=!0;const s=yield se.mX.deleteRecord(t);!0===s.success&&this.rows.splice(e,1),this.showSuccessToast(this.$t("success"))}catch(s){const e=oe.w.getErrorMessage(s);this.showErrorToast(e)}finally{this.loading=!1}}))},getAppKey(){return os(this,void 0,void 0,(function*(){try{this.loading=!0;const e={app_key:"FELLOW_DOC2"},t=yield se.FT.getAppSubscription(e);this.api_key=t[0].token}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},de_activateEmail(e){return os(this,void 0,void 0,(function*(){try{this.loading=!0;const t=e.id,s=e.is_active;yield se.mX.DeActivateEmail(t,s);this.showSuccessToast(this.$t("success"))}catch(t){const e=oe.w.getErrorMessage(t);this.showErrorToast(e)}finally{this.loading=!1}}))},checkLogin(e){return os(this,void 0,void 0,(function*(){try{this.loading=!0;const t=yield se.mX.testEmailLogin(String(e.id));if(!t||t.hasOwnProperty("success")&&!1===t.success)throw t;this.showSuccessToast(this.$t("check_login_success"))}catch(t){const e=oe.w.getErrorMessage(t);this.showErrorToast(e)}finally{this.loading=!1}}))},flattenSubOrgs(){this.subOrgList.forEach((e=>{this.sub_orgs_flattened[e.value]=e.label}))},prepareColumns(){this.columns=[],this.columns.push({name:"username",label:this.$t("username"),field:"username",align:"left"}),this.columns.push({name:"email",label:this.$t("email"),field:"email",align:"left"}),this.columns.push({name:"shared_email",label:this.$t("shared_email"),field:"shared_email",align:"left"}),this.columns.push({name:"protocol",label:this.$t("protocol"),field:"protocol",align:"left"}),this.columns.push({name:"encryption",label:this.$t("encryption"),field:"encryption",align:"left"}),this.columns.push({name:"sub_org_id",label:this.$t("sub_organizations"),field:"sub_org_id",align:"left"}),this.columns.push({name:"folder",label:this.$t("folder"),field:"folder",align:"left"}),this.columns.push({name:"action",label:this.$t("action"),field:"action",align:"right"})},webSiteLink(){const e=(0,ss.Rg)("import_settings");e&&window.open(e)}},setup(){const e=(0,wt.At)(),{subOrgList:t,sub_org_list_loading:s}=(0,gt.Jk)(e);let o=(0,S.iH)({});const i=(0,S.iH)(null);return{sub_org_list_loading:s,subOrgList:t,myForm:i,import_email:o,errors:(0,S.iH)({}),show_connection_logs:(0,S.iH)(!1),connection_type:(0,S.iH)(""),connection_id:(0,S.iH)({}),sub_orgs_flattened:(0,S.iH)({}),processing:(0,S.iH)(!1),ms_url:(0,S.iH)("https://microsoft.com/devicelogin"),ms_code:(0,S.iH)(""),ms_authenticate:(0,S.iH)(!1),ms_is_authenticated:(0,S.iH)(!1),ms_message:(0,S.iH)("Microsoft o365 is authenticated already."),loading:(0,S.iH)(!1),userDialog:(0,S.iH)(!1),columns:(0,S.iH)([]),rows:(0,S.iH)([]),show_edit_create:(0,S.iH)(!1),selected_row:(0,S.iH)({}),api_key:(0,S.iH)(""),EMAIL_ENCRYPTION_KEY:(0,S.iH)("")}},data(){return{}}});var ls=s(56362),as=s(13246),rs=s(490),ns=s(76749),ds=s(50926),cs=s(32074);const us=(0,D.Z)(is,[["render",te]]),ms=us;M()(is,"components",{QTable:Ft.Z,QTr:jt.Z,QTh:Nt.Z,QTd:Yt.Z,QBtn:Ct.Z,QMenu:ls.Z,QList:as.Z,QItem:rs.Z,QItemSection:ns.Z,QSeparator:ds.Z,QTooltip:z.Z,QInnerLoading:Tt.Z,QDialog:cs.Z});const ps={class:"container"},_s={class:"row mt-8 mb-25"},hs={class:"row"},gs={class:"row float-right"},ws={class:"text-red-14"},fs=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function ys(e,t,s,l,a,r){const n=(0,o.up)("f-btn"),d=(0,o.up)("q-th"),c=(0,o.up)("q-tr"),u=(0,o.up)("q-item-section"),m=(0,o.up)("q-item"),p=(0,o.up)("q-separator"),_=(0,o.up)("q-list"),h=(0,o.up)("q-menu"),g=(0,o.up)("q-btn"),w=(0,o.up)("q-td"),f=(0,o.up)("q-table"),y=(0,o.up)("q-inner-loading"),b=(0,o.up)("EditCreate"),v=(0,o.up)("q-dialog"),k=(0,o.up)("ConnectionLogs");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",ps,[(0,o._)("div",_s,[(0,o.Wm)(n,{class:"q-ml-auto float-right",icon:"add",label:e.$t("new"),onClick:e.createNewRecord},null,8,["label","onClick"])]),(0,o._)("div",hs,[(0,o.Wm)(f,{style:{width:"100%",height:"100%"},class:"dashboard-table-style dashboard-table-height back-white",rows:e.rows,columns:e.columns,"row-key":"name",flat:"","no-data-label":e.$t("pages.messages.NO_RECORD_FOUND"),"table-header-class":"table-header-text","rows-per-page-options":[0]},{header:(0,o.w5)((e=>[(0,o.Wm)(c,{props:e},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,((t,s)=>((0,o.wg)(),(0,o.j4)(d,{key:t.name,props:e,dropzone:"true","data-index":s},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(t.label),1)])),_:2},1032,["props","data-index"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((s=>[(0,o.Wm)(c,{props:s,id:s.key},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.cols,(l=>((0,o.wg)(),(0,o.iD)(o.HY,{key:l.name},["action"===l.name?((0,o.wg)(),(0,o.j4)(w,{key:0,style:{width:"236px"}},{default:(0,o.w5)((()=>[(0,o._)("div",gs,[(0,o.Wm)(g,{flat:"",dense:"",round:"",onClick:t[0]||(t[0]=(0,j.iM)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{persistent:"","auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{dense:"",style:{"min-width":"100px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{onClick:t=>e.checkConnection(s.row.id)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("test_connection")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(m,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{onClick:t=>e.showFtpConnectionLogs(s.row.id)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.import.connection_logs")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(p,{inset:""}),(0,o.Wm)(m,{clickable:""},{default:(0,o.w5)((()=>[s.row.is_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(u,{key:0,onClick:t=>{s.row.is_active=!0,e.de_activate(s.row)}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("activate")),1)])),_:2},1032,["onClick"])),s.row.is_active?((0,o.wg)(),(0,o.j4)(u,{key:1,onClick:t=>{s.row.is_active=!1,e.de_activate(s.row)}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("deactivate")),1)])),_:2},1032,["onClick"])):(0,o.kq)("",!0)])),_:2},1024),(0,o.Wm)(m,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{onClick:t=>e.editRow(s.rowIndex,s.row)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(p,{inset:""}),(0,o.Wm)(m,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{onClick:t=>e.deleteClicked(s.rowIndex,s.row.id)},{default:(0,o.w5)((()=>[(0,o._)("span",ws,(0,i.zw)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):"sub_org_id"===l.name?((0,o.wg)(),(0,o.j4)(w,{key:1,class:(0,i.C_)(s.row.is_active?"":"email-import-deactive-column")},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.sub_orgs_flattened[s.row[l.name]]),1)])),_:2},1032,["class"])):((0,o.wg)(),(0,o.j4)(w,{key:2,class:(0,i.C_)(1==s.row.is_active?"":"email-import-deactive-column")},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)("null"===s.row[l.name]?"":s.row[l.name]),1)])),_:2},1032,["class"]))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","no-data-label"])])]),(0,o.Wm)(y,{showing:e.loading,class:"z-index-1"},{default:(0,o.w5)((()=>[fs])),_:1},8,["showing"]),(0,o.Wm)(v,{modelValue:e.show_edit_create,"onUpdate:modelValue":t[1]||(t[1]=t=>e.show_edit_create=t),persistent:"",onKeydown:t[2]||(t[2]=(0,j.D2)((t=>e.show_edit_create=!1),["esc"]))},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{selected_model:e.selected_row,api_key:e.api_key},null,8,["selected_model","api_key"])])),_:1},8,["modelValue"]),(0,o.Wm)(v,{modelValue:e.show_connection_logs,"onUpdate:modelValue":t[3]||(t[3]=t=>e.show_connection_logs=t)},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{connection_id:e.connection_id,connection_type:"ftp_import"},null,8,["connection_id"])])),_:1},8,["modelValue"])],64)}const bs={key:0,class:"text-weight-bold"},vs={key:1,class:"text-weight-bold"},ks={class:"row q-mt-md"},Es={class:"col-2"},qs={class:"col-7"},Cs={class:"col-3"},Ws={class:"row q-mt-md"},Os={class:"col-2"},Ss={class:"col-7"},Ts=(0,o._)("div",{class:"col-3"},null,-1),Ls={class:"row q-mt-md"},$s=(0,o._)("div",{class:"col-2"},null,-1),Vs={class:"col-7"},xs=(0,o._)("div",{class:"col-3"},null,-1),Us={class:"row q-mt-md"},Is=(0,o._)("div",{class:"col-2"},null,-1),Zs={class:"col-7"},Rs=(0,o._)("div",{class:"col-3"},null,-1),Ds={class:"row q-mt-md"},Hs=(0,o._)("div",{class:"col-2"},null,-1),zs={class:"col-7"},Qs=(0,o._)("div",{class:"col-3"},null,-1),As={class:"row q-mt-md"},Ms=(0,o._)("div",{class:"col-2"},null,-1),Ps={class:"col-7"},Fs=(0,o._)("div",{class:"col-3"},null,-1),js={class:"row q-mt-md"},Ns=(0,o._)("div",{class:"col-2"},null,-1),Ys={class:"col-7"},Ks=(0,o._)("div",{class:"col-3"},null,-1),Js=(0,o._)("img",{class:"loading-image",src:"loader.gif",alt:"Loading..."},null,-1);function Xs(e,t,s,l,a,r){const n=(0,o.up)("q-toolbar-title"),d=(0,o.up)("q-btn"),c=(0,o.up)("q-toolbar"),u=(0,o.up)("q-tooltip"),m=(0,o.up)("q-icon"),p=(0,o.up)("q-select"),_=(0,o.up)("q-input"),h=(0,o.up)("q-card-section"),g=(0,o.up)("q-inner-loading"),w=(0,o.up)("q-card"),f=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(w,{style:{width:"1200px","max-width":"1200px",height:"600px"}},{default:(0,o.w5)((()=>[(0,o._)("form",{onSubmit:t[10]||(t[10]=(0,j.iM)(((...t)=>e.submitFrom&&e.submitFrom(...t)),["prevent","stop"]))},[(0,o.Wm)(c,{class:"text-white secondary-toolbar"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[e.row_id?((0,o.wg)(),(0,o.iD)("span",bs,(0,i.zw)(e.$t("pages.settings.master_data_lookup.edit_row")),1)):((0,o.wg)(),(0,o.iD)("span",vs,(0,i.zw)(e.$t("pages.settings.master_data_lookup.create_row")),1))])),_:1}),(0,o.wy)((0,o.Wm)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[f]])])),_:1}),(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o._)("div",ks,[(0,o._)("div",Es,[(0,o.Wm)(p,{modelValue:e.model["ftp_type"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.model["ftp_type"]=t),outlined:"",options:e.ftp_types,label:e.$t("type")},{append:(0,o.w5)((()=>[e.errors["ftp_type"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","options","label"])]),(0,o._)("div",qs,[(0,o.Wm)(_,{modelValue:e.model["server"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.model["server"]=t),label:e.$t("pages.import.server"),outlined:"",class:(0,i.C_)("full q-ml-sm")},{append:(0,o.w5)((()=>[e.errors["server"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),(0,o._)("div",Cs,[(0,o.Wm)(_,{modelValue:e.model["default_directory"],"onUpdate:modelValue":t[2]||(t[2]=t=>e.model["default_directory"]=t),label:e.$t("default_directory"),outlined:"","data-cy":"default_directory",class:"full q-ml-sm"},null,8,["modelValue","label"])])]),(0,o._)("div",Ws,[(0,o._)("div",Os,[(0,o.Wm)(_,{modelValue:e.model["port"],"onUpdate:modelValue":t[3]||(t[3]=t=>e.model["port"]=t),label:e.$t("pages.import.port"),outlined:"","data-cy":"port",class:(0,i.C_)("full")},{append:(0,o.w5)((()=>[e.errors["port"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),(0,o._)("div",Ss,[(0,o.Wm)(_,{modelValue:e.model["username"],"onUpdate:modelValue":t[4]||(t[4]=t=>e.model["username"]=t),class:(0,i.C_)(["full q-ml-sm","full q-ml-sm"]),label:e.$t("username"),outlined:"","data-cy":"username"},{append:(0,o.w5)((()=>[e.errors["username"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),Ts]),(0,o._)("div",Ls,[$s,(0,o._)("div",Vs,[(0,o.Wm)(_,{modelValue:e.model["password"],"onUpdate:modelValue":t[5]||(t[5]=t=>e.model["password"]=t),type:"password",label:e.$t("pages.import.password"),outlined:"","data-cy":"password",class:(0,i.C_)("full q-ml-sm")},{append:(0,o.w5)((()=>[e.errors["password"]?((0,o.wg)(),(0,o.j4)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-red line-error-tooltip"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1},8,["modelValue","label"])]),xs]),(0,o._)("div",Us,[Is,(0,o._)("div",Zs,[(0,o.Wm)(_,{modelValue:e.model["file_name_matching_patterns"],"onUpdate:modelValue":t[6]||(t[6]=t=>e.model["file_name_matching_patterns"]=t),label:e.$t("file_name_matching_patterns"),outlined:"","data-cy":"file_name_matching_patterns",class:"full q-ml-sm"},null,8,["modelValue","label"])]),Rs]),(0,o._)("div",Ds,[Hs,(0,o._)("div",zs,[(0,o.Wm)(p,{class:"full q-ml-sm",outlined:"",clearable:"",modelValue:e.model["sub_org_id"],"onUpdate:modelValue":t[7]||(t[7]=t=>e.model["sub_org_id"]=t),"use-input":"",options:e.filterSubOrgsList,onFilter:e.filterSubOrgslistEvent,label:e.$t("sub_organizations"),loading:e.sub_org_list_loading,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","label","loading"])]),Qs]),(0,o._)("div",As,[Ms,(0,o._)("div",Ps,[(0,o.Wm)(_,{class:(0,i.C_)(["full q-ml-sm","bg-disable"]),id:"apiKey",outlined:"",modelValue:e.api_key_ref,"onUpdate:modelValue":t[8]||(t[8]=t=>e.api_key_ref=t),readonly:"",label:e.$t("pages.import.token")},null,8,["modelValue","label"])]),Fs])])),_:1}),(0,o.Wm)(h,{class:"p-t-0"},{default:(0,o.w5)((()=>[(0,o._)("div",js,[Ns,(0,o._)("div",Ys,[(0,o.Wm)(d,{type:"submit",color:"primary",class:"q-ml-sm float-right",label:e.$t("save")},null,8,["label"]),e.row_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"q-ml-sm float-right",color:"primary",label:e.$t("test_connection"),onClick:t[9]||(t[9]=t=>e.checkConnection())},{default:(0,o.w5)((()=>[e.row_id?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(u,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.$t("available_after_save")),1)])),_:1}))])),_:1},8,["label"])):(0,o.kq)("",!0),(0,o.wy)((0,o.Wm)(d,{class:"float-right highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[f]])]),Ks])])),_:1})],32),(0,o.Wm)(g,{showing:e.loading,class:"z-index-1"},{default:(0,o.w5)((()=>[Js])),_:1},8,["showing"])])),_:1})}var Bs=function(e,t,s,o){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{n(o.next(e))}catch(t){l(t)}}function r(e){try{n(o["throw"](e))}catch(t){l(t)}}function n(e){e.done?s(e.value):i(e.value).then(a,r)}n((o=o.apply(e,t||[])).next())}))};const Gs=(0,o.aZ)({el:"#app",mixins:[T.Z,L.Z],props:{selected_model:{},api_key:{type:String,default:""}},components:{},data(){return{}},setup(){const e=(0,wt.At)(),{ftp_types:t,subOrgList:s,sub_org_list_loading:o}=(0,gt.Jk)(e),i=(0,S.iH)(e.subOrgList);return{EMAIL_ENCRYPTION_KEY:(0,S.iH)(""),subOrgList:s,sub_org_list_loading:o,filterSubOrgsList:i,ftp_types:t,loading:(0,S.iH)(!1),model:(0,S.iH)({}),row_id:(0,S.iH)(""),errors:(0,S.iH)({}),api_key_ref:(0,S.iH)("")}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";if(void 0==e)throw"Missing EMAIL_ENCRYPTION_KEY env - unable to load";this.EMAIL_ENCRYPTION_KEY=e,this.initView(),window.aa=this},methods:{initView(){this.api_key_ref=this.api_key,this.row_id=this.selected_model.hasOwnProperty("id")?this.selected_model.id:"",this.model=JSON.parse(JSON.stringify(this.selected_model));for(let[e,t]of Object.entries(this.model))t||(this.model[e]="");this.model["server"]=this.model["server_url"],this.row_id||this.resetForm()},resetForm(){this.model={username:"",password:"",server:"",port:"22",default_directory:"",file_name_matching_patterns:"",ftp_type:"SFTP",sub_org_id:""}},submitFrom(){return Bs(this,void 0,void 0,(function*(){try{if(!this.validateForm())return;this.loading=!0;const e=yield se.mX.ftpImportAddUpdate(this.prepareApiData());if(!e.success)throw e;e.data.hasOwnProperty("id")&&(this.row_id=e.data.id),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),yield this.checkConnection();const t=new CustomEvent("ftp_import_updated",{detail:{}});document.dispatchEvent(t)}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},validateForm(){let e=!0;this.resetErrors();const t=["default_directory","file_name_matching_patterns","sub_org_id"];for(const[s,o]of Object.entries(this.model))t.includes(s)||o&&0!=String(o).length||(e=!1,this.errors[s]=!0);return e},prepareApiData(){this.encryptPassword();return{password:this.model.password,username:this.model.username,server:this.model.server,port:this.model.port,ftp_type:this.model.ftp_type,file_name_matching_patterns:this.model.file_name_matching_patterns,api_key:this.api_key,sub_org_id:this.model.sub_org_id,id:this.row_id,default_directory:this.model.default_directory}},encryptPassword(){var e=yt.cE.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),t=yt.es.encrypt(this.model.password,e,{mode:yt.xJ.ECB,padding:yt.vk.PKCS7});return t},decryptPassword(e){var t=yt.cE.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),s=yt.es.decrypt(e,t,{mode:yt.xJ.ECB});return s},updateFTPImportEvent(){const e=new CustomEvent("email_import_updated",{});document.dispatchEvent(e)},checkConnection(){return Bs(this,void 0,void 0,(function*(){try{if(!this.row_id)return;this.loading=!0;const e=yield se.mX.ftpConnectionTest(this.row_id);if(!e||e.hasOwnProperty("success")&&!1===e.success)throw e;this.showSuccessToast(this.$t("test_connection_success"))}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},resetErrors(){for(const[e,t]of Object.entries(this.model))this.errors[e]=!1},filterSubOrgslistEvent(e,t,s){t(e?()=>{const t=e.toLowerCase();this.filterSubOrgsList=this.subOrgList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}:()=>{this.filterSubOrgsList=this.subOrgList})}}}),eo=(0,D.Z)(Gs,[["render",Xs]]),to=eo;M()(Gs,"components",{QCard:kt.Z,QToolbar:Et.Z,QToolbarTitle:qt.Z,QBtn:Ct.Z,QCardSection:Wt.Z,QSelect:Q.Z,QIcon:Ot.Z,QTooltip:z.Z,QInput:H.Z,QInnerLoading:Tt.Z}),M()(Gs,"directives",{ClosePopup:Lt.Z});var so=function(e,t,s,o){function i(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{n(o.next(e))}catch(t){l(t)}}function r(e){try{n(o["throw"](e))}catch(t){l(t)}}function n(e){e.done?s(e.value):i(e.value).then(a,r)}n((o=o.apply(e,t||[])).next())}))};const oo=(0,o.aZ)({mixins:[T.Z,L.Z,ts],components:{EditCreate:to,ConnectionLogs:Xt},watch:{sub_org_list_loading(e,t){!1===e&&this.initView()}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";void 0!=e?(document.addEventListener("ftp_import_updated",this.emailImportUpdated),this.handleSubOrgs()):this.showErrorToast("Missing an important value - unable to load email import")},unmounted:function(){document.removeEventListener("ftp_import_updated",this.emailImportUpdated)},methods:{showFtpConnectionLogs(e){this.connection_id=e,this.show_connection_logs=!0},initView(){return so(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns(),yield this.getAppKey(),this.flattenSubOrgs(),this.getList()}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},handleSubOrgs(){this.subOrgList.length>1&&this.initView(),this.sub_org_list_loading&&(this.loading=!0)},getList(){return so(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns();const e=yield se.mX.getFTPImport_List();if(0==e.data.length)return;this.prepareRows(e.data)}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},prepareRows(e){this.rows=[],Array.from(e).forEach((e=>{const t=e;this.addNewRow(t)}))},addNewRow(e){let t=Object.assign({},e);return this.rows.push(t),this.rows.length.toString()},createNewRecord(){this.selected_row={},this.show_edit_create=!0},emailImportUpdated(){this.show_edit_create=!1,this.getList()},editRow(e,t){this.selected_row=JSON.parse(JSON.stringify(t)),this.show_edit_create=!0},deleteClicked(e,t){return so(this,void 0,void 0,(function*(){try{this.loading=!0;const s=yield se.mX.ftpImportDelete(t);!0===s.success&&this.rows.splice(e,1),this.showSuccessToast(this.$t("success"))}catch(s){const e=oe.w.getErrorMessage(s);this.showErrorToast(e)}finally{this.loading=!1}}))},checkConnection(e){return so(this,void 0,void 0,(function*(){try{this.loading=!0;const t=yield se.mX.ftpConnectionTest(e);if(!t||t.hasOwnProperty("success")&&!1===t.success)throw t;this.showSuccessToast(this.$t("test_connection_success"))}catch(t){const e=oe.w.getErrorMessage(t);this.showErrorToast(e)}finally{this.loading=!1}}))},getAppKey(){return so(this,void 0,void 0,(function*(){try{this.loading=!0;const e={app_key:"FELLOW_DOC2"},t=yield se.FT.getAppSubscription(e);this.api_key=t[0].token}catch(e){const t=oe.w.getErrorMessage(e);this.showErrorToast(t)}finally{this.loading=!1}}))},de_activate(e){return so(this,void 0,void 0,(function*(){try{this.loading=!0;const t=e.id,s=e.is_active;yield se.mX.setFTPImportActiveDeactive(t,s);this.showSuccessToast(this.$t("success"))}catch(t){const e=oe.w.getErrorMessage(t);this.showErrorToast(e)}finally{this.loading=!1}}))},flattenSubOrgs(){this.subOrgList.forEach((e=>{this.sub_orgs_flattened[e.value]=e.label}))},prepareColumns(){this.columns=[],this.columns.push({name:"ftp_type",label:this.$t("type"),field:"ftp_type",align:"left"}),this.columns.push({name:"server_url",label:this.$t("server_url"),field:"server_url",align:"left"}),this.columns.push({name:"username",label:this.$t("username"),field:"username",align:"left"}),this.columns.push({name:"port",label:this.$t("port"),field:"port",align:"left"}),this.columns.push({name:"sub_org_id",label:this.$t("sub_organizations"),field:"sub_org_id",align:"left"}),this.columns.push({name:"default_directory",label:this.$t("default_directory"),field:"default_directory",align:"left"}),this.columns.push({name:"action",label:this.$t("action"),field:"action",align:"right"})}},setup(){const e=(0,wt.At)(),{subOrgList:t,sub_org_list_loading:s}=(0,gt.Jk)(e);let o=(0,S.iH)({});const i=(0,S.iH)(null);return{sub_org_list_loading:s,subOrgList:t,myForm:i,import_email:o,show_connection_logs:(0,S.iH)(!1),connection_id:(0,S.iH)(""),errors:(0,S.iH)({}),sub_orgs_flattened:(0,S.iH)({}),processing:(0,S.iH)(!1),ms_url:(0,S.iH)("https://microsoft.com/devicelogin"),ms_code:(0,S.iH)(""),ms_authenticate:(0,S.iH)(!1),ms_is_authenticated:(0,S.iH)(!1),ms_message:(0,S.iH)("Microsoft o365 is authenticated already."),loading:(0,S.iH)(!1),userDialog:(0,S.iH)(!1),columns:(0,S.iH)([]),rows:(0,S.iH)([]),show_edit_create:(0,S.iH)(!1),selected_row:(0,S.iH)({}),api_key:(0,S.iH)("")}},data(){return{}}}),io=(0,D.Z)(oo,[["render",ys]]),lo=io;M()(oo,"components",{QTable:Ft.Z,QTr:jt.Z,QTh:Nt.Z,QTd:Yt.Z,QBtn:Ct.Z,QMenu:ls.Z,QList:as.Z,QItem:rs.Z,QItemSection:ns.Z,QSeparator:ds.Z,QTooltip:z.Z,QInnerLoading:Tt.Z,QDialog:cs.Z});const ao=(0,o.aZ)({el:"#app",components:{SubHeader:u.Z,BackToSettings:m.Z,PageRestriction:F,EmailImportList:ms,FtpImportList:lo},mounted:function(){this.getSubOrgsList()},setup(){const e=(0,wt.At)(),{getSubOrgsList:t}=e;return{getSubOrgsList:t}}});var ro=s(50651),no=s(90136);const co=(0,D.Z)(ao,[["render",c]]),uo=co;M()(ao,"components",{QList:as.Z,QExpansionItem:ro.Z,QSeparator:ds.Z,QIcon:Ot.Z,QSpace:no.Z,QCard:kt.Z,QCardSection:Wt.Z})}}]);