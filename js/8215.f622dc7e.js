"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[8215],{98215:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ws});var s=o(61758),l=o(58790);const a={class:"container page-height-limit"},i={style:{width:"100%"}},r={style:{"margin-top":"3px"}},n={style:{"margin-top":"3px"}},d={style:{"margin-top":"3px"}};function c(e,t,o,c,u,m){const p=(0,s.g2)("SubHeader"),_=(0,s.g2)("BackToSettings"),h=(0,s.g2)("q-separator"),g=(0,s.g2)("q-icon"),f=(0,s.g2)("q-space"),b=(0,s.g2)("PageRestriction"),k=(0,s.g2)("q-card-section"),v=(0,s.g2)("q-card"),y=(0,s.g2)("q-expansion-item"),w=(0,s.g2)("FtpImportList"),L=(0,s.g2)("EmailImportList"),E=(0,s.g2)("q-list");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(p,{name:"import_settings",label:e.$t("Import"),onSearch:!1},null,8,["label"]),(0,s.bF)(_),(0,s.Lk)("div",a,[(0,s.Lk)("div",i,[(0,s.Lk)("div",null,[(0,s.bF)(E,{bordered:"",class:"rounded-borders"},{default:(0,s.k6)((()=>[(0,s.bF)(y,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,s.k6)((()=>[(0,s.bF)(g,{size:"25px",class:"q-mr-lg black_to_white",name:"img:settings/doc.svg"}),(0,s.Lk)("span",r,(0,l.v_)(e.$t("pages.import.email_import")),1),(0,s.bF)(f)])),default:(0,s.k6)((()=>[(0,s.bF)(h),(0,s.bF)(v,{class:"page-background"},{default:(0,s.k6)((()=>[(0,s.bF)(k,null,{default:(0,s.k6)((()=>[(0,s.bF)(b)])),_:1})])),_:1})])),_:1}),(0,s.bF)(y,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,s.k6)((()=>[(0,s.bF)(g,{size:"25px",class:"q-mr-lg icon-grey q-mt-xs",name:"cloud_download"}),(0,s.Lk)("span",n,(0,l.v_)(e.$t("ftp_import")),1),(0,s.bF)(f)])),default:(0,s.k6)((()=>[(0,s.bF)(h),(0,s.bF)(v,{class:"page-background"},{default:(0,s.k6)((()=>[(0,s.bF)(k,null,{default:(0,s.k6)((()=>[(0,s.bF)(w)])),_:1})])),_:1})])),_:1}),(0,s.bF)(y,{"expand-separator":"","header-class":"highlighted-back","default-opened":""},{header:(0,s.k6)((()=>[(0,s.bF)(g,{size:"25px",class:"q-mr-lg black_to_white",name:"img:settings/email-import.svg"}),(0,s.Lk)("span",d,(0,l.v_)(e.$t("pages.settings.email_import")),1),(0,s.bF)(f)])),default:(0,s.k6)((()=>[(0,s.bF)(h),(0,s.bF)(v,{class:"page-background"},{default:(0,s.k6)((()=>[(0,s.bF)(k,null,{default:(0,s.k6)((()=>[(0,s.bF)(L)])),_:1})])),_:1})])),_:1})])),_:1})])])])],64)}var u=o(66693),m=o(25773);const p={class:"import-container q-pa-xl"},_={class:"row"},h={style:{width:"30%",margin:"auto","padding-right":"5%"}},g={style:{width:"30%"}},f=(0,s.Lk)("div",{style:{width:"40%",margin:"auto","padding-left":"5%"}},null,-1),b={class:"row q-py-sm"},k={style:{width:"30%",margin:"auto","padding-right":"5%"}},v={style:{width:"30%"}},y=(0,s.Lk)("div",{style:{width:"40%"}},null,-1),w={class:"row"},L={style:{width:"30%",margin:"auto","padding-right":"5%"}},E={style:{width:"30%"}},F=(0,s.Lk)("div",{style:{width:"40%"}},null,-1);function C(e,t,o,a,i,r){const n=(0,s.g2)("q-tooltip"),d=(0,s.g2)("q-input"),c=(0,s.g2)("q-select");return(0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",_,[(0,s.Lk)("div",h,(0,l.v_)(e.$t("restrict_to_pages")),1),(0,s.Lk)("div",g,[(0,s.bF)(d,{outlined:"",dense:"","data-cy":"restrict_to_pages",tabindex:"0",type:"number",class:(0,l.C4)("full-width back-white"),modelValue:e.user_settings["RESTRICT_TO_PAGES"],"onUpdate:modelValue":[t[0]||(t[0]=t=>e.user_settings["RESTRICT_TO_PAGES"]=t),t[1]||(t[1]=t=>{e.saveSettings("RESTRICT_TO_PAGES",t)})]},{default:(0,s.k6)((()=>[(0,s.bF)(n,null,{default:(0,s.k6)((()=>[(0,s.eW)(" Only process given number of pages every further page will be ignored. ")])),_:1})])),_:1},8,["modelValue"])]),f]),(0,s.Lk)("div",b,[(0,s.Lk)("div",k,(0,l.v_)(e.$t("payment_terms_days")),1),(0,s.Lk)("div",v,[(0,s.bF)(d,{outlined:"",dense:"","data-cy":"payment_terms_days",tabindex:"0",type:"number",class:(0,l.C4)("full-width back-white"),modelValue:e.user_settings["PAYMENT_TERMS_DAYS"],"onUpdate:modelValue":[t[2]||(t[2]=t=>e.user_settings["PAYMENT_TERMS_DAYS"]=t),t[3]||(t[3]=t=>{e.saveSettings("PAYMENT_TERMS_DAYS",t)})]},null,8,["modelValue"])]),y]),(0,s.Lk)("div",w,[(0,s.Lk)("div",L,(0,l.v_)(e.$t("date_pattern")),1),(0,s.Lk)("div",E,[(0,s.bF)(c,{outlined:"",dense:"",class:"back-white","data-cy":"date_pattern",modelValue:e.user_settings["DATE_PATTERN"],"onUpdate:modelValue":[t[4]||(t[4]=t=>e.user_settings["DATE_PATTERN"]=t),t[5]||(t[5]=t=>{e.saveSettings("DATE_PATTERN",t)})],options:[{label:e.$t("select"),value:""},{label:"%d/%m/%Y",value:"%d/%m/%Y"},{label:"%d.%m.%Y",value:"%d.%m.%Y"},{label:"%m %d, %Y",value:"%m %d, %Y"},{label:"%Y %m, %d",value:"%Y %m, %d"}],"emit-value":"","map-options":"",label:e.$t("date_pattern")},null,8,["modelValue","options","label"])]),F])])}var A=o(1659),R=o(24622),V=o(38734),D=o(1595),q=o(18505),$=function(e,t,o,s){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,a){function i(e){try{n(s.next(e))}catch(t){a(t)}}function r(e){try{n(s["throw"](e))}catch(t){a(t)}}function n(e){e.done?o(e.value):l(e.value).then(i,r)}n((s=s.apply(e,t||[])).next())}))};const S=(0,s.pM)({mixins:[q.A,R.A],methods:{saveSettings(e,t){return $(this,void 0,void 0,(function*(){if(e){this.showLoading();try{yield this.updateSetting(e,t)}catch(o){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}}))}},setup(){const e=(0,D.Bu)(),{user_settings:t}=(0,A.bP)(e),{updateSetting:o}=e;return{user_settings:t,updateSetting:o}},data(){return{userDialog:(0,V.KR)(!1),api_key:""}}});var x=o(12807),I=o(67837),O=o(97410),T=o(94940),Q=o(98582),K=o.n(Q);const W=(0,x.A)(S,[["render",C]]),M=W;K()(S,"components",{QInput:I.A,QTooltip:O.A,QSelect:T.A});var U=o(29104);const X={class:"container q-pa-xl"},P={class:"row",style:{"margin-bottom":"15px"}},N={style:{width:"20%",margin:"auto"}},Y={style:{width:"80%"}},z={class:"row"},j={key:0,class:"cursor-default"},B={key:1},J={class:"row float-right"},G={class:"text-red-14"},H=(0,s.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function Z(e,t,o,a,i,r){const n=(0,s.g2)("f-btn"),d=(0,s.g2)("ImportLogs"),c=(0,s.g2)("q-th"),u=(0,s.g2)("q-tr"),m=(0,s.g2)("q-item-section"),p=(0,s.g2)("q-item"),_=(0,s.g2)("q-separator"),h=(0,s.g2)("q-list"),g=(0,s.g2)("q-menu"),f=(0,s.g2)("q-btn"),b=(0,s.g2)("q-td"),k=(0,s.g2)("q-table"),v=(0,s.g2)("q-inner-loading"),y=(0,s.g2)("EditCreate"),w=(0,s.g2)("q-dialog"),L=(0,s.g2)("ConnectionLogs");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",X,[(0,s.Lk)("div",P,[(0,s.Lk)("div",N,(0,l.v_)(e.$t("pages.import.email")),1),(0,s.Lk)("div",Y,[(0,s.eW)((0,l.v_)(e.$t("pages.import.email_info"))+" ",1),(0,s.Lk)("a",{onClick:t[0]||(t[0]=(...t)=>e.webSiteLink&&e.webSiteLink(...t)),class:"cursor-pointer color-primary",target:"_blank"},(0,l.v_)(e.$t("pages.import.email_link")),1)]),(0,s.bF)(n,{class:"q-ml-auto",icon:"add",label:e.$t("new"),onClick:e.createNewRecord},null,8,["label","onClick"]),(0,s.bF)(d,{setheight:"36px"})]),(0,s.Lk)("div",z,[(0,s.bF)(k,{"no-data-label":e.$t("pages.messages.no_record_found"),style:{width:"100%",height:"100%"},class:"dashboard-table-style back-white",rows:e.rows,columns:e.columns,"row-key":"name",flat:"","rows-per-page-options":[0],id:"email_import_table"},{header:(0,s.k6)((t=>[(0,s.bF)(u,{props:t},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.cols,((o,a)=>((0,s.uX)(),(0,s.Wv)(c,{key:o.name,props:t,"data-index":a,draggable:e.canDragDropColumn(o),dropzone:e.canDragDropColumn(o),direction:"horizontal",onDragstart:t=>e.onDragStart(t,e.columns,a),onDrop:(0,U.D$)((t=>e.handleDrop(t,a)),["prevent"]),onDragover:(0,U.D$)((t=>e.onDragOver(t,a)),["prevent"]),onDragenter:(0,U.D$)(e.onDragEnter,["prevent"]),onDragleave:(0,U.D$)(e.onDragLeave,["prevent"]),style:(0,l.Tr)({cursor:e.getIsDragging?"pointer":"move"})},{default:(0,s.k6)((()=>["action"==o.name?((0,s.uX)(),(0,s.CE)("span",j,(0,l.v_)(o.label),1)):((0,s.uX)(),(0,s.CE)("span",B,(0,l.v_)(o.label),1))])),_:2},1032,["props","data-index","draggable","dropzone","onDragstart","onDrop","onDragover","onDragenter","onDragleave","style"])))),128))])),_:2},1032,["props"])])),body:(0,s.k6)((o=>[(0,s.bF)(u,{props:o,id:o.key},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.cols,(a=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a.name},["action"===a.name?((0,s.uX)(),(0,s.Wv)(b,{key:0,style:{width:"350px"}},{default:(0,s.k6)((()=>[(0,s.Lk)("div",J,[(0,s.bF)(f,{flat:"",dense:"",round:"",onClick:t[1]||(t[1]=(0,U.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,s.k6)((()=>[(0,s.bF)(g,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,s.k6)((()=>[(0,s.bF)(h,{dense:"",style:{"min-width":"100px"}},{default:(0,s.k6)((()=>["IMAP"===o.row.protocol||"POP3"===o.row.protocol?((0,s.uX)(),(0,s.Wv)(p,{key:0,clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(m,{onClick:t=>e.checkLogin(o.row)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("test_connection")),1)])),_:2},1032,["onClick"])])),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(p,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(m,{onClick:t=>e.showMailConnectionLogs(o.row.id)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.import.connection_logs")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(p,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(m,{onClick:t=>e.showMailImportLogs(o.row.id)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.import.import_log")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(_,{inset:""}),(0,s.bF)(p,{clickable:""},{default:(0,s.k6)((()=>[o.row.is_active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(m,{key:0,onClick:t=>{o.row.is_active=!0,e.de_activateEmail(o.row)}},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("activate")),1)])),_:2},1032,["onClick"])),o.row.is_active?((0,s.uX)(),(0,s.Wv)(m,{key:1,onClick:t=>{o.row.is_active=!1,e.de_activateEmail(o.row)}},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("deactivate")),1)])),_:2},1032,["onClick"])):(0,s.Q3)("",!0)])),_:2},1024),(0,s.bF)(p,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(m,{onClick:t=>e.editRow(o.rowIndex,o.row)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(_,{inset:""}),(0,s.bF)(p,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(m,{onClick:t=>e.deleteClicked(o.rowIndex,o.row.id)},{default:(0,s.k6)((()=>[(0,s.Lk)("span",G,(0,l.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):"sub_org_id"===a.name?((0,s.uX)(),(0,s.Wv)(b,{key:1,class:(0,l.C4)(o.row.is_active?"":"email-import-deactive-column")},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.sub_orgs_flattened[o.row[a.name]]),1)])),_:2},1032,["class"])):((0,s.uX)(),(0,s.Wv)(b,{key:2,class:(0,l.C4)(1==o.row.is_active?"":"email-import-deactive-column")},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)("null"===o.row[a.name]?"":o.row[a.name]),1)])),_:2},1032,["class"]))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["no-data-label","rows","columns"])])]),(0,s.bF)(v,{showing:e.loading,class:"z-index-1",style:{"z-index":"1000"}},{default:(0,s.k6)((()=>[H])),_:1},8,["showing"]),(0,s.bF)(w,{modelValue:e.show_edit_create,"onUpdate:modelValue":t[2]||(t[2]=t=>e.show_edit_create=t),persistent:"",onKeydown:t[3]||(t[3]=(0,U.jR)((t=>e.show_edit_create=!1),["esc"]))},{default:(0,s.k6)((()=>[(0,s.bF)(y,{selected_model:e.selected_row,api_key:e.api_key},null,8,["selected_model","api_key"])])),_:1},8,["modelValue"]),(0,s.bF)(w,{modelValue:e.show_connection_logs,"onUpdate:modelValue":t[4]||(t[4]=t=>e.show_connection_logs=t)},{default:(0,s.k6)((()=>[(0,s.bF)(L,{connection_id:e.connection_id,connection_type:e.connection_type},null,8,["connection_id","connection_type"])])),_:1},8,["modelValue"]),(0,s.bF)(w,{modelValue:e.show_import_logs,"onUpdate:modelValue":t[5]||(t[5]=t=>e.show_import_logs=t),onKeypress:t[6]||(t[6]=(0,U.jR)((t=>e.show_import_logs=!1),["esc"])),onHide:t[7]||(t[7]=t=>e.show_import_logs=!1)},{default:(0,s.k6)((()=>[(0,s.bF)(d,{connection_id:e.connection_id,setheight:"36px"},null,8,["connection_id"])])),_:1},8,["modelValue"])],64)}var ee=o(10739),te=o(11470),oe=o(64775);const se={key:0,class:"text-weight-bold"},le={key:1,class:"text-weight-bold"},ae={class:"row q-mt-md"},ie={class:"col-2"},re={key:0,class:"col-7"},ne={class:"col-3"},de={class:"row q-mt-md"},ce=(0,s.Lk)("div",{class:"col-2"},null,-1),ue={class:"col-3"},me={class:"col-1"},pe=(0,s.Lk)("div",{class:"col-3"},null,-1),_e={key:0,class:"row q-mt-md"},he=(0,s.Lk)("div",{class:"col-2"},null,-1),ge={class:"col-7"},fe={class:"row"},be={class:"col-4"},ke={style:{"margin-top":"8px"}},ve={class:"col"},ye=(0,s.Lk)("div",{class:"col-3"},null,-1),we={key:1,class:"row q-mt-md"},Le=(0,s.Lk)("div",{class:"col-2"},null,-1),Ee={class:"col-7"},Fe={class:"row"},Ce={class:"col-4"},Ae={style:{"margin-top":"8px"}},Re={class:"col"},Ve=(0,s.Lk)("div",{class:"col-3"},null,-1),De={key:2,class:"row q-mt-md"},qe=(0,s.Lk)("div",{class:"col-2"},null,-1),$e={class:"col-7"},Se={class:"row"},xe={class:"col-6"},Ie={style:{"margin-top":"8px"}},Oe={class:"col"},Te=(0,s.Lk)("div",{class:"col-3"},null,-1),Qe={class:"row q-mt-md"},Ke={class:"col-2"},We={class:"col-7"},Me={class:"row q-mt-md"},Ue=(0,s.Lk)("div",{class:"col-2"},null,-1),Xe={class:"col-7"},Pe={class:"row q-mt-md"},Ne={class:"col-2"},Ye={class:"col-7"},ze={class:"col-3"},je={class:"row q-mt-md"},Be={class:"col-2"},Je={class:"col-7"},Ge={class:"col-3"},He={class:"row q-mt-md"},Ze=(0,s.Lk)("div",{class:"col-2"},null,-1),et={class:"col-7"},tt={key:0,class:"col-3",style:{"margin-top":"-5px"}},ot={class:"row q-mt-md"},st=(0,s.Lk)("div",{class:"col-2"},null,-1),lt={class:"col-7"},at={class:"col-3",style:{"margin-top":"-5px"}},it={style:{"margin-top":"5px"}},rt={style:{"margin-top":"15px"}},nt={class:"row q-mt-sm"},dt=(0,s.Lk)("div",{class:"col-2"},null,-1),ct={class:"col-7"},ut={class:"col-3"},mt={class:"row q-mt-md"},pt=(0,s.Lk)("div",{class:"col-2"},null,-1),_t={class:"col-7"},ht={class:"col-3"},gt={class:"row q-mt-md"},ft=(0,s.Lk)("div",{class:"col-2"},null,-1),bt={class:"col-7"},kt={class:"col-3"},vt={style:{"margin-top":"15px"}},yt={class:"row q-mt-md"},wt=(0,s.Lk)("div",{class:"col-2"},null,-1),Lt=(0,s.Lk)("div",{class:"col-6"},null,-1),Et={class:"col-4"},Ft=(0,s.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function Ct(e,t,o,a,i,r){const n=(0,s.g2)("q-toolbar-title"),d=(0,s.g2)("q-btn"),c=(0,s.g2)("q-toolbar"),u=(0,s.g2)("q-tooltip"),m=(0,s.g2)("q-icon"),p=(0,s.g2)("q-select"),_=(0,s.g2)("f-btn"),h=(0,s.g2)("q-input"),g=(0,s.g2)("q-toggle"),f=(0,s.g2)("q-card-section"),b=(0,s.g2)("q-inner-loading"),k=(0,s.g2)("q-card"),v=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.Wv)(k,{style:{width:"1200px","max-width":"1200px",height:"650px"}},{default:(0,s.k6)((()=>[(0,s.Lk)("form",{onSubmit:t[34]||(t[34]=(0,U.D$)(((...t)=>e.submitFrom&&e.submitFrom(...t)),["prevent","stop"]))},[(0,s.bF)(c,{class:"text-white secondary-toolbar"},{default:(0,s.k6)((()=>[(0,s.bF)(n,null,{default:(0,s.k6)((()=>[e.row_id?((0,s.uX)(),(0,s.CE)("span",se,(0,l.v_)(e.$t("pages.settings.master_data_lookup.edit_row")),1)):((0,s.uX)(),(0,s.CE)("span",le,(0,l.v_)(e.$t("pages.settings.master_data_lookup.create_row")),1))])),_:1}),(0,s.bo)((0,s.bF)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])])),_:1}),e.Office365_selected?((0,s.uX)(),(0,s.Wv)(f,{key:0},{default:(0,s.k6)((()=>[(0,s.Lk)("div",ae,[(0,s.Lk)("div",ie,[(0,s.bF)(p,{modelValue:e.model["protocol"],"onUpdate:modelValue":[t[0]||(t[0]=t=>e.model["protocol"]=t),e.protocolUpdated],outlined:"",options:e.protocols,label:e.$t("pages.import.protocol")},{append:(0,s.k6)((()=>[e.errors["protocol"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","options","label","onUpdate:modelValue"])]),e.loading||1!=e.ms_is_authenticated?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",re,[(0,s.bF)(p,{class:"full q-ml-sm",outlined:"",clearable:"",modelValue:e.model["sub_org_id"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.model["sub_org_id"]=t),"use-input":"",options:e.filterSubOrgsList,onFilter:e.filterSubOrgslistEvent,label:e.$t("sub_organizations"),loading:e.sub_org_list_loading,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","label","loading"])])),(0,s.Lk)("div",ne,[0==e.ms_authenticate&&0==e.ms_is_authenticated?((0,s.uX)(),(0,s.Wv)(_,{key:0,class:"q-ml-sm",appearance:"secondary",label:e.$t("pages.import.authenticate"),onClick:t[2]||(t[2]=t=>e.submitFrom()),style:{height:"56px"}},null,8,["label"])):1==e.ms_authenticate&&0==e.ms_is_authenticated?((0,s.uX)(),(0,s.Wv)(_,{key:1,class:"q-ml-sm",style:{height:"56px"},label:e.$t("pages.import.finish_authentication"),onClick:t[3]||(t[3]=t=>e.msfinish())},null,8,["label"])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",de,[ce,(0,s.Lk)("div",ue,[1==e.ms_authenticate&&0==e.ms_is_authenticated?((0,s.uX)(),(0,s.Wv)(h,{key:0,modelValue:e.ms_code,"onUpdate:modelValue":t[4]||(t[4]=t=>e.ms_code=t),label:e.$t("pages.import.microsoft_code"),outlined:"",readonly:"",onClick:e.copyText,id:"mscode",style:{"margin-left":"10px",width:"90%"}},null,8,["modelValue","label","onClick"])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",me,[1==e.ms_authenticate&&0==e.ms_is_authenticated?((0,s.uX)(),(0,s.Wv)(_,{key:0,style:{"margin-left":"4px","margin-top":"8px"},icon:"fas fa-copy",onClick:e.copyText},null,8,["onClick"])):(0,s.Q3)("",!0)]),pe]),e.loading||1!=e.ms_is_authenticated?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",_e,[he,(0,s.Lk)("div",ge,[(0,s.Lk)("div",fe,[(0,s.Lk)("div",be,[(0,s.bF)(g,{modelValue:e.use_folder,"onUpdate:modelValue":t[5]||(t[5]=t=>e.use_folder=t)},null,8,["modelValue"]),(0,s.Lk)("span",ke,(0,l.v_)(e.$t("Use Folder")),1)]),(0,s.Lk)("div",ve,[1==e.use_folder&&""!=e.row_id?((0,s.uX)(),(0,s.Wv)(p,{key:0,modelValue:e.model["folder"],"onUpdate:modelValue":t[6]||(t[6]=t=>e.model["folder"]=t),label:e.$t("pages.import.folder"),options:e.folder_list,outlined:"","data-cy":"folder",style:{"margin-left":"10px"}},null,8,["modelValue","label","options"])):(0,s.Q3)("",!0)])])]),ye])),e.loading||1!=e.ms_is_authenticated?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",we,[Le,(0,s.Lk)("div",Ee,[(0,s.Lk)("div",Fe,[(0,s.Lk)("div",Ce,[(0,s.bF)(g,{modelValue:e.use_email,"onUpdate:modelValue":t[7]||(t[7]=t=>e.use_email=t)},null,8,["modelValue"]),(0,s.Lk)("span",Ae,(0,l.v_)(e.$t("Use shared Mailbox")),1),(0,s.bF)(m,{name:"help",style:{"margin-top":"-8px","margin-left":"2px"}},{default:(0,s.k6)((()=>[(0,s.bF)(u,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("Seperate, shared Email-Adress you want to import from.")),1)])),_:1})])),_:1})]),(0,s.Lk)("div",Re,[1==e.use_email?((0,s.uX)(),(0,s.Wv)(h,{key:0,modelValue:e.model["shared_email"],"onUpdate:modelValue":t[8]||(t[8]=t=>e.model["shared_email"]=t),label:e.$t("pages.import.shared_email"),outlined:"","data-cy":"shared_email",style:{"margin-left":"10px"}},null,8,["modelValue","label"])):(0,s.Q3)("",!0)])])]),Ve])),e.loading||1!=e.ms_is_authenticated?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",De,[qe,(0,s.Lk)("div",$e,[(0,s.Lk)("div",Se,[(0,s.Lk)("div",xe,[(0,s.bF)(g,{dense:"",style:{"margin-left":"5px","margin-right":"5px"},modelValue:e.model["delete_after_import"],"onUpdate:modelValue":t[9]||(t[9]=t=>e.model["delete_after_import"]=t)},null,8,["modelValue"]),(0,s.Lk)("span",Ie,(0,l.v_)(e.$t("Move Emails to other folder")),1)]),(0,s.Lk)("div",Oe,[1==e.model["delete_after_import"]?((0,s.uX)(),(0,s.Wv)(p,{key:0,modelValue:e.model["move_to_folder"],"onUpdate:modelValue":t[10]||(t[10]=t=>e.model["move_to_folder"]=t),label:e.$t("pages.import.folder"),options:e.folder_list,outlined:"","data-cy":"folder"},null,8,["modelValue","label","options"])):(0,s.Q3)("",!0)])])]),Te]))])),_:1})):e.Mailersend_selected?((0,s.uX)(),(0,s.Wv)(f,{key:1},{default:(0,s.k6)((()=>[(0,s.Lk)("div",Qe,[(0,s.Lk)("div",Ke,[(0,s.bF)(p,{modelValue:e.model["protocol"],"onUpdate:modelValue":[t[11]||(t[11]=t=>e.model["protocol"]=t),e.protocolUpdated],outlined:"",options:e.protocols,label:e.$t("pages.import.protocol")},{append:(0,s.k6)((()=>[e.errors["protocol"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","options","label","onUpdate:modelValue"])]),(0,s.Lk)("div",We,[(0,s.bF)(h,{modelValue:e.model["username"],"onUpdate:modelValue":t[12]||(t[12]=t=>e.model["username"]=t),class:(0,l.C4)(["full q-ml-sm","full q-ml-sm"]),label:e.$t("pages.import.username"),outlined:"","data-cy":"username"},{append:(0,s.k6)((()=>[e.errors["username"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])])]),(0,s.Lk)("div",Me,[Ue,(0,s.Lk)("div",Xe,[(0,s.bF)(h,{modelValue:e.model["email"],"onUpdate:modelValue":t[13]||(t[13]=t=>e.model["email"]=t),label:e.$t("pages.import.email"),outlined:"","data-cy":"email",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["email"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])])])])),_:1})):((0,s.uX)(),(0,s.Wv)(f,{key:2},{default:(0,s.k6)((()=>[(0,s.Lk)("div",Pe,[(0,s.Lk)("div",Ne,[(0,s.bF)(p,{modelValue:e.model["protocol"],"onUpdate:modelValue":[t[14]||(t[14]=t=>e.model["protocol"]=t),e.protocolUpdated],outlined:"",options:e.protocols,label:e.$t("pages.import.protocol")},{append:(0,s.k6)((()=>[e.errors["protocol"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","options","label","onUpdate:modelValue"])]),(0,s.Lk)("div",Ye,[(0,s.bF)(h,{modelValue:e.model["server"],"onUpdate:modelValue":t[15]||(t[15]=t=>e.model["server"]=t),label:e.$t("pages.import.server"),outlined:"",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["server"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),(0,s.Lk)("div",ze,[(0,s.bF)(h,{modelValue:e.model["port"],"onUpdate:modelValue":t[16]||(t[16]=t=>e.model["port"]=t),label:e.$t("pages.import.port"),outlined:"","data-cy":"port",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["port"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])])]),(0,s.Lk)("div",je,[(0,s.Lk)("div",Be,[(0,s.bF)(p,{modelValue:e.model["encryption"],"onUpdate:modelValue":t[17]||(t[17]=t=>e.model["encryption"]=t),outlined:"","data-cy":"encryption",options:e.encryptions,class:(0,l.C4)("full-width "),label:e.$t("pages.import.encryption")},{append:(0,s.k6)((()=>[e.errors["encryption"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","options","label"])]),(0,s.Lk)("div",Je,[(0,s.bF)(h,{modelValue:e.model["username"],"onUpdate:modelValue":t[18]||(t[18]=t=>e.model["username"]=t),class:(0,l.C4)(["full q-ml-sm","full q-ml-sm"]),label:e.$t("pages.import.username"),outlined:"","data-cy":"username"},{append:(0,s.k6)((()=>[e.errors["username"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),(0,s.Lk)("div",Ge,["IMAP"==e.model["protocol"]&&""!=e.row_id?((0,s.uX)(),(0,s.Wv)(p,{key:0,modelValue:e.model["folder"],"onUpdate:modelValue":t[19]||(t[19]=t=>e.model["folder"]=t),label:e.$t("pages.import.folder"),options:e.folder_list,outlined:"","data-cy":"folder",class:"full q-ml-sm"},null,8,["modelValue","label","options"])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",He,[Ze,(0,s.Lk)("div",et,[(0,s.bF)(h,{modelValue:e.model["email"],"onUpdate:modelValue":t[20]||(t[20]=t=>e.model["email"]=t),label:e.$t("pages.import.email"),outlined:"","data-cy":"email",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["email"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),e.row_id?((0,s.uX)(),(0,s.CE)("div",tt,[(0,s.bF)(g,{dense:"",style:{"margin-top":"-3px","margin-left":"5px","margin-right":"5px"},modelValue:e.model.delete_after_import,"onUpdate:modelValue":t[21]||(t[21]=t=>e.model.delete_after_import=t)},null,8,["modelValue"]),(0,s.Lk)("span",null,(0,l.v_)(e.$t("Move Emails to other folder")),1),"IMAP"==e.model["protocol"]&&""!=e.row_id&&1==e.model["delete_after_import"]?((0,s.uX)(),(0,s.Wv)(p,{key:0,modelValue:e.model["move_to_folder"],"onUpdate:modelValue":t[22]||(t[22]=t=>e.model["move_to_folder"]=t),label:e.$t("pages.import.folder"),options:e.folder_list,outlined:"",dense:"","data-cy":"folder",class:"full q-ml-sm"},null,8,["modelValue","label","options"])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",ot,[st,(0,s.Lk)("div",lt,[(0,s.bF)(h,{modelValue:e.model["password"],"onUpdate:modelValue":t[23]||(t[23]=t=>e.model["password"]=t),type:"password",label:e.$t("pages.import.password"),outlined:"","data-cy":"password",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["password"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),(0,s.Lk)("div",at,[(0,s.Lk)("div",it,[(0,s.bF)(g,{dense:"",style:{"margin-left":"5px","margin-right":"5px"},modelValue:e.model["merge_pdf_files"],"onUpdate:modelValue":t[24]||(t[24]=t=>e.model["merge_pdf_files"]=t)},null,8,["modelValue"]),(0,s.Lk)("span",null,(0,l.v_)(e.$t("pages.import.merge_attached_documents")),1)]),(0,s.Lk)("div",rt,[(0,s.bF)(g,{dense:"",style:{"margin-left":"5px","margin-right":"5px"},modelValue:e.model["send_email_after_import"],"onUpdate:modelValue":t[25]||(t[25]=t=>e.model["send_email_after_import"]=t)},null,8,["modelValue"]),(0,s.Lk)("span",null,(0,l.v_)(e.$t("pages.import.send_email")),1)])])]),(0,s.Lk)("div",nt,[dt,(0,s.Lk)("div",ct,[(0,s.bF)(p,{class:"full q-ml-sm",outlined:"",clearable:"",modelValue:e.model["sub_org_id"],"onUpdate:modelValue":t[26]||(t[26]=t=>e.model["sub_org_id"]=t),"use-input":"",options:e.filterSubOrgsList,onFilter:e.filterSubOrgslistEvent,label:e.$t("sub_organizations"),loading:e.sub_org_list_loading,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","label","loading"])]),(0,s.Lk)("div",ut,[e.model["send_email_after_import"]?((0,s.uX)(),(0,s.Wv)(h,{key:0,modelValue:e.model["email_subject"],"onUpdate:modelValue":t[27]||(t[27]=t=>e.model["email_subject"]=t),label:e.$t("pages.import.email_subject"),outlined:"",class:(0,l.C4)("full q-ml-sm")},null,8,["modelValue","label"])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",mt,[pt,(0,s.Lk)("div",_t,[(0,s.bF)(h,{class:(0,l.C4)(["full q-ml-sm","bg-disable"]),id:"apiKey",outlined:"",modelValue:e.api_key_ref,"onUpdate:modelValue":t[28]||(t[28]=t=>e.api_key_ref=t),readonly:"",label:e.$t("pages.import.token")},null,8,["modelValue","label"])]),(0,s.Lk)("div",ht,[e.model["send_email_after_import"]?((0,s.uX)(),(0,s.Wv)(h,{key:0,modelValue:e.model["email_body"],"onUpdate:modelValue":t[29]||(t[29]=t=>e.model["email_body"]=t),label:e.$t("pages.import.email_body"),outlined:"",class:(0,l.C4)("full q-ml-sm")},null,8,["modelValue","label"])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",gt,[ft,(0,s.Lk)("div",bt,[(0,s.bF)(h,{modelValue:e.model["error_notification_email"],"onUpdate:modelValue":t[30]||(t[30]=t=>e.model["error_notification_email"]=t),label:e.$t("pages.import.error_notification_email"),outlined:"",class:(0,l.C4)("full q-ml-sm")},null,8,["modelValue","label"])]),(0,s.Lk)("div",kt,[(0,s.Lk)("div",vt,[(0,s.bF)(g,{dense:"",style:{"margin-left":"5px","margin-right":"5px"},modelValue:e.model["use_filename_filter"],"onUpdate:modelValue":t[31]||(t[31]=t=>e.model["use_filename_filter"]=t)},null,8,["modelValue"]),(0,s.Lk)("span",null,(0,l.v_)(e.$t("pages.import.use_filename_filter")),1)])])])])),_:1})),e.Office365_selected&&1!=e.ms_is_authenticated?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(f,{key:3,class:"p-t-0"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",yt,[wt,Lt,(0,s.Lk)("div",Et,[1==e.ms_is_authenticated?((0,s.uX)(),(0,s.Wv)(_,{key:0,class:"q-ml-sm float-right",label:e.$t("pages.import.save"),onClick:t[32]||(t[32]=t=>e.saveFolder())},null,8,["label"])):(0,s.Q3)("",!0),e.row_id?((0,s.uX)(),(0,s.Wv)(_,{key:1,appearance:"secondary",class:"q-ml-sm float-right",label:e.$t("pages.import.import"),onClick:t[33]||(t[33]=t=>e.manual_import())},null,8,["label"])):(0,s.Q3)("",!0),e.Office365_selected?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(_,{key:2,type:"submit",class:"q-ml-sm float-right",label:e.$t("save")},null,8,["label"])),(0,s.bo)((0,s.bF)(_,{class:"float-right",appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[v]])])])])),_:1}))],32),(0,s.bF)(b,{showing:e.loading,class:"z-index-1"},{default:(0,s.k6)((()=>[Ft])),_:1},8,["showing"])])),_:1})}var At=o(78652),Rt=o(7813),Vt=function(e,t,o,s){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,a){function i(e){try{n(s.next(e))}catch(t){a(t)}}function r(e){try{n(s["throw"](e))}catch(t){a(t)}}function n(e){e.done?o(e.value):l(e.value).then(i,r)}n((s=s.apply(e,t||[])).next())}))};const Dt=(0,s.pM)({el:"#app",mixins:[q.A,R.A],props:{selected_model:{},api_key:{type:String,default:""}},components:{},data(){return{}},setup(){const e=(0,D.cY)(),{encryptions:t,protocols:o,subOrgList:s,sub_org_list_loading:l}=(0,A.bP)(e),a=(0,V.KR)(e.subOrgList);return{EMAIL_ENCRYPTION_KEY:(0,V.KR)(""),subOrgList:s,sub_org_list_loading:l,filterSubOrgsList:a,protocols:o,encryptions:t,loading:(0,V.KR)(!1),model:(0,V.KR)({}),row_id:(0,V.KR)(""),errors:(0,V.KR)({}),Office365_selected:(0,V.KR)(!1),Mailersend_selected:(0,V.KR)(!1),use_folder:(0,V.KR)(!1),use_email:(0,V.KR)(!1),delete_after_import:(0,V.KR)(!1),send_email_after_import:(0,V.KR)(!1),ms_url:(0,V.KR)("https://microsoft.com/devicelogin"),ms_code:(0,V.KR)(""),ms_authenticate:(0,V.KR)(!1),ms_is_authenticated:(0,V.KR)(!1),ms_message:(0,V.KR)("Microsoft o365 is authenticated already."),api_key_ref:(0,V.KR)(""),folder_list:(0,V.KR)([])}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";if(void 0==e)throw"Missing EMAIL_ENCRYPTION_KEY env - unable to load";this.EMAIL_ENCRYPTION_KEY=e,this.initView()},methods:{initView(){return Vt(this,void 0,void 0,(function*(){this.api_key_ref=this.api_key,this.row_id=this.selected_model.hasOwnProperty("id")?this.selected_model.id:"",""!=this.row_id&&(yield this.getFolders()),this.folder_list,this.model=JSON.parse(JSON.stringify(this.selected_model));for(let[e,t]of Object.entries(this.model))(t||"merge_pdf_files"!=e)&&(t||"delete_after_import"!=e)&&(t||"is_active"!=e)&&(t||"send_email_after_import"!=e)&&(t||"use_filename_filter"!=e)?t||(this.model[e]=""):this.model[e]=!1;this.protocolUpdated(),"OAuth Office365"==this.model.protocol&&(this.ms_is_authenticated=!0,"null"!=this.model.shared_email&&null!=this.model.shared_email?this.use_email=!0:(this.model.shared_email="",this.use_email=!1)),this.model.hasOwnProperty("service_type")||(this.model.service_type="Other"),null!=this.model["password"]&&""!=this.model["password"]&&(this.model["password"]=this.decryptPassword(this.model["password"]).toString(Rt.fk.Utf8)),this.row_id||this.resetForm()}))},resetForm(){this.model={port:"",email:"",server:"",folder:"",skip:!1,username:"",password:"",protocol:"",active:!1,encryption:"",sub_org_id:"",email_body:"",shared_email:"",email_subject:"",whole_email:!1,service_type:"Other",merge_pdf_files:!1,use_filename_filter:"",delete_after_import:!1,error_notification_email:"",send_email_after_import:!1}},submitFrom(){return Vt(this,void 0,void 0,(function*(){try{this.loading=!0,"OAuth Office365"==this.model.protocol&&this.updateModel();const e=yield te.D.AddUpdateEmail(this.prepareApiData());if(!e.success)throw e.message;if(this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),"OAuth Office365"!==this.model.protocol)return this.resetForm(),void this.updateEmailImportEvent();"OAuth Office365"==this.model.protocol&&e.hasOwnProperty("code")&&(this.model=e.data,this.row_id=this.model.id,this.ms_code=e.code,this.openMsPage(),this.ms_authenticate=!0);const t=new CustomEvent("record_saved",{detail:{}});document.dispatchEvent(t)}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},prepareApiData(){let e=this.encryptPassword();return{email:this.model.email,shared_email:this.model.shared_email,password:e,username:this.model.username,server:this.model.server,port:this.model.port,encryption:this.model.encryption,protocol:this.model.protocol,whole_email:""!==this.model.whole_email&&this.model.whole_email,skip:""!==this.model.skip&&this.model.skip,api_key:this.api_key,sub_org_id:this.model.sub_org_id,id:this.row_id,folder:"SSL"!=this.model.encryption||"IMAP"!=this.model.protocol?"":this.model.folder,email_body:this.model.email_body,email_subject:this.model.email_subject,merge_pdf_files:this.model.merge_pdf_files,use_filename_filter:this.model.use_filename_filter,delete_after_import:this.model.delete_after_import,send_email_after_import:this.model.send_email_after_import,error_notification_email:this.model.error_notification_email,move_to_folder:1==this.model.delete_after_import?this.model.move_to_folder:""}},encryptPassword(){var e=Rt.fk.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),t=Rt.c5.encrypt(this.model.password,e,{mode:Rt.Mq.ECB,padding:Rt.eV.PKCS7});return t},decryptPassword(e){var t=Rt.fk.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),o=Rt.c5.decrypt(e,t,{mode:Rt.Mq.ECB});return o},updateModel(){this.model.password="",this.model.username="",this.model.server="",this.model.port="",this.model.encryption="",this.model.folder="",this.model.email_body="",this.model.email_subject="",this.model.shared_email=null,this.model.sub_org_id=null},copyText(){(0,At.A)(this.ms_code).then((()=>{this.showSuccessToast("Copied!")}))},updateEmailImportEvent(){const e=new CustomEvent("email_import_updated",{});document.dispatchEvent(e)},openMsPage(){window.open(this.ms_url,"_blank")},protocolUpdated(){"OAuth Office365"==this.model.protocol?(this.Office365_selected=!0,this.Mailersend_selected=!1):"Mailersend"==this.model.protocol?(this.Mailersend_selected=!0,this.Office365_selected=!1):(this.Office365_selected=!1,this.Mailersend_selected=!1)},msfinish(){return Vt(this,void 0,void 0,(function*(){try{this.loading=!0;const e=yield te.D.finishMsAuth(this.row_id);1==e.success&&(this.ms_is_authenticated=!0,this.showSuccessToast(this.$t("Authentication completed")))}catch(e){this.showErrorToast(this.$t("Something failed on the transmission. Please try again."))}finally{this.loading=!1}}))},manual_import(){return Vt(this,void 0,void 0,(function*(){this.loading=!0,yield te.D.performManuelImportMail(this.row_id),this.loading=!1,this.showSuccessToast(this.$t("pages.messages.import_try")),this.$router.push("/dashboard")}))},validateLoginTest(){let e=!0;this.resetErrors();const t=["folder","whole_email","skip","active"];if("OAuth Office365"===this.model.protocol)return e=!1,this.showErrorToast(this.$t("service_type_not_supported")),e;for(const[o,s]of Object.entries(this.model))t.includes(o)||s&&0!=String(s).length||(e=!1,this.errors[o]=!0);return e},resetErrors(){for(const[e,t]of Object.entries(this.model))this.errors[e]=!1},saveFolder(){return Vt(this,void 0,void 0,(function*(){try{this.loading=!0;const e={id:this.row_id,folder:1==this.use_folder?this.model.folder:"null",shared_email:1==this.use_email?this.model.shared_email:"null",sub_org_id:this.model.sub_org_id,delete_after_import:this.model.delete_after_import,move_to_folder:this.model.move_to_folder};let t=yield te.D.saveFolder(e);if(!t.success)throw t;this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),this.resetForm(),this.updateEmailImportEvent()}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}finally{this.loading=!1}}))},getFolders(){return Vt(this,void 0,void 0,(function*(){try{this.loading=!0;let e=yield te.D.getFolders(this.row_id);if(!e.success)throw e;this.folder_list=e.data}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}finally{this.loading=!1}}))},filterSubOrgslistEvent(e,t,o){t(e?()=>{const t=e.toLowerCase();this.filterSubOrgsList=this.subOrgList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}:()=>{this.filterSubOrgsList=this.subOrgList})}}});var qt=o(23316),$t=o(36914),St=o(39150),xt=o(56384),It=o(44189),Ot=o(50492),Tt=o(66908),Qt=o(39035),Kt=o(88672);const Wt=(0,x.A)(Dt,[["render",Ct]]),Mt=Wt;K()(Dt,"components",{QCard:qt.A,QToolbar:$t.A,QToolbarTitle:St.A,QBtn:xt.A,QCardSection:It.A,QSelect:T.A,QIcon:Ot.A,QTooltip:O.A,QInput:I.A,QToggle:Tt.A,QInnerLoading:Qt.A}),K()(Dt,"directives",{ClosePopup:Kt.A});const Ut={class:"text-weight-bold primary-bg-text"},Xt={class:"q-pl-md q-pr-md q-pt-md"},Pt={class:"text-item"},Nt=(0,s.Lk)("div",{class:"row float-right"},null,-1),Yt={key:0,style:{"text-wrap":"wrap"}},zt={key:1},jt={class:"q-mt-md row full-width"};function Bt(e,t,o,a,i,r){const n=(0,s.g2)("q-toolbar-title"),d=(0,s.g2)("q-btn"),c=(0,s.g2)("q-toolbar"),u=(0,s.g2)("q-th"),m=(0,s.g2)("q-tr"),p=(0,s.g2)("q-td"),_=(0,s.g2)("q-icon"),h=(0,s.g2)("q-table"),g=(0,s.g2)("q-pagination"),f=(0,s.g2)("q-card-section"),b=(0,s.g2)("q-card"),k=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.Wv)(b,{style:{width:"1060px","max-width":"1060px"}},{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"secondary-toolbar"},{default:(0,s.k6)((()=>[(0,s.bF)(n,null,{default:(0,s.k6)((()=>[(0,s.Lk)("span",Ut,(0,l.v_)(e.$t("pages.import.connection_logs")),1)])),_:1}),(0,s.bo)((0,s.bF)(d,{flat:"",round:"",dense:"",class:"primary-bg-text",icon:"close",onClick:e.cleanupOnhide},null,8,["onClick"]),[[k]])])),_:1}),(0,s.bF)(f,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",Xt,[(0,s.bF)(h,{class:"dashboard-table-style dashboard-table-height back-white","rows-per-page-options":[0],rows:e.rows,columns:e.columns,"row-key":"id","hide-bottom":"",flat:"","table-header-class":"table-header-text back-white","no-data-label":e.$t("no_data_found"),"no-results-label":"The filter didn't uncover any results",style:{overflow:"auto",height:"550px"}},{header:(0,s.k6)((t=>[(0,s.bF)(m,{props:t},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.cols,((e,o)=>((0,s.uX)(),(0,s.Wv)(u,{key:e.name,props:t,"data-index":o},{default:(0,s.k6)((()=>[(0,s.Lk)("span",Pt,(0,l.v_)(e.label),1)])),_:2},1032,["props","data-index"])))),128))])),_:2},1032,["props"]),0==e.rows.length?((0,s.uX)(),(0,s.Wv)(m,{key:0},{default:(0,s.k6)((()=>[(0,s.bF)(p,{colspan:"20",class:"text-center"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("no_data_found")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),body:(0,s.k6)((e=>[(0,s.bF)(m,{props:e,id:e.key},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.cols,(t=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t.name},["action"===t.name?((0,s.uX)(),(0,s.Wv)(p,{key:0},{default:(0,s.k6)((()=>[Nt])),_:1})):(0,s.Q3)("",!0),"success"===t.name?((0,s.uX)(),(0,s.Wv)(p,{key:1},{default:(0,s.k6)((()=>[(0,s.bF)(_,{name:!0===e.row[t.name]?"check_circle":"cancel",color:!0===e.row[t.name]?"green":"red",size:"20px"},null,8,["name","color"])])),_:2},1024)):((0,s.uX)(),(0,s.Wv)(p,{key:2},{default:(0,s.k6)((()=>["message"===t.name?((0,s.uX)(),(0,s.CE)("span",Yt,(0,l.v_)(e.row[t.name]),1)):((0,s.uX)(),(0,s.CE)("span",zt,(0,l.v_)(e.row[t.name]),1))])),_:2},1024))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","no-data-label"]),(0,s.Lk)("div",jt,[e.total_pages>1?((0,s.uX)(),(0,s.Wv)(g,{key:0,modelValue:e.current_page,"onUpdate:modelValue":t[0]||(t[0]=t=>e.current_page=t),max:3,"max-pages":3,"direction-links":"",unelevated:"",color:"black","active-color":"black",class:"doc2-pagination q-mb-md q-ml-auto q-mr-auto",onClick:t[1]||(t[1]=t=>e.nexPageClicked())},null,8,["modelValue"])):(0,s.Q3)("",!0)])])])),_:1})])),_:1})}var Jt=o(36246),Gt=function(e,t,o,s){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,a){function i(e){try{n(s.next(e))}catch(t){a(t)}}function r(e){try{n(s["throw"](e))}catch(t){a(t)}}function n(e){e.done?o(e.value):l(e.value).then(i,r)}n((s=s.apply(e,t||[])).next())}))};const Ht=(0,s.pM)({mixins:[R.A,q.A],props:{connection_id:{type:String,required:!0},connection_type:{type:String,required:!0}},components:{},watch:{},computed:{},mounted:function(){this.init(),this.checkConnectionLogs()},unmounted:function(){this.cleanupOnhide()},methods:{init(){this.prepareColumns()},checkConnectionLogs(){try{this.resetPagination(),this.getDataFromServer()}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}},getDataFromServer(){return Gt(this,void 0,void 0,(function*(){try{this.loading=!0,this.request_params={},this.request_params["offset"]=this.offset,this.request_params["limit"]=10,this.request_params["connection_type"]=this.connection_type,this.request_params["connection_id"]=this.connection_id,this.request_params["order_by_direction"]="desc";const e=yield te.D.fetchConnectionLogs(this.request_params);if(!1===e.success)throw{message:e.message};this.total_records=e.total_records_count,this.setTotalPages(),this.prepareRows(e.elements)}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},prepareRows(e){this.rows=[],Array.from(e).forEach((e=>{const t=e;this.addNewRow(t)})),logInfo(this.rows.length)},addNewRow(e){let t=Object.assign({},e);return t["created_on"]=this.formateDate(e["created_on"],"DD-MM-YYYY HH:mm:ss"),this.rows.push(t),this.rows.length.toString()},formateDate(e,t){return Jt.Ay.formatDate(e,t)},resetPagination(){this.offset=0,this.total_pages=0,this.current_page=1,this.total_records=0},setTotalPages(){this.total_pages=Math.ceil(this.total_records/this.page_size)},nexPageClicked(){return Gt(this,void 0,void 0,(function*(){try{this.calculateOffset(),yield this.getDataFromServer()}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}}))},calculateOffset(){this.offset=10*(this.current_page-1),logInfo(this.offset)},prepareColumns(){this.columns=[],this.columns.push({name:"success",label:this.$t("status"),field:"status",align:"left"}),this.columns.push({name:"created_on",label:this.$t("pages.import.attempted_on"),field:"created_on",align:"left"}),this.columns.push({name:"message",label:this.$t("pages.support.message"),field:"message",align:"left"})},cleanupOnhide(){this.resetPagination()}},setup(){return{loading:(0,V.KR)(!1),request_params:(0,V.KR)({}),current_page:(0,V.KR)(1),total_pages:(0,V.KR)(0),offset:(0,V.KR)(0),page_size:(0,V.KR)(8),total_records:(0,V.KR)(0),columns:(0,V.KR)([]),rows:(0,V.KR)([])}}});var Zt=o(42315),eo=o(44488),to=o(57722),oo=o(45262),so=o(54700);const lo=(0,x.A)(Ht,[["render",Bt]]),ao=lo;K()(Ht,"components",{QCard:qt.A,QToolbar:$t.A,QToolbarTitle:St.A,QBtn:xt.A,QCardSection:It.A,QTable:Zt.A,QTr:eo.A,QTh:to.A,QTd:oo.A,QIcon:Ot.A,QPagination:so.A,QInnerLoading:Qt.A}),K()(Ht,"directives",{ClosePopup:Kt.A});var io=o(22941),ro=o(51476);const no="sub_app",co={methods:{async getSubscriptionFromServer(){try{const e=await te.jD.getSubscription();if(!e||!e||!Array.isArray(e)||0==e.length)return;(0,ro._Y)(no,this.getDoc2AppSubscription(e))}catch(e){logInfo(e)}},getDoc2AppSubscription(e){let t=!1,o={};for(let s of e){const e=s.apps;for(let l of e)if("FELLOW_DOC2"===l.app_key){t=!0,o=s;break}if(!0===t)break}return o},getRemainingDays(){let e=-1,t=this.getSubscription();if(!t)return null;let o=this.getDateFromServerDate(t.end_date);const s=(new Date).setHours(0,0,0,0);return e=this.datediff(s,o),e},datediff(e,t){return Math.round((t-e)/864e5)},getDateFromServerDate(e){var t=e.split(" ");return new Date(t[0]).setHours(0,0,0,0)},async getsubscriptionRemainingDays(){let e=0;try{e=this.getRemainingDays(),null==e&&(await this.getSubscriptionFromServer(),e=this.getRemainingDays())}catch(t){logInfo(t)}return e},subscriptionAlertShowDays(){return 30},getSubscription(){let e=(0,ro.KW)(no);return e&&e.hasOwnProperty("start_date")&&e.hasOwnProperty("end_date")?e:null}}};var uo=o(41498),mo=o(45022),po=function(e,t,o,s){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,a){function i(e){try{n(s.next(e))}catch(t){a(t)}}function r(e){try{n(s["throw"](e))}catch(t){a(t)}}function n(e){e.done?o(e.value):l(e.value).then(i,r)}n((s=s.apply(e,t||[])).next())}))};const _o=(0,s.pM)({mixins:[q.A,R.A,co,ee.A],components:{EditCreate:Mt,ConnectionLogs:ao,ImportLogs:io.A},watch:{sub_org_list_loading(e,t){!1===e&&this.initView()}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";void 0!=e?(this.EMAIL_ENCRYPTION_KEY=e,this.initDragDropColumns("email_import_table","label",["action"]),document.addEventListener("email_import_table-column-drop",this.onDropColumns),document.addEventListener("email_import_updated",this.emailImportUpdated),this.handleSubOrgs()):this.showErrorToast("Missing an important value - unable to load email import")},unmounted:function(){document.removeEventListener("email_import_updated",this.emailImportUpdated),document.removeEventListener("email_import_table-column-drop",this.onDropColumns)},methods:{showMailConnectionLogs(e){this.connection_type="email_import",this.connection_id=e,this.show_connection_logs=!0},showMailImportLogs(e){this.show_import_logs=!1,this.connection_id=e,this.show_import_logs=!0},initView(){return po(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns(),yield this.getAppKey(),this.flattenSubOrgs(),this.getList()}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},handleSubOrgs(){this.subOrgList.length>1&&this.initView(),this.sub_org_list_loading&&(this.loading=!0)},getList(){return po(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns();const e=yield te.D.getList();if(0==e.data.length)return;this.prepareRows(e.data)}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},prepareRows(e){this.rows=[],Array.from(e).forEach((e=>{const t=e;this.addNewRow(t)}))},addNewRow(e){let t=Object.assign({},e);return this.rows.push(t),this.rows.length.toString()},createNewRecord(){this.selected_row={},this.show_edit_create=!0},emailImportUpdated(){this.show_edit_create=!1,this.getList()},editRow(e,t){this.selected_row=JSON.parse(JSON.stringify(t)),this.show_edit_create=!0},deleteClicked(e,t){return po(this,void 0,void 0,(function*(){try{this.loading=!0;const o=yield te.D.deleteRecord(t);!0===o.success&&this.rows.splice(e,1),this.showSuccessToast(this.$t("success"))}catch(o){const e=oe.t.getErrorMessage(o);this.showErrorToast(e),logError(o)}finally{this.loading=!1}}))},getAppKey(){return po(this,void 0,void 0,(function*(){try{this.loading=!0;const e={app_key:"FELLOW_DOC2"},t=yield te.jD.getAppSubscription(e);this.api_key=t[0].token}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},de_activateEmail(e){return po(this,void 0,void 0,(function*(){try{this.loading=!0;const t=e.id,o=e.is_active;yield te.D.DeActivateEmail(t,o);this.showSuccessToast(this.$t("success"))}catch(t){const e=oe.t.getErrorMessage(t);this.showErrorToast(e),logError(t)}finally{this.loading=!1}}))},checkLogin(e){return po(this,void 0,void 0,(function*(){try{this.loading=!0;const t=yield te.D.testEmailLogin(String(e.id));if(!t||t.hasOwnProperty("success")&&!1===t.success)throw t;this.showSuccessToast(this.$t("check_login_success"))}catch(t){const e=oe.t.getErrorMessage(t);this.showErrorToast(e),logError(t)}finally{this.loading=!1}}))},flattenSubOrgs(){this.subOrgList.forEach((e=>{this.sub_orgs_flattened[e.value]=e.label}))},prepareColumns(){this.columns=[],this.columns.push({name:"username",label:this.$t("username"),field:"username",align:"left"}),this.columns.push({name:"email",label:this.$t("email"),field:"email",align:"left"}),this.columns.push({name:"shared_email",label:this.$t("shared_email"),field:"shared_email",align:"left"}),this.columns.push({name:"protocol",label:this.$t("protocol"),field:"protocol",align:"left"}),this.columns.push({name:"encryption",label:this.$t("encryption"),field:"encryption",align:"left"}),this.columns.push({name:"sub_org_id",label:this.$t("sub_organizations"),field:"sub_org_id",align:"left"}),this.columns.push({name:"folder",label:this.$t("folder"),field:"folder",align:"left"}),this.columns.push({name:"action",label:this.$t("action"),field:"action",align:"right"});const e=mo.A.getItem("EMAIL_IMPORT_SETTING_COLUMNS");this.columns=e&&""!=e?JSON.parse(e):this.columns},onDropColumns(){mo.A.set("EMAIL_IMPORT_SETTING_COLUMNS",JSON.stringify(this.columns))},webSiteLink(){const e=(0,uo.TEc)("import_settings");e&&window.open(e)}},setup(){const e=(0,D.cY)(),{subOrgList:t,sub_org_list_loading:o}=(0,A.bP)(e);let s=(0,V.KR)({});const l=(0,V.KR)(null);return{sub_org_list_loading:o,subOrgList:t,myForm:l,import_email:s,errors:(0,V.KR)({}),show_connection_logs:(0,V.KR)(!1),show_import_logs:(0,V.KR)(!1),connection_type:(0,V.KR)(""),connection_id:(0,V.KR)({}),sub_orgs_flattened:(0,V.KR)({}),processing:(0,V.KR)(!1),ms_url:(0,V.KR)("https://microsoft.com/devicelogin"),ms_code:(0,V.KR)(""),ms_authenticate:(0,V.KR)(!1),ms_is_authenticated:(0,V.KR)(!1),ms_message:(0,V.KR)("Microsoft o365 is authenticated already."),loading:(0,V.KR)(!1),userDialog:(0,V.KR)(!1),columns:(0,V.KR)([]),rows:(0,V.KR)([]),show_edit_create:(0,V.KR)(!1),selected_row:(0,V.KR)({}),api_key:(0,V.KR)(""),EMAIL_ENCRYPTION_KEY:(0,V.KR)("")}},data(){return{}}});var ho=o(84436),go=o(53999),fo=o(90124),bo=o(25173),ko=o(10386),vo=o(82156);const yo=(0,x.A)(_o,[["render",Z]]),wo=yo;K()(_o,"components",{QTable:Zt.A,QTr:eo.A,QTh:to.A,QTd:oo.A,QBtn:xt.A,QMenu:ho.A,QList:go.A,QItem:fo.A,QItemSection:bo.A,QSeparator:ko.A,QTooltip:O.A,QInnerLoading:Qt.A,QDialog:vo.A});const Lo={class:"container"},Eo={class:"row mt-8 mb-25"},Fo={class:"row"},Co={key:0,class:"cursor-default"},Ao={key:1},Ro={class:"row float-right"},Vo={class:"text-red-14"},Do=(0,s.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function qo(e,t,o,a,i,r){const n=(0,s.g2)("f-btn"),d=(0,s.g2)("q-th"),c=(0,s.g2)("q-tr"),u=(0,s.g2)("q-item-section"),m=(0,s.g2)("q-item"),p=(0,s.g2)("q-separator"),_=(0,s.g2)("q-list"),h=(0,s.g2)("q-menu"),g=(0,s.g2)("q-btn"),f=(0,s.g2)("q-td"),b=(0,s.g2)("q-table"),k=(0,s.g2)("q-inner-loading"),v=(0,s.g2)("EditCreate"),y=(0,s.g2)("q-dialog"),w=(0,s.g2)("ConnectionLogs");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Lo,[(0,s.Lk)("div",Eo,[(0,s.bF)(n,{class:"q-ml-auto float-right",icon:"add",label:e.$t("new"),id:"create_new_ftp",onClick:e.createNewRecord},null,8,["label","onClick"])]),(0,s.Lk)("div",Fo,[(0,s.bF)(b,{style:{width:"100%",height:"100%"},class:"dashboard-table-style dashboard-table-height back-white",rows:e.rows,columns:e.columns,"row-key":"name",flat:"","no-data-label":e.$t("pages.messages.no_record_found"),"table-header-class":"table-header-text","rows-per-page-options":[0],id:"ftp_import_table"},{header:(0,s.k6)((t=>[(0,s.bF)(c,{props:t},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.cols,((o,a)=>((0,s.uX)(),(0,s.Wv)(d,{key:o.name,props:t,"data-index":a,draggable:e.canDragDropColumn(o),dropzone:e.canDragDropColumn(o),direction:"horizontal",onDragstart:t=>e.onDragStart(t,e.columns,a),onDrop:(0,U.D$)((t=>e.handleDrop(t,a)),["prevent"]),onDragover:(0,U.D$)((t=>e.onDragOver(t,a)),["prevent"]),onDragenter:(0,U.D$)(e.onDragEnter,["prevent"]),onDragleave:(0,U.D$)(e.onDragLeave,["prevent"]),style:(0,l.Tr)({cursor:e.getIsDragging?"pointer":"move"})},{default:(0,s.k6)((()=>["action"==o.name?((0,s.uX)(),(0,s.CE)("span",Co,(0,l.v_)(o.label),1)):((0,s.uX)(),(0,s.CE)("span",Ao,(0,l.v_)(o.label),1))])),_:2},1032,["props","data-index","draggable","dropzone","onDragstart","onDrop","onDragover","onDragenter","onDragleave","style"])))),128))])),_:2},1032,["props"])])),body:(0,s.k6)((o=>[(0,s.bF)(c,{props:o,id:o.key},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.cols,(a=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a.name},["action"===a.name?((0,s.uX)(),(0,s.Wv)(f,{key:0,style:{width:"236px"}},{default:(0,s.k6)((()=>[(0,s.Lk)("div",Ro,[(0,s.bF)(g,{flat:"",dense:"",round:"",onClick:t[0]||(t[0]=(0,U.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,s.k6)((()=>[(0,s.bF)(h,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,s.k6)((()=>[(0,s.bF)(_,{dense:"",style:{"min-width":"100px"}},{default:(0,s.k6)((()=>[(0,s.bF)(m,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(u,{onClick:t=>e.checkConnection(o.row.id)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("test_connection")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(m,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(u,{onClick:t=>e.showFtpConnectionLogs(o.row.id)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.import.connection_logs")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(p,{inset:""}),(0,s.bF)(m,{clickable:""},{default:(0,s.k6)((()=>[o.row.is_active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:0,onClick:t=>{o.row.is_active=!0,e.de_activate(o.row)}},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("activate")),1)])),_:2},1032,["onClick"])),o.row.is_active?((0,s.uX)(),(0,s.Wv)(u,{key:1,onClick:t=>{o.row.is_active=!1,e.de_activate(o.row)}},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("deactivate")),1)])),_:2},1032,["onClick"])):(0,s.Q3)("",!0)])),_:2},1024),(0,s.bF)(m,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(u,{onClick:t=>e.editRow(o.rowIndex,o.row)},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,s.bF)(p,{inset:""}),(0,s.bF)(m,{clickable:""},{default:(0,s.k6)((()=>[(0,s.bF)(u,{onClick:t=>e.deleteClicked(o.rowIndex,o.row.id)},{default:(0,s.k6)((()=>[(0,s.Lk)("span",Vo,(0,l.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):"sub_org_id"===a.name?((0,s.uX)(),(0,s.Wv)(f,{key:1,class:(0,l.C4)(o.row.is_active?"":"email-import-deactive-column")},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.sub_orgs_flattened[o.row[a.name]]),1)])),_:2},1032,["class"])):((0,s.uX)(),(0,s.Wv)(f,{key:2,class:(0,l.C4)(1==o.row.is_active?"":"email-import-deactive-column")},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)("null"===o.row[a.name]?"":o.row[a.name]),1)])),_:2},1032,["class"]))],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","columns","no-data-label"])])]),(0,s.bF)(k,{showing:e.loading,class:"z-index-1",style:{"z-index":"1000"}},{default:(0,s.k6)((()=>[Do])),_:1},8,["showing"]),(0,s.bF)(y,{modelValue:e.show_edit_create,"onUpdate:modelValue":t[1]||(t[1]=t=>e.show_edit_create=t),persistent:"",onKeydown:t[2]||(t[2]=(0,U.jR)((t=>e.show_edit_create=!1),["esc"]))},{default:(0,s.k6)((()=>[(0,s.bF)(v,{selected_model:e.selected_row,api_key:e.api_key},null,8,["selected_model","api_key"])])),_:1},8,["modelValue"]),(0,s.bF)(y,{modelValue:e.show_connection_logs,"onUpdate:modelValue":t[3]||(t[3]=t=>e.show_connection_logs=t)},{default:(0,s.k6)((()=>[(0,s.bF)(w,{connection_id:e.connection_id,connection_type:"ftp_import"},null,8,["connection_id"])])),_:1},8,["modelValue"])],64)}const $o={key:0,class:"text-weight-bold"},So={key:1,class:"text-weight-bold"},xo={class:"row q-mt-md"},Io={class:"col-2"},Oo={class:"col-7"},To={class:"col-3"},Qo={class:"row q-mt-md"},Ko={class:"col-2"},Wo={class:"col-7"},Mo=(0,s.Lk)("div",{class:"col-3"},null,-1),Uo={class:"row q-mt-md"},Xo=(0,s.Lk)("div",{class:"col-2"},null,-1),Po={class:"col-7"},No=(0,s.Lk)("div",{class:"col-3"},null,-1),Yo={class:"row q-mt-md"},zo=(0,s.Lk)("div",{class:"col-2"},null,-1),jo={class:"col-7"},Bo=(0,s.Lk)("div",{class:"col-3"},null,-1),Jo={class:"row q-mt-md"},Go=(0,s.Lk)("div",{class:"col-2"},null,-1),Ho={class:"col-7"},Zo=(0,s.Lk)("div",{class:"col-3"},null,-1),es={class:"row q-mt-md"},ts=(0,s.Lk)("div",{class:"col-2"},null,-1),os={class:"col-7"},ss=(0,s.Lk)("div",{class:"col-3"},null,-1),ls={class:"row q-mt-md"},as=(0,s.Lk)("div",{class:"col-2"},null,-1),is={class:"col-7"},rs=(0,s.Lk)("div",{class:"col-3"},null,-1),ns=(0,s.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function ds(e,t,o,a,i,r){const n=(0,s.g2)("q-toolbar-title"),d=(0,s.g2)("q-btn"),c=(0,s.g2)("q-toolbar"),u=(0,s.g2)("q-tooltip"),m=(0,s.g2)("q-icon"),p=(0,s.g2)("q-select"),_=(0,s.g2)("q-input"),h=(0,s.g2)("q-card-section"),g=(0,s.g2)("q-inner-loading"),f=(0,s.g2)("q-card"),b=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.Wv)(f,{style:{width:"1200px","max-width":"1200px",height:"600px"}},{default:(0,s.k6)((()=>[(0,s.Lk)("form",{onSubmit:t[10]||(t[10]=(0,U.D$)(((...t)=>e.submitFrom&&e.submitFrom(...t)),["prevent","stop"]))},[(0,s.bF)(c,{class:"text-white secondary-toolbar"},{default:(0,s.k6)((()=>[(0,s.bF)(n,null,{default:(0,s.k6)((()=>[e.row_id?((0,s.uX)(),(0,s.CE)("span",$o,(0,l.v_)(e.$t("pages.settings.master_data_lookup.edit_row")),1)):((0,s.uX)(),(0,s.CE)("span",So,(0,l.v_)(e.$t("pages.settings.master_data_lookup.create_row")),1))])),_:1}),(0,s.bo)((0,s.bF)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[b]])])),_:1}),(0,s.bF)(h,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",xo,[(0,s.Lk)("div",Io,[(0,s.bF)(p,{"data-cy":"ftp_type",modelValue:e.model["ftp_type"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.model["ftp_type"]=t),outlined:"",options:e.ftp_types,label:e.$t("type")},{append:(0,s.k6)((()=>[e.errors["ftp_type"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","options","label"])]),(0,s.Lk)("div",Oo,[(0,s.bF)(_,{"data-cy":"ftp_server",modelValue:e.model["server"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.model["server"]=t),label:e.$t("pages.import.server"),outlined:"",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["server"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),(0,s.Lk)("div",To,[(0,s.bF)(_,{modelValue:e.model["default_directory"],"onUpdate:modelValue":t[2]||(t[2]=t=>e.model["default_directory"]=t),label:e.$t("default_directory"),outlined:"","data-cy":"ftp_default_directory",class:"full q-ml-sm"},null,8,["modelValue","label"])])]),(0,s.Lk)("div",Qo,[(0,s.Lk)("div",Ko,[(0,s.bF)(_,{modelValue:e.model["port"],"onUpdate:modelValue":t[3]||(t[3]=t=>e.model["port"]=t),label:e.$t("pages.import.port"),outlined:"","data-cy":"ftp_port",class:(0,l.C4)("full")},{append:(0,s.k6)((()=>[e.errors["port"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),(0,s.Lk)("div",Wo,[(0,s.bF)(_,{modelValue:e.model["username"],"onUpdate:modelValue":t[4]||(t[4]=t=>e.model["username"]=t),class:(0,l.C4)(["full q-ml-sm","full q-ml-sm"]),label:e.$t("username"),outlined:"","data-cy":"ftp_username"},{append:(0,s.k6)((()=>[e.errors["username"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),Mo]),(0,s.Lk)("div",Uo,[Xo,(0,s.Lk)("div",Po,[(0,s.bF)(_,{modelValue:e.model["password"],"onUpdate:modelValue":t[5]||(t[5]=t=>e.model["password"]=t),type:"password",label:e.$t("pages.import.password"),outlined:"","data-cy":"ftp_password",class:(0,l.C4)("full q-ml-sm")},{append:(0,s.k6)((()=>[e.errors["password"]?((0,s.uX)(),(0,s.Wv)(m,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{class:"bg-red line-error-tooltip"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("pages.api_user_messages.FIELD_REQUIRED")),1)])),_:1})])),_:1})):(0,s.Q3)("",!0)])),_:1},8,["modelValue","label"])]),No]),(0,s.Lk)("div",Yo,[zo,(0,s.Lk)("div",jo,[(0,s.bF)(_,{modelValue:e.model["file_name_matching_patterns"],"onUpdate:modelValue":t[6]||(t[6]=t=>e.model["file_name_matching_patterns"]=t),label:e.$t("file_name_matching_patterns"),outlined:"","data-cy":"ftp_file_name_matching_patterns",class:"full q-ml-sm"},null,8,["modelValue","label"])]),Bo]),(0,s.Lk)("div",Jo,[Go,(0,s.Lk)("div",Ho,[(0,s.bF)(p,{"data-cy":"ftp_sub_org",class:"full q-ml-sm",outlined:"",clearable:"",modelValue:e.model["sub_org_id"],"onUpdate:modelValue":t[7]||(t[7]=t=>e.model["sub_org_id"]=t),"use-input":"",options:e.filterSubOrgsList,onFilter:e.filterSubOrgslistEvent,label:e.$t("sub_organizations"),loading:e.sub_org_list_loading,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","label","loading"])]),Zo]),(0,s.Lk)("div",es,[ts,(0,s.Lk)("div",os,[(0,s.bF)(_,{class:(0,l.C4)(["full q-ml-sm","bg-disable"]),"data-cy":"ftp_apiKey",outlined:"",modelValue:e.api_key_ref,"onUpdate:modelValue":t[8]||(t[8]=t=>e.api_key_ref=t),readonly:"",label:e.$t("pages.import.token")},null,8,["modelValue","label"])]),ss])])),_:1}),(0,s.bF)(h,{class:"p-t-0"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",ls,[as,(0,s.Lk)("div",is,[(0,s.bF)(d,{type:"submit",color:"primary",class:"q-ml-sm float-right",id:"ftp_btn_save",label:e.$t("save")},null,8,["label"]),e.row_id?((0,s.uX)(),(0,s.Wv)(d,{key:0,class:"q-ml-sm float-right",color:"primary",label:e.$t("test_connection"),id:"ftp_btn_test_connection",onClick:t[9]||(t[9]=t=>e.checkConnection())},{default:(0,s.k6)((()=>[e.row_id?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.$t("available_after_save")),1)])),_:1}))])),_:1},8,["label"])):(0,s.Q3)("",!0),(0,s.bo)((0,s.bF)(d,{id:"ftp_btn_cancel",class:"float-right highlighted-back",label:e.$t("cancel")},null,8,["label"]),[[b]])]),rs])])),_:1})],32),(0,s.bF)(g,{showing:e.loading,class:"z-index-1"},{default:(0,s.k6)((()=>[ns])),_:1},8,["showing"])])),_:1})}var cs=function(e,t,o,s){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,a){function i(e){try{n(s.next(e))}catch(t){a(t)}}function r(e){try{n(s["throw"](e))}catch(t){a(t)}}function n(e){e.done?o(e.value):l(e.value).then(i,r)}n((s=s.apply(e,t||[])).next())}))};const us=(0,s.pM)({el:"#app",mixins:[q.A,R.A],props:{selected_model:{},api_key:{type:String,default:""}},components:{},data(){return{}},setup(){const e=(0,D.cY)(),{ftp_types:t,subOrgList:o,sub_org_list_loading:s}=(0,A.bP)(e),l=(0,V.KR)(e.subOrgList);return{EMAIL_ENCRYPTION_KEY:(0,V.KR)(""),subOrgList:o,sub_org_list_loading:s,filterSubOrgsList:l,ftp_types:t,loading:(0,V.KR)(!1),model:(0,V.KR)({}),row_id:(0,V.KR)(""),errors:(0,V.KR)({}),api_key_ref:(0,V.KR)("")}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";if(void 0==e)throw"Missing EMAIL_ENCRYPTION_KEY env - unable to load";this.EMAIL_ENCRYPTION_KEY=e,this.initView()},methods:{initView(){this.api_key_ref=this.api_key,this.row_id=this.selected_model.hasOwnProperty("id")?this.selected_model.id:"",this.model=JSON.parse(JSON.stringify(this.selected_model));for(let[e,t]of Object.entries(this.model))t||(this.model[e]="");this.model["server"]=this.model["server_url"],this.row_id||this.resetForm()},resetForm(){this.model={username:"",password:"",server:"",port:"22",default_directory:"",file_name_matching_patterns:"",ftp_type:"SFTP",sub_org_id:""}},submitFrom(){return cs(this,void 0,void 0,(function*(){try{if(!this.validateForm())return;this.loading=!0;const e=yield te.D.ftpImportAddUpdate(this.prepareApiData());if(!e.success)throw e;e.data.hasOwnProperty("id")&&(this.row_id=e.data.id),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE")),yield this.checkConnection();const t=new CustomEvent("ftp_import_updated",{detail:{}});document.dispatchEvent(t)}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},validateForm(){let e=!0;this.resetErrors();const t=["default_directory","file_name_matching_patterns","sub_org_id"];for(const[o,s]of Object.entries(this.model))t.includes(o)||"is_active"===o||s&&0!=String(s).length||(e=!1,this.errors[o]=!0);return e},prepareApiData(){this.encryptPassword();return{password:this.model.password,username:this.model.username,server:this.model.server,port:this.model.port,ftp_type:this.model.ftp_type,file_name_matching_patterns:this.model.file_name_matching_patterns,api_key:this.api_key,sub_org_id:this.model.sub_org_id,id:this.row_id,default_directory:this.model.default_directory}},encryptPassword(){var e=Rt.fk.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),t=Rt.c5.encrypt(this.model.password,e,{mode:Rt.Mq.ECB,padding:Rt.eV.PKCS7});return t},decryptPassword(e){var t=Rt.fk.Utf8.parse(this.EMAIL_ENCRYPTION_KEY),o=Rt.c5.decrypt(e,t,{mode:Rt.Mq.ECB});return o},updateFTPImportEvent(){const e=new CustomEvent("email_import_updated",{});document.dispatchEvent(e)},checkConnection(){return cs(this,void 0,void 0,(function*(){try{if(!this.row_id)return;this.loading=!0;const e=yield te.D.ftpConnectionTest(this.row_id);if(!e||e.hasOwnProperty("success")&&!1===e.success)throw e;this.showSuccessToast(this.$t("test_connection_success"))}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},resetErrors(){for(const[e,t]of Object.entries(this.model))this.errors[e]=!1},filterSubOrgslistEvent(e,t,o){t(e?()=>{const t=e.toLowerCase();this.filterSubOrgsList=this.subOrgList.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}:()=>{this.filterSubOrgsList=this.subOrgList})}}}),ms=(0,x.A)(us,[["render",ds]]),ps=ms;K()(us,"components",{QCard:qt.A,QToolbar:$t.A,QToolbarTitle:St.A,QBtn:xt.A,QCardSection:It.A,QSelect:T.A,QIcon:Ot.A,QTooltip:O.A,QInput:I.A,QInnerLoading:Qt.A}),K()(us,"directives",{ClosePopup:Kt.A});var _s=function(e,t,o,s){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,a){function i(e){try{n(s.next(e))}catch(t){a(t)}}function r(e){try{n(s["throw"](e))}catch(t){a(t)}}function n(e){e.done?o(e.value):l(e.value).then(i,r)}n((s=s.apply(e,t||[])).next())}))};const hs=(0,s.pM)({mixins:[q.A,R.A,co,ee.A],components:{EditCreate:ps,ConnectionLogs:ao},watch:{sub_org_list_loading(e,t){!1===e&&this.initView()}},mounted:function(){const e="thi5i5@very5ecurehardc0d3denCrIp";void 0!=e?(this.initDragDropColumns("ftp_import_table","label",["action"]),document.addEventListener("ftp_import_table-column-drop",this.onDropColumns),document.addEventListener("ftp_import_updated",this.emailImportUpdated),this.handleSubOrgs()):this.showErrorToast("Missing an important value - unable to load email import")},unmounted:function(){document.removeEventListener("ftp_import_updated",this.emailImportUpdated),document.removeEventListener("ftp_import_table-column-drop",this.onDropColumns)},methods:{showFtpConnectionLogs(e){this.connection_id=e,this.show_connection_logs=!0},initView(){return _s(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns(),yield this.getAppKey(),this.flattenSubOrgs(),this.getList()}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},handleSubOrgs(){this.subOrgList.length>1&&this.initView(),this.sub_org_list_loading&&(this.loading=!0)},getList(){return _s(this,void 0,void 0,(function*(){try{this.loading=!0,this.prepareColumns();const e=yield te.D.getFTPImport_List();if(0==e.data.length)return;this.prepareRows(e.data)}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},prepareRows(e){this.rows=[],Array.from(e).forEach((e=>{const t=e;this.addNewRow(t)}))},addNewRow(e){let t=Object.assign({},e);return this.rows.push(t),this.rows.length.toString()},createNewRecord(){this.selected_row={},this.show_edit_create=!0},emailImportUpdated(){this.show_edit_create=!1,this.getList()},editRow(e,t){this.selected_row=JSON.parse(JSON.stringify(t)),this.show_edit_create=!0},deleteClicked(e,t){return _s(this,void 0,void 0,(function*(){try{this.loading=!0;const o=yield te.D.ftpImportDelete(t);!0===o.success&&this.rows.splice(e,1),this.showSuccessToast(this.$t("success"))}catch(o){const e=oe.t.getErrorMessage(o);this.showErrorToast(e),logError(o)}finally{this.loading=!1}}))},checkConnection(e){return _s(this,void 0,void 0,(function*(){try{this.loading=!0;const t=yield te.D.ftpConnectionTest(e);if(!t||t.hasOwnProperty("success")&&!1===t.success)throw t;this.showSuccessToast(this.$t("test_connection_success"))}catch(t){const e=oe.t.getErrorMessage(t);this.showErrorToast(e),logError(t)}finally{this.loading=!1}}))},getAppKey(){return _s(this,void 0,void 0,(function*(){try{this.loading=!0;const e={app_key:"FELLOW_DOC2"},t=yield te.jD.getAppSubscription(e);this.api_key=t[0].token}catch(e){const t=oe.t.getErrorMessage(e);this.showErrorToast(t),logError(e)}finally{this.loading=!1}}))},de_activate(e){return _s(this,void 0,void 0,(function*(){try{this.loading=!0;const t=e.id,o=e.is_active;yield te.D.setFTPImportActiveDeactive(t,o);this.showSuccessToast(this.$t("success"))}catch(t){const e=oe.t.getErrorMessage(t);this.showErrorToast(e),logError(t)}finally{this.loading=!1}}))},flattenSubOrgs(){this.subOrgList.forEach((e=>{this.sub_orgs_flattened[e.value]=e.label}))},prepareColumns(){this.columns=[],this.columns.push({name:"ftp_type",label:this.$t("type"),field:"ftp_type",align:"left"}),this.columns.push({name:"server_url",label:this.$t("server_url"),field:"server_url",align:"left"}),this.columns.push({name:"username",label:this.$t("username"),field:"username",align:"left"}),this.columns.push({name:"port",label:this.$t("port"),field:"port",align:"left"}),this.columns.push({name:"sub_org_id",label:this.$t("sub_organizations"),field:"sub_org_id",align:"left"}),this.columns.push({name:"default_directory",label:this.$t("default_directory"),field:"default_directory",align:"left"}),this.columns.push({name:"action",label:this.$t("action"),field:"action",align:"right"});const e=mo.A.getItem("FTP_IMPORT_SETTING_COLUMNS");this.columns=e&&""!=e?JSON.parse(e):this.columns},onDropColumns(){mo.A.set("FTP_IMPORT_SETTING_COLUMNS",JSON.stringify(this.columns))}},setup(){const e=(0,D.cY)(),{subOrgList:t,sub_org_list_loading:o}=(0,A.bP)(e);let s=(0,V.KR)({});const l=(0,V.KR)(null);return{sub_org_list_loading:o,subOrgList:t,myForm:l,import_email:s,show_connection_logs:(0,V.KR)(!1),connection_id:(0,V.KR)(""),errors:(0,V.KR)({}),sub_orgs_flattened:(0,V.KR)({}),processing:(0,V.KR)(!1),ms_url:(0,V.KR)("https://microsoft.com/devicelogin"),ms_code:(0,V.KR)(""),ms_authenticate:(0,V.KR)(!1),ms_is_authenticated:(0,V.KR)(!1),ms_message:(0,V.KR)("Microsoft o365 is authenticated already."),loading:(0,V.KR)(!1),userDialog:(0,V.KR)(!1),columns:(0,V.KR)([]),rows:(0,V.KR)([]),show_edit_create:(0,V.KR)(!1),selected_row:(0,V.KR)({}),api_key:(0,V.KR)("")}},data(){return{}}}),gs=(0,x.A)(hs,[["render",qo]]),fs=gs;K()(hs,"components",{QTable:Zt.A,QTr:eo.A,QTh:to.A,QTd:oo.A,QBtn:xt.A,QMenu:ho.A,QList:go.A,QItem:fo.A,QItemSection:bo.A,QSeparator:ko.A,QTooltip:O.A,QInnerLoading:Qt.A,QDialog:vo.A});const bs=(0,s.pM)({el:"#app",components:{SubHeader:u.A,BackToSettings:m.A,PageRestriction:M,EmailImportList:wo,FtpImportList:fs},mounted:function(){this.getSubOrgsList()},setup(){const e=(0,D.cY)(),{getSubOrgsList:t}=e;return{getSubOrgsList:t}}});var ks=o(88841),vs=o(93676);const ys=(0,x.A)(bs,[["render",c]]),ws=ys;K()(bs,"components",{QList:go.A,QExpansionItem:ks.A,QSeparator:ko.A,QIcon:Ot.A,QSpace:vs.A,QCard:qt.A,QCardSection:It.A})}}]);