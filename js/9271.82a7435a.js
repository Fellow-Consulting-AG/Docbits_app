"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[9271],{79271:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Je});var r=s(61758),o=s(58790),i=s(29104);const n=e=>((0,r.Qi)("data-v-43998f97"),e=e(),(0,r.jt)(),e),a={class:"container"},l={class:"full-width"},d={style:{"text-transform":"capitalize"}},u={style:{"text-transform":"capitalize"}},c={class:"text-red-14"},_={class:"q-ml-sm"},g={class:"text-weight-bold text-white"},m={class:"table-container col-sm-12 col-md-12 col-lg-12 min-height-300"},h=n((()=>(0,r.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1)));function p(e,t,s,n,p,b){const f=(0,r.g2)("SubHeader"),w=(0,r.g2)("BackToSettings"),v=(0,r.g2)("f-btn"),y=(0,r.g2)("AllSubOrgSetting"),k=(0,r.g2)("GenericColumnOrderBy"),F=(0,r.g2)("q-th"),A=(0,r.g2)("q-td"),S=(0,r.g2)("q-item-section"),C=(0,r.g2)("q-item"),L=(0,r.g2)("q-separator"),E=(0,r.g2)("q-list"),O=(0,r.g2)("q-menu"),q=(0,r.g2)("q-btn"),U=(0,r.g2)("q-table"),R=(0,r.g2)("q-avatar"),Q=(0,r.g2)("q-card-section"),T=(0,r.g2)("q-card-actions"),x=(0,r.g2)("q-card"),$=(0,r.g2)("q-dialog"),K=(0,r.g2)("Create"),V=(0,r.g2)("q-toolbar-title"),N=(0,r.g2)("q-toolbar"),B=(0,r.g2)("UsersList"),z=(0,r.g2)("q-inner-loading"),I=(0,r.gN)("close-popup");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(f,{name:"sub_organizations",onSearch:!1,label:e.$t("sub_organizations"),display_help_link:!0},null,8,["label"]),(0,r.bF)(w),(0,r.Lk)("div",a,[(0,r.bF)(v,{class:"float-right",icon:"add",label:e.$t("new"),onClick:t[0]||(t[0]=t=>e.display_create_dialog=!0)},null,8,["label"]),(0,r.bF)(y),(0,r.Lk)("div",l,[(0,r.bF)(U,{class:"dashboard-table-style scroll-height-100vh-110px back-white",rows:e.rows,"no-data-label":e.$t("pages.messages.no_record_found"),columns:e.columns,"row-key":"name",flat:"","table-header-class":"table-header-text","rows-per-page-options":[0]},{"header-cell":(0,r.k6)((t=>[(0,r.bF)(F,{props:t},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(t.col.label)+" ",1),"action"!=t.col.name?((0,r.uX)(),(0,r.Wv)(k,{key:0,prefKey:e.sub_org_sort_order,column_name:t.col.name,sort_by:e.sortField,sort_order:e.sortOrder,onSortData:e.sortData},null,8,["prefKey","column_name","sort_by","sort_order","onSortData"])):(0,r.Q3)("",!0)])),_:2},1032,["props"])])),"body-cell-name":(0,r.k6)((e=>[(0,r.bF)(A,{props:e},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(e.row.name),1)])),_:2},1032,["props"])])),"body-cell-action":(0,r.k6)((s=>[(0,r.bF)(A,{props:s},{default:(0,r.k6)((()=>[(0,r.bF)(q,{flat:"",dense:"",round:"",onClick:t[1]||(t[1]=(0,i.D$)((()=>{}),["stop","prevent"])),icon:"more_horiz"},{default:(0,r.k6)((()=>[(0,r.bF)(O,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:(0,r.k6)((()=>[(0,r.bF)(E,{dense:"",style:{"min-width":"130px"}},{default:(0,r.k6)((()=>[(0,r.bF)(C,{clickable:""},{default:(0,r.k6)((()=>[(0,r.bF)(S,{onClick:t=>e.manageUsers(s.row)},{default:(0,r.k6)((()=>[(0,r.Lk)("span",d,(0,o.v_)(e.$t("pages.settings.manage_users")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,r.bF)(C,{clickable:""},{default:(0,r.k6)((()=>[(0,r.bF)(S,{onClick:t=>e.openForm(s.row)},{default:(0,r.k6)((()=>[(0,r.Lk)("span",u,(0,o.v_)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,r.bF)(L,{inset:""}),(0,r.bF)(C,{clickable:""},{default:(0,r.k6)((()=>[(0,r.bF)(S,{onClick:t=>{e.delete_id=s.row.id,e.delete_confirm=!0}},{default:(0,r.k6)((()=>[(0,r.Lk)("span",c,(0,o.v_)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,r.k6)((()=>[])),_:1},8,["rows","no-data-label","columns"])])]),(0,r.bF)($,{modelValue:e.delete_confirm,"onUpdate:modelValue":t[3]||(t[3]=t=>e.delete_confirm=t),persistent:""},{default:(0,r.k6)((()=>[(0,r.bF)(x,null,{default:(0,r.k6)((()=>[(0,r.bF)(Q,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:(0,r.k6)((()=>[(0,r.bF)(R,{icon:"warning",color:"primary"})])),_:1}),(0,r.bF)(Q,{class:"row items-center"},{default:(0,r.k6)((()=>[(0,r.Lk)("span",_,(0,o.v_)(e.$t("pages.messages.msg_delete")),1)])),_:1}),(0,r.bF)(T,{align:"right"},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.bF)(v,{appearance:"cancel",label:e.$t("pages.user.cancel")},null,8,["label"]),[[I]]),(0,r.bo)((0,r.bF)(v,{appearance:"negative",label:e.$t("pages.user.done"),onClick:t[2]||(t[2]=t=>e.deleteRow())},null,8,["label"]),[[I]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,r.bF)($,{modelValue:e.display_create_dialog,"onUpdate:modelValue":t[4]||(t[4]=t=>e.display_create_dialog=t),persistent:"",onKeydown:t[5]||(t[5]=(0,i.jR)((t=>e.display_create_dialog=!1),["esc"]))},{default:(0,r.k6)((()=>[(0,r.bF)(K)])),_:1},8,["modelValue"]),(0,r.bF)($,{modelValue:e.display_users_dialog,"onUpdate:modelValue":t[6]||(t[6]=t=>e.display_users_dialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[7]||(t[7]=(0,i.jR)((t=>e.display_users_dialog=!1),["esc"]))},{default:(0,r.k6)((()=>[(0,r.bF)(x,{style:{width:"700px","max-width":"1060px",height:"600px"}},{default:(0,r.k6)((()=>[(0,r.bF)(N,{class:"secondary-toolbar"},{default:(0,r.k6)((()=>[(0,r.bF)(V,null,{default:(0,r.k6)((()=>[(0,r.Lk)("span",g,(0,o.v_)(e.selectedName)+" "+(0,o.v_)(e.$t("users")),1)])),_:1}),(0,r.bo)((0,r.bF)(v,{icon:"close"},null,512),[[I]])])),_:1}),(0,r.bF)(Q,{class:"row items-center q-pb-none"}),(0,r.bF)(Q,null,{default:(0,r.k6)((()=>[(0,r.Lk)("div",m,[(0,r.bF)(B,{sub_org_id:e.selectedId},null,8,["sub_org_id"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,r.bF)($,{modelValue:e.sub_organiztion_form,"onUpdate:modelValue":t[8]||(t[8]=t=>e.sub_organiztion_form=t),persistent:"",onKeydown:t[9]||(t[9]=(0,i.jR)((t=>e.sub_organiztion_form=!1),["esc"]))},{default:(0,r.k6)((()=>[(0,r.bF)(K,{is_edit:!0,name:e.sub_org_edit_name,id:e.sub_org_edit_id,description:e.sub_org_edit_desc},null,8,["name","id","description"])])),_:1},8,["modelValue"]),(0,r.bF)(z,{showing:e.processing},{default:(0,r.k6)((()=>[h])),_:1},8,["showing"])],64)}const b={class:"text-weight-bold"},f={class:"text-weight-bold"},w={style:{"margin-bottom":"20px"},class:"row full-width mb-10 mt-8"},v={class:"full-width"},y={class:"row full-width mb-10 mt-8",style:{"margin-bottom":"20px"}},k={class:"full-width"},F=(0,r.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function A(e,t,s,n,a,l){const d=(0,r.g2)("q-toolbar-title"),u=(0,r.g2)("f-btn"),c=(0,r.g2)("q-toolbar"),_=(0,r.g2)("q-tooltip"),g=(0,r.g2)("q-icon"),m=(0,r.g2)("q-input"),h=(0,r.g2)("q-card-section"),p=(0,r.g2)("q-card-actions"),A=(0,r.g2)("q-inner-loading"),S=(0,r.g2)("q-card"),C=(0,r.gN)("close-popup");return(0,r.uX)(),(0,r.Wv)(S,{style:{width:"600px"}},{default:(0,r.k6)((()=>[(0,r.Lk)("form",{onSubmit:t[2]||(t[2]=(0,i.D$)(((...t)=>e.submitNewColumFrom&&e.submitNewColumFrom(...t)),["prevent","stop"]))},[(0,r.bF)(c,{class:"text-white secondary-toolbar"},{default:(0,r.k6)((()=>[e.is_edit?((0,r.uX)(),(0,r.Wv)(d,{key:0},{default:(0,r.k6)((()=>[(0,r.Lk)("span",b,(0,o.v_)(e.$t("pages.user.edit_sub_organization")),1)])),_:1})):((0,r.uX)(),(0,r.Wv)(d,{key:1},{default:(0,r.k6)((()=>[(0,r.Lk)("span",f,(0,o.v_)(e.$t("create_sub_org")),1)])),_:1})),(0,r.bo)((0,r.bF)(u,{icon:"close"},null,512),[[C]])])),_:1}),(0,r.bF)(h,{class:"q-pt-none"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",w,[(0,r.Lk)("div",v,[(0,r.bF)(m,{outlined:"",tabindex:"0",class:(0,o.C4)("full-width "+(!e.new_model["validate"]||e.new_model["required_error"]?"column-error-border":"")),modelValue:e.new_model["name"],"onUpdate:modelValue":t[0]||(t[0]=t=>e.new_model["name"]=t),label:e.$t("field_name"),hint:e.message},{append:(0,r.k6)((()=>[!e.new_model["validate"]||e.new_model["required_error"]?((0,r.uX)(),(0,r.Wv)(g,{key:0,flat:"",dense:"",name:"error",size:"24px",color:"red"},{default:(0,r.k6)((()=>[(0,r.bF)(_,{class:"bg-red line-error-tooltip"},{default:(0,r.k6)((()=>[e.new_model["validate"]?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,o.v_)(e.message),1)],64)),e.new_model["required_error"]?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)((0,o.v_)(e.$t("field_required")),1)],64)):(0,r.Q3)("",!0)])),_:1})])),_:1})):(0,r.Q3)("",!0)])),_:1},8,["class","modelValue","label","hint"])])]),(0,r.Lk)("div",y,[(0,r.Lk)("div",k,[(0,r.bF)(m,{modelValue:e.new_model["description"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.new_model["description"]=t),outlined:"",type:"textarea",autogrow:"",label:e.$t("description")},null,8,["modelValue","label"])])])])),_:1}),(0,r.bF)(p,{align:"right"},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.bF)(u,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[C]]),(0,r.bF)(u,{type:"submit",class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})],32),(0,r.bF)(A,{showing:e.loading},{default:(0,r.k6)((()=>[F])),_:1},8,["showing"])])),_:1})}var S=s(38734),C=s(24622),L=s(68450),E=s(11470),O=function(e,t,s,r){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?s(e.value):o(e.value).then(n,a)}l((r=r.apply(e,t||[])).next())}))};const q=(0,r.pM)({el:"#app",mixins:[C.A],props:{is_edit:{type:Boolean,default:!1},name:{type:String||null,default:null},description:{type:String||null,default:null},id:{type:String||null,default:null}},components:{},data(){return{message:this.$t("only_characters")}},setup(){let e={};return{new_model:(0,S.KR)(e),loading:(0,S.KR)(!1)}},watch:{},mounted(){this.setNewModel(),this.is_edit?(this.new_model["name"]=this.name,this.new_model["description"]=this.description):(this.new_model["name"]="",this.new_model["description"]="")},methods:{setNewModel(){this.new_model["name"]="",this.new_model["description"]="",this.new_model["validate"]=!0,this.new_model["required_error"]=!1},submitNewColumFrom(){return O(this,void 0,void 0,(function*(){try{if(!this.validateRow(this.new_model))return;this.loading=!0,this.is_edit?yield this.onSubmitEdition():yield this.saveNewRow()}catch(e){return null!=e&&"object"==typeof e&&e.hasOwnProperty("message")?void this.showErrorToast(e.message):(this.showErrorToast(this.$t("pages.messages.error_internal_occur")),void logError(e))}finally{this.loading=!1}}))},onSubmitEdition(){return O(this,void 0,void 0,(function*(){const e={name:this.new_model["name"],description:this.new_model["description"]};yield E.BS.update(this.id,e),this.setNewModel();const t=new CustomEvent("row_editted",{});document.dispatchEvent(t),this.showSuccessToast(this.$t("pages.messages.SUB_ORGANIZATION_UPDATED"))}))},saveNewRow(){return O(this,void 0,void 0,(function*(){const e={name:this.new_model["name"],description:this.new_model["description"]},t=yield E.BS.create(e);if(!t.id)throw new Error("Failed to create new record");this.setNewModel();const s=new CustomEvent("row_added",{detail:t});document.dispatchEvent(s),this.showSuccessToast("Record Created successfully")}))},validateRow(e){let t=!0;return e["name"]&&0!=e["name"].length?(0,L.Ss)(e["name"])?t:(e.validate=!1,!1):(e.required_error=!0,!1)}}});var U=s(12807),R=s(23316),Q=s(36914),T=s(39150),x=s(44189),$=s(67837),K=s(50492),V=s(97410),N=s(62669),B=s(39035),z=s(88672),I=s(98582),M=s.n(I);const P=(0,U.A)(q,[["render",A]]),D=P;M()(q,"components",{QCard:R.A,QToolbar:Q.A,QToolbarTitle:T.A,QCardSection:x.A,QInput:$.A,QIcon:K.A,QTooltip:V.A,QCardActions:N.A,QInnerLoading:B.A}),M()(q,"directives",{ClosePopup:z.A});var j=s(1659);const X=(0,r.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function W(e,t,s,n,a,l){const d=(0,r.g2)("q-icon"),u=(0,r.g2)("q-input"),c=(0,r.g2)("q-space"),_=(0,r.g2)("f-btn"),g=(0,r.g2)("q-td"),m=(0,r.g2)("q-tr"),h=(0,r.g2)("q-table"),p=(0,r.g2)("AddUser"),b=(0,r.g2)("q-dialog"),f=(0,r.g2)("q-inner-loading");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(h,{class:"sticky-header-table",rows:e.rows,"no-data-label":e.$t("pages.messages.no_record_found"),columns:e.columns,"rows-per-page-options":[0],"row-key":"id",filter:e.filter,loading:e.loading,"table-header-class":"table-header-text"},{top:(0,r.k6)((()=>[(0,r.bF)(u,{outlined:"",debounce:"300",color:"primary",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t),autofocus:"",dense:""},{append:(0,r.k6)((()=>[(0,r.bF)(d,{name:"search"})])),_:1},8,["modelValue"]),(0,r.bF)(c),(0,r.bF)(_,{label:e.$t("pages.user.add_user"),onClick:t[1]||(t[1]=t=>e.openUserDlg())},null,8,["label"])])),body:(0,r.k6)((t=>[(0,r.bF)(m,{props:t,id:t.key},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.cols,(s=>((0,r.uX)(),(0,r.CE)(r.FK,{key:s.name},["action"===s.name?((0,r.uX)(),(0,r.Wv)(g,{key:0,style:{width:"30%"}},{default:(0,r.k6)((()=>[(0,r.bF)(_,{class:"float-right",onClick:s=>e.removeUser(t.row.id),icon:"img:images/trash-bin-default.svg",appearance:"flat"},null,8,["onClick"])])),_:2},1024)):(0,r.Q3)("",!0),"user_name"===s.name?((0,r.uX)(),(0,r.Wv)(g,{key:1,style:{width:"70%"}},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(t.row.user_name),1)])),_:2},1024)):(0,r.Q3)("",!0)],64)))),128))])),_:2},1032,["props","id"])])),_:1},8,["rows","no-data-label","columns","filter","loading"]),(0,r.bF)(b,{modelValue:e.add_users_dialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.add_users_dialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",onKeydown:t[3]||(t[3]=(0,i.jR)((t=>e.add_users_dialog=!1),["esc"]))},{default:(0,r.k6)((()=>[(0,r.bF)(p,{sub_org_id:e.sub_org_id,sub_org_users:e.sub_org_users},null,8,["sub_org_id","sub_org_users"])])),_:1},8,["modelValue"]),(0,r.bF)(f,{showing:e.processing||e.user_list_loading},{default:(0,r.k6)((()=>[X])),_:1},8,["showing"])],64)}var G=s(89156),J=s(83319),H=s(18505);const Y={class:"text-weight-bold"},Z={class:"table-container col-sm-12 col-md-12 col-lg-12"},ee={class:"table-container col-sm-12 col-md-12 col-lg-12"};function te(e,t,s,i,n,a){const l=(0,r.g2)("q-toolbar-title"),d=(0,r.g2)("q-btn"),u=(0,r.g2)("q-toolbar"),c=(0,r.g2)("q-card-section"),_=(0,r.g2)("q-item-section"),g=(0,r.g2)("q-item"),m=(0,r.g2)("q-select"),h=(0,r.g2)("q-checkbox"),p=(0,r.g2)("f-btn"),b=(0,r.g2)("q-card-actions"),f=(0,r.g2)("q-card"),w=(0,r.gN)("close-popup");return(0,r.uX)(),(0,r.Wv)(f,{style:{width:"700px","max-width":"1060px"}},{default:(0,r.k6)((()=>[(0,r.bF)(u,{class:"text-white secondary-toolbar"},{default:(0,r.k6)((()=>[(0,r.bF)(l,null,{default:(0,r.k6)((()=>[(0,r.Lk)("span",Y,(0,o.v_)(e.$t("pages.user.add_user")),1)])),_:1}),(0,r.bo)((0,r.bF)(d,{flat:"",round:"",dense:"",icon:"close"},null,512),[[w]])])),_:1}),(0,r.bF)(c,{class:"row items-center q-pb-none"}),(0,r.bF)(c,null,{default:(0,r.k6)((()=>[(0,r.Lk)("div",Z,[(0,r.bF)(m,{outlined:"",autofocus:"",loading:e.user_list_loading,modelValue:e.selected_user_id,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selected_user_id=t),options:e.filterUsersList,"use-input":"","emit-value":"","map-options":"",onFilter:e.filterUserbykeyword,label:e.$t("select_user")},{"no-option":(0,r.k6)((()=>[(0,r.bF)(g,null,{default:(0,r.k6)((()=>[(0,r.bF)(_,{class:"text-grey"},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:1},8,["loading","modelValue","options","onFilter","label"])])])),_:1}),(0,r.bF)(c,null,{default:(0,r.k6)((()=>[(0,r.Lk)("div",ee,[(0,r.bF)(h,{label:e.$t("remove_from_other_sub_orgs"),modelValue:e.remove_from_others,"onUpdate:modelValue":t[1]||(t[1]=t=>e.remove_from_others=t),size:"50px",color:"grey-6"},null,8,["label","modelValue"])])])),_:1}),(0,r.bF)(b,{align:"right"},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.bF)(p,{appearance:"cancel",label:e.$t("cancel")},null,8,["label"]),[[w]]),(0,r.bF)(p,{onClick:t[2]||(t[2]=t=>e.addUserToSubOrg()),class:"q-mr-sm",label:e.$t("save")},null,8,["label"])])),_:1})])),_:1})}var se=function(e,t,s,r){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?s(e.value):o(e.value).then(n,a)}l((r=r.apply(e,t||[])).next())}))};const re=(0,r.pM)({el:"#app",mixins:[C.A,H.A],props:{sub_org_id:{type:String,default:""},sub_org_users:{type:Array,default:[]}},components:{},data(){return{}},mounted(){this.filterUsersList=this.all_users.filter((e=>!this.sub_org_users.find((t=>t.id===e.value))))},setup(){const e=(0,J.cY)(),{user_list_loading:t,usersList:s}=(0,j.bP)(e),r=(0,S.KR)(e.usersList),o=(0,S.KR)(e.usersList);return{all_users:r,filterUsersList:o,usersList:s,remove_from_others:(0,S.KR)(!1),selected_user_id:(0,S.KR)(""),user_list_loading:t}},methods:{addUserToSubOrg(){return se(this,void 0,void 0,(function*(){if(this.selected_user_id){this.showLoading();try{const e={sub_org_id:this.sub_org_id,user_id:String(this.selected_user_id),remove_from_others:String(this.remove_from_others)},t=yield E.BS.addUserToSubOrg(e);if(!1===t.success)return void this.showErrorToast(t.message);this.dispatchEvents(),this.showSuccessToast("Record Created successfully"),this.selected_user_id=""}catch(e){if(e.message)return void this.showErrorToast(e.message);this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.hideLoading()}}else this.showErrorToast(this.$t("select_user"))}))},dispatchEvents(){const e=new CustomEvent("user_added",{detail:this.selected_user_id});document.dispatchEvent(e);const t=new CustomEvent("update_current_user_orgs",{detail:this.selected_user_id});document.dispatchEvent(t)},filterUserbykeyword(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.filterUsersList=this.all_users.filter((e=>e.label.toLowerCase().indexOf(t)>-1))}:()=>{this.filterUsersList=this.all_users})}}});var oe=s(56384),ie=s(94940),ne=s(90124),ae=s(25173),le=s(80460);const de=(0,U.A)(re,[["render",te]]),ue=de;M()(re,"components",{QCard:R.A,QToolbar:Q.A,QToolbarTitle:T.A,QBtn:oe.A,QCardSection:x.A,QSelect:ie.A,QItem:ne.A,QItemSection:ae.A,QCheckbox:le.A,QCardActions:N.A}),M()(re,"directives",{ClosePopup:z.A});var ce=function(e,t,s,r){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?s(e.value):o(e.value).then(n,a)}l((r=r.apply(e,t||[])).next())}))};const _e=(0,r.pM)({mixins:[H.A,C.A,G.A],components:{AddUser:ue},props:{sub_org_id:{type:String,default:""}},data(){return{}},mounted:function(){this.init(),document.addEventListener("user_added",this.userAdded)},methods:{init(){return ce(this,void 0,void 0,(function*(){try{this.processing=!0,yield this.prepareTableData(),yield this.prepareUsersDropdown()}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},userAdded(e){e&&e.detail&&(this.add_users_dialog=!1,this.addNewUserToListView(e.detail))},addNewUserToListView(e){const t=JSON.parse(JSON.stringify(this.usersMap.get(e)));t["user_name"]=t.first_name+" "+t.last_name,this.rows.push(t)},prepareTableData(){return ce(this,void 0,void 0,(function*(){yield this.getGroupUsers(),this.prepareTableColumns(),this.prepareTableRows()}))},getGroupUsers(){return ce(this,void 0,void 0,(function*(){let e=null;this.processing=!0;try{if(e=yield E.BS.getSubOrgUsers(this.sub_org_id),!e)throw e;this.sub_org_users=e}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},prepareTableColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"user_name",label:this.$t("name"),field:"user_name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareTableRows(){this.rows=[];for(let e of this.sub_org_users)e["user_name"]=e.first_name+" "+e.last_name;this.rows=this.sub_org_users},removeUser(e){return ce(this,void 0,void 0,(function*(){this.processing=!0;try{yield E.BS.deleteUserFromSubOrg(this.sub_org_id,String(e));this.removeUserFromListView(e);const t=new CustomEvent("sub_org_user_removed",{detail:{user_id:e,sub_org_id:this.sub_org_id}});document.dispatchEvent(t),this.showSuccessToast(this.$t("user_removed_from_group"))}catch(t){this.showErrorToast(this.$t("pages.messages.error_internal_occur"))}finally{this.processing=!1}}))},removeUserFromListView(e){const t=this.rows.findIndex((t=>t.id===e));-1!==t&&this.rows.splice(t,1)},openUserDlg(){this.add_users_dialog=!0}},setup(){const e=(0,S.KR)("");let t=[];const s=(0,S.KR)(t),r=(0,J.cY)(),{usersMap:o,user_list_loading:i}=(0,j.bP)(r),{prepareUsersDropdown:n}=r;return{user_list_loading:i,prepareUsersDropdown:n,filter:e,columns:s,usersMap:o,rows:(0,S.KR)(t),loading:(0,S.KR)(!1),sub_org_users:(0,S.KR)([]),add_users_dialog:(0,S.KR)(!1),processing:(0,S.KR)(!1)}}});var ge=s(42315),me=s(93676),he=s(44488),pe=s(45262),be=s(82156);const fe=(0,U.A)(_e,[["render",W]]),we=fe;M()(_e,"components",{QTable:ge.A,QInput:$.A,QIcon:K.A,QSpace:me.A,QTr:he.A,QTd:pe.A,QDialog:be.A,QInnerLoading:B.A});var ve=s(60521),ye=s(64775),ke=s(76956),Fe=s(68130),Ae=s(73937),Se=s(77362);const Ce={class:"orderByParentSpan arrow-color"},Le=["data-name"],Ee=["data-name"];function Oe(e,t,s,i,n,a){return(0,r.uX)(),(0,r.CE)("span",Ce,[(0,r.Lk)("span",{class:(0,o.C4)(["up-arrow orderBy absolute",e.sort_by==e.column_name&&"asc"==e.sort_order?"selected":""]),"data-name":e.column_name,"data-direction":"asc",onClick:t[0]||(t[0]=t=>e.OrderBy(e.column_name,"asc"))},null,10,Le),(0,r.Lk)("span",{class:(0,o.C4)(["down-arrow orderBy absolute",e.sort_by==e.column_name&&"desc"==e.sort_order?"selected":""]),"data-name":e.column_name,"data-direction":"desc",onClick:t[1]||(t[1]=t=>e.OrderBy(e.column_name,"desc"))},null,10,Ee)])}const qe=(0,r.pM)({mixins:[],props:{column_name:{type:String,required:!0},prefKey:{type:String,required:!0},sort_by:{type:String,default:""},sort_order:{type:String,default:""}},emits:["sortData"],components:{},watch:{},mounted:function(){},unmounted:function(){},methods:{resetFilters(){let e=document.getElementsByClassName("orderBy selected");Array.from(e).forEach((e=>{e.classList.remove("selected")}))},OrderBy(e,t){this.setOrderByPreference(e,t),this.triggerApplyFilters()},triggerApplyFilters(){const e=new CustomEvent("apply_filters",{detail:{}});document.dispatchEvent(e)},setOrderByPreference(e,t){this.$emit("sortData",e,t)}},setup(){return{}}}),Ue=(0,U.A)(qe,[["render",Oe],["__scopeId","data-v-3d40ccb4"]]),Re=Ue;var Qe=s(25773);const Te=(0,r.Lk)("img",{class:"loading-image",src:"images/loader.gif",alt:"Loading..."},null,-1);function xe(e,t,s,o,i,n){const a=(0,r.g2)("q-toggle"),l=(0,r.g2)("q-inner-loading");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(a,{modelValue:e.user_settings[e.all_sub_org_setting],"onUpdate:modelValue":[t[0]||(t[0]=t=>e.user_settings[e.all_sub_org_setting]=t),t[1]||(t[1]=t=>{e.saveSettings(e.all_sub_org_setting,t)})],label:e.$t("pages.settings.select_all_sub_orgs_setting"),"left-label":""},null,8,["modelValue","label"]),(0,r.bF)(l,{showing:e.loading_settings},{default:(0,r.k6)((()=>[Te])),_:1},8,["showing"])],64)}var $e=s(36801),Ke=function(e,t,s,r){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?s(e.value):o(e.value).then(n,a)}l((r=r.apply(e,t||[])).next())}))};const Ve=(0,r.pM)({name:"AllSubOrgSetting",mixins:[C.A],setup(){const e=(0,J.Bu)(),{user_settings:t,loading_settings:s}=(0,j.bP)(e);return{user_settings:t,loading_settings:s,all_sub_org_setting:ke.nA}},methods:{saveSettings(e,t){return Ke(this,void 0,void 0,(function*(){try{if(yield(0,$e.qf)(e,t),t){const e=new CustomEvent("addAllSubOrg");document.dispatchEvent(e)}else{const e=new CustomEvent("removeAllSubOrg");document.dispatchEvent(e)}this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(s){const e=ye.t.getErrorMessage(s);this.showErrorToast(e),logError(s)}}))}}});var Ne=s(66908);const Be=(0,U.A)(Ve,[["render",xe]]),ze=Be;M()(Ve,"components",{QToggle:Ne.A,QInnerLoading:B.A});var Ie=function(e,t,s,r){function o(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?s(e.value):o(e.value).then(n,a)}l((r=r.apply(e,t||[])).next())}))};const Me=(0,r.pM)({el:"#app",mixins:[C.A,ve.A],components:{SubHeader:Se.A,Create:D,UsersList:we,BackToSettings:Qe.A,GenericColumnOrderBy:Re,AllSubOrgSetting:ze},data(){return{dialog:!1,current_user_id:"",sub_organiztion_form:(0,S.KR)(!1),sub_org_edit_name:(0,S.KR)(""),sub_org_edit_id:(0,S.KR)(""),sub_org_edit_desc:(0,S.KR)(""),sortField:(0,S.KR)(""),sortOrder:(0,S.KR)(""),sub_org_sort_order:ke.C5}},watch:{loading_settings:{handler:function(e,t){!1===e&&this.sortRows()}}},mounted(){this.initView(),document.addEventListener("row_added",this.rowAdded),document.addEventListener("row_editted",this.rowEditted),document.addEventListener("sub_org_user_removed",this.subOrgUserRemoved),document.addEventListener("update_current_user_orgs",this.updateCurrentUserOrganizations)},unmounted(){document.removeEventListener("row_added",this.rowAdded),document.removeEventListener("row_editted",this.rowEditted),document.removeEventListener("sub_org_user_removed",this.subOrgUserRemoved),document.removeEventListener("update_current_user_orgs",this.updateCurrentUserOrganizations)},methods:{initView(){return Ie(this,void 0,void 0,(function*(){try{this.processing=!0,yield this.getList(),this.prepareColumns(),this.sortRows(),this.current_user_id=(0,Ae.Ky)("id")}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}finally{this.processing=!1}}))},openForm(e){e&&(this.sub_org_edit_name=e.name,this.sub_org_edit_id=e.id,this.sub_org_edit_desc=e.description),this.sub_organiztion_form=!0},rowAdded(e){e&&e.detail&&(this.display_create_dialog=!1,this.addNewRow(e.detail),this.resetSubOrgsList())},rowEditted(){this.sub_organiztion_form=!1,this.initView()},deleteRow(){return Ie(this,void 0,void 0,(function*(){try{if(!this.delete_id)return;this.processing=!0,yield E.BS.delete(this.delete_id);let e=-1;this.rows.forEach(((t,s)=>{t["id"]===this.delete_id&&(e=s)})),-1!==e&&delete this.rows[e],yield this.updateCurrentUserSubOrgs(this.delete_id),yield this.resetSubOrgsList(),this.delete_id=""}catch(e){this.showErrorToast(this.$t("pages.messages.error_internal_occur")),logError(e)}finally{this.processing=!1}}))},getList(){return Ie(this,void 0,void 0,(function*(){const e=yield E.BS.getAll();this.prepareRows(e)}))},prepareColumns(){this.columns=[],this.columns.push(Object.assign({},{name:"name",label:"Name",field:"name",align:"left"})),this.columns.push(Object.assign({},{name:"action",label:this.$t("action"),field:"action",align:"right"}))},prepareRows(e){if(e){this.rows=[];for(let[t,s]of Object.entries(e)){const e=s;this.addNewRow(e)}}},addNewRow(e){let t=Object.assign({},e);return this.rows.push(t),this.rows.length.toString()},manageUsers(e){this.selectedId=e.id,this.selectedName=e.name,this.display_users_dialog=!0},updateCurrentUserSubOrgs(e){return Ie(this,void 0,void 0,(function*(){const t=e===this.sub_org_id;if(t&&(yield this.refreshUserOrganizations(),yield this.removeCurrentOrgFromProfile()),!t){const t=Fe.E.getSubOrgbyId(e);t&&0!==Object.keys(t).length&&(yield this.refreshUserOrganizations())}}))},subOrgUserRemoved(e){e&&e.detail&&e.detail.user_id===this.current_user_id&&this.removeSubOrgFromCurrentUserList(e.detail)},removeSubOrgFromCurrentUserList(e){return Ie(this,void 0,void 0,(function*(){const t=yield this.getSubOrgId();t==e.sub_org_id&&(yield this.removeCurrentOrgFromProfile()),this.refreshUserOrganizations()}))},removeCurrentOrgFromProfile(){return Ie(this,void 0,void 0,(function*(){yield Fe.E.setSubOrgId(""),this.sub_org_id="",this.sub_org_name="",this.getMainOrganization()}))},updateCurrentUserOrganizations(e){e&&e.detail&&e.detail===this.current_user_id&&this.refreshUserOrganizations()},sortRows(){const e=this.user_settings[ke.C5];if(!e||0==Object.entries(this.rows).length)return;const t=JSON.parse(e);this.sortField=t.sort_by,this.sortOrder=t.sort_order,this.rows=this.customSort(this.rows,this.sortField,this.sortOrder)},sortData(e,t){e&&(this.rows=this.customSort(this.rows,e,t),this.persistSort(e,t))},persistSort(e,t){this.sortField=e,this.sortOrder=t;const s={sort_by:e,sort_order:t};this.saveSettings(ke.C5,JSON.stringify(s))},saveSettings(e,t){return Ie(this,void 0,void 0,(function*(){if(e)try{yield this.updateSetting(e,t),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(s){const e=ye.t.getErrorMessage(s);this.showErrorToast(e),logError(s)}}))}},setup(){const e=(0,J.kH)(),{getSubOrgId:t,refreshUserOrganizations:s,getMainOrganization:r}=e,{sub_org_id:o,sub_org_name:i}=(0,j.bP)(e),n=(0,J.cY)(),{resetSubOrgsList:a}=n,l=(0,J.Bu)(),{user_settings:d,loading_settings:u}=(0,j.bP)(l),{updateSetting:c}=l;return{refreshUserOrganizations:s,getMainOrganization:r,resetSubOrgsList:a,updateSetting:c,getSubOrgId:t,sub_org_id:o,sub_org_name:i,display_users_dialog:(0,S.KR)(!1),display_create_dialog:(0,S.KR)(!1),selectedId:(0,S.KR)(""),selectedName:(0,S.KR)(""),columns:(0,S.KR)([]),rows:(0,S.KR)([]),delete_confirm:(0,S.KR)(!1),delete_id:(0,S.KR)(""),processing:(0,S.KR)(!1),user_settings:d,loading_settings:u}}});var Pe=s(57722),De=s(84436),je=s(53999),Xe=s(10386),We=s(3952);const Ge=(0,U.A)(Me,[["render",p],["__scopeId","data-v-43998f97"]]),Je=Ge;M()(Me,"components",{QTable:ge.A,QTh:Pe.A,QTd:pe.A,QBtn:oe.A,QMenu:De.A,QList:je.A,QItem:ne.A,QItemSection:ae.A,QSeparator:Xe.A,QDialog:be.A,QCard:R.A,QCardSection:x.A,QAvatar:We.A,QCardActions:N.A,QToolbar:Q.A,QToolbarTitle:T.A,QInnerLoading:B.A}),M()(Me,"directives",{ClosePopup:z.A})}}]);