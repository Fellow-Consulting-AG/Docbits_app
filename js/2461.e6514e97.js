"use strict";(globalThis["webpackChunkfc_ocr_vue"]=globalThis["webpackChunkfc_ocr_vue"]||[]).push([[2461],{22461:(e,l,o)=>{o.r(l),o.d(l,{default:()=>zl});var t=o(83673),i=o(62323);const s=e=>((0,t.dD)("data-v-c41a3e42"),e=e(),(0,t.Cn)(),e),a={class:"row back-white"},d={class:"col-sm-12 col-md-12 col-lg-12 q-pl-md q-pb-lg"},c={class:"secondary-c-text text-h6"},n=s((()=>(0,t._)("img",{width:"24",src:"back-primary.svg"},null,-1))),r={class:"primary-back"},m={class:"col-sm-12 col-md-12 col-lg-12 q-pa-sm"},u={class:"row workflow-builder-box"},w={class:"col-sm-7 col-md-7 col-lg-7 q-pt-lg wf-b-section border-right-D8D8D8-1px"},p={class:"row"},_={class:"col-sm-12 col-md-12 col-lg-12"},f={class:"row"},h={class:"col-sm-2 col-md-2 col-lg-2 text-align-center"},g={class:"center flow-oval-shape text-primary back-white"},v={class:"row"},k={class:"col-sm-2 col-md-2 col-lg-2 text-align-center q-pt-sm q-pb-sm"},b={class:"row"},x={class:"col-sm-2 col-md-2 col-lg-2 text-align-center q-pt-sm q-pb-sm"},q=["onClick"],C={class:"criteria-content"},y={class:"col-sm-1 col-md-1 col-lg-1 align-center flow-text"},I={class:"col-sm-2 col-md-2 col-lg-2 align-center"},R={class:"col-sm-12 col-md-12 col-lg-12 back-white"},W={class:"col-sm-3 col-md-3 col-lg-3 align-center flow-text"},B={class:"center flow-oval-shape text-primary back-white"},V={class:"row"},$={class:"col-sm-2 col-md-2 col-lg-2 text-align-center flow-text q-pt-sm"},D=s((()=>(0,t._)("div",{class:"col-sm-10 col-md-10 col-lg-10 text-align-center"},null,-1))),F={class:"col-sm-2 col-md-2 col-lg-2 text-align-center q-pb-sm"},M=s((()=>(0,t._)("div",{class:"col-sm-10 col-md-10 col-lg-10 text-align-center"},null,-1))),z={class:"row q-mb-md"},Z={class:"col-sm-2 col-md-2 col-lg-2 text-align-center"},A={class:"center flow-oval-shape text-primary back-white"},S={class:"col-sm-5 col-md-5 col-lg-5 wf-b-section"},T={class:"row q-pa-md"},U={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},Q={class:"text-h6"},O={class:"row back-white"},E={class:"col-sm-12 col-md-12 col-lg-12"},H={class:"row"},L={class:"col-sm-12 col-md-12 col-lg-12"},N={class:"row center-inner"};function J(e,l,o,s,J,G){const Y=(0,t.up)("SubHeader"),P=(0,t.up)("q-icon"),j=(0,t.up)("q-btn"),K=(0,t.up)("Criteria"),X=(0,t.up)("Action"),ee=(0,t.up)("q-space"),le=(0,t.up)("q-card-section"),oe=(0,t.up)("q-separator"),te=(0,t.up)("q-option-group"),ie=(0,t.up)("q-card-actions"),se=(0,t.up)("q-card"),ae=(0,t.up)("q-dialog"),de=(0,t.up)("Loader"),ce=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(Y,{name:"workflow_builder",label:e.$t("workflow_builder")+" - WORKFLOW 1",show_expiry_alert:!0,display_help_link:!1},null,8,["label"]),(0,t._)("div",a,[(0,t._)("div",d,[(0,t._)("div",c,[(0,t.Wm)(j,{flat:"",rounded:"","data-cy":"workflow_builder",color:"primary",to:"/workflows"},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{class:"text-red-13",size:"sm"},{default:(0,t.w5)((()=>[n])),_:1}),(0,t._)("label",r,(0,i.zw)(e.$t("processes")),1)])),_:1})])]),(0,t._)("div",m,[(0,t._)("div",u,[(0,t._)("div",w,[(0,t._)("div",p,[(0,t._)("div",_,[(0,t.Wm)(j,{outline:"",icon:"add",color:"primary",label:e.$t("add_criteria"),class:"float-right q-mr-md",onClick:l[0]||(l[0]=l=>e.openAddCriteriadlg())},null,8,["label"])])]),(0,t._)("div",f,[(0,t._)("div",h,[(0,t._)("label",g,(0,i.zw)(e.$t("start")),1)])]),(0,t._)("div",v,[(0,t._)("div",k,[(0,t.Wm)(P,{name:"las la-long-arrow-alt-down color-B1B1B1",size:"lg"})])]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.workflowBuilderModel,((l,o)=>((0,t.wg)(),(0,t.iD)(t.HY,{key:o},[(0,t._)("div",b,[(0,t._)("div",x,[(0,t._)("div",{class:(0,i.C_)(["criteria-box back-white align-center cursor-pointer",o==e.selectedRowIndex&&e.isConditionContent?"active-criteria-box back-white":""]),onClick:l=>e.setSelectionType(!0,o)},[(0,t._)("div",C,(0,i.zw)(e.$t("criteria")),1)],10,q)]),(0,t._)("div",y,[(0,t._)("div",null,[(0,t.Uk)((0,i.zw)(e.$t("true"))+" ",1),(0,t.Wm)(P,{name:"las la-long-arrow-alt-right color-B1B1B1",size:"lg"})])]),(0,t._)("div",I,[(0,t._)("div",{class:(0,i.C_)(["row action-box cursor-pointer",o!=e.selectedRowIndex||e.isConditionContent?"":"active-border"])},[(0,t._)("div",{class:(0,i.C_)(["col-sm-12 col-md-12 col-lg-12 flow-text action-header",o!=e.selectedRowIndex||e.isConditionContent?"":"active-border-bottom"])},(0,i.zw)(e.$t("immediate_action")),3),(0,t._)("div",R,[(0,t.Wm)(j,{flat:"",color:"primary",icon:"add",label:e.$t("add_action"),size:"sm",onClick:l=>e.setSelectionType(!1,o)},null,8,["label","onClick"])])],2)]),(0,t._)("div",W,[(0,t._)("div",null,[(0,t.Wm)(P,{name:"las la-long-arrow-alt-right color-B1B1B1",size:"lg"}),(0,t._)("label",B,(0,i.zw)(e.$t("form_builder.done")),1)])])]),(0,t._)("div",V,[(0,t._)("div",$,(0,i.zw)(e.$t("false")),1),D,(0,t._)("div",F,[(0,t.Wm)(P,{name:"las la-long-arrow-alt-down color-B1B1B1",size:"lg"})]),M])],64)))),128)),(0,t._)("div",z,[(0,t._)("div",Z,[(0,t._)("label",A,(0,i.zw)(e.$t("form_builder.done")),1)])])]),(0,t._)("div",S,[e.isConditionContent&&e.workflowBuilderModel[e.selectedRowIndex]&&e.workflowBuilderModel[e.selectedRowIndex].criteria?((0,t.wg)(),(0,t.j4)(K,{key:0})):(0,t.kq)("",!0),!e.isConditionContent&&e.workflowBuilderModel[e.selectedRowIndex]&&e.workflowBuilderModel[e.selectedRowIndex].action?((0,t.wg)(),(0,t.j4)(X,{key:1})):(0,t.kq)("",!0),(0,t._)("div",T,[(0,t._)("div",U,[(0,t.Wm)(j,{flat:"",color:"primary",label:e.$t("delete_selected_criteria"),class:"float-left",onClick:l[1]||(l[1]=l=>e.deleteSelectedCriteria())},null,8,["label"]),(0,t.Wm)(j,{color:"primary",label:e.$t("save"),class:"float-right",onClick:l[2]||(l[2]=l=>e.saveWorkFlow())},null,8,["label"]),(0,t.Wm)(j,{color:"white","text-color":"black",label:e.$t("cancel"),class:"float-right q-ml-sm q-mr-sm"},null,8,["label"])])])])])])]),(0,t.Wm)(ae,{modelValue:e.showAddCriteriaBox,"onUpdate:modelValue":l[5]||(l[5]=l=>e.showAddCriteriaBox=l),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(se,{style:{width:"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(le,{class:"row items-center q-pb-none secondary-c-text"},{default:(0,t.w5)((()=>[(0,t._)("div",Q,(0,i.zw)(e.$t("add_criteria")),1),(0,t.Wm)(ee)])),_:1}),(0,t.Wm)(oe),(0,t.Wm)(le,null,{default:(0,t.w5)((()=>[(0,t._)("div",O,[(0,t._)("div",E,[(0,t._)("div",H,[(0,t._)("div",L,[(0,t.Wm)(te,{modelValue:e.criteriaValue,"onUpdate:modelValue":l[3]||(l[3]=l=>e.criteriaValue=l),options:e.criteriaOptions,color:"primary"},null,8,["modelValue","options"])]),(0,t.Wm)(oe)])])])])),_:1}),(0,t.Wm)(oe),(0,t.Wm)(ie,{class:"back-white text-teal"},{default:(0,t.w5)((()=>[(0,t._)("div",N,[(0,t.wy)((0,t.Wm)(j,{label:e.$t("cancel"),color:"primary",outline:""},null,8,["label"]),[[ce]]),(0,t.wy)((0,t.Wm)(j,{label:e.$t("create"),color:"primary",onClick:l[4]||(l[4]=l=>e.createCriteria()),class:"q-ml-md"},null,8,["label"]),[[ce]])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(de)],64)}var G=o(10321),Y=o(53371),P=o(77378),j=o(61959),K=o(78564),X=o(72113),ee=o(45401),le=o(80579),oe=o(60727);const te={class:"row q-pa-sm back-white"},ie={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},se={class:"secondary-c-text"},ae={class:"row q-pa-md"},de={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ce={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ne={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},re={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},me={key:0,class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ue={class:"row"},we={key:0,class:"col-sm-12 col-md-12 col-lg-12"},pe={class:"row q-pa-xs q-mt-md"},_e={class:"row q-pa-md workflow-border"},fe=(0,t._)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),he={class:"col-sm-5 col-md-4 col-lg-5 q-pr-sm"},ge={class:"col-sm-5 col-md-4 col-lg-5 q-pl-sm"},ve=(0,t._)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),ke={key:1,class:"row full-width"},be={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs q-mt-md"},xe={class:"col-sm-12 col-md-12 col-lg-12"};function qe(e,l,o,s,a,d){const c=(0,t.up)("q-icon"),n=(0,t.up)("q-input"),r=(0,t.up)("q-item-section"),m=(0,t.up)("q-item"),u=(0,t.up)("q-select"),w=(0,t.up)("ActionFieldsView");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",te,[(0,t._)("div",ie,[(0,t._)("span",se,(0,i.zw)(e.$t("define_action_for_this_group")),1),(0,t.Wm)(c,{name:"help",class:"float-right",size:"sm"})])]),(0,t._)("div",ae,[(0,t._)("div",de,[(0,t.Uk)((0,i.zw)(e.$t("action_name"))+"* ",1),(0,t.Wm)(c,{name:"info",size:"xs"})]),(0,t._)("div",ce,[(0,t.Wm)(n,{outlined:"",dense:"",modelValue:e.workflowBuilderModel[e.selectedRowIndex].action.name,"onUpdate:modelValue":l[0]||(l[0]=l=>e.workflowBuilderModel[e.selectedRowIndex].action.name=l),placeholder:e.$t("name"),class:"back-white"},null,8,["modelValue","placeholder"])]),(0,t._)("div",ne,[(0,t.Uk)((0,i.zw)(e.$t("action_type"))+"* ",1),(0,t.Wm)(c,{name:"info",size:"xs"})]),(0,t._)("div",re,[(0,t.Wm)(u,{dense:"",outlined:"","emit-value":"","map-options":"",clearable:"","use-input":"","hide-selected":"","fill-input":"","hide-dropdown-icon":"",class:"back-white",options:e.actionTypes,modelValue:e.workflowBuilderModel[e.selectedRowIndex].action.type,"onUpdate:modelValue":[l[1]||(l[1]=l=>e.workflowBuilderModel[e.selectedRowIndex].action.type=l),l[2]||(l[2]=l=>e.setActionNode())],"input-debounce":"0",label:e.$t("action_type")},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)(" $t"+(0,i.zw)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:1},8,["options","modelValue","label"])]),e.workflowBuilderModel[e.selectedRowIndex].action.type?((0,t.wg)(),(0,t.iD)("div",me,[(0,t._)("div",ue,[e.workflowBuilderModel[e.selectedRowIndex].action.type==e.fieldUpdate?((0,t.wg)(),(0,t.iD)("div",we,[(0,t._)("div",pe,(0,i.zw)(e.$t("add_actions")),1),(0,t._)("div",_e,[fe,(0,t._)("div",he,(0,i.zw)(e.$t("pages.settings.fields"))+"* ",1),(0,t._)("div",ge,(0,i.zw)(e.$t("value"))+"* ",1),ve,(0,t.Wm)(w)])])):((0,t.wg)(),(0,t.iD)("div",ke,[(0,t._)("div",be,(0,i.zw)(e.$t("status")),1),(0,t._)("div",xe,[(0,t.Wm)(u,{outlined:"",dense:"",modelValue:e.workflowBuilderModel[e.selectedRowIndex].action.action_elements[0].status,"onUpdate:modelValue":l[3]||(l[3]=l=>e.workflowBuilderModel[e.selectedRowIndex].action.action_elements[0].status=l),options:e.document_statuses_list,"emit-value":"","map-options":"",class:"back-white",label:e.$t("status")},null,8,["modelValue","options","label"])])]))])])):(0,t.kq)("",!0)])],64)}var Ce=o(41891);const ye={class:"col-sm-1 col-md-1 col-lg-1"},Ie={class:"workflow-count-box q-mr-md"},Re={class:"col-sm-5 col-md-5 col-lg-5 q-pr-sm"},We={class:"col-sm-5 col-md-5 col-lg-5 q-pl-sm"},Be={class:"col-sm-1 col-md-1 col-lg-1"},Ve={class:"col-sm-12 col-md-12 col-lg-12"};function $e(e,l,o,s,a,d){const c=(0,t.up)("q-item-section"),n=(0,t.up)("q-item"),r=(0,t.up)("q-select"),m=(0,t.up)("q-input"),u=(0,t.up)("q-btn");return(0,t.wg)(),(0,t.iD)(t.HY,null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.workflowBuilderModel[e.selectedRowIndex].action.action_elements,((l,o)=>((0,t.wg)(),(0,t.iD)("div",{key:o+"_"+o,class:"row q-pb-xs full-width"},[(0,t._)("div",ye,[(0,t._)("span",Ie,(0,i.zw)(o+1),1)]),(0,t._)("div",Re,[(0,t.Wm)(r,{dense:"",outlined:"","emit-value":"","map-options":"",clearable:"","use-input":"","hide-selected":"","fill-input":"","hide-dropdown-icon":"",class:"back-white",modelValue:l.field,"onUpdate:modelValue":e=>l.field=e,"input-debounce":"0",label:e.$t("select_a_field"),options:e.filteredDocFields,onFilter:e.filterlistEvent},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)(" $t"+(0,i.zw)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","label","options","onFilter"])]),(0,t._)("div",We,[(0,t.Wm)(m,{outlined:"",dense:"",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,class:"back-white"},null,8,["modelValue","onUpdate:modelValue"])]),(0,t._)("div",Be,[(0,t.Wm)(u,{flat:"",color:"primary",icon:"close",onClick:l=>e.removeAction(o)},null,8,["onClick"])])])))),128)),(0,t._)("div",Ve,[(0,t.Wm)(u,{flat:"",color:"primary",icon:"add",label:e.$t("pages.settings.master_data_lookup.add_row"),onClick:l[0]||(l[0]=l=>e.addRowToActions(e.selectedRowIndex))},null,8,["label"])])],64)}const De=(0,t.aZ)({el:"#app",mixins:[],components:{},data(){return{criteriaName:(0,j.iH)("")}},mounted(){this.loadDocumentDefaultFields("INVOICE")},methods:{filterlistEvent(e,l,o){l(e?()=>{const l=e.toLowerCase();this.filteredDocFields=this.docFields.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{this.filteredDocFields=this.docFields})},removeAction(e){this.workflowBuilderModel[this.selectedRowIndex].action.action_elements.splice(e,1)}},setup(){const e=(0,oe.zG)(),{loadDocumentDefaultFields:l,addRowToActions:o}=e,{docFields:t,workflowBuilderModel:i,selectedRowIndex:s}=(0,G.Jk)(e);return{docFields:t,filteredDocFields:(0,j.iH)([]),selectedRowIndex:s,workflowBuilderModel:i,addRowToActions:o,loadDocumentDefaultFields:l}}});var Fe=o(74260),Me=o(72448),ze=o(83414),Ze=o(52035),Ae=o(64689),Se=o(2165),Te=o(7518),Ue=o.n(Te);const Qe=(0,Fe.Z)(De,[["render",$e]]),Oe=Qe;Ue()(De,"components",{QSelect:Me.Z,QItem:ze.Z,QItemSection:Ze.Z,QInput:Ae.Z,QBtn:Se.Z});const Ee=(0,t.aZ)({name:"ActionFieldView",mixins:[],components:{ActionFieldsView:Oe},data(){return{fieldUpdate:Ce.tl.field_update}},mounted:function(){this.getDocumentStatuses()},methods:{setActionNode(){this.workflowBuilderModel[this.selectedRowIndex].action.action_elements=[],this.workflowBuilderModel[this.selectedRowIndex].action.type==this.fieldUpdate?this.addRowToActions(this.selectedRowIndex):this.addRowToActionsForStatusChange(this.selectedRowIndex)}},setup(){const e=(0,oe.zG)(),{addRowToActions:l,addRowToActionsForStatusChange:o}=e,{workflowBuilderModel:t,selectedRowIndex:i}=(0,G.Jk)(e),s=(0,oe.At)(),{document_statuses_list:a}=(0,G.Jk)(s),{getDocumentStatuses:d}=s;return{selectedRowIndex:i,workflowBuilderModel:t,actionTypes:[{label:"Update Field",value:Ce.tl.field_update},{label:"Change Status",value:Ce.tl.status_change}],document_statuses_list:a,getDocumentStatuses:d,addRowToActions:l,addRowToActionsForStatusChange:o}}});var He=o(24554);const Le=(0,Fe.Z)(Ee,[["render",qe]]),Ne=Le;Ue()(Ee,"components",{QIcon:He.Z,QInput:Ae.Z,QSelect:Me.Z,QItem:ze.Z,QItemSection:Ze.Z});const Je={class:"row q-pa-sm back-white"},Ge={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},Ye={class:"secondary-c-text"},Pe={class:"row q-pa-md"},je={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},Ke={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},Xe={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs q-mt-md"},el={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"},ll={class:"row q-pa-md workflow-border"},ol=(0,t._)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),tl={class:"col-sm-4 col-md-4 col-lg-4"},il={class:"col-sm-2 col-md-2 col-lg-2"},sl={class:"col-sm-4 col-md-4 col-lg-4 q-pl-md"},al=(0,t._)("div",{class:"col-sm-1 col-md-1 col-lg-1"},null,-1),dl={class:"col-sm-12 col-md-12 col-lg-12 q-pa-xs"};function cl(e,l,o,s,a,d){const c=(0,t.up)("q-icon"),n=(0,t.up)("q-input"),r=(0,t.up)("CriteriaFieldView"),m=(0,t.up)("q-option-group");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",Je,[(0,t._)("div",Ge,[(0,t._)("span",Ye,(0,i.zw)(e.$t("define_criteria_for_action_group")),1),(0,t.Wm)(c,{name:"help",class:"float-right",size:"sm"})])]),(0,t._)("div",Pe,[(0,t._)("div",je,[(0,t.Uk)((0,i.zw)(e.$t("criteria_name")+"*")+" ",1),(0,t.Wm)(c,{name:"info",size:"xs"})]),(0,t._)("div",Ke,[(0,t.Wm)(n,{outlined:"",dense:"",modelValue:e.workflowBuilderModel[e.selectedRowIndex].criteria.name,"onUpdate:modelValue":l[0]||(l[0]=l=>e.workflowBuilderModel[e.selectedRowIndex].criteria.name=l),placeholder:e.$t("name"),class:"back-white"},null,8,["modelValue","placeholder"])]),(0,t._)("div",Xe,(0,i.zw)(e.$t("set_conditions")),1),(0,t._)("div",el,[(0,t._)("div",ll,[ol,(0,t._)("div",tl,(0,i.zw)(e.$t("pages.settings.fields"))+"* ",1),(0,t._)("div",il,(0,i.zw)(e.$t("operator"))+"* ",1),(0,t._)("div",sl,(0,i.zw)(e.$t("doc2light.popups.value"))+"* ",1),al,(0,t.Wm)(r)])]),(0,t._)("div",dl,[(0,t.Wm)(m,{modelValue:e.workflowBuilderModel[e.selectedRowIndex].criteria.type,"onUpdate:modelValue":l[1]||(l[1]=l=>e.workflowBuilderModel[e.selectedRowIndex].criteria.type=l),options:e.operatorOptions,color:"primary"},null,8,["modelValue","options"])])])],64)}const nl={class:"col-sm-1 col-md-1 col-lg-1"},rl={class:"workflow-count-box q-mr-md"},ml={class:"col-sm-4 col-md-4 col-lg-4 q-pr-md"},ul={class:"col-sm-2 col-md-2 col-lg-2"},wl={class:"col-sm-4 col-md-4 col-lg-4 q-pl-md"},pl={class:"col-sm-1 col-md-1 col-lg-1"},_l={class:"col-sm-12 col-md-12 col-lg-12"};function fl(e,l,o,s,a,d){const c=(0,t.up)("q-item-section"),n=(0,t.up)("q-item"),r=(0,t.up)("q-select"),m=(0,t.up)("q-input"),u=(0,t.up)("q-btn");return(0,t.wg)(),(0,t.iD)(t.HY,null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.workflowBuilderModel[e.selectedRowIndex].criteria.condition_elements,((l,o)=>((0,t.wg)(),(0,t.iD)("div",{key:o,class:"row q-pb-xs full-width"},[(0,t._)("div",nl,[(0,t._)("span",rl,(0,i.zw)(o+1),1)]),(0,t._)("div",ml,[(0,t.Wm)(r,{dense:"",outlined:"","emit-value":"","map-options":"",clearable:"","use-input":"","hide-selected":"","fill-input":"","hide-dropdown-icon":"",class:"back-white",modelValue:l.key,"onUpdate:modelValue":e=>l.key=e,"input-debounce":"0",label:e.$t("select_a_field"),options:e.filteredDocFields,onFilter:e.filterlistEvent},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)(" $t"+(0,i.zw)(e.$t("no_data_found")),1)])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","label","options","onFilter"])]),(0,t._)("div",ul,[(0,t.Wm)(r,{dense:"",outlined:"",modelValue:l.match_type,"onUpdate:modelValue":e=>l.match_type=e,class:"back-white",label:e.$t("please_select"),"emit-value":"","map-options":"",options:e.operators},null,8,["modelValue","onUpdate:modelValue","label","options"])]),(0,t._)("div",wl,[(0,t.Wm)(m,{outlined:"",dense:"",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,class:"back-white"},null,8,["modelValue","onUpdate:modelValue"])]),(0,t._)("div",pl,[(0,t.Wm)(u,{flat:"",color:"primary",icon:"close",onClick:l=>e.removeCondition(o)},null,8,["onClick"])])])))),128)),(0,t._)("div",_l,[(0,t.Wm)(u,{flat:"",color:"primary",icon:"add",label:e.$t("pages.settings.master_data_lookup.add_row"),onClick:l[0]||(l[0]=l=>e.addRowToCondition(e.selectedRowIndex))},null,8,["label"])])],64)}const hl=(0,t.aZ)({name:"criteriaField",mixins:[],components:{},data(){return{criteriaName:(0,j.iH)("")}},mounted(){const e=this.$route.params.doc_type;this.loadDocumentDefaultFields(e)},methods:{filterlistEvent(e,l,o){l(e?()=>{const l=e.toLowerCase();this.filteredDocFields=this.docFields.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{this.filteredDocFields=this.docFields})},removeCondition(e){this.workflowBuilderModel[this.selectedRowIndex].criteria.condition_elements.splice(e,1)}},setup(){const e=(0,oe.zG)(),{loadDocumentDefaultFields:l,addRowToCondition:o}=e,{docFields:t,workflowBuilderModel:i,selectedRowIndex:s}=(0,G.Jk)(e);return{docFields:t,filteredDocFields:(0,j.iH)([]),selectedRowIndex:s,workflowBuilderModel:i,addRowToCondition:o,loadDocumentDefaultFields:l,operators:[{value:"eq",label:Y.i18n.t("equal")},{value:"ne",label:Y.i18n.t("not_equal")},{value:"gt",label:Y.i18n.t("greater_than")},{value:"lt",label:Y.i18n.t("less_than")}]}}}),gl=(0,Fe.Z)(hl,[["render",fl]]),vl=gl;Ue()(hl,"components",{QSelect:Me.Z,QItem:ze.Z,QItemSection:Ze.Z,QInput:Ae.Z,QBtn:Se.Z});const kl=(0,t.aZ)({name:"criteriaField",mixins:[],components:{CriteriaFieldView:vl},data(){return{}},methods:{},setup(){const e=(0,oe.zG)(),{workflowBuilderModel:l,selectedRowIndex:o}=(0,G.Jk)(e);return{selectedRowIndex:o,workflowBuilderModel:l,operatorOptions:[{label:Y.i18n.t("all_conditions_met_and"),value:"and"},{label:Y.i18n.t("all_conditions_met_or"),value:"or"}],criteriaOptions:[{label:Y.i18n.t("update_records_that_meet_all_conditions"),value:"all_conditions"},{label:Y.i18n.t("no_criteria_update_all_records"),value:"no_conditions"}]}}});var bl=o(75682);const xl=(0,Fe.Z)(kl,[["render",cl]]),ql=xl;Ue()(kl,"components",{QIcon:He.Z,QInput:Ae.Z,QOptionGroup:bl.Z});var Cl=o(13873),yl=function(e,l,o,t){function i(e){return e instanceof o?e:new o((function(l){l(e)}))}return new(o||(o=Promise))((function(o,s){function a(e){try{c(t.next(e))}catch(l){s(l)}}function d(e){try{c(t["throw"](e))}catch(l){s(l)}}function c(e){e.done?o(e.value):i(e.value).then(a,d)}c((t=t.apply(e,l||[])).next())}))};const Il=(0,t.aZ)({name:"workflowDesigner",mixins:[P.Z,K.Z,ee.Z],components:{Loader:X.Z,SubHeader:Cl.Z,Criteria:ql,Action:Ne},data(){return{workFlowId:(0,j.iH)(""),criteriaValue:(0,j.iH)("after"),showAddCriteriaBox:(0,j.iH)(!1),isConditionContent:(0,j.iH)(!0)}},mounted(){this.workflowBuilderModel=[],this.workFlowId=this.$route.params.id,this.workFlowId&&(this.loadWorkFlowBuilderById(),this.prepareCriteriaOptions())},unmounted:function(){},methods:{openAddCriteriadlg(){this.showAddCriteriaBox=!0,this.criteriaValue="after"},createCriteria(){let e=this.selectedRowIndex;"after"==this.criteriaValue&&(e+=1),this.addCriteria(e)},deleteSelectedCriteria(){let e=this.deleteCriteria(this.selectedRowIndex);e?this.showSuccessToast(this.$t("pages.messages.CRITERIA_DELETED")):this.showSuccessToast(this.$t("pages.messages.CRITERIA_VALUE_CLEARED"))},setSelectionType(e,l){this.isConditionContent=e,this.selectedRowIndex=l},loadWorkFlowBuilderById(){return yl(this,void 0,void 0,(function*(){let e;try{this.showLoading(),e=yield le.fo.getWorkflowJson(this.workFlowId),e&&e.conditions&&e.actions&&e.logic?this.prepareWorkflowBuilderModel(e):this.loadDefaultWorkFlowJson()}catch(l){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}}))},prepareWorkflowBuilderModel(e){let l=new Map,o=new Map,t=new Map;for(const d of e.conditions)t.set(d.id,d);for(const d of e.actions)o.set(d.id,d);for(const d of e.logic.nodes)d.hasOwnProperty("next_step")||l.set(d.id,d);let i=e.logic.start,s={criteria:t.get(i.id),action:o.get(i.true)},a=i.false;this.workflowBuilderModel.push(s);while(l.size>0)i=l.get(a),s={criteria:t.get(i.id),action:o.get(i.true)},this.workflowBuilderModel.push(s),a=i.false,l.delete(i.id)},validateConditionsNode(e,l){let o=!1;e.name||(o=!0);for(const t of e.condition_elements)if(!t.key||!t.match_type||!t.value){this.setSelectionType(!0,l),o=!0;break}return o},validateActionNode(e,l){let o=!1;e.name||(o=!0);for(const t of e.action_elements)if(t.hasOwnProperty("field")&&!t.field||t.hasOwnProperty("value")&&!t.value||t.hasOwnProperty("status")&&!t.status){this.setSelectionType(!1,l),o=!0;break}return o},saveWorkFlow(){0==this.workflowBuilderModel.length&&this.showErrorToast("No Data found to save");let e=[],l=[],o=[],t={},i=null,s=null;for(const[d,c]of Object.entries(this.workflowBuilderModel)){let t=c;if(this.validateConditionsNode(t.criteria,+d)||this.validateActionNode(t.action,+d))return void this.showErrorToast(this.$t("pages.messages.MISSING_FIELD"));e.push(t.criteria),l.push(t.action),i=this.workflowBuilderModel[+d+1],s=null,i&&(s=i.criteria.id),o.push(Object.assign({},{false:s,id:t.criteria.id,true:t.action.id})),o.push(Object.assign({},{id:t.action.id,next_step:null}))}t=o[0],o.splice(0,1);const a={actions:l,conditions:e,logic:{nodes:o,start:t}};this.proceedWorkflowSaving(a)},proceedWorkflowSaving(e){try{this.showLoading(),this.showSuccessToast(this.$t("pages.messages.MSG_SAVE"))}catch(l){this.showErrorToast(this.$t("pages.messages.ERROR_INTERNAL_OCCUR"))}finally{this.hideLoading()}},prepareCriteriaOptions(){this.criteriaOptions=[{label:Y.i18n.t("add_criteria_after_current_criteria"),value:"after"},{label:Y.i18n.t("add_criteria_before_current_criteria"),value:"before"}]}},setup(){const e=(0,oe.zG)(),{addCriteria:l,deleteCriteria:o,loadDefaultWorkFlowJson:t}=e,{workflowBuilderModel:i,selectedRowIndex:s}=(0,G.Jk)(e);return e.$reset(),{selectedRowIndex:s,workflowBuilderModel:i,addCriteria:l,deleteCriteria:o,loadDefaultWorkFlowJson:t,criteriaOptions:(0,j.iH)([])}}});var Rl=o(46778),Wl=o(10151),Bl=o(25589),Vl=o(62025),$l=o(65869),Dl=o(99367),Fl=o(60677);const Ml=(0,Fe.Z)(Il,[["render",J],["__scopeId","data-v-c41a3e42"]]),zl=Ml;Ue()(Il,"components",{QBtn:Se.Z,QIcon:He.Z,QDialog:Rl.Z,QCard:Wl.Z,QCardSection:Bl.Z,QSpace:Vl.Z,QSeparator:$l.Z,QOptionGroup:bl.Z,QCardActions:Dl.Z}),Ue()(Il,"directives",{ClosePopup:Fl.Z})}}]);